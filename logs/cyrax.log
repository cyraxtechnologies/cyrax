{"asctime": "2025-10-29 00:33:29,980", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-10-29 00:33:29,980", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-10-29 00:33:30,015", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-10-29 00:33:30,015", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-10-29 00:33:30,016", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-10-29 00:33:30,016", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-10-29 00:33:30,016", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-10-29 00:33:30,016", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-10-29 00:33:30,017", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-29 00:33:30,018", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-29 00:33:30,018", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00014s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-29 00:33:30,022", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-29 00:33:30,022", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.00416s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-29 00:33:30,023", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-29 00:33:30,023", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.004706s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-29 00:33:30,025", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-29 00:33:30,025", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00011s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-29 00:33:30,025", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "CREATE TYPE userstatus AS ENUM ('PENDING_VERIFICATION', 'ACTIVE', 'SUSPENDED', 'BLOCKED')"}
{"asctime": "2025-10-29 00:33:30,026", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[no key 0.00007s] {}"}
{"asctime": "2025-10-29 00:33:30,031", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-29 00:33:30,031", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.006278s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-29 00:33:30,032", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "CREATE TYPE transactiontype AS ENUM ('SEND_MONEY', 'RECEIVE_MONEY', 'BILL_PAYMENT', 'AIRTIME_PURCHASE', 'DATA_PURCHASE', 'ELECTRICITY_PURCHASE', 'WITHDRAWAL', 'DEPOSIT', 'REFUND')"}
{"asctime": "2025-10-29 00:33:30,032", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[no key 0.00008s] {}"}
{"asctime": "2025-10-29 00:33:30,032", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-29 00:33:30,032", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.007525s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-29 00:33:30,033", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "CREATE TYPE transactionstatus AS ENUM ('PENDING', 'PROCESSING', 'COMPLETED', 'FAILED', 'REVERSED')"}
{"asctime": "2025-10-29 00:33:30,033", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[no key 0.00006s] {}"}
{"asctime": "2025-10-29 00:33:30,034", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "\nCREATE TABLE users (\n\tid UUID NOT NULL, \n\tphone_number VARCHAR(20) NOT NULL, \n\temail VARCHAR(255), \n\twhatsapp_name VARCHAR(255), \n\tfirst_name VARCHAR(100), \n\tlast_name VARCHAR(100), \n\tid_number VARCHAR(20), \n\tdate_of_birth TIMESTAMP WITHOUT TIME ZONE, \n\tnationality VARCHAR(50), \n\taddress_line1 VARCHAR(255), \n\taddress_line2 VARCHAR(255), \n\tcity VARCHAR(100), \n\tprovince VARCHAR(100), \n\tpostal_code VARCHAR(10), \n\tcountry VARCHAR(50), \n\taccount_number VARCHAR(50), \n\tbalance FLOAT NOT NULL, \n\tstatus userstatus, \n\tpin_hash VARCHAR(255), \n\tpin_attempts INTEGER, \n\tpin_locked_until TIMESTAMP WITHOUT TIME ZONE, \n\tis_phone_verified BOOLEAN, \n\tis_email_verified BOOLEAN, \n\tis_id_verified BOOLEAN, \n\tis_address_verified BOOLEAN, \n\tis_fica_compliant BOOLEAN, \n\tid_document_url VARCHAR(500), \n\tproof_of_residence_url VARCHAR(500), \n\tselfie_url VARCHAR(500), \n\tdaily_limit FLOAT, \n\tmonthly_limit FLOAT, \n\tdaily_spent FLOAT, \n\tmonthly_spent FLOAT, \n\tlast_daily_reset TIMESTAMP WITHOUT TIME ZONE, \n\tlast_monthly_reset TIMESTAMP WITHOUT TIME ZONE, \n\tpreferred_language VARCHAR(10), \n\tnotification_enabled BOOLEAN, \n\tmarketing_consent BOOLEAN, \n\tuser_metadata JSONB, \n\treferral_code VARCHAR(20), \n\treferred_by UUID, \n\tcreated_at TIMESTAMP WITHOUT TIME ZONE NOT NULL, \n\tupdated_at TIMESTAMP WITHOUT TIME ZONE, \n\tlast_active_at TIMESTAMP WITHOUT TIME ZONE, \n\tverified_at TIMESTAMP WITHOUT TIME ZONE, \n\tPRIMARY KEY (id), \n\tUNIQUE (email), \n\tUNIQUE (id_number), \n\tUNIQUE (account_number), \n\tUNIQUE (referral_code)\n)\n\n"}
{"asctime": "2025-10-29 00:33:30,034", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[no key 0.00011s] {}"}
{"asctime": "2025-10-29 00:33:30,061", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "CREATE UNIQUE INDEX ix_users_phone_number ON users (phone_number)"}
{"asctime": "2025-10-29 00:33:30,061", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[no key 0.00027s] {}"}
{"asctime": "2025-10-29 00:33:30,064", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "\nCREATE TABLE conversations (\n\tid UUID NOT NULL, \n\tuser_id UUID, \n\tphone_number VARCHAR(20) NOT NULL, \n\tmessage_id VARCHAR(100), \n\tmessage_type VARCHAR(20) NOT NULL, \n\tdirection VARCHAR(10) NOT NULL, \n\tmessage_text TEXT, \n\tmedia_url VARCHAR(500), \n\tmedia_mime_type VARCHAR(50), \n\tai_response TEXT, \n\tintent_detected VARCHAR(50), \n\tentities_extracted JSONB, \n\tconfidence_score FLOAT, \n\tprocessing_time_ms INTEGER, \n\tconversation_context JSONB, \n\tsession_id VARCHAR(100), \n\tis_processed BOOLEAN, \n\tis_error BOOLEAN, \n\terror_message TEXT, \n\tconversation_metadata JSONB, \n\tcreated_at TIMESTAMP WITHOUT TIME ZONE NOT NULL, \n\tprocessed_at TIMESTAMP WITHOUT TIME ZONE, \n\tPRIMARY KEY (id), \n\tFOREIGN KEY(user_id) REFERENCES users (id), \n\tUNIQUE (message_id)\n)\n\n"}
{"asctime": "2025-10-29 00:33:30,064", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[no key 0.00021s] {}"}
{"asctime": "2025-10-29 00:33:30,068", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "CREATE INDEX ix_conversations_user_id ON conversations (user_id)"}
{"asctime": "2025-10-29 00:33:30,068", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[no key 0.00008s] {}"}
{"asctime": "2025-10-29 00:33:30,069", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "CREATE INDEX ix_conversations_session_id ON conversations (session_id)"}
{"asctime": "2025-10-29 00:33:30,069", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[no key 0.00005s] {}"}
{"asctime": "2025-10-29 00:33:30,070", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "CREATE INDEX ix_conversations_phone_number ON conversations (phone_number)"}
{"asctime": "2025-10-29 00:33:30,070", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[no key 0.00006s] {}"}
{"asctime": "2025-10-29 00:33:30,071", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "CREATE INDEX ix_conversations_created_at ON conversations (created_at)"}
{"asctime": "2025-10-29 00:33:30,071", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[no key 0.00005s] {}"}
{"asctime": "2025-10-29 00:33:30,073", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "\nCREATE TABLE transactions (\n\tid UUID NOT NULL, \n\tuser_id UUID NOT NULL, \n\ttype transactiontype NOT NULL, \n\tstatus transactionstatus, \n\tamount FLOAT NOT NULL, \n\tcurrency VARCHAR(3), \n\tsender_phone VARCHAR(20), \n\trecipient_phone VARCHAR(20), \n\trecipient_name VARCHAR(255), \n\trecipient_bank VARCHAR(100), \n\trecipient_account VARCHAR(50), \n\tbill_provider VARCHAR(100), \n\tbill_account_number VARCHAR(100), \n\tbill_reference VARCHAR(100), \n\tpayment_reference VARCHAR(100), \n\tgateway_reference VARCHAR(100), \n\tgateway_response JSONB, \n\ttransaction_fee FLOAT, \n\tgateway_fee FLOAT, \n\ttotal_amount FLOAT NOT NULL, \n\tbalance_before FLOAT, \n\tbalance_after FLOAT, \n\tdescription TEXT, \n\tuser_note TEXT, \n\tadmin_note TEXT, \n\toriginal_message TEXT, \n\tintent_detected VARCHAR(50), \n\tfailure_reason TEXT, \n\tretry_count INTEGER, \n\ttransaction_metadata JSONB, \n\tip_address VARCHAR(50), \n\tdevice_info VARCHAR(255), \n\tcreated_at TIMESTAMP WITHOUT TIME ZONE NOT NULL, \n\tupdated_at TIMESTAMP WITHOUT TIME ZONE, \n\tcompleted_at TIMESTAMP WITHOUT TIME ZONE, \n\tfailed_at TIMESTAMP WITHOUT TIME ZONE, \n\tPRIMARY KEY (id), \n\tFOREIGN KEY(user_id) REFERENCES users (id)\n)\n\n"}
{"asctime": "2025-10-29 00:33:30,073", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[no key 0.00010s] {}"}
{"asctime": "2025-10-29 00:33:30,075", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "CREATE INDEX ix_transactions_status ON transactions (status)"}
{"asctime": "2025-10-29 00:33:30,076", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[no key 0.00006s] {}"}
{"asctime": "2025-10-29 00:33:30,077", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "CREATE INDEX ix_transactions_user_id ON transactions (user_id)"}
{"asctime": "2025-10-29 00:33:30,077", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[no key 0.00005s] {}"}
{"asctime": "2025-10-29 00:33:30,078", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "CREATE UNIQUE INDEX ix_transactions_payment_reference ON transactions (payment_reference)"}
{"asctime": "2025-10-29 00:33:30,078", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[no key 0.00006s] {}"}
{"asctime": "2025-10-29 00:33:30,079", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "CREATE INDEX ix_transactions_created_at ON transactions (created_at)"}
{"asctime": "2025-10-29 00:33:30,079", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[no key 0.00005s] {}"}
{"asctime": "2025-10-29 00:33:30,079", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "CREATE INDEX ix_transactions_type ON transactions (type)"}
{"asctime": "2025-10-29 00:33:30,080", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[no key 0.00007s] {}"}
{"asctime": "2025-10-29 00:33:30,080", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-10-29 00:33:30,081", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-10-29 00:33:30,081", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-10-29 00:33:30,081", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-10-29 00:36:42,035", "name": "app.main", "levelname": "ERROR", "message": "Health check failed: Textual SQL expression 'SELECT 1' should be explicitly declared as text('SELECT 1')"}
{"asctime": "2025-10-29 17:20:55,347", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-10-29 17:20:55,994", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-10-29 17:20:55,994", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-10-29 17:20:56,021", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-10-29 17:20:56,021", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-10-29 17:20:56,022", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-10-29 17:20:56,022", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-10-29 17:20:56,023", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-10-29 17:20:56,023", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-10-29 17:20:56,023", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-29 17:20:56,024", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-29 17:20:56,024", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00012s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-29 17:20:56,029", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-29 17:20:56,029", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.004356s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-29 17:20:56,029", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-29 17:20:56,029", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.004996s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-29 17:20:56,031", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-29 17:20:56,031", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00011s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-29 17:20:56,032", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-29 17:20:56,032", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001157s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-29 17:20:56,032", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-29 17:20:56,032", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001642s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-29 17:20:56,033", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-10-29 17:20:56,033", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-10-29 17:20:56,033", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-10-29 17:20:56,033", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-10-29 17:21:14,860", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-29 17:21:14,861", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT 1"}
{"asctime": "2025-10-29 17:21:14,861", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00010s] {}"}
{"asctime": "2025-10-29 17:21:14,861", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "ROLLBACK"}
{"asctime": "2025-10-29 22:44:24,178", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-29 22:44:24,192", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT count(users.id) AS count_1 \nFROM users"}
{"asctime": "2025-10-29 22:44:24,192", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00052s] {}"}
{"asctime": "2025-10-29 22:44:24,199", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT count(users.id) AS count_1 \nFROM users \nWHERE users.status = %(status_1)s"}
{"asctime": "2025-10-29 22:44:24,200", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00022s] {'status_1': 'ACTIVE'}"}
{"asctime": "2025-10-29 22:44:24,203", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT count(users.id) AS count_1 \nFROM users \nWHERE users.is_fica_compliant = true"}
{"asctime": "2025-10-29 22:44:24,203", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00014s] {}"}
{"asctime": "2025-10-29 22:44:24,204", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT count(transactions.id) AS count_1 \nFROM transactions"}
{"asctime": "2025-10-29 22:44:24,204", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00013s] {}"}
{"asctime": "2025-10-29 22:44:24,208", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT count(transactions.id) AS count_1 \nFROM transactions \nWHERE transactions.status = %(status_1)s"}
{"asctime": "2025-10-29 22:44:24,208", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00014s] {'status_1': 'COMPLETED'}"}
{"asctime": "2025-10-29 22:44:24,209", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT count(transactions.id) AS count_1 \nFROM transactions \nWHERE transactions.status = %(status_1)s"}
{"asctime": "2025-10-29 22:44:24,209", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001184s ago] {'status_1': 'FAILED'}"}
{"asctime": "2025-10-29 22:44:24,210", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT sum(transactions.amount) AS sum_1 \nFROM transactions \nWHERE transactions.status = %(status_1)s"}
{"asctime": "2025-10-29 22:44:24,211", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00012s] {'status_1': 'COMPLETED'}"}
{"asctime": "2025-10-29 22:44:24,213", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT count(conversations.id) AS count_1 \nFROM conversations"}
{"asctime": "2025-10-29 22:44:24,213", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00012s] {}"}
{"asctime": "2025-10-29 22:44:24,217", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "ROLLBACK"}
{"asctime": "2025-10-29 22:52:07,031", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-29 22:52:07,046", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT transactions.id AS transactions_id, transactions.user_id AS transactions_user_id, transactions.type AS transactions_type, transactions.status AS transactions_status, transactions.amount AS transactions_amount, transactions.currency AS transactions_currency, transactions.sender_phone AS transactions_sender_phone, transactions.recipient_phone AS transactions_recipient_phone, transactions.recipient_name AS transactions_recipient_name, transactions.recipient_bank AS transactions_recipient_bank, transactions.recipient_account AS transactions_recipient_account, transactions.bill_provider AS transactions_bill_provider, transactions.bill_account_number AS transactions_bill_account_number, transactions.bill_reference AS transactions_bill_reference, transactions.payment_reference AS transactions_payment_reference, transactions.gateway_reference AS transactions_gateway_reference, transactions.gateway_response AS transactions_gateway_response, transactions.transaction_fee AS transactions_transaction_fee, transactions.gateway_fee AS transactions_gateway_fee, transactions.total_amount AS transactions_total_amount, transactions.balance_before AS transactions_balance_before, transactions.balance_after AS transactions_balance_after, transactions.description AS transactions_description, transactions.user_note AS transactions_user_note, transactions.admin_note AS transactions_admin_note, transactions.original_message AS transactions_original_message, transactions.intent_detected AS transactions_intent_detected, transactions.failure_reason AS transactions_failure_reason, transactions.retry_count AS transactions_retry_count, transactions.transaction_metadata AS transactions_transaction_metadata, transactions.ip_address AS transactions_ip_address, transactions.device_info AS transactions_device_info, transactions.created_at AS transactions_created_at, transactions.updated_at AS transactions_updated_at, transactions.completed_at AS transactions_completed_at, transactions.failed_at AS transactions_failed_at \nFROM transactions ORDER BY transactions.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-10-29 22:52:07,046", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00041s] {'param_1': 20}"}
{"asctime": "2025-10-29 22:52:07,059", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "ROLLBACK"}
{"asctime": "2025-10-29 23:11:09,781", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-10-29 23:12:10,685", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-10-29 23:12:10,685", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-10-29 23:12:10,783", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-10-29 23:12:10,783", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-10-29 23:12:10,785", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-10-29 23:12:10,785", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-10-29 23:12:10,786", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-10-29 23:12:10,786", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-10-29 23:12:10,787", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-29 23:12:10,788", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-29 23:12:10,789", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00014s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-29 23:12:10,790", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-29 23:12:10,790", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001623s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-29 23:12:10,791", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-29 23:12:10,791", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002221s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-29 23:12:10,793", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-29 23:12:10,793", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00016s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-29 23:12:10,794", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-29 23:12:10,794", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0009575s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-29 23:12:10,794", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-29 23:12:10,794", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001469s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-29 23:12:10,795", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-10-29 23:12:10,795", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-10-29 23:12:10,795", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-10-29 23:12:10,795", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-10-29 23:16:26,288", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-29 23:16:26,294", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT count(users.id) AS count_1 \nFROM users"}
{"asctime": "2025-10-29 23:16:26,294", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00021s] {}"}
{"asctime": "2025-10-29 23:16:26,300", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT count(users.id) AS count_1 \nFROM users \nWHERE users.status = %(status_1)s"}
{"asctime": "2025-10-29 23:16:26,300", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00014s] {'status_1': 'ACTIVE'}"}
{"asctime": "2025-10-29 23:16:26,301", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT count(users.id) AS count_1 \nFROM users \nWHERE users.is_fica_compliant = true"}
{"asctime": "2025-10-29 23:16:26,301", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00013s] {}"}
{"asctime": "2025-10-29 23:16:26,302", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT count(transactions.id) AS count_1 \nFROM transactions"}
{"asctime": "2025-10-29 23:16:26,302", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00010s] {}"}
{"asctime": "2025-10-29 23:16:26,304", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT count(transactions.id) AS count_1 \nFROM transactions \nWHERE transactions.status = %(status_1)s"}
{"asctime": "2025-10-29 23:16:26,304", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00012s] {'status_1': 'COMPLETED'}"}
{"asctime": "2025-10-29 23:16:26,304", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT count(transactions.id) AS count_1 \nFROM transactions \nWHERE transactions.status = %(status_1)s"}
{"asctime": "2025-10-29 23:16:26,304", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0007139s ago] {'status_1': 'FAILED'}"}
{"asctime": "2025-10-29 23:16:26,305", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT sum(transactions.amount) AS sum_1 \nFROM transactions \nWHERE transactions.status = %(status_1)s"}
{"asctime": "2025-10-29 23:16:26,305", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00010s] {'status_1': 'COMPLETED'}"}
{"asctime": "2025-10-29 23:16:26,306", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT count(conversations.id) AS count_1 \nFROM conversations"}
{"asctime": "2025-10-29 23:16:26,306", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00017s] {}"}
{"asctime": "2025-10-29 23:16:26,308", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "ROLLBACK"}
{"asctime": "2025-10-29 23:18:54,904", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-10-29 23:18:55,522", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-10-29 23:18:55,522", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-10-29 23:18:55,536", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-10-29 23:18:55,536", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-10-29 23:18:55,537", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-10-29 23:18:55,537", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-10-29 23:18:55,537", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-10-29 23:18:55,538", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-10-29 23:18:55,538", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-29 23:18:55,539", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-29 23:18:55,539", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00010s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-29 23:18:55,541", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-29 23:18:55,542", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002606s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-29 23:18:55,542", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-29 23:18:55,542", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.003023s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-29 23:18:55,543", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-29 23:18:55,543", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00011s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-29 23:18:55,544", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-29 23:18:55,544", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001115s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-29 23:18:55,545", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-29 23:18:55,545", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.00171s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-29 23:18:55,545", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-10-29 23:18:55,545", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-10-29 23:18:55,545", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-10-29 23:18:55,545", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-10-29 23:29:59,650", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-10-29 23:30:00,277", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-10-29 23:30:00,277", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-10-29 23:30:00,296", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-10-29 23:30:00,297", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-10-29 23:30:00,297", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-10-29 23:30:00,297", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-10-29 23:30:00,298", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-10-29 23:30:00,298", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-10-29 23:30:00,298", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-29 23:30:00,299", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-29 23:30:00,299", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00011s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-29 23:30:00,302", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-29 23:30:00,302", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002616s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-29 23:30:00,302", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-29 23:30:00,302", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.003112s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-29 23:30:00,304", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-29 23:30:00,304", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00008s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-29 23:30:00,304", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-29 23:30:00,305", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0009262s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-29 23:30:00,305", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-29 23:30:00,305", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001592s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-29 23:30:00,306", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-10-29 23:30:00,306", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-10-29 23:30:00,306", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-10-29 23:30:00,306", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-10-29 23:30:10,443", "name": "app.services.ai_service", "levelname": "ERROR", "message": "AI processing error: \n\nYou tried to access openai.ChatCompletion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.\n\nYou can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. \n\nAlternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`\n\nA detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742\n"}
{"asctime": "2025-10-29 23:32:59,926", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-10-29 23:33:00,544", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-10-29 23:33:00,544", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-10-29 23:33:00,626", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-10-29 23:33:00,626", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-10-29 23:33:00,627", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-10-29 23:33:00,627", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-10-29 23:33:00,627", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-10-29 23:33:00,627", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-10-29 23:33:00,627", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-29 23:33:00,629", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-29 23:33:00,629", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00012s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-29 23:33:00,631", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-29 23:33:00,631", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002069s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-29 23:33:00,631", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-29 23:33:00,631", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002493s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-29 23:33:00,633", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-29 23:33:00,633", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00013s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-29 23:33:00,634", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-29 23:33:00,634", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0009743s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-29 23:33:00,635", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-29 23:33:00,635", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001454s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-29 23:33:00,635", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-10-29 23:33:00,635", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-10-29 23:33:00,635", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-10-29 23:33:00,635", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-10-29 23:33:06,378", "name": "app.services.ai_service", "levelname": "ERROR", "message": "AI processing error: \n\nYou tried to access openai.ChatCompletion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.\n\nYou can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. \n\nAlternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`\n\nA detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742\n"}
{"asctime": "2025-10-29 23:33:24,777", "name": "app.services.ai_service", "levelname": "ERROR", "message": "AI processing error: \n\nYou tried to access openai.ChatCompletion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.\n\nYou can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. \n\nAlternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`\n\nA detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742\n"}
{"asctime": "2025-10-30 19:16:04,476", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-10-30 19:16:04,476", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-10-30 19:16:04,572", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-10-30 19:16:04,572", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-10-30 19:16:04,575", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-10-30 19:16:04,575", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-10-30 19:16:04,576", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-10-30 19:16:04,576", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-10-30 19:16:04,576", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-30 19:16:04,578", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-30 19:16:04,578", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00018s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-30 19:16:04,582", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-30 19:16:04,582", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.003617s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-30 19:16:04,582", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-30 19:16:04,582", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.004025s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-30 19:16:04,583", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-30 19:16:04,583", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00010s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-30 19:16:04,584", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-30 19:16:04,584", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.00128s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-30 19:16:04,585", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-30 19:16:04,585", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002302s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-30 19:16:04,586", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-10-30 19:16:04,586", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-10-30 19:16:04,586", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-10-30 19:16:04,586", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-10-30 19:16:20,682", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 404 Not Found\""}
{"asctime": "2025-10-30 19:16:20,684", "name": "app.services.ai_service", "levelname": "ERROR", "message": "AI processing error: Error code: 404 - {'error': {'message': 'The model `gpt-4-turbo-preview` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}"}
{"asctime": "2025-10-30 19:16:36,332", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-10-30 19:16:37,115", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-10-30 19:16:37,115", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-10-30 19:16:37,134", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-10-30 19:16:37,134", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-10-30 19:16:37,135", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-10-30 19:16:37,135", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-10-30 19:16:37,135", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-10-30 19:16:37,135", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-10-30 19:16:37,136", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-30 19:16:37,137", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-30 19:16:37,137", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00009s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-30 19:16:37,139", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-30 19:16:37,139", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.00221s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-30 19:16:37,139", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-30 19:16:37,139", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002772s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-30 19:16:37,140", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-30 19:16:37,140", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00008s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-30 19:16:37,141", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-30 19:16:37,141", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0006498s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-30 19:16:37,141", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-30 19:16:37,141", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001183s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-30 19:16:37,142", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-10-30 19:16:37,142", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-10-30 19:16:37,142", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-10-30 19:16:37,142", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-10-30 19:17:07,440", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 404 Not Found\""}
{"asctime": "2025-10-30 19:17:07,443", "name": "app.services.ai_service", "levelname": "ERROR", "message": "AI processing error: Error code: 404 - {'error': {'message': 'The model `gpt-4-turbo-preview` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}"}
{"asctime": "2025-10-30 19:22:44,736", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-10-30 19:22:53,646", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-10-30 19:22:53,647", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-10-30 19:22:53,665", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-10-30 19:22:53,665", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-10-30 19:22:53,666", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-10-30 19:22:53,666", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-10-30 19:22:53,666", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-10-30 19:22:53,666", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-10-30 19:22:53,666", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-30 19:22:53,668", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-30 19:22:53,668", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00009s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-30 19:22:53,670", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-30 19:22:53,670", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002115s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-30 19:22:53,670", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-30 19:22:53,670", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002439s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-30 19:22:53,671", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-30 19:22:53,671", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00006s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-30 19:22:53,671", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-30 19:22:53,671", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.00058s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-30 19:22:53,671", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-30 19:22:53,671", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0009478s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-30 19:22:53,672", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-10-30 19:22:53,672", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-10-30 19:22:53,672", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-10-30 19:22:53,672", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-10-30 19:23:15,267", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-10-30 19:43:02,412", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-10-30 19:43:02,996", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-10-30 19:43:02,996", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-10-30 19:43:03,017", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-10-30 19:43:03,017", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-10-30 19:43:03,018", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-10-30 19:43:03,018", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-10-30 19:43:03,018", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-10-30 19:43:03,018", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-10-30 19:43:03,018", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-30 19:43:03,020", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-30 19:43:03,020", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00010s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-30 19:43:03,023", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-30 19:43:03,024", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.003965s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-30 19:43:03,024", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-30 19:43:03,024", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.004682s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-30 19:43:03,025", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-30 19:43:03,025", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00008s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-30 19:43:03,026", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-30 19:43:03,026", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.000573s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-30 19:43:03,026", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-30 19:43:03,026", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001032s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-30 19:43:03,026", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-10-30 19:43:03,027", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-10-30 19:43:03,027", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-10-30 19:43:03,027", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-10-30 19:43:11,618", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-10-30 19:43:12,116", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-10-30 19:43:12,117", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-10-30 19:43:12,133", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-10-30 19:43:12,133", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-10-30 19:43:12,134", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-10-30 19:43:12,134", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-10-30 19:43:12,135", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-10-30 19:43:12,135", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-10-30 19:43:12,135", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-30 19:43:12,136", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-30 19:43:12,136", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00009s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-30 19:43:12,139", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-30 19:43:12,139", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002523s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-30 19:43:12,139", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-30 19:43:12,139", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.003021s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-30 19:43:12,140", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-30 19:43:12,140", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00008s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-30 19:43:12,141", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-30 19:43:12,141", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0006171s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-30 19:43:12,141", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-30 19:43:12,141", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001035s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-30 19:43:12,141", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-10-30 19:43:12,142", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-10-30 19:43:12,142", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-10-30 19:43:12,142", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-10-30 19:44:04,924", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-10-30 21:00:56,656", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-10-30 21:00:56,656", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-10-30 21:00:56,677", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-10-30 21:00:56,677", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-10-30 21:00:56,678", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-10-30 21:00:56,678", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-10-30 21:00:56,678", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-10-30 21:00:56,679", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-10-30 21:00:56,679", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-30 21:00:56,680", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-30 21:00:56,680", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00010s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-30 21:00:56,682", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-30 21:00:56,682", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001653s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-30 21:00:56,682", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-30 21:00:56,682", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001968s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-30 21:00:56,683", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-30 21:00:56,683", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00007s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-30 21:00:56,683", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-30 21:00:56,683", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0006776s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-30 21:00:56,684", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-30 21:00:56,684", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001199s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-30 21:00:56,684", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-10-30 21:00:56,684", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-10-30 21:00:56,684", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-10-30 21:00:56,684", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-10-30 21:06:02,888", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-10-30 21:06:05,058", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-10-30 21:06:05,058", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-10-30 21:06:05,075", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-10-30 21:06:05,075", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-10-30 21:06:05,075", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-10-30 21:06:05,075", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-10-30 21:06:05,076", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-10-30 21:06:05,076", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-10-30 21:06:05,076", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-30 21:06:05,077", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-30 21:06:05,077", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00010s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-30 21:06:05,079", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-30 21:06:05,079", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.00184s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-30 21:06:05,079", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-30 21:06:05,079", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002164s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-30 21:06:05,080", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-30 21:06:05,080", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00006s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-30 21:06:05,081", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-30 21:06:05,081", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0008913s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-30 21:06:05,082", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-30 21:06:05,082", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001627s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-30 21:06:05,082", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-10-30 21:06:05,083", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-10-30 21:06:05,083", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-10-30 21:06:05,083", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-10-30 21:15:23,203", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'SmsMessageSid': 'SM29a54314fd0f40414375228c13acf210', 'NumMedia': '0', 'ProfileName': 'Hello World!', 'MessageType': 'text', 'SmsSid': 'SM29a54314fd0f40414375228c13acf210', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': 'Hi', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'SM29a54314fd0f40414375228c13acf210', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-10-30 21:15:23,213", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-30 21:15:23,217", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-10-30 21:15:23,217", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00025s] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-10-30 21:15:23,228", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO users (id, phone_number, email, whatsapp_name, first_name, last_name, id_number, date_of_birth, nationality, address_line1, address_line2, city, province, postal_code, country, account_number, balance, status, pin_hash, pin_attempts, pin_locked_until, is_phone_verified, is_email_verified, is_id_verified, is_address_verified, is_fica_compliant, id_document_url, proof_of_residence_url, selfie_url, daily_limit, monthly_limit, daily_spent, monthly_spent, last_daily_reset, last_monthly_reset, preferred_language, notification_enabled, marketing_consent, user_metadata, referral_code, referred_by, created_at, updated_at, last_active_at, verified_at) VALUES (%(id)s::UUID, %(phone_number)s, %(email)s, %(whatsapp_name)s, %(first_name)s, %(last_name)s, %(id_number)s, %(date_of_birth)s, %(nationality)s, %(address_line1)s, %(address_line2)s, %(city)s, %(province)s, %(postal_code)s, %(country)s, %(account_number)s, %(balance)s, %(status)s, %(pin_hash)s, %(pin_attempts)s, %(pin_locked_until)s, %(is_phone_verified)s, %(is_email_verified)s, %(is_id_verified)s, %(is_address_verified)s, %(is_fica_compliant)s, %(id_document_url)s, %(proof_of_residence_url)s, %(selfie_url)s, %(daily_limit)s, %(monthly_limit)s, %(daily_spent)s, %(monthly_spent)s, now(), now(), %(preferred_language)s, %(notification_enabled)s, %(marketing_consent)s, %(user_metadata)s, %(referral_code)s, %(referred_by)s::UUID, now(), now(), now(), %(verified_at)s) RETURNING users.last_daily_reset, users.last_monthly_reset, users.created_at, users.updated_at, users.last_active_at"}
{"asctime": "2025-10-30 21:15:23,228", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00045s] {'id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'phone_number': '+27763514028', 'email': None, 'whatsapp_name': 'Hello World!', 'first_name': None, 'last_name': None, 'id_number': None, 'date_of_birth': None, 'nationality': None, 'address_line1': None, 'address_line2': None, 'city': None, 'province': None, 'postal_code': None, 'country': 'South Africa', 'account_number': None, 'balance': 0.0, 'status': 'PENDING_VERIFICATION', 'pin_hash': None, 'pin_attempts': 0, 'pin_locked_until': None, 'is_phone_verified': False, 'is_email_verified': False, 'is_id_verified': False, 'is_address_verified': False, 'is_fica_compliant': False, 'id_document_url': None, 'proof_of_residence_url': None, 'selfie_url': None, 'daily_limit': 25000.0, 'monthly_limit': 100000.0, 'daily_spent': 0.0, 'monthly_spent': 0.0, 'preferred_language': 'en', 'notification_enabled': True, 'marketing_consent': False, 'user_metadata': '{}', 'referral_code': None, 'referred_by': None, 'verified_at': None}"}
{"asctime": "2025-10-30 21:15:23,233", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-10-30 21:15:24,287", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-10-30 21:15:24,288", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SM4de6b1ce4817f91e97c362a4d1bdb85c"}
{"asctime": "2025-10-30 21:15:52,527", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'SmsMessageSid': 'SMe7bca71b3472352b6f54fa8704bb65db', 'NumMedia': '0', 'ProfileName': 'Hello World!', 'MessageType': 'text', 'SmsSid': 'SMe7bca71b3472352b6f54fa8704bb65db', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': '2244', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'SMe7bca71b3472352b6f54fa8704bb65db', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-10-30 21:15:52,530", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-30 21:15:52,530", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-10-30 21:15:52,531", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 29.31s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-10-30 21:15:52,541", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-10-30 21:15:52,541", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00082s] {'last_active_at': datetime.datetime(2025, 10, 30, 19, 15, 52, 539815), 'users_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-10-30 21:15:52,549", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-10-30 21:15:52,551", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-30 21:15:52,552", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-10-30 21:15:52,553", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00029s] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-10-30 21:15:52,556", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-10-30 21:15:52,556", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00036s] {'id': UUID('c1fe810b-34b0-451d-a306-c3b3bdfee24e'), 'user_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'phone_number': '+27763514028', 'message_id': 'SMe7bca71b3472352b6f54fa8704bb65db', 'message_type': 'text', 'direction': 'inbound', 'message_text': '2244', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-10-30 21:15:52,562", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-10-30 21:15:52,563", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-30 21:15:52,564", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-10-30 21:15:52,564", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.01163s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-10-30 21:15:52,566", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(id_1)s::UUID \n LIMIT %(param_1)s"}
{"asctime": "2025-10-30 21:15:52,566", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00018s] {'id_1': 'd55d888e-4ff5-49b4-9d97-795cff228fac', 'param_1': 1}"}
{"asctime": "2025-10-30 21:15:52,997", "name": "passlib.handlers.bcrypt", "levelname": "WARNING", "message": "(trapped) error reading bcrypt version", "exc_info": "Traceback (most recent call last):\n  File \"/Users/explosive/projects/cyrax/venv/lib/python3.11/site-packages/passlib/handlers/bcrypt.py\", line 620, in _load_backend_mixin\n    version = _bcrypt.__about__.__version__\n              ^^^^^^^^^^^^^^^^^\nAttributeError: module 'bcrypt' has no attribute '__about__'"}
{"asctime": "2025-10-30 21:15:53,006", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "ROLLBACK"}
{"asctime": "2025-10-30 21:15:53,007", "name": "app.services.security_service", "levelname": "ERROR", "message": "Set PIN error: password cannot be longer than 72 bytes, truncate manually if necessary (e.g. my_password[:72])"}
{"asctime": "2025-10-30 21:15:53,672", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-10-30 21:15:53,673", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SMb93af07efc5344949e43c67a42d85a4a"}
{"asctime": "2025-10-30 21:16:07,445", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'SmsMessageSid': 'SM2c0a377c7cd4679e8b3f4ca8585f7e15', 'NumMedia': '0', 'ProfileName': 'Hello World!', 'MessageType': 'text', 'SmsSid': 'SM2c0a377c7cd4679e8b3f4ca8585f7e15', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': '4028', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'SM2c0a377c7cd4679e8b3f4ca8585f7e15', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-10-30 21:16:07,447", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-30 21:16:07,448", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-10-30 21:16:07,448", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 44.23s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-10-30 21:16:07,450", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-10-30 21:16:07,452", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 14.91s ago] {'last_active_at': datetime.datetime(2025, 10, 30, 19, 16, 7, 449843), 'users_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-10-30 21:16:07,453", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-10-30 21:16:07,455", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-30 21:16:07,455", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-10-30 21:16:07,456", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 14.9s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-10-30 21:16:07,461", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-10-30 21:16:07,462", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 14.91s ago] {'id': UUID('3cf3ed6c-3eac-4f8d-94c2-2b5df5c044fd'), 'user_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'phone_number': '+27763514028', 'message_id': 'SM2c0a377c7cd4679e8b3f4ca8585f7e15', 'message_type': 'text', 'direction': 'inbound', 'message_text': '4028', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-10-30 21:16:07,463", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-10-30 21:16:07,464", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-30 21:16:07,464", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-10-30 21:16:07,464", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 14.91s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-10-30 21:16:07,466", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(id_1)s::UUID \n LIMIT %(param_1)s"}
{"asctime": "2025-10-30 21:16:07,466", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 14.9s ago] {'id_1': 'd55d888e-4ff5-49b4-9d97-795cff228fac', 'param_1': 1}"}
{"asctime": "2025-10-30 21:16:07,467", "name": "passlib.handlers.bcrypt", "levelname": "WARNING", "message": "(trapped) error reading bcrypt version", "exc_info": "Traceback (most recent call last):\n  File \"/Users/explosive/projects/cyrax/venv/lib/python3.11/site-packages/passlib/handlers/bcrypt.py\", line 620, in _load_backend_mixin\n    version = _bcrypt.__about__.__version__\n              ^^^^^^^^^^^^^^^^^\nAttributeError: module 'bcrypt' has no attribute '__about__'"}
{"asctime": "2025-10-30 21:16:07,478", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "ROLLBACK"}
{"asctime": "2025-10-30 21:16:07,478", "name": "app.services.security_service", "levelname": "ERROR", "message": "Set PIN error: password cannot be longer than 72 bytes, truncate manually if necessary (e.g. my_password[:72])"}
{"asctime": "2025-10-30 21:16:07,962", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-10-30 21:16:07,963", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SMa4d59cec3aa0326c8c28326a78acee9e"}
{"asctime": "2025-10-30 21:16:20,709", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'SmsMessageSid': 'SM5602aa5fd095731c81d9b0d7c5f999f0', 'NumMedia': '0', 'ProfileName': 'Hello World!', 'MessageType': 'text', 'SmsSid': 'SM5602aa5fd095731c81d9b0d7c5f999f0', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': 'What else can you do ?', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'SM5602aa5fd095731c81d9b0d7c5f999f0', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-10-30 21:16:20,711", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-30 21:16:20,711", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-10-30 21:16:20,712", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 57.49s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-10-30 21:16:20,713", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-10-30 21:16:20,714", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 28.17s ago] {'last_active_at': datetime.datetime(2025, 10, 30, 19, 16, 20, 713399), 'users_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-10-30 21:16:20,715", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-10-30 21:16:20,716", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-30 21:16:20,717", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-10-30 21:16:20,717", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 28.16s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-10-30 21:16:20,719", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-10-30 21:16:20,719", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 28.16s ago] {'id': UUID('1689d47c-8d5b-47c0-84e5-8a47d6329ebc'), 'user_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'phone_number': '+27763514028', 'message_id': 'SM5602aa5fd095731c81d9b0d7c5f999f0', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'What else can you do ?', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-10-30 21:16:20,720", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-10-30 21:16:20,726", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-30 21:16:20,727", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-10-30 21:16:20,728", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 28.17s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-10-30 21:16:21,321", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-10-30 21:16:21,323", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SM95ca2c423a9dac2f019225676fc1bb18"}
{"asctime": "2025-10-30 21:16:21,323", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "ROLLBACK"}
{"asctime": "2025-10-30 21:16:38,058", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'SmsMessageSid': 'SM72bc42b240b7f95248d6d418924002d0', 'NumMedia': '0', 'ProfileName': 'Hello World!', 'MessageType': 'text', 'SmsSid': 'SM72bc42b240b7f95248d6d418924002d0', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': '6798', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'SM72bc42b240b7f95248d6d418924002d0', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-10-30 21:16:38,061", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-30 21:16:38,062", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-10-30 21:16:38,062", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 74.84s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-10-30 21:16:38,063", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-10-30 21:16:38,063", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 45.52s ago] {'last_active_at': datetime.datetime(2025, 10, 30, 19, 16, 38, 63259), 'users_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-10-30 21:16:38,065", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-10-30 21:16:38,066", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-30 21:16:38,067", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-10-30 21:16:38,067", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 45.51s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-10-30 21:16:38,068", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-10-30 21:16:38,069", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 45.51s ago] {'id': UUID('16ac2f55-7ce9-41b4-97d8-d9e5f472eef8'), 'user_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'phone_number': '+27763514028', 'message_id': 'SM72bc42b240b7f95248d6d418924002d0', 'message_type': 'text', 'direction': 'inbound', 'message_text': '6798', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-10-30 21:16:38,070", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-10-30 21:16:38,075", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-30 21:16:38,076", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-10-30 21:16:38,077", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 45.52s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-10-30 21:16:38,079", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(id_1)s::UUID \n LIMIT %(param_1)s"}
{"asctime": "2025-10-30 21:16:38,079", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 45.51s ago] {'id_1': 'd55d888e-4ff5-49b4-9d97-795cff228fac', 'param_1': 1}"}
{"asctime": "2025-10-30 21:16:38,080", "name": "passlib.handlers.bcrypt", "levelname": "WARNING", "message": "(trapped) error reading bcrypt version", "exc_info": "Traceback (most recent call last):\n  File \"/Users/explosive/projects/cyrax/venv/lib/python3.11/site-packages/passlib/handlers/bcrypt.py\", line 620, in _load_backend_mixin\n    version = _bcrypt.__about__.__version__\n              ^^^^^^^^^^^^^^^^^\nAttributeError: module 'bcrypt' has no attribute '__about__'"}
{"asctime": "2025-10-30 21:16:38,090", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "ROLLBACK"}
{"asctime": "2025-10-30 21:16:38,091", "name": "app.services.security_service", "levelname": "ERROR", "message": "Set PIN error: password cannot be longer than 72 bytes, truncate manually if necessary (e.g. my_password[:72])"}
{"asctime": "2025-10-30 21:16:38,642", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-10-30 21:16:38,644", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SM9e0a44371c0e53c766f15836222476b0"}
{"asctime": "2025-10-30 21:16:48,747", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'SmsMessageSid': 'SMbaa91db11020237c0240a2c7c3242a03', 'NumMedia': '0', 'ProfileName': 'Hello World!', 'MessageType': 'text', 'SmsSid': 'SMbaa91db11020237c0240a2c7c3242a03', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': '9175', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'SMbaa91db11020237c0240a2c7c3242a03', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-10-30 21:16:48,749", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-30 21:16:48,749", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-10-30 21:16:48,749", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 85.53s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-10-30 21:16:48,751", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-10-30 21:16:48,751", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 56.21s ago] {'last_active_at': datetime.datetime(2025, 10, 30, 19, 16, 48, 750962), 'users_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-10-30 21:16:48,753", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-10-30 21:16:48,756", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-30 21:16:48,757", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-10-30 21:16:48,757", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 56.2s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-10-30 21:16:48,760", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-10-30 21:16:48,761", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 56.2s ago] {'id': UUID('8da06d83-edc9-449c-90c3-16adf4cf4c9e'), 'user_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'phone_number': '+27763514028', 'message_id': 'SMbaa91db11020237c0240a2c7c3242a03', 'message_type': 'text', 'direction': 'inbound', 'message_text': '9175', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-10-30 21:16:48,764", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-10-30 21:16:48,766", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-30 21:16:48,766", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-10-30 21:16:48,766", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 56.21s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-10-30 21:16:48,768", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(id_1)s::UUID \n LIMIT %(param_1)s"}
{"asctime": "2025-10-30 21:16:48,768", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 56.2s ago] {'id_1': 'd55d888e-4ff5-49b4-9d97-795cff228fac', 'param_1': 1}"}
{"asctime": "2025-10-30 21:16:48,769", "name": "passlib.handlers.bcrypt", "levelname": "WARNING", "message": "(trapped) error reading bcrypt version", "exc_info": "Traceback (most recent call last):\n  File \"/Users/explosive/projects/cyrax/venv/lib/python3.11/site-packages/passlib/handlers/bcrypt.py\", line 620, in _load_backend_mixin\n    version = _bcrypt.__about__.__version__\n              ^^^^^^^^^^^^^^^^^\nAttributeError: module 'bcrypt' has no attribute '__about__'"}
{"asctime": "2025-10-30 21:16:48,780", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "ROLLBACK"}
{"asctime": "2025-10-30 21:16:48,781", "name": "app.services.security_service", "levelname": "ERROR", "message": "Set PIN error: password cannot be longer than 72 bytes, truncate manually if necessary (e.g. my_password[:72])"}
{"asctime": "2025-10-30 21:16:49,358", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-10-30 21:16:49,359", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SMaff23bbc1beb77b1345616deb9f7b38d"}
{"asctime": "2025-10-30 21:23:21,001", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'SmsMessageSid': 'SMb89699b936a6658769b893e16dadd27a', 'NumMedia': '0', 'ProfileName': 'Hello World!', 'MessageType': 'text', 'SmsSid': 'SMb89699b936a6658769b893e16dadd27a', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': '5678', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'SMb89699b936a6658769b893e16dadd27a', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-10-30 21:23:21,009", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-30 21:23:21,010", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-10-30 21:23:21,010", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 477.8s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-10-30 21:23:21,014", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-10-30 21:23:21,014", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 448.5s ago] {'last_active_at': datetime.datetime(2025, 10, 30, 19, 23, 21, 13354), 'users_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-10-30 21:23:21,016", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-10-30 21:23:21,018", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-30 21:23:21,018", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-10-30 21:23:21,019", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 448.5s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-10-30 21:23:21,020", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-10-30 21:23:21,020", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 448.5s ago] {'id': UUID('6d2a4316-197b-4e2d-abaf-0bc356fb4749'), 'user_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'phone_number': '+27763514028', 'message_id': 'SMb89699b936a6658769b893e16dadd27a', 'message_type': 'text', 'direction': 'inbound', 'message_text': '5678', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-10-30 21:23:21,022", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-10-30 21:23:21,023", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-30 21:23:21,023", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-10-30 21:23:21,023", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 448.5s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-10-30 21:23:21,033", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(id_1)s::UUID \n LIMIT %(param_1)s"}
{"asctime": "2025-10-30 21:23:21,033", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 448.5s ago] {'id_1': 'd55d888e-4ff5-49b4-9d97-795cff228fac', 'param_1': 1}"}
{"asctime": "2025-10-30 21:23:21,034", "name": "passlib.handlers.bcrypt", "levelname": "WARNING", "message": "(trapped) error reading bcrypt version", "exc_info": "Traceback (most recent call last):\n  File \"/Users/explosive/projects/cyrax/venv/lib/python3.11/site-packages/passlib/handlers/bcrypt.py\", line 620, in _load_backend_mixin\n    version = _bcrypt.__about__.__version__\n              ^^^^^^^^^^^^^^^^^\nAttributeError: module 'bcrypt' has no attribute '__about__'"}
{"asctime": "2025-10-30 21:23:21,042", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "ROLLBACK"}
{"asctime": "2025-10-30 21:23:21,042", "name": "app.services.security_service", "levelname": "ERROR", "message": "Set PIN error: password cannot be longer than 72 bytes, truncate manually if necessary (e.g. my_password[:72])"}
{"asctime": "2025-10-30 21:23:22,208", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-10-30 21:23:22,210", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SM8d737ad83ae2c5f26e6a5ff5c4058e21"}
{"asctime": "2025-10-30 21:25:23,364", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'SmsMessageSid': 'SM54c2393573f1e77254cb0ae220b0e103', 'NumMedia': '0', 'ProfileName': 'Hello World!', 'MessageType': 'text', 'SmsSid': 'SM54c2393573f1e77254cb0ae220b0e103', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': '7702', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'SM54c2393573f1e77254cb0ae220b0e103', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-10-30 21:25:23,372", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-30 21:25:23,373", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-10-30 21:25:23,374", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 600.1s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-10-30 21:25:23,376", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-10-30 21:25:23,377", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 570.8s ago] {'last_active_at': datetime.datetime(2025, 10, 30, 19, 25, 23, 376414), 'users_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-10-30 21:25:23,378", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-10-30 21:25:23,380", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-30 21:25:23,380", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-10-30 21:25:23,380", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 570.8s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-10-30 21:25:23,382", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-10-30 21:25:23,382", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 570.8s ago] {'id': UUID('5acd44de-5269-429b-9b54-f63c5da49fa5'), 'user_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'phone_number': '+27763514028', 'message_id': 'SM54c2393573f1e77254cb0ae220b0e103', 'message_type': 'text', 'direction': 'inbound', 'message_text': '7702', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-10-30 21:25:23,383", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-10-30 21:25:23,384", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-30 21:25:23,385", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-10-30 21:25:23,385", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 570.8s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-10-30 21:25:23,386", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(id_1)s::UUID \n LIMIT %(param_1)s"}
{"asctime": "2025-10-30 21:25:23,386", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 570.8s ago] {'id_1': 'd55d888e-4ff5-49b4-9d97-795cff228fac', 'param_1': 1}"}
{"asctime": "2025-10-30 21:25:23,387", "name": "passlib.handlers.bcrypt", "levelname": "WARNING", "message": "(trapped) error reading bcrypt version", "exc_info": "Traceback (most recent call last):\n  File \"/Users/explosive/projects/cyrax/venv/lib/python3.11/site-packages/passlib/handlers/bcrypt.py\", line 620, in _load_backend_mixin\n    version = _bcrypt.__about__.__version__\n              ^^^^^^^^^^^^^^^^^\nAttributeError: module 'bcrypt' has no attribute '__about__'"}
{"asctime": "2025-10-30 21:25:23,396", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "ROLLBACK"}
{"asctime": "2025-10-30 21:25:23,396", "name": "app.services.security_service", "levelname": "ERROR", "message": "Set PIN error: password cannot be longer than 72 bytes, truncate manually if necessary (e.g. my_password[:72])"}
{"asctime": "2025-10-30 21:25:24,461", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-10-30 21:25:24,462", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SMef329b83ac5266e4dc0391b875ae3fb0"}
{"asctime": "2025-10-30 21:25:49,308", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'SmsMessageSid': 'SM121faa34ad2ac3c7061e3930010a7c97', 'NumMedia': '0', 'ProfileName': 'Hello World!', 'MessageType': 'text', 'SmsSid': 'SM121faa34ad2ac3c7061e3930010a7c97', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': '0852', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'SM121faa34ad2ac3c7061e3930010a7c97', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-10-30 21:25:49,311", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-30 21:25:49,312", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-10-30 21:25:49,312", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 626.1s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-10-30 21:25:49,316", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-10-30 21:25:49,316", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 596.8s ago] {'last_active_at': datetime.datetime(2025, 10, 30, 19, 25, 49, 315169), 'users_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-10-30 21:25:49,318", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-10-30 21:25:49,326", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-30 21:25:49,326", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-10-30 21:25:49,327", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 596.8s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-10-30 21:25:49,329", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-10-30 21:25:49,329", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 596.8s ago] {'id': UUID('88da3700-f77c-4131-990b-f673ac4f1cd1'), 'user_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'phone_number': '+27763514028', 'message_id': 'SM121faa34ad2ac3c7061e3930010a7c97', 'message_type': 'text', 'direction': 'inbound', 'message_text': '0852', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-10-30 21:25:49,330", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-10-30 21:25:49,331", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-30 21:25:49,331", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-10-30 21:25:49,331", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 596.8s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-10-30 21:25:49,332", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(id_1)s::UUID \n LIMIT %(param_1)s"}
{"asctime": "2025-10-30 21:25:49,333", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 596.8s ago] {'id_1': 'd55d888e-4ff5-49b4-9d97-795cff228fac', 'param_1': 1}"}
{"asctime": "2025-10-30 21:25:49,334", "name": "passlib.handlers.bcrypt", "levelname": "WARNING", "message": "(trapped) error reading bcrypt version", "exc_info": "Traceback (most recent call last):\n  File \"/Users/explosive/projects/cyrax/venv/lib/python3.11/site-packages/passlib/handlers/bcrypt.py\", line 620, in _load_backend_mixin\n    version = _bcrypt.__about__.__version__\n              ^^^^^^^^^^^^^^^^^\nAttributeError: module 'bcrypt' has no attribute '__about__'"}
{"asctime": "2025-10-30 21:25:49,344", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "ROLLBACK"}
{"asctime": "2025-10-30 21:25:49,345", "name": "app.services.security_service", "levelname": "ERROR", "message": "Set PIN error: password cannot be longer than 72 bytes, truncate manually if necessary (e.g. my_password[:72])"}
{"asctime": "2025-10-30 21:25:50,416", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-10-30 21:25:50,417", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SM3297222e0abae6e9c341afcbd1b49839"}
{"asctime": "2025-10-30 21:30:24,633", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-10-30 21:30:25,186", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-10-30 21:30:25,186", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-10-30 21:30:25,205", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-10-30 21:30:25,205", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-10-30 21:30:25,206", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-10-30 21:30:25,206", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-10-30 21:30:25,206", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-10-30 21:30:25,206", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-10-30 21:30:25,206", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-30 21:30:25,207", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-30 21:30:25,207", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00009s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-30 21:30:25,209", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-30 21:30:25,209", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001935s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-30 21:30:25,210", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-30 21:30:25,210", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002468s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-30 21:30:25,211", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-30 21:30:25,211", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00007s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-30 21:30:25,211", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-30 21:30:25,211", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.000492s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-30 21:30:25,211", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-30 21:30:25,211", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0009216s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-30 21:30:25,212", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-10-30 21:30:25,212", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-10-30 21:30:25,212", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-10-30 21:30:25,212", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-10-30 21:30:38,310", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'SmsMessageSid': 'SM8e87e5983cda6db2762bc2cb76afd420', 'NumMedia': '0', 'ProfileName': 'Hello World!', 'MessageType': 'text', 'SmsSid': 'SM8e87e5983cda6db2762bc2cb76afd420', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': '4028', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'SM8e87e5983cda6db2762bc2cb76afd420', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-10-30 21:30:38,319", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-30 21:30:38,322", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-10-30 21:30:38,323", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00035s] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-10-30 21:30:38,326", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-10-30 21:30:38,327", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00024s] {'last_active_at': datetime.datetime(2025, 10, 30, 19, 30, 38, 325836), 'users_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-10-30 21:30:38,328", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-10-30 21:30:38,329", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-30 21:30:38,330", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-10-30 21:30:38,331", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00017s] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-10-30 21:30:38,333", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-10-30 21:30:38,333", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00024s] {'id': UUID('3437df41-7226-492e-9c7a-23a12a8f45e5'), 'user_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'phone_number': '+27763514028', 'message_id': 'SM8e87e5983cda6db2762bc2cb76afd420', 'message_type': 'text', 'direction': 'inbound', 'message_text': '4028', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-10-30 21:30:38,335", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-10-30 21:30:38,335", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-30 21:30:38,336", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-10-30 21:30:38,336", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.005393s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-10-30 21:30:38,337", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(id_1)s::UUID \n LIMIT %(param_1)s"}
{"asctime": "2025-10-30 21:30:38,338", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00015s] {'id_1': 'd55d888e-4ff5-49b4-9d97-795cff228fac', 'param_1': 1}"}
{"asctime": "2025-10-30 21:30:38,339", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.phone_number = %(phone_number_1)s ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-10-30 21:30:38,340", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00015s] {'phone_number_1': '+27763514028', 'param_1': 5}"}
{"asctime": "2025-10-30 21:30:43,083", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-10-30 21:30:43,090", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.phone_number = %(phone_number_1)s ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-10-30 21:30:43,091", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 4.751s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-10-30 21:30:43,095", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-10-30 21:30:43,095", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00050s] {'ai_response': \"It looks like you're entering a PIN. Just to let you know, I can't process transactions if your FICA status is pending. Is there anything else you'd like to do, like checking your balance or buying airtime?\", 'intent_detected': 'conversation', 'confidence_score': 0.8, 'is_processed': True, 'conversations_id': UUID('3437df41-7226-492e-9c7a-23a12a8f45e5')}"}
{"asctime": "2025-10-30 21:30:43,097", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-10-30 21:30:43,885", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-10-30 21:30:43,888", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SMe657ba598c6fe7d49bdf499027a063bc"}
{"asctime": "2025-10-30 21:31:15,677", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'SmsMessageSid': 'SM4d6be8fc8a0317b1b1edb199d7a941c8', 'NumMedia': '0', 'ProfileName': 'Hello World!', 'MessageType': 'text', 'SmsSid': 'SM4d6be8fc8a0317b1b1edb199d7a941c8', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': 'What\u2019s my balance', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'SM4d6be8fc8a0317b1b1edb199d7a941c8', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-10-30 21:31:15,679", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-30 21:31:15,680", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-10-30 21:31:15,680", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 37.36s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-10-30 21:31:15,682", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-10-30 21:31:15,682", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 37.35s ago] {'last_active_at': datetime.datetime(2025, 10, 30, 19, 31, 15, 681777), 'users_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-10-30 21:31:15,684", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-10-30 21:31:15,687", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-30 21:31:15,695", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-10-30 21:31:15,695", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 37.36s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-10-30 21:31:15,697", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-10-30 21:31:15,698", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 37.36s ago] {'id': UUID('859ae153-5889-4545-a796-5d82cdd60435'), 'user_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'phone_number': '+27763514028', 'message_id': 'SM4d6be8fc8a0317b1b1edb199d7a941c8', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'What\u2019s my balance', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-10-30 21:31:15,698", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-10-30 21:31:15,699", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-30 21:31:15,699", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-10-30 21:31:15,699", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 37.37s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-10-30 21:31:15,702", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(id_1)s::UUID \n LIMIT %(param_1)s"}
{"asctime": "2025-10-30 21:31:15,702", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 37.36s ago] {'id_1': 'd55d888e-4ff5-49b4-9d97-795cff228fac', 'param_1': 1}"}
{"asctime": "2025-10-30 21:31:15,702", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.phone_number = %(phone_number_1)s ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-10-30 21:31:15,703", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 37.36s ago] {'phone_number_1': '+27763514028', 'param_1': 5}"}
{"asctime": "2025-10-30 21:31:19,941", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-10-30 21:31:19,946", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.phone_number = %(phone_number_1)s ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-10-30 21:31:19,947", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 41.61s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-10-30 21:31:19,949", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-10-30 21:31:19,949", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 36.85s ago] {'ai_response': 'Your current balance is R0.00. If you need help with anything else, just let me know!', 'intent_detected': 'check_balance', 'confidence_score': 0.9, 'is_processed': True, 'conversations_id': UUID('859ae153-5889-4545-a796-5d82cdd60435')}"}
{"asctime": "2025-10-30 21:31:19,950", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-10-30 21:31:19,952", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-30 21:31:19,953", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-10-30 21:31:19,954", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 41.62s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-10-30 21:31:19,958", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(id_1)s::UUID \n LIMIT %(param_1)s"}
{"asctime": "2025-10-30 21:31:19,958", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 41.62s ago] {'id_1': 'd55d888e-4ff5-49b4-9d97-795cff228fac', 'param_1': 1}"}
{"asctime": "2025-10-30 21:31:20,538", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-10-30 21:31:20,539", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SM58db09d632f27e51f0de430f13bd9bdb"}
{"asctime": "2025-10-30 21:31:20,540", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "ROLLBACK"}
{"asctime": "2025-10-30 21:31:45,228", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'SmsMessageSid': 'SM9611d67294d010623147f373372b705f', 'NumMedia': '0', 'ProfileName': 'Hello World!', 'MessageType': 'text', 'SmsSid': 'SM9611d67294d010623147f373372b705f', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': 'Okay send r10 to thabo', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'SM9611d67294d010623147f373372b705f', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-10-30 21:31:45,231", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-30 21:31:45,231", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-10-30 21:31:45,232", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 66.91s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-10-30 21:31:45,233", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-10-30 21:31:45,234", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 66.91s ago] {'last_active_at': datetime.datetime(2025, 10, 30, 19, 31, 45, 233455), 'users_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-10-30 21:31:45,234", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-10-30 21:31:45,236", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-30 21:31:45,236", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-10-30 21:31:45,236", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 66.9s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-10-30 21:31:45,238", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-10-30 21:31:45,238", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 66.9s ago] {'id': UUID('60df7c34-c21c-4f66-9a52-233e68729772'), 'user_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'phone_number': '+27763514028', 'message_id': 'SM9611d67294d010623147f373372b705f', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'Okay send r10 to thabo', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-10-30 21:31:45,239", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-10-30 21:31:45,241", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-30 21:31:45,241", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-10-30 21:31:45,241", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 66.91s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-10-30 21:31:45,242", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(id_1)s::UUID \n LIMIT %(param_1)s"}
{"asctime": "2025-10-30 21:31:45,243", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 66.9s ago] {'id_1': 'd55d888e-4ff5-49b4-9d97-795cff228fac', 'param_1': 1}"}
{"asctime": "2025-10-30 21:31:45,244", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.phone_number = %(phone_number_1)s ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-10-30 21:31:45,244", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 66.9s ago] {'phone_number_1': '+27763514028', 'param_1': 5}"}
{"asctime": "2025-10-30 21:31:49,509", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-10-30 21:31:49,526", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.phone_number = %(phone_number_1)s ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-10-30 21:31:49,527", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 71.19s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-10-30 21:31:49,530", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-10-30 21:31:49,530", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00034s] {'ai_response': \"Just to confirm, you want to send R10 to Thabo. Could you please provide Thabo's phone number or account number? Also, remember that your balance is currently R0.00, so you'll need to top up first. Let me know how you'd like to proceed!\", 'intent_detected': 'send_money', 'entities_extracted': '{\"amount\": 10.0, \"recipient_name\": \"thabo\"}', 'confidence_score': 0.9, 'is_processed': True, 'conversations_id': UUID('60df7c34-c21c-4f66-9a52-233e68729772')}"}
{"asctime": "2025-10-30 21:31:49,531", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-10-30 21:31:49,532", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-30 21:31:49,533", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-10-30 21:31:49,533", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 71.2s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-10-30 21:31:50,032", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-10-30 21:31:50,033", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SM8a5d483b959f19b1ec26707bdac2a411"}
{"asctime": "2025-10-30 21:31:50,035", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET is_fica_compliant=%(is_fica_compliant)s, updated_at=now() WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-10-30 21:31:50,035", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00041s] {'is_fica_compliant': True, 'users_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-10-30 21:31:50,036", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-10-30 21:31:50,480", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-10-30 21:31:50,481", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SM32e3ce77839372eaaac1b589bdefdb06"}
{"asctime": "2025-10-30 21:32:14,815", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'SmsMessageSid': 'SM2c0e1f547abaa9322c7ec88b1709cf03', 'NumMedia': '0', 'ProfileName': 'Hello World!', 'MessageType': 'text', 'SmsSid': 'SM2c0e1f547abaa9322c7ec88b1709cf03', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': 'Yes', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'SM2c0e1f547abaa9322c7ec88b1709cf03', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-10-30 21:32:14,817", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-30 21:32:14,818", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-10-30 21:32:14,818", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 96.49s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-10-30 21:32:14,820", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-10-30 21:32:14,821", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 96.49s ago] {'last_active_at': datetime.datetime(2025, 10, 30, 19, 32, 14, 820290), 'users_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-10-30 21:32:14,822", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-10-30 21:32:14,823", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-30 21:32:14,824", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-10-30 21:32:14,824", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 96.49s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-10-30 21:32:14,825", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-10-30 21:32:14,826", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 96.49s ago] {'id': UUID('e79dbea3-6aad-4200-8c5c-bab8f871a390'), 'user_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'phone_number': '+27763514028', 'message_id': 'SM2c0e1f547abaa9322c7ec88b1709cf03', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'Yes', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-10-30 21:32:14,827", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-10-30 21:32:15,368", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-10-30 21:32:15,369", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SM0dad0405dc057370dc3ae1b5e059cb5e"}
{"asctime": "2025-10-30 21:32:28,276", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'SmsMessageSid': 'SMf99c2b56c52850246bea2241b2639fc1', 'NumMedia': '0', 'ProfileName': 'Hello World!', 'MessageType': 'text', 'SmsSid': 'SMf99c2b56c52850246bea2241b2639fc1', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': '4029', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'SMf99c2b56c52850246bea2241b2639fc1', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-10-30 21:32:28,277", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-30 21:32:28,277", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-10-30 21:32:28,278", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 110s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-10-30 21:32:28,279", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-10-30 21:32:28,279", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 110s ago] {'last_active_at': datetime.datetime(2025, 10, 30, 19, 32, 28, 279206), 'users_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-10-30 21:32:28,280", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-10-30 21:32:28,281", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-30 21:32:28,282", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-10-30 21:32:28,282", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 109.9s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-10-30 21:32:28,283", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-10-30 21:32:28,284", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 109.9s ago] {'id': UUID('87181b57-6c80-409c-8d52-12bfe039ae93'), 'user_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'phone_number': '+27763514028', 'message_id': 'SMf99c2b56c52850246bea2241b2639fc1', 'message_type': 'text', 'direction': 'inbound', 'message_text': '4029', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-10-30 21:32:28,285", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-10-30 21:32:28,285", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-30 21:32:28,286", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-10-30 21:32:28,286", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 110s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-10-30 21:32:28,287", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(id_1)s::UUID \n LIMIT %(param_1)s"}
{"asctime": "2025-10-30 21:32:28,287", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 109.9s ago] {'id_1': 'd55d888e-4ff5-49b4-9d97-795cff228fac', 'param_1': 1}"}
{"asctime": "2025-10-30 21:32:28,778", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-10-30 21:32:28,780", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SM5b21386e457b8a007d725fcb626b8d94"}
{"asctime": "2025-10-30 21:32:28,781", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "ROLLBACK"}
{"asctime": "2025-10-30 21:32:40,589", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'SmsMessageSid': 'SM6082c3597f4b8a49586dc4419836652e', 'NumMedia': '0', 'ProfileName': 'Hello World!', 'MessageType': 'text', 'SmsSid': 'SM6082c3597f4b8a49586dc4419836652e', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': '4028', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'SM6082c3597f4b8a49586dc4419836652e', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-10-30 21:32:40,590", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-30 21:32:40,591", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-10-30 21:32:40,591", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 122.3s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-10-30 21:32:40,592", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-10-30 21:32:40,592", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 122.3s ago] {'last_active_at': datetime.datetime(2025, 10, 30, 19, 32, 40, 592441), 'users_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-10-30 21:32:40,593", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-10-30 21:32:40,595", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-30 21:32:40,595", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-10-30 21:32:40,595", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 122.3s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-10-30 21:32:40,596", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-10-30 21:32:40,597", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 122.3s ago] {'id': UUID('3318ce49-cd24-4ca9-9eeb-e6e2b61180ab'), 'user_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'phone_number': '+27763514028', 'message_id': 'SM6082c3597f4b8a49586dc4419836652e', 'message_type': 'text', 'direction': 'inbound', 'message_text': '4028', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-10-30 21:32:40,597", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-10-30 21:32:40,598", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-30 21:32:40,598", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-10-30 21:32:40,598", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 122.3s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-10-30 21:32:40,599", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(id_1)s::UUID \n LIMIT %(param_1)s"}
{"asctime": "2025-10-30 21:32:40,600", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 122.3s ago] {'id_1': 'd55d888e-4ff5-49b4-9d97-795cff228fac', 'param_1': 1}"}
{"asctime": "2025-10-30 21:32:41,151", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-10-30 21:32:41,153", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SMe772ca6a8254cebdc18559946070860a"}
{"asctime": "2025-10-30 21:32:41,154", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "ROLLBACK"}
{"asctime": "2025-10-30 21:32:52,299", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'SmsMessageSid': 'SM8fda00212f62ea29b00d37c990052935', 'NumMedia': '0', 'ProfileName': 'Hello World!', 'MessageType': 'text', 'SmsSid': 'SM8fda00212f62ea29b00d37c990052935', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': 'I\u2019ve created a pin', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'SM8fda00212f62ea29b00d37c990052935', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-10-30 21:32:52,300", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-30 21:32:52,301", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-10-30 21:32:52,301", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 134s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-10-30 21:32:52,302", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-10-30 21:32:52,303", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 134s ago] {'last_active_at': datetime.datetime(2025, 10, 30, 19, 32, 52, 302642), 'users_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-10-30 21:32:52,303", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-10-30 21:32:52,305", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-30 21:32:52,305", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-10-30 21:32:52,306", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 134s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-10-30 21:32:52,307", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-10-30 21:32:52,307", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 134s ago] {'id': UUID('cf3b2b2e-8d7f-4a27-b87e-96f5d57fdff0'), 'user_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'phone_number': '+27763514028', 'message_id': 'SM8fda00212f62ea29b00d37c990052935', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'I\u2019ve d a pin', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-10-30 21:32:52,308", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-10-30 21:32:52,309", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-30 21:32:52,309", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-10-30 21:32:52,309", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 134s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-10-30 21:32:52,310", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(id_1)s::UUID \n LIMIT %(param_1)s"}
{"asctime": "2025-10-30 21:32:52,310", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 134s ago] {'id_1': 'd55d888e-4ff5-49b4-9d97-795cff228fac', 'param_1': 1}"}
{"asctime": "2025-10-30 21:32:53,290", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-10-30 21:32:53,291", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SM38ea51825f4170d682bdca83de93e9f2"}
{"asctime": "2025-10-30 21:32:53,292", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "ROLLBACK"}
{"asctime": "2025-10-30 21:33:00,367", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'SmsMessageSid': 'SMbbecb1d1abfac612989d9b88964d303c', 'NumMedia': '0', 'ProfileName': 'Hello World!', 'MessageType': 'text', 'SmsSid': 'SMbbecb1d1abfac612989d9b88964d303c', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': 'Set pin', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'SMbbecb1d1abfac612989d9b88964d303c', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-10-30 21:33:00,369", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-30 21:33:00,370", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-10-30 21:33:00,370", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 142s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-10-30 21:33:00,371", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-10-30 21:33:00,372", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 142s ago] {'last_active_at': datetime.datetime(2025, 10, 30, 19, 33, 0, 371612), 'users_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-10-30 21:33:00,373", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-10-30 21:33:00,374", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-30 21:33:00,375", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-10-30 21:33:00,375", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 142s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-10-30 21:33:00,377", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-10-30 21:33:00,377", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 142s ago] {'id': UUID('cdaff683-cece-48db-9f76-935bcf2b2bf5'), 'user_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'phone_number': '+27763514028', 'message_id': 'SMbbecb1d1abfac612989d9b88964d303c', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'Set pin', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-10-30 21:33:00,378", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-10-30 21:33:00,379", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-30 21:33:00,379", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-10-30 21:33:00,380", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 142s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-10-30 21:33:00,381", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(id_1)s::UUID \n LIMIT %(param_1)s"}
{"asctime": "2025-10-30 21:33:00,382", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 142s ago] {'id_1': 'd55d888e-4ff5-49b4-9d97-795cff228fac', 'param_1': 1}"}
{"asctime": "2025-10-30 21:33:01,335", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-10-30 21:33:01,336", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SM955a7ce10a2dd87e8d37cad180d986ef"}
{"asctime": "2025-10-30 21:33:01,337", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "ROLLBACK"}
{"asctime": "2025-10-30 21:40:57,367", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-10-30 21:40:57,935", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-10-30 21:40:57,935", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-10-30 21:40:57,953", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-10-30 21:40:57,953", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-10-30 21:40:57,954", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-10-30 21:40:57,954", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-10-30 21:40:57,954", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-10-30 21:40:57,954", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-10-30 21:40:57,955", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-30 21:40:57,956", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-30 21:40:57,956", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00009s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-30 21:40:57,958", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-30 21:40:57,958", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002185s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-30 21:40:57,958", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-30 21:40:57,958", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002668s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-30 21:40:57,959", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-30 21:40:57,959", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00007s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-30 21:40:57,960", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-30 21:40:57,960", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0006341s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-30 21:40:57,960", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-30 21:40:57,961", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001365s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-30 21:40:57,961", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-10-30 21:40:57,961", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-10-30 21:40:57,961", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-10-30 21:40:57,961", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-10-30 21:45:24,441", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-10-30 21:45:24,989", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-10-30 21:45:24,989", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-10-30 21:45:25,008", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-10-30 21:45:25,008", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-10-30 21:45:25,009", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-10-30 21:45:25,009", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-10-30 21:45:25,009", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-10-30 21:45:25,009", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-10-30 21:45:25,009", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-30 21:45:25,011", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-30 21:45:25,011", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00010s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-30 21:45:25,013", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-30 21:45:25,013", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002621s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-30 21:45:25,014", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-30 21:45:25,014", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.003188s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-30 21:45:25,015", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-30 21:45:25,015", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00007s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-30 21:45:25,016", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-30 21:45:25,016", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0008052s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-30 21:45:25,016", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-10-30 21:45:25,016", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001223s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-10-30 21:45:25,017", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-10-30 21:45:25,017", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-10-30 21:45:25,017", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-10-30 21:45:25,017", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-10-30 21:45:33,303", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'SmsMessageSid': 'SM2b3d98121ad7b6917ffd7ea5d4ea1eae', 'NumMedia': '0', 'ProfileName': 'Hello World!', 'MessageType': 'text', 'SmsSid': 'SM2b3d98121ad7b6917ffd7ea5d4ea1eae', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': 'Hi', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'SM2b3d98121ad7b6917ffd7ea5d4ea1eae', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-10-30 21:45:33,308", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-30 21:45:33,311", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-10-30 21:45:33,312", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00031s] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-10-30 21:45:33,314", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-10-30 21:45:33,314", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00008s] {'last_active_at': datetime.datetime(2025, 10, 30, 19, 45, 33, 313480), 'users_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-10-30 21:45:33,315", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-10-30 21:45:33,316", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-30 21:45:33,317", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-10-30 21:45:33,317", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00011s] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-10-30 21:45:33,318", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-10-30 21:45:33,318", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00013s] {'id': UUID('819dc56d-0e8e-47ec-a83c-b7c79eb08200'), 'user_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'phone_number': '+27763514028', 'message_id': 'SM2b3d98121ad7b6917ffd7ea5d4ea1eae', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'Hi', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-10-30 21:45:33,319", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-10-30 21:45:33,319", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-30 21:45:33,320", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-10-30 21:45:33,320", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002935s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-10-30 21:45:33,321", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(id_1)s::UUID \n LIMIT %(param_1)s"}
{"asctime": "2025-10-30 21:45:33,321", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00013s] {'id_1': 'd55d888e-4ff5-49b4-9d97-795cff228fac', 'param_1': 1}"}
{"asctime": "2025-10-30 21:45:33,323", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.phone_number = %(phone_number_1)s ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-10-30 21:45:33,323", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00027s] {'phone_number_1': '+27763514028', 'param_1': 5}"}
{"asctime": "2025-10-30 21:45:34,427", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-10-30 21:45:34,432", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.phone_number = %(phone_number_1)s ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-10-30 21:45:34,433", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 1.11s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-10-30 21:45:34,437", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-10-30 21:45:34,437", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00054s] {'ai_response': 'Hey there! How can I assist you today? \ud83d\ude0a', 'intent_detected': 'conversation', 'confidence_score': 0.8, 'is_processed': True, 'conversations_id': UUID('819dc56d-0e8e-47ec-a83c-b7c79eb08200')}"}
{"asctime": "2025-10-30 21:45:34,439", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-10-30 21:45:35,584", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-10-30 21:45:35,585", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SM8a5ed22479e722bac1f67cc6bc27d3fc"}
{"asctime": "2025-10-30 21:45:47,201", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'SmsMessageSid': 'SMe70aafa3d6d93cb81b00f4940e9977c5', 'NumMedia': '0', 'ProfileName': 'Hello World!', 'MessageType': 'text', 'SmsSid': 'SMe70aafa3d6d93cb81b00f4940e9977c5', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': 'Send money to Samuel', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'SMe70aafa3d6d93cb81b00f4940e9977c5', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-10-30 21:45:47,202", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-30 21:45:47,203", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-10-30 21:45:47,203", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 13.89s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-10-30 21:45:47,205", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-10-30 21:45:47,205", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 13.89s ago] {'last_active_at': datetime.datetime(2025, 10, 30, 19, 45, 47, 205205), 'users_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-10-30 21:45:47,207", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-10-30 21:45:47,219", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-30 21:45:47,220", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-10-30 21:45:47,220", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 13.9s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-10-30 21:45:47,222", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-10-30 21:45:47,222", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 13.9s ago] {'id': UUID('79cae9e6-12a9-44d0-b0fd-83c65686e330'), 'user_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'phone_number': '+27763514028', 'message_id': 'SMe70aafa3d6d93cb81b00f4940e9977c5', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'Send money to Samuel', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-10-30 21:45:47,224", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-10-30 21:45:47,225", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-30 21:45:47,225", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-10-30 21:45:47,225", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 13.91s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-10-30 21:45:47,228", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(id_1)s::UUID \n LIMIT %(param_1)s"}
{"asctime": "2025-10-30 21:45:47,228", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 13.91s ago] {'id_1': 'd55d888e-4ff5-49b4-9d97-795cff228fac', 'param_1': 1}"}
{"asctime": "2025-10-30 21:45:47,229", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.phone_number = %(phone_number_1)s ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-10-30 21:45:47,230", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 13.91s ago] {'phone_number_1': '+27763514028', 'param_1': 5}"}
{"asctime": "2025-10-30 21:45:48,437", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-10-30 21:45:48,446", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.phone_number = %(phone_number_1)s ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-10-30 21:45:48,446", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 15.12s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-10-30 21:45:48,448", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-10-30 21:45:48,448", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00024s] {'ai_response': 'Sure! How much would you like to send to Samuel? Also, do you have his phone number or bank account details?', 'intent_detected': 'send_money', 'entities_extracted': '{\"amount\": 0, \"recipient_name\": \"samuel\"}', 'confidence_score': 0.9, 'is_processed': True, 'conversations_id': UUID('79cae9e6-12a9-44d0-b0fd-83c65686e330')}"}
{"asctime": "2025-10-30 21:45:48,449", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-10-30 21:45:48,450", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-30 21:45:48,450", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-10-30 21:45:48,450", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 15.13s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-10-30 21:45:48,880", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-10-30 21:45:48,883", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SM0c785f46ecb27d0ca2bef61865da2977"}
{"asctime": "2025-10-30 21:45:48,884", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "ROLLBACK"}
{"asctime": "2025-10-30 21:46:00,022", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'SmsMessageSid': 'SMeedd1f42cdf6d8825c9bd011bbaf8c3b', 'NumMedia': '0', 'ProfileName': 'Hello World!', 'MessageType': 'text', 'SmsSid': 'SMeedd1f42cdf6d8825c9bd011bbaf8c3b', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': 'No', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'SMeedd1f42cdf6d8825c9bd011bbaf8c3b', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-10-30 21:46:00,024", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-30 21:46:00,025", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-10-30 21:46:00,025", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 26.71s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-10-30 21:46:00,027", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-10-30 21:46:00,028", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 26.71s ago] {'last_active_at': datetime.datetime(2025, 10, 30, 19, 46, 0, 27072), 'users_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-10-30 21:46:00,029", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-10-30 21:46:00,031", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-30 21:46:00,032", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-10-30 21:46:00,033", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 26.72s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-10-30 21:46:00,041", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-10-30 21:46:00,041", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 26.72s ago] {'id': UUID('6afdfd3e-d405-4f1b-b670-39dcc89415dc'), 'user_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'phone_number': '+27763514028', 'message_id': 'SMeedd1f42cdf6d8825c9bd011bbaf8c3b', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'No', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-10-30 21:46:00,043", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-10-30 21:46:00,635", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-10-30 21:46:00,637", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SM23a15e00f30d087993fbc3801411e6a3"}
{"asctime": "2025-10-30 21:46:21,081", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'SmsMessageSid': 'SMede9daf55e3c8327f021b1725b6bf6d0', 'NumMedia': '0', 'ProfileName': 'Hello World!', 'MessageType': 'text', 'SmsSid': 'SMede9daf55e3c8327f021b1725b6bf6d0', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': 'Send 50 rand to thabo', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'SMede9daf55e3c8327f021b1725b6bf6d0', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-10-30 21:46:21,084", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-30 21:46:21,085", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-10-30 21:46:21,087", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 47.77s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-10-30 21:46:21,089", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-10-30 21:46:21,089", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 47.77s ago] {'last_active_at': datetime.datetime(2025, 10, 30, 19, 46, 21, 88456), 'users_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-10-30 21:46:21,090", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-10-30 21:46:21,091", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-30 21:46:21,091", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-10-30 21:46:21,091", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 47.77s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-10-30 21:46:21,093", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-10-30 21:46:21,093", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 47.77s ago] {'id': UUID('c6b3bf9d-500e-4c26-8d23-4409483ee22b'), 'user_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'phone_number': '+27763514028', 'message_id': 'SMede9daf55e3c8327f021b1725b6bf6d0', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'Send 50 rand to thabo', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-10-30 21:46:21,094", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-10-30 21:46:21,095", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-30 21:46:21,095", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-10-30 21:46:21,096", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 47.78s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-10-30 21:46:21,101", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(id_1)s::UUID \n LIMIT %(param_1)s"}
{"asctime": "2025-10-30 21:46:21,102", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 47.78s ago] {'id_1': 'd55d888e-4ff5-49b4-9d97-795cff228fac', 'param_1': 1}"}
{"asctime": "2025-10-30 21:46:21,103", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.phone_number = %(phone_number_1)s ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-10-30 21:46:21,104", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 47.78s ago] {'phone_number_1': '+27763514028', 'param_1': 5}"}
{"asctime": "2025-10-30 21:46:22,247", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-10-30 21:46:22,252", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.phone_number = %(phone_number_1)s ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-10-30 21:46:22,252", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 48.93s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-10-30 21:46:22,254", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-10-30 21:46:22,254", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 33.81s ago] {'ai_response': \"I can help you with that! Could you please provide Thabo's phone number or bank account details?\", 'intent_detected': 'send_money', 'entities_extracted': '{\"amount\": 50.0, \"recipient_name\": \"thabo\"}', 'confidence_score': 0.9, 'is_processed': True, 'conversations_id': UUID('c6b3bf9d-500e-4c26-8d23-4409483ee22b')}"}
{"asctime": "2025-10-30 21:46:22,255", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-10-30 21:46:22,257", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-30 21:46:22,257", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-10-30 21:46:22,257", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 48.94s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-10-30 21:46:22,963", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-10-30 21:46:22,966", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SM114687ff6df5f29f67119ad49d51ccd6"}
{"asctime": "2025-10-30 21:46:22,967", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "ROLLBACK"}
{"asctime": "2025-10-30 21:46:34,436", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'SmsMessageSid': 'SM1706bb85fa58439a63d7c02f68d17862', 'NumMedia': '0', 'ProfileName': 'Hello World!', 'MessageType': 'text', 'SmsSid': 'SM1706bb85fa58439a63d7c02f68d17862', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': 'Yes', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'SM1706bb85fa58439a63d7c02f68d17862', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-10-30 21:46:34,439", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-30 21:46:34,439", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-10-30 21:46:34,440", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 61.13s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-10-30 21:46:34,441", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-10-30 21:46:34,441", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 61.13s ago] {'last_active_at': datetime.datetime(2025, 10, 30, 19, 46, 34, 441213), 'users_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-10-30 21:46:34,442", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-10-30 21:46:34,444", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-30 21:46:34,444", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-10-30 21:46:34,444", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 61.13s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-10-30 21:46:34,446", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-10-30 21:46:34,446", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 61.13s ago] {'id': UUID('6f743b34-64a9-4cc2-afad-e51cf8d9994d'), 'user_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'phone_number': '+27763514028', 'message_id': 'SM1706bb85fa58439a63d7c02f68d17862', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'Yes', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-10-30 21:46:34,447", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-10-30 21:46:35,051", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-10-30 21:46:35,053", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SMa2f63f987d6cd168ac4eca6994799538"}
{"asctime": "2025-10-30 21:46:40,673", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'SmsMessageSid': 'SM7bdb00aa28fda922bb304091d16a2b00', 'NumMedia': '0', 'ProfileName': 'Hello World!', 'MessageType': 'text', 'SmsSid': 'SM7bdb00aa28fda922bb304091d16a2b00', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': '4028', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'SM7bdb00aa28fda922bb304091d16a2b00', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-10-30 21:46:40,675", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-30 21:46:40,675", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-10-30 21:46:40,676", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 67.36s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-10-30 21:46:40,677", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-10-30 21:46:40,677", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 67.36s ago] {'last_active_at': datetime.datetime(2025, 10, 30, 19, 46, 40, 677199), 'users_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-10-30 21:46:40,679", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-10-30 21:46:40,681", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-30 21:46:40,682", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-10-30 21:46:40,683", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 67.36s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-10-30 21:46:40,684", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-10-30 21:46:40,685", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 67.37s ago] {'id': UUID('aa3e54b1-db69-4d10-9871-a013130d7a18'), 'user_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'phone_number': '+27763514028', 'message_id': 'SM7bdb00aa28fda922bb304091d16a2b00', 'message_type': 'text', 'direction': 'inbound', 'message_text': '4028', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-10-30 21:46:40,693", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-10-30 21:46:40,695", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-30 21:46:40,695", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-10-30 21:46:40,695", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 67.38s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-10-30 21:46:40,697", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(id_1)s::UUID \n LIMIT %(param_1)s"}
{"asctime": "2025-10-30 21:46:40,697", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 67.38s ago] {'id_1': 'd55d888e-4ff5-49b4-9d97-795cff228fac', 'param_1': 1}"}
{"asctime": "2025-10-30 21:46:41,159", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-10-30 21:46:41,161", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SM0ef1f4068c754d97a0b0ab84fd32a22e"}
{"asctime": "2025-10-30 21:46:41,162", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "ROLLBACK"}
{"asctime": "2025-10-30 21:46:48,323", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'SmsMessageSid': 'SMbbaca57f738febbba434e67a5eedb8a9', 'NumMedia': '0', 'ProfileName': 'Hello World!', 'MessageType': 'text', 'SmsSid': 'SMbbaca57f738febbba434e67a5eedb8a9', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': 'Set pin', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'SMbbaca57f738febbba434e67a5eedb8a9', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-10-30 21:46:48,324", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-30 21:46:48,325", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-10-30 21:46:48,325", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 75.01s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-10-30 21:46:48,327", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-10-30 21:46:48,330", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 75.02s ago] {'last_active_at': datetime.datetime(2025, 10, 30, 19, 46, 48, 327163), 'users_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-10-30 21:46:48,333", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-10-30 21:46:48,335", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-30 21:46:48,336", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-10-30 21:46:48,337", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 75.02s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-10-30 21:46:48,346", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-10-30 21:46:48,346", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 75.03s ago] {'id': UUID('53f597b7-e8cc-4a91-a7bf-49f8e234dcc1'), 'user_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'phone_number': '+27763514028', 'message_id': 'SMbbaca57f738febbba434e67a5eedb8a9', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'Set pin', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-10-30 21:46:48,348", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-10-30 21:46:48,349", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-30 21:46:48,349", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-10-30 21:46:48,349", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 75.03s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-10-30 21:46:48,351", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(id_1)s::UUID \n LIMIT %(param_1)s"}
{"asctime": "2025-10-30 21:46:48,351", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 75.03s ago] {'id_1': 'd55d888e-4ff5-49b4-9d97-795cff228fac', 'param_1': 1}"}
{"asctime": "2025-10-30 21:46:48,863", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-10-30 21:46:48,865", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SM9ae74e43fd30c1f5b21ca986ce617428"}
{"asctime": "2025-10-30 21:46:48,866", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "ROLLBACK"}
{"asctime": "2025-10-30 21:46:56,639", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'SmsMessageSid': 'SMae0fa596f8a0e6df851f74b3d22e3eeb', 'NumMedia': '0', 'ProfileName': 'Hello World!', 'MessageType': 'text', 'SmsSid': 'SMae0fa596f8a0e6df851f74b3d22e3eeb', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': 'SET PIN', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'SMae0fa596f8a0e6df851f74b3d22e3eeb', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-10-30 21:46:56,641", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-30 21:46:56,642", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-10-30 21:46:56,642", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 83.33s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-10-30 21:46:56,643", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-10-30 21:46:56,644", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 83.33s ago] {'last_active_at': datetime.datetime(2025, 10, 30, 19, 46, 56, 643581), 'users_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-10-30 21:46:56,645", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-10-30 21:46:56,646", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-30 21:46:56,647", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-10-30 21:46:56,647", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 83.33s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-10-30 21:46:56,649", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-10-30 21:46:56,649", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 83.33s ago] {'id': UUID('3b608c98-8326-4d0a-b2b9-de37b753a799'), 'user_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'phone_number': '+27763514028', 'message_id': 'SMae0fa596f8a0e6df851f74b3d22e3eeb', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'SET PIN', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-10-30 21:46:56,650", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-10-30 21:46:56,651", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-30 21:46:56,651", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-10-30 21:46:56,652", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 83.33s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-10-30 21:46:56,653", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(id_1)s::UUID \n LIMIT %(param_1)s"}
{"asctime": "2025-10-30 21:46:56,654", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 83.33s ago] {'id_1': 'd55d888e-4ff5-49b4-9d97-795cff228fac', 'param_1': 1}"}
{"asctime": "2025-10-30 21:46:57,127", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-10-30 21:46:57,128", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SM077b4d7ac5cb8b178cb59e6db5a2b478"}
{"asctime": "2025-10-30 21:46:57,129", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "ROLLBACK"}
{"asctime": "2025-10-30 21:53:37,399", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'SmsMessageSid': 'SMcc5e9a69a20890b215e76e72bd3b746c', 'NumMedia': '0', 'ProfileName': 'Hello World!', 'MessageType': 'text', 'SmsSid': 'SMcc5e9a69a20890b215e76e72bd3b746c', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': 'Ok', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'SMcc5e9a69a20890b215e76e72bd3b746c', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-10-30 21:53:37,406", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-30 21:53:37,407", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-10-30 21:53:37,407", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 484.1s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-10-30 21:53:37,410", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-10-30 21:53:37,410", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 484.1s ago] {'last_active_at': datetime.datetime(2025, 10, 30, 19, 53, 37, 410087), 'users_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-10-30 21:53:37,411", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-10-30 21:53:37,413", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-30 21:53:37,414", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-10-30 21:53:37,414", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 484.1s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-10-30 21:53:37,415", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-10-30 21:53:37,415", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 484.1s ago] {'id': UUID('c696c92c-efb0-4fa8-a2cf-04d1892e0cf7'), 'user_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'phone_number': '+27763514028', 'message_id': 'SMcc5e9a69a20890b215e76e72bd3b746c', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'Ok', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-10-30 21:53:37,416", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-10-30 21:53:37,417", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-30 21:53:37,417", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-10-30 21:53:37,417", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 484.1s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-10-30 21:53:37,418", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(id_1)s::UUID \n LIMIT %(param_1)s"}
{"asctime": "2025-10-30 21:53:37,419", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 484.1s ago] {'id_1': 'd55d888e-4ff5-49b4-9d97-795cff228fac', 'param_1': 1}"}
{"asctime": "2025-10-30 21:53:38,022", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-10-30 21:53:38,023", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SM1c0d9e7965f1b014218b8f0d1689822e"}
{"asctime": "2025-10-30 21:53:38,024", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "ROLLBACK"}
{"asctime": "2025-10-30 21:53:42,366", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'SmsMessageSid': 'SMbfe2ef9fc489e15a13f373917e6226f2', 'NumMedia': '0', 'ProfileName': 'Hello World!', 'MessageType': 'text', 'SmsSid': 'SMbfe2ef9fc489e15a13f373917e6226f2', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': 'Hi', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'SMbfe2ef9fc489e15a13f373917e6226f2', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-10-30 21:53:42,368", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-30 21:53:42,368", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-10-30 21:53:42,368", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 489.1s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-10-30 21:53:42,370", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-10-30 21:53:42,370", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 489s ago] {'last_active_at': datetime.datetime(2025, 10, 30, 19, 53, 42, 369968), 'users_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-10-30 21:53:42,371", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-10-30 21:53:42,373", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-30 21:53:42,373", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-10-30 21:53:42,373", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 489s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-10-30 21:53:42,375", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-10-30 21:53:42,375", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 489s ago] {'id': UUID('dffe46f8-f8fd-481e-970d-999286accdf1'), 'user_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'phone_number': '+27763514028', 'message_id': 'SMbfe2ef9fc489e15a13f373917e6226f2', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'Hi', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-10-30 21:53:42,376", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-10-30 21:53:42,376", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-10-30 21:53:42,377", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-10-30 21:53:42,377", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 489.1s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-10-30 21:53:42,378", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(id_1)s::UUID \n LIMIT %(param_1)s"}
{"asctime": "2025-10-30 21:53:42,378", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 489.1s ago] {'id_1': 'd55d888e-4ff5-49b4-9d97-795cff228fac', 'param_1': 1}"}
{"asctime": "2025-10-30 21:53:42,871", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-10-30 21:53:42,873", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SM4709fa11da1d86bb62e157fa53b7a481"}
{"asctime": "2025-10-30 21:53:42,874", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "ROLLBACK"}
{"asctime": "2025-11-04 05:55:12,824", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-11-04 05:55:13,447", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-11-04 05:55:13,447", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-11-04 05:55:13,540", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-11-04 05:55:13,540", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-04 05:55:13,541", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-11-04 05:55:13,541", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-04 05:55:13,541", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-11-04 05:55:13,541", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-04 05:55:13,541", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-04 05:55:13,543", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-04 05:55:13,543", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00010s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-04 05:55:13,545", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-04 05:55:13,545", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002297s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-04 05:55:13,545", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-04 05:55:13,545", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002855s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-04 05:55:13,546", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-04 05:55:13,546", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00008s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-04 05:55:13,547", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-04 05:55:13,547", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0006575s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-04 05:55:13,548", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-04 05:55:13,548", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001249s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-04 05:55:13,548", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-04 05:55:13,548", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-11-04 05:55:13,548", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-11-04 05:55:13,548", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-11-10 21:24:20,391", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'SmsMessageSid': 'SM9d99c4e583fef2c7909fc8cdf1c8ff6a', 'NumMedia': '0', 'ProfileName': 'Hello World!', 'MessageType': 'text', 'SmsSid': 'SM9d99c4e583fef2c7909fc8cdf1c8ff6a', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': 'Hi', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'SM9d99c4e583fef2c7909fc8cdf1c8ff6a', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-11-10 21:24:20,411", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-10 21:24:20,413", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-10 21:24:20,414", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00018s] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-10 21:24:20,425", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-10 21:24:20,425", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00012s] {'last_active_at': datetime.datetime(2025, 11, 10, 19, 24, 20, 425095), 'users_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-10 21:24:20,430", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-10 21:24:20,432", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-10 21:24:20,433", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-10 21:24:20,433", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00011s] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-10 21:24:20,435", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-10 21:24:20,435", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00017s] {'id': UUID('c19bac85-2ec6-48ae-b2e4-d74e4eb242d3'), 'user_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'phone_number': '+27763514028', 'message_id': 'SM9d99c4e583fef2c7909fc8cdf1c8ff6a', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'Hi', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-10 21:24:20,438", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-10 21:24:20,439", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-10 21:24:20,439", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-10 21:24:20,439", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.006111s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-10 21:24:20,440", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(id_1)s::UUID \n LIMIT %(param_1)s"}
{"asctime": "2025-11-10 21:24:20,440", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00012s] {'id_1': 'd55d888e-4ff5-49b4-9d97-795cff228fac', 'param_1': 1}"}
{"asctime": "2025-11-10 21:24:20,441", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET last_daily_reset=%(last_daily_reset)s, updated_at=now() WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-10 21:24:20,441", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00009s] {'last_daily_reset': datetime.datetime(2025, 11, 10, 19, 24, 20, 441353), 'users_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-10 21:24:20,442", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-10 21:24:20,442", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-10 21:24:20,442", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-10 21:24:20,442", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.009568s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-10 21:24:20,443", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET last_monthly_reset=%(last_monthly_reset)s, updated_at=now() WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-10 21:24:20,443", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00011s] {'last_monthly_reset': datetime.datetime(2025, 11, 10, 19, 24, 20, 441353), 'users_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-10 21:24:20,446", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-10 21:24:20,446", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-10 21:24:20,446", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-10 21:24:20,446", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0136s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-10 21:24:20,448", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.phone_number = %(phone_number_1)s ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-10 21:24:20,448", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00014s] {'phone_number_1': '+27763514028', 'param_1': 5}"}
{"asctime": "2025-11-10 21:24:22,100", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-10 21:24:22,111", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.phone_number = %(phone_number_1)s ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-10 21:24:22,111", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 1.663s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-10 21:24:22,114", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-10 21:24:22,115", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00038s] {'ai_response': 'Hey there! How can I assist you today? \ud83d\ude0a', 'intent_detected': 'conversation', 'confidence_score': 0.8, 'is_processed': True, 'conversations_id': UUID('c19bac85-2ec6-48ae-b2e4-d74e4eb242d3')}"}
{"asctime": "2025-11-10 21:24:22,117", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-10 21:24:22,823", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-10 21:24:22,824", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SMa230af2f09bcaf107ccc337317d8cbc1"}
{"asctime": "2025-11-10 21:24:33,810", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'SmsMessageSid': 'SMf3f742ac8906e8b0116394ce4c0639bd', 'NumMedia': '0', 'ProfileName': 'Hello World!', 'MessageType': 'text', 'SmsSid': 'SMf3f742ac8906e8b0116394ce4c0639bd', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': 'What can you do for me', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'SMf3f742ac8906e8b0116394ce4c0639bd', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-11-10 21:24:33,812", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-10 21:24:33,813", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-10 21:24:33,813", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 13.4s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-10 21:24:33,815", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-10 21:24:33,815", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 13.39s ago] {'last_active_at': datetime.datetime(2025, 11, 10, 19, 24, 33, 814856), 'users_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-10 21:24:33,816", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-10 21:24:33,818", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-10 21:24:33,818", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-10 21:24:33,819", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 13.39s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-10 21:24:33,821", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-10 21:24:33,821", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 13.39s ago] {'id': UUID('cea949e2-c4dd-4da9-a782-38621983415b'), 'user_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'phone_number': '+27763514028', 'message_id': 'SMf3f742ac8906e8b0116394ce4c0639bd', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'What can you do for me', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-10 21:24:33,823", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-10 21:24:33,824", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-10 21:24:33,824", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-10 21:24:33,824", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 13.39s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-10 21:24:33,826", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(id_1)s::UUID \n LIMIT %(param_1)s"}
{"asctime": "2025-11-10 21:24:33,826", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 13.39s ago] {'id_1': 'd55d888e-4ff5-49b4-9d97-795cff228fac', 'param_1': 1}"}
{"asctime": "2025-11-10 21:24:33,828", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.phone_number = %(phone_number_1)s ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-10 21:24:33,829", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 13.38s ago] {'phone_number_1': '+27763514028', 'param_1': 5}"}
{"asctime": "2025-11-10 21:24:36,650", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-10 21:24:36,658", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.phone_number = %(phone_number_1)s ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-10 21:24:36,659", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 16.21s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-10 21:24:36,661", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-10 21:24:36,661", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 14.55s ago] {'ai_response': 'I can help you with a few things:\\n\\n1. Send money to friends or family.\\n2. Pay your prepaid electricity bills.\\n3. Buy airtime or data bundles for your phone.\\n4. Check your account balance and transaction history.\\n5. Set up recurring payments.\\n\\nLet me know what you need help with!', 'intent_detected': 'conversation', 'confidence_score': 0.8, 'is_processed': True, 'conversations_id': UUID('cea949e2-c4dd-4da9-a782-38621983415b')}"}
{"asctime": "2025-11-10 21:24:36,663", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-10 21:24:37,256", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-10 21:24:37,257", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SM2a033051e1e136667699bcd3c5edeb5e"}
{"asctime": "2025-11-10 21:25:59,145", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'MediaContentType0': 'image/jpeg', 'SmsMessageSid': 'MM3c5e95f216c12f9dcf88670a20925da7', 'NumMedia': '1', 'ProfileName': 'Hello World!', 'MessageType': 'image', 'SmsSid': 'MM3c5e95f216c12f9dcf88670a20925da7', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': 'Send r500', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'MM3c5e95f216c12f9dcf88670a20925da7', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'MediaUrl0': 'https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages/MM3c5e95f216c12f9dcf88670a20925da7/Media/ME92067d42a5ac332f793fb1cb00c9ed08', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-11-10 21:25:59,148", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-10 21:25:59,149", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-10 21:25:59,149", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 98.74s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-10 21:25:59,151", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-10 21:25:59,151", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 98.73s ago] {'last_active_at': datetime.datetime(2025, 11, 10, 19, 25, 59, 150912), 'users_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-10 21:25:59,153", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-10 21:25:59,156", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-10 21:25:59,157", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-10 21:25:59,157", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 98.72s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-10 21:25:59,159", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-10 21:25:59,159", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 98.72s ago] {'id': UUID('65016277-d402-4b3d-8273-854241d26485'), 'user_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'phone_number': '+27763514028', 'message_id': 'MM3c5e95f216c12f9dcf88670a20925da7', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'Send r500', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-10 21:25:59,160", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-10 21:25:59,161", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-10 21:25:59,161", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-10 21:25:59,161", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 98.73s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-10 21:25:59,162", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(id_1)s::UUID \n LIMIT %(param_1)s"}
{"asctime": "2025-11-10 21:25:59,163", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 98.72s ago] {'id_1': 'd55d888e-4ff5-49b4-9d97-795cff228fac', 'param_1': 1}"}
{"asctime": "2025-11-10 21:25:59,164", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.phone_number = %(phone_number_1)s ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-10 21:25:59,164", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 98.72s ago] {'phone_number_1': '+27763514028', 'param_1': 5}"}
{"asctime": "2025-11-10 21:26:01,496", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-10 21:26:01,503", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.phone_number = %(phone_number_1)s ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-10 21:26:01,504", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 101.1s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-10 21:26:01,508", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-10 21:26:01,508", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00039s] {'ai_response': \"Just to confirm, you want to send R500. Could you please provide the phone number or account number you\u2019d like to send it to? Also, I'll need your PIN to process the transaction.\", 'intent_detected': 'send_money', 'entities_extracted': '{\"amount\": 500.0, \"recipient_name\": \"recipient\"}', 'confidence_score': 0.9, 'is_processed': True, 'conversations_id': UUID('65016277-d402-4b3d-8273-854241d26485')}"}
{"asctime": "2025-11-10 21:26:01,509", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-10 21:26:01,514", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-10 21:26:01,515", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-10 21:26:01,515", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 101.1s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-10 21:26:02,471", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-10 21:26:02,473", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SM57aa95031b43d9431634dc54049a3e16"}
{"asctime": "2025-11-10 21:26:02,474", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "ROLLBACK"}
{"asctime": "2025-11-10 21:26:16,969", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'SmsMessageSid': 'SM7678d3de1c880d8ae68e3bcb4b53bbf2', 'NumMedia': '0', 'ProfileName': 'Hello World!', 'MessageType': 'text', 'SmsSid': 'SM7678d3de1c880d8ae68e3bcb4b53bbf2', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': 'No', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'SM7678d3de1c880d8ae68e3bcb4b53bbf2', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-11-10 21:26:16,971", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-10 21:26:16,972", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-10 21:26:16,972", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 116.6s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-10 21:26:16,974", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-10 21:26:16,974", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 116.5s ago] {'last_active_at': datetime.datetime(2025, 11, 10, 19, 26, 16, 974030), 'users_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-10 21:26:16,975", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-10 21:26:16,977", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-10 21:26:16,977", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-10 21:26:16,977", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 116.5s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-10 21:26:16,979", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-10 21:26:16,979", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 116.5s ago] {'id': UUID('c9fd5ecc-cc32-4e10-941b-75681881224f'), 'user_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'phone_number': '+27763514028', 'message_id': 'SM7678d3de1c880d8ae68e3bcb4b53bbf2', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'No', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-10 21:26:16,980", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-10 21:26:17,457", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-10 21:26:17,459", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SM2b5d175cd17b1d83d472d3b91a31f636"}
{"asctime": "2025-11-10 21:26:33,938", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'SmsMessageSid': 'SM7f65f814574a4ddf1d3e1cbbcd7c4da7', 'NumMedia': '0', 'ProfileName': 'Hello World!', 'MessageType': 'text', 'SmsSid': 'SM7f65f814574a4ddf1d3e1cbbcd7c4da7', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': 'How many transfers have I made today ?', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'SM7f65f814574a4ddf1d3e1cbbcd7c4da7', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-11-10 21:26:33,940", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-10 21:26:33,941", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-10 21:26:33,941", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 133.5s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-10 21:26:33,942", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-10 21:26:33,943", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 133.5s ago] {'last_active_at': datetime.datetime(2025, 11, 10, 19, 26, 33, 942582), 'users_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-10 21:26:33,944", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-10 21:26:33,945", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-10 21:26:33,946", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-10 21:26:33,946", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 133.5s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-10 21:26:33,947", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-10 21:26:33,947", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 133.5s ago] {'id': UUID('0bb3d15a-6de0-404b-bbf2-147d3857cf5c'), 'user_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'phone_number': '+27763514028', 'message_id': 'SM7f65f814574a4ddf1d3e1cbbcd7c4da7', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'How many transfers have I made today ?', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-10 21:26:33,948", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-10 21:26:33,949", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-10 21:26:33,950", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-10 21:26:33,950", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 133.5s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-10 21:26:33,951", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(id_1)s::UUID \n LIMIT %(param_1)s"}
{"asctime": "2025-11-10 21:26:33,951", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 133.5s ago] {'id_1': 'd55d888e-4ff5-49b4-9d97-795cff228fac', 'param_1': 1}"}
{"asctime": "2025-11-10 21:26:33,953", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.phone_number = %(phone_number_1)s ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-10 21:26:33,953", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 133.5s ago] {'phone_number_1': '+27763514028', 'param_1': 5}"}
{"asctime": "2025-11-10 21:26:37,612", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-10 21:26:37,619", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.phone_number = %(phone_number_1)s ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-10 21:26:37,621", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 137.2s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-10 21:26:37,623", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-10 21:26:37,624", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 135.5s ago] {'ai_response': \"I can't access your transaction history directly, but I can help you check your balance and recent transactions. Would you like me to do that?\", 'intent_detected': 'conversation', 'confidence_score': 0.8, 'is_processed': True, 'conversations_id': UUID('0bb3d15a-6de0-404b-bbf2-147d3857cf5c')}"}
{"asctime": "2025-11-10 21:26:37,625", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-10 21:26:38,393", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-10 21:26:38,394", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SMbfdfa1e2663dbbb71240f60d82b6285d"}
{"asctime": "2025-11-10 21:26:50,616", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'SmsMessageSid': 'SM53c86c4cc9f1241fcc3573baf3115f09', 'NumMedia': '0', 'ProfileName': 'Hello World!', 'MessageType': 'text', 'SmsSid': 'SM53c86c4cc9f1241fcc3573baf3115f09', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': 'Yes', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'SM53c86c4cc9f1241fcc3573baf3115f09', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-11-10 21:26:50,617", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-10 21:26:50,618", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-10 21:26:50,618", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 150.2s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-10 21:26:50,620", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-10 21:26:50,621", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 150.2s ago] {'last_active_at': datetime.datetime(2025, 11, 10, 19, 26, 50, 620257), 'users_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-10 21:26:50,623", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-10 21:26:50,625", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-10 21:26:50,625", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-10 21:26:50,625", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 150.2s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-10 21:26:50,627", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-10 21:26:50,627", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 150.2s ago] {'id': UUID('c262f65a-4927-4a43-ae36-3d1b7511618e'), 'user_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'phone_number': '+27763514028', 'message_id': 'SM53c86c4cc9f1241fcc3573baf3115f09', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'Yes', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-10 21:26:50,628", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-10 21:26:50,629", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-10 21:26:50,629", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-10 21:26:50,630", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 150.2s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-10 21:26:50,631", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(id_1)s::UUID \n LIMIT %(param_1)s"}
{"asctime": "2025-11-10 21:26:50,631", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 150.2s ago] {'id_1': 'd55d888e-4ff5-49b4-9d97-795cff228fac', 'param_1': 1}"}
{"asctime": "2025-11-10 21:26:50,632", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.phone_number = %(phone_number_1)s ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-10 21:26:50,632", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 150.2s ago] {'phone_number_1': '+27763514028', 'param_1': 5}"}
{"asctime": "2025-11-10 21:26:54,399", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-10 21:26:54,405", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.phone_number = %(phone_number_1)s ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-10 21:26:54,406", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 154s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-10 21:26:54,408", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-10 21:26:54,408", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 152.3s ago] {'ai_response': 'Great! Just a moment while I check your balance and recent transactions. \\n\\nSince you have a balance of R0.00, there might not be recent transactions to show. Would you like to do something else, like sending money, buying airtime, or paying a bill?', 'intent_detected': 'conversation', 'confidence_score': 0.8, 'is_processed': True, 'conversations_id': UUID('c262f65a-4927-4a43-ae36-3d1b7511618e')}"}
{"asctime": "2025-11-10 21:26:54,409", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-10 21:26:55,628", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-10 21:26:55,630", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SM4b4a3d40dc982582824756aeea4ab61b"}
{"asctime": "2025-11-10 21:32:55,034", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'SmsMessageSid': 'SM1b8be2cc468c514ea7375f31f843bbed', 'NumMedia': '0', 'ProfileName': 'Hello World!', 'MessageType': 'text', 'SmsSid': 'SM1b8be2cc468c514ea7375f31f843bbed', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': 'I wanna buy airtime', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'SM1b8be2cc468c514ea7375f31f843bbed', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-11-10 21:32:55,048", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-10 21:32:55,050", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-10 21:32:55,050", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 514.6s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-10 21:32:55,054", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-10 21:32:55,054", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 514.6s ago] {'last_active_at': datetime.datetime(2025, 11, 10, 19, 32, 55, 53690), 'users_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-10 21:32:55,056", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-10 21:32:55,058", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-10 21:32:55,058", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-10 21:32:55,058", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 514.6s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-10 21:32:55,060", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-10 21:32:55,060", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 514.6s ago] {'id': UUID('75c0ce27-c82c-460e-b42f-2c8e99210be4'), 'user_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'phone_number': '+27763514028', 'message_id': 'SM1b8be2cc468c514ea7375f31f843bbed', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'I wanna buy airtime', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-10 21:32:55,061", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-10 21:32:55,062", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-10 21:32:55,062", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-10 21:32:55,062", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 514.6s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-10 21:32:55,064", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(id_1)s::UUID \n LIMIT %(param_1)s"}
{"asctime": "2025-11-10 21:32:55,064", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 514.6s ago] {'id_1': 'd55d888e-4ff5-49b4-9d97-795cff228fac', 'param_1': 1}"}
{"asctime": "2025-11-10 21:32:55,065", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.phone_number = %(phone_number_1)s ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-10 21:32:55,065", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 514.6s ago] {'phone_number_1': '+27763514028', 'param_1': 5}"}
{"asctime": "2025-11-10 21:32:56,468", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-10 21:32:56,502", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.phone_number = %(phone_number_1)s ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-10 21:32:56,503", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 516.1s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-10 21:32:56,505", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-10 21:32:56,506", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 415s ago] {'ai_response': 'Sure! How much airtime would you like to buy, and which mobile provider are you using? (MTN, Vodacom, Cell C, or Telkom)', 'intent_detected': 'airtime_purchase', 'entities_extracted': '{\"amount\": 0}', 'confidence_score': 0.85, 'is_processed': True, 'conversations_id': UUID('75c0ce27-c82c-460e-b42f-2c8e99210be4')}"}
{"asctime": "2025-11-10 21:32:56,507", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-10 21:32:56,508", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-10 21:32:56,508", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-10 21:32:56,509", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 516.1s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-10 21:32:57,108", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-10 21:32:57,109", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SMe79972068c5325090657d6893fe473a2"}
{"asctime": "2025-11-10 21:32:57,110", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "ROLLBACK"}
{"asctime": "2025-11-10 21:33:14,212", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'SmsMessageSid': 'SM59355dbac5d5e2614721b2666f18843f', 'NumMedia': '0', 'ProfileName': 'Hello World!', 'MessageType': 'text', 'SmsSid': 'SM59355dbac5d5e2614721b2666f18843f', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': 'Do you understand Zulu yet ?', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'SM59355dbac5d5e2614721b2666f18843f', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-11-10 21:33:14,215", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-10 21:33:14,215", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-10 21:33:14,216", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 533.8s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-10 21:33:14,219", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-10 21:33:14,219", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 533.8s ago] {'last_active_at': datetime.datetime(2025, 11, 10, 19, 33, 14, 218122), 'users_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-10 21:33:14,220", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-10 21:33:14,222", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-10 21:33:14,222", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-10 21:33:14,222", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 533.8s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-10 21:33:14,224", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-10 21:33:14,224", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 533.8s ago] {'id': UUID('6504bfc8-85dc-4db5-a3dd-8d0d99422114'), 'user_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'phone_number': '+27763514028', 'message_id': 'SM59355dbac5d5e2614721b2666f18843f', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'Do you understand Zulu yet ?', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-10 21:33:14,228", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-10 21:33:14,679", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-10 21:33:14,681", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SM8e660c803fe7f17125a235066ecda7e7"}
{"asctime": "2025-11-10 21:33:20,081", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'SmsMessageSid': 'SMdb47811fe0b69de88b4fc924cb78ba75', 'NumMedia': '0', 'ProfileName': 'Hello World!', 'MessageType': 'text', 'SmsSid': 'SMdb47811fe0b69de88b4fc924cb78ba75', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': 'No', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'SMdb47811fe0b69de88b4fc924cb78ba75', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-11-10 21:33:20,082", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-10 21:33:20,083", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-10 21:33:20,083", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 539.7s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-10 21:33:20,085", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-10 21:33:20,086", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 539.7s ago] {'last_active_at': datetime.datetime(2025, 11, 10, 19, 33, 20, 85089), 'users_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-10 21:33:20,087", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-10 21:33:20,089", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-10 21:33:20,089", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-10 21:33:20,089", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 539.7s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-10 21:33:20,090", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-10 21:33:20,091", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 539.7s ago] {'id': UUID('7ad80126-5d87-41b7-b244-98c6d55dea37'), 'user_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'phone_number': '+27763514028', 'message_id': 'SMdb47811fe0b69de88b4fc924cb78ba75', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'No', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-10 21:33:20,091", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-10 21:33:21,033", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-10 21:33:21,033", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SM87d8d3e849c438f0a048c963be043d51"}
{"asctime": "2025-11-10 21:33:30,032", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'SmsMessageSid': 'SM013e712773618d9b352da79226643592', 'NumMedia': '0', 'ProfileName': 'Hello World!', 'MessageType': 'text', 'SmsSid': 'SM013e712773618d9b352da79226643592', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': 'Do you understand Zulu ?', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'SM013e712773618d9b352da79226643592', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-11-10 21:33:30,033", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-10 21:33:30,034", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-10 21:33:30,034", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 549.6s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-10 21:33:30,036", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-10 21:33:30,037", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 549.6s ago] {'last_active_at': datetime.datetime(2025, 11, 10, 19, 33, 30, 36494), 'users_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-10 21:33:30,039", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-10 21:33:30,040", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-10 21:33:30,040", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-10 21:33:30,040", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 549.6s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-10 21:33:30,041", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-10 21:33:30,041", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 549.6s ago] {'id': UUID('2caf1170-6011-46d5-9cce-2b299ca54ccb'), 'user_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'phone_number': '+27763514028', 'message_id': 'SM013e712773618d9b352da79226643592', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'Do you understand Zulu ?', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-10 21:33:30,042", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-10 21:33:30,043", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-10 21:33:30,043", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-10 21:33:30,043", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 549.6s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-10 21:33:30,044", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(id_1)s::UUID \n LIMIT %(param_1)s"}
{"asctime": "2025-11-10 21:33:30,044", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 549.6s ago] {'id_1': 'd55d888e-4ff5-49b4-9d97-795cff228fac', 'param_1': 1}"}
{"asctime": "2025-11-10 21:33:30,045", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.phone_number = %(phone_number_1)s ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-10 21:33:30,046", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 549.6s ago] {'phone_number_1': '+27763514028', 'param_1': 5}"}
{"asctime": "2025-11-10 21:33:31,751", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-10 21:33:31,755", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.phone_number = %(phone_number_1)s ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-10 21:33:31,755", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 551.3s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-10 21:33:31,756", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-10 21:33:31,756", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 549.6s ago] {'ai_response': 'Yes, I understand Zulu! If you want to chat in Zulu, feel free. How can I assist you today?', 'intent_detected': 'conversation', 'confidence_score': 0.8, 'is_processed': True, 'conversations_id': UUID('2caf1170-6011-46d5-9cce-2b299ca54ccb')}"}
{"asctime": "2025-11-10 21:33:31,757", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-10 21:33:32,294", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-10 21:33:32,296", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SMa7ec530e5d26e3be17d68a1f0d4c3ac3"}
{"asctime": "2025-11-10 21:34:02,456", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'SmsMessageSid': 'SM3ff8c24150356db02b71ac0a239e2dc7', 'NumMedia': '0', 'ProfileName': 'Hello World!', 'MessageType': 'text', 'SmsSid': 'SM3ff8c24150356db02b71ac0a239e2dc7', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': 'Ngicela uthumele u-500 kuMbali.', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'SM3ff8c24150356db02b71ac0a239e2dc7', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-11-10 21:34:02,459", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-10 21:34:02,459", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-10 21:34:02,460", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 582s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-10 21:34:02,461", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-10 21:34:02,462", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 582s ago] {'last_active_at': datetime.datetime(2025, 11, 10, 19, 34, 2, 461405), 'users_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-10 21:34:02,462", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-10 21:34:02,464", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-10 21:34:02,464", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-10 21:34:02,465", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 582s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-10 21:34:02,466", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-10 21:34:02,467", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 582s ago] {'id': UUID('78b62657-fa57-48b6-befb-3a44488b8f30'), 'user_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'phone_number': '+27763514028', 'message_id': 'SM3ff8c24150356db02b71ac0a239e2dc7', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'Ngicela uthumele u-500 kuMbali.', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-10 21:34:02,469", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-10 21:34:02,470", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-10 21:34:02,471", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-10 21:34:02,471", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 582s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-10 21:34:02,473", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(id_1)s::UUID \n LIMIT %(param_1)s"}
{"asctime": "2025-11-10 21:34:02,473", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 582s ago] {'id_1': 'd55d888e-4ff5-49b4-9d97-795cff228fac', 'param_1': 1}"}
{"asctime": "2025-11-10 21:34:02,474", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.phone_number = %(phone_number_1)s ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-10 21:34:02,474", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 582s ago] {'phone_number_1': '+27763514028', 'param_1': 5}"}
{"asctime": "2025-11-10 21:34:04,470", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-10 21:34:04,476", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.phone_number = %(phone_number_1)s ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-10 21:34:04,476", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 584s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-10 21:34:04,479", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-10 21:34:04,479", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 582.4s ago] {'ai_response': 'Ngiyavuma! Ngabe uqinisekile ukuthi ufuna ukuthumela u-R500 kuMbali? Ngabe unayo inombolo yakhe yocingo noma i-akhawunti? Futhi, ungakuthanda ukufaka i-PIN yakho ukuze ngiqhubele phambili?', 'intent_detected': 'conversation', 'confidence_score': 0.8, 'is_processed': True, 'conversations_id': UUID('78b62657-fa57-48b6-befb-3a44488b8f30')}"}
{"asctime": "2025-11-10 21:34:04,481", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-10 21:34:04,966", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-10 21:34:04,968", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SM9bfbd4ae892b80b7d587e7ae251758ab"}
{"asctime": "2025-11-10 21:34:34,901", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'SmsMessageSid': 'SMd0a372bca3cf1c225df1365a38c0ee69', 'NumMedia': '0', 'ProfileName': 'Hello World!', 'MessageType': 'text', 'SmsSid': 'SMd0a372bca3cf1c225df1365a38c0ee69', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': 'No', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'SMd0a372bca3cf1c225df1365a38c0ee69', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-11-10 21:34:34,904", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-10 21:34:34,905", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-10 21:34:34,905", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 614.4s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-10 21:34:34,907", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-10 21:34:34,907", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 614.4s ago] {'last_active_at': datetime.datetime(2025, 11, 10, 19, 34, 34, 906734), 'users_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-10 21:34:34,908", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-10 21:34:34,910", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-10 21:34:34,910", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-10 21:34:34,910", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 614.4s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-10 21:34:34,912", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-10 21:34:34,912", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 614.4s ago] {'id': UUID('0a9929f3-10e7-4e8f-837d-ea1b4c519215'), 'user_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'phone_number': '+27763514028', 'message_id': 'SMd0a372bca3cf1c225df1365a38c0ee69', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'No', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-10 21:34:34,915", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-10 21:34:34,916", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-10 21:34:34,917", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-10 21:34:34,917", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 614.4s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-10 21:34:34,918", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(id_1)s::UUID \n LIMIT %(param_1)s"}
{"asctime": "2025-11-10 21:34:34,918", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 614.4s ago] {'id_1': 'd55d888e-4ff5-49b4-9d97-795cff228fac', 'param_1': 1}"}
{"asctime": "2025-11-10 21:34:34,919", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.phone_number = %(phone_number_1)s ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-10 21:34:34,920", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 614.4s ago] {'phone_number_1': '+27763514028', 'param_1': 5}"}
{"asctime": "2025-11-10 21:34:36,190", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-10 21:34:36,197", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.phone_number = %(phone_number_1)s ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-10 21:34:36,197", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 615.6s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-10 21:34:36,200", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-10 21:34:36,200", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 614s ago] {'ai_response': 'Got it! If you change your mind or need help with something else, just let me know. What else can I assist you with?', 'intent_detected': 'conversation', 'confidence_score': 0.8, 'is_processed': True, 'conversations_id': UUID('0a9929f3-10e7-4e8f-837d-ea1b4c519215')}"}
{"asctime": "2025-11-10 21:34:36,201", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-10 21:34:36,684", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-10 21:34:36,686", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SMff07c66cccaa39b1b9521eddbdf03f48"}
{"asctime": "2025-11-10 21:34:47,890", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'OriginalRepliedMessageSender': 'whatsapp:+14155238886', 'SmsMessageSid': 'SM7ba14da3703b5f79cbda03aacde9c360', 'FrequentlyForwarded': 'false', 'NumMedia': '0', 'ProfileName': 'Hello World!', 'MessageType': 'text', 'SmsSid': 'SM7ba14da3703b5f79cbda03aacde9c360', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': 'Yes', 'Forwarded': 'false', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'SM7ba14da3703b5f79cbda03aacde9c360', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'OriginalRepliedMessageSid': 'SM9bfbd4ae892b80b7d587e7ae251758ab', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"Forwarded\":\"false\",\"FrequentlyForwarded\":\"false\",\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-11-10 21:34:47,892", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-10 21:34:47,892", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-10 21:34:47,892", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 627.4s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-10 21:34:47,894", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-10 21:34:47,894", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 627.4s ago] {'last_active_at': datetime.datetime(2025, 11, 10, 19, 34, 47, 894255), 'users_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-10 21:34:47,896", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-10 21:34:47,906", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-10 21:34:47,907", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-10 21:34:47,908", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 627.4s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-10 21:34:47,909", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-10 21:34:47,909", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 627.4s ago] {'id': UUID('7bb6b149-405f-40a3-9e91-0e471b3db1c1'), 'user_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'phone_number': '+27763514028', 'message_id': 'SM7ba14da3703b5f79cbda03aacde9c360', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'Yes', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-10 21:34:47,910", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-10 21:34:47,911", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-10 21:34:47,912", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-10 21:34:47,912", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 627.4s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-10 21:34:47,913", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(id_1)s::UUID \n LIMIT %(param_1)s"}
{"asctime": "2025-11-10 21:34:47,913", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 627.4s ago] {'id_1': 'd55d888e-4ff5-49b4-9d97-795cff228fac', 'param_1': 1}"}
{"asctime": "2025-11-10 21:34:47,914", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.phone_number = %(phone_number_1)s ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-10 21:34:47,914", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 627.4s ago] {'phone_number_1': '+27763514028', 'param_1': 5}"}
{"asctime": "2025-11-10 21:34:49,739", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-10 21:34:49,746", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.phone_number = %(phone_number_1)s ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-10 21:34:49,746", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 629.2s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-10 21:34:49,749", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-10 21:34:49,749", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 627.5s ago] {'ai_response': \"Great! Just to confirm: you want to send R500 to Mbali. Could you please provide me with Mbali's phone number or account number? And once I have that, I'll need your PIN to proceed.\", 'intent_detected': 'conversation', 'confidence_score': 0.8, 'is_processed': True, 'conversations_id': UUID('7bb6b149-405f-40a3-9e91-0e471b3db1c1')}"}
{"asctime": "2025-11-10 21:34:49,751", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-10 21:34:50,206", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-10 21:34:50,208", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SMe87e8a547306b5948100145ef5fe97f2"}
{"asctime": "2025-11-10 21:36:47,449", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'SmsMessageSid': 'SM31dda2544f06033e1e5aeb7bcdfd2258', 'NumMedia': '0', 'ProfileName': 'Hello World!', 'MessageType': 'text', 'SmsSid': 'SM31dda2544f06033e1e5aeb7bcdfd2258', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': 'Angikayitholi okwamanje', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'SM31dda2544f06033e1e5aeb7bcdfd2258', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-11-10 21:36:47,453", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-10 21:36:47,453", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-10 21:36:47,454", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 746.9s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-10 21:36:47,456", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-10 21:36:47,456", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 746.9s ago] {'last_active_at': datetime.datetime(2025, 11, 10, 19, 36, 47, 456170), 'users_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-10 21:36:47,457", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-10 21:36:47,459", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-10 21:36:47,459", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-10 21:36:47,460", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 746.9s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-10 21:36:47,461", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-10 21:36:47,462", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 746.9s ago] {'id': UUID('fad137d7-de13-444c-b4ec-82498e27ab60'), 'user_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'phone_number': '+27763514028', 'message_id': 'SM31dda2544f06033e1e5aeb7bcdfd2258', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'Angikayitholi okwamanje', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-10 21:36:47,462", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-10 21:36:47,463", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-10 21:36:47,464", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-10 21:36:47,464", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 746.9s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-10 21:36:47,465", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(id_1)s::UUID \n LIMIT %(param_1)s"}
{"asctime": "2025-11-10 21:36:47,466", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 746.9s ago] {'id_1': 'd55d888e-4ff5-49b4-9d97-795cff228fac', 'param_1': 1}"}
{"asctime": "2025-11-10 21:36:47,467", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.phone_number = %(phone_number_1)s ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-10 21:36:47,467", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 746.9s ago] {'phone_number_1': '+27763514028', 'param_1': 5}"}
{"asctime": "2025-11-10 21:36:49,559", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-10 21:36:49,566", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.phone_number = %(phone_number_1)s ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-10 21:36:49,567", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 749s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-10 21:36:49,569", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-10 21:36:49,570", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 747.4s ago] {'ai_response': 'Kulungile, akusho lutho! Uma udinga usizo nganoma yini, ngicela ungazise. Ngabe kukhona okunye engingakusiza ngakho?', 'intent_detected': 'conversation', 'confidence_score': 0.8, 'is_processed': True, 'conversations_id': UUID('fad137d7-de13-444c-b4ec-82498e27ab60')}"}
{"asctime": "2025-11-10 21:36:49,571", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-10 21:36:50,480", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-10 21:36:50,482", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SM2dc09ac76041d432fe3612a75b50b0d0"}
{"asctime": "2025-11-10 21:37:22,885", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'SmsMessageSid': 'SMbbd5857b4e4e06ff847a42f5bdb06415', 'NumMedia': '0', 'ProfileName': 'Hello World!', 'MessageType': 'text', 'SmsSid': 'SMbbd5857b4e4e06ff847a42f5bdb06415', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': 'Say that in English', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'SMbbd5857b4e4e06ff847a42f5bdb06415', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-11-10 21:37:22,888", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-10 21:37:22,889", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-10 21:37:22,889", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 782.4s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-10 21:37:22,891", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-10 21:37:22,891", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 782.4s ago] {'last_active_at': datetime.datetime(2025, 11, 10, 19, 37, 22, 891032), 'users_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-10 21:37:22,893", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-10 21:37:22,894", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-10 21:37:22,895", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-10 21:37:22,895", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 782.4s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-10 21:37:22,896", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-10 21:37:22,897", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 782.4s ago] {'id': UUID('b9fe0c00-718a-48e2-b52d-aed251ecc6b2'), 'user_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'phone_number': '+27763514028', 'message_id': 'SMbbd5857b4e4e06ff847a42f5bdb06415', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'Say that in English', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-10 21:37:22,898", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-10 21:37:22,899", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-10 21:37:22,899", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-10 21:37:22,899", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 782.4s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-10 21:37:22,901", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(id_1)s::UUID \n LIMIT %(param_1)s"}
{"asctime": "2025-11-10 21:37:22,901", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 782.4s ago] {'id_1': 'd55d888e-4ff5-49b4-9d97-795cff228fac', 'param_1': 1}"}
{"asctime": "2025-11-10 21:37:22,904", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.phone_number = %(phone_number_1)s ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-10 21:37:22,904", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 782.4s ago] {'phone_number_1': '+27763514028', 'param_1': 5}"}
{"asctime": "2025-11-10 21:37:24,820", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-10 21:37:24,829", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.phone_number = %(phone_number_1)s ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-10 21:37:24,830", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 784.3s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-10 21:37:24,832", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-10 21:37:24,832", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 782.6s ago] {'ai_response': 'No problem! I said, \"Alright, that\u2019s fine! If you need help with anything, just let me know. Is there anything else I can assist you with?\"', 'intent_detected': 'conversation', 'confidence_score': 0.8, 'is_processed': True, 'conversations_id': UUID('b9fe0c00-718a-48e2-b52d-aed251ecc6b2')}"}
{"asctime": "2025-11-10 21:37:24,833", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-10 21:37:25,459", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-10 21:37:25,460", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SM38e25ac8571222b6b183ab857ddb6d1d"}
{"asctime": "2025-11-10 22:37:36,424", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-11-10 22:37:37,401", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-11-10 22:37:37,401", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-11-10 22:37:37,497", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-11-10 22:37:37,497", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-10 22:37:37,498", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-11-10 22:37:37,498", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-10 22:37:37,498", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-11-10 22:37:37,498", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-10 22:37:37,499", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-10 22:37:37,500", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-10 22:37:37,500", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00013s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-10 22:37:37,502", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-10 22:37:37,502", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001731s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-10 22:37:37,502", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-10 22:37:37,503", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.00228s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-10 22:37:37,504", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-10 22:37:37,504", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00011s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-10 22:37:37,504", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-10 22:37:37,504", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0008178s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-10 22:37:37,505", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-10 22:37:37,505", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001325s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-10 22:37:37,505", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-10 22:37:37,505", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-11-10 22:37:37,505", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-11-10 22:37:37,505", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-11-10 22:38:21,585", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-11-10 22:42:57,462", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-11-10 22:42:57,462", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-11-10 22:42:57,482", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-11-10 22:42:57,482", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-10 22:42:57,483", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-11-10 22:42:57,483", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-10 22:42:57,484", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-11-10 22:42:57,484", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-10 22:42:57,484", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-10 22:42:57,486", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-10 22:42:57,486", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00010s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-10 22:42:57,487", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-10 22:42:57,487", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001695s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-10 22:42:57,488", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-10 22:42:57,488", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002112s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-10 22:42:57,489", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-10 22:42:57,489", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00008s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-10 22:42:57,490", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-10 22:42:57,490", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001049s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-10 22:42:57,490", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-10 22:42:57,490", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001472s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-10 22:42:57,490", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-10 22:42:57,490", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-11-10 22:42:57,490", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-11-10 22:42:57,491", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-11-10 22:49:21,063", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-11-10 22:49:21,634", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-11-10 22:49:21,634", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-11-10 22:49:21,650", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-11-10 22:49:21,650", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-10 22:49:21,651", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-11-10 22:49:21,651", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-10 22:49:21,651", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-11-10 22:49:21,652", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-10 22:49:21,652", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-10 22:49:21,653", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-10 22:49:21,653", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00010s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-10 22:49:21,655", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-10 22:49:21,655", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002334s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-10 22:49:21,656", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-10 22:49:21,656", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002772s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-10 22:49:21,657", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-10 22:49:21,657", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00009s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-10 22:49:21,657", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-10 22:49:21,657", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.000648s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-10 22:49:21,658", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-10 22:49:21,658", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001236s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-10 22:49:21,658", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-10 22:49:21,658", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-11-10 22:49:21,658", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-11-10 22:49:21,659", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-11-10 22:58:31,815", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-11-10 23:15:54,620", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-11-10 23:15:54,620", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-11-10 23:15:54,641", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-11-10 23:15:54,642", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-10 23:15:54,642", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-11-10 23:15:54,642", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-10 23:15:54,643", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-11-10 23:15:54,643", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-10 23:15:54,644", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-10 23:15:54,645", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-10 23:15:54,645", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00010s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-10 23:15:54,647", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-10 23:15:54,647", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002344s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-10 23:15:54,648", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-10 23:15:54,648", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.003124s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-10 23:15:54,649", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-10 23:15:54,649", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00007s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-10 23:15:54,650", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-10 23:15:54,650", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0005624s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-10 23:15:54,650", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-10 23:15:54,650", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001194s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-10 23:15:54,651", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-10 23:15:54,651", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-11-10 23:15:54,651", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-11-10 23:15:54,651", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-11-10 23:17:06,010", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'SmsMessageSid': 'SM1fa59ef37e0a15f815e1e6c663fec285', 'NumMedia': '0', 'ProfileName': 'Hello World!', 'MessageType': 'text', 'SmsSid': 'SM1fa59ef37e0a15f815e1e6c663fec285', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': 'Hi', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'SM1fa59ef37e0a15f815e1e6c663fec285', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-11-10 23:17:06,011", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763514028"}
{"asctime": "2025-11-10 23:17:06,019", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-10 23:17:06,022", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-10 23:17:06,022", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00030s] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-10 23:17:06,028", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-10 23:17:06,028", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00024s] {'last_active_at': datetime.datetime(2025, 11, 10, 21, 17, 6, 26794), 'users_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-10 23:17:06,029", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-10 23:17:06,031", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-10 23:17:06,032", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-10 23:17:06,032", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00016s] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-10 23:17:06,034", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-10 23:17:06,034", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00025s] {'id': UUID('9c1fa024-8297-4e81-af8b-b9896ec195a2'), 'user_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'phone_number': '+27763514028', 'message_id': 'SM1fa59ef37e0a15f815e1e6c663fec285', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'Hi', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-10 23:17:06,036", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-10 23:17:06,037", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-10 23:17:06,037", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-10 23:17:06,037", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0056s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-10 23:17:06,039", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-10 23:17:06,039", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00015s] {'user_id_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'param_1': 5}"}
{"asctime": "2025-11-10 23:17:08,103", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-10 23:17:08,113", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-10 23:17:08,113", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00100s] {'pk_1': UUID('9c1fa024-8297-4e81-af8b-b9896ec195a2')}"}
{"asctime": "2025-11-10 23:17:08,117", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-10 23:17:08,117", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00046s] {'ai_response': 'Hey there! How can I assist you today? \ud83d\ude0a', 'intent_detected': 'greeting', 'entities_extracted': '{}', 'confidence_score': 0.95, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 10, 21, 17, 8, 108952), 'conversations_id': UUID('9c1fa024-8297-4e81-af8b-b9896ec195a2')}"}
{"asctime": "2025-11-10 23:17:08,120", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-10 23:17:08,901", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-10 23:17:08,903", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SM393d7de4e1ce587d7fb6cac05a11e4ec"}
{"asctime": "2025-11-10 23:17:09,838", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-10 23:17:09,840", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SM3595894be515b226fe2f4f96257ad16d"}
{"asctime": "2025-11-10 23:17:34,967", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'SmsMessageSid': 'SM0b4bd8be85aab9d9a3f56e9cbfb7d0a5', 'NumMedia': '0', 'ProfileName': 'Hello World!', 'MessageType': 'text', 'SmsSid': 'SM0b4bd8be85aab9d9a3f56e9cbfb7d0a5', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': 'Wha can you do ?', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'SM0b4bd8be85aab9d9a3f56e9cbfb7d0a5', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-11-10 23:17:34,969", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763514028"}
{"asctime": "2025-11-10 23:17:34,971", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-10 23:17:34,971", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-10 23:17:34,972", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 28.95s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-10 23:17:34,974", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-10 23:17:34,975", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 28.95s ago] {'last_active_at': datetime.datetime(2025, 11, 10, 21, 17, 34, 973480), 'users_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-10 23:17:34,976", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-10 23:17:34,977", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-10 23:17:34,978", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-10 23:17:34,978", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 28.95s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-10 23:17:34,981", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-10 23:17:34,981", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 28.95s ago] {'id': UUID('bc8a7149-5b27-4f0a-8e83-38f21b81c68c'), 'user_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'phone_number': '+27763514028', 'message_id': 'SM0b4bd8be85aab9d9a3f56e9cbfb7d0a5', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'Wha can you do ?', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-10 23:17:34,983", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-10 23:17:34,984", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-10 23:17:34,985", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-10 23:17:34,985", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 28.95s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-10 23:17:34,986", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-10 23:17:34,987", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 28.95s ago] {'user_id_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'param_1': 5}"}
{"asctime": "2025-11-10 23:17:38,203", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-10 23:17:38,209", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-10 23:17:38,210", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 30.1s ago] {'pk_1': UUID('bc8a7149-5b27-4f0a-8e83-38f21b81c68c')}"}
{"asctime": "2025-11-10 23:17:38,214", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-10 23:17:38,214", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 30.1s ago] {'ai_response': 'I can help you with a few things:\\n\\n1. Buy airtime for MTN, Vodacom, Cell C, and Telkom.\\n2. Purchase data bundles for all networks.\\n3. Pay for pre ... (8 characters truncated) ... ctricity (Eskom and municipalities).\\n4. Check your wallet balance.\\n5. View your transaction history.\\n\\nJust let me know what you need help with! \ud83d\ude0a', 'intent_detected': 'conversation', 'entities_extracted': '{}', 'confidence_score': 0.7, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 10, 21, 17, 38, 208021), 'conversations_id': UUID('bc8a7149-5b27-4f0a-8e83-38f21b81c68c')}"}
{"asctime": "2025-11-10 23:17:38,216", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-10 23:17:39,251", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-10 23:17:39,252", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SM53c0d7d9ca6ce0fd843ce86fdfaa39ae"}
{"asctime": "2025-11-10 23:17:51,431", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'SmsMessageSid': 'SMc9f2b7798ae7e2759516ffbc3fa146ad', 'NumMedia': '0', 'ProfileName': 'Hello World!', 'MessageType': 'text', 'SmsSid': 'SMc9f2b7798ae7e2759516ffbc3fa146ad', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': 'What\u2019s my balance', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'SMc9f2b7798ae7e2759516ffbc3fa146ad', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-11-10 23:17:51,432", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763514028"}
{"asctime": "2025-11-10 23:17:51,434", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-10 23:17:51,434", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-10 23:17:51,435", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 45.41s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-10 23:17:51,436", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-10 23:17:51,437", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 45.41s ago] {'last_active_at': datetime.datetime(2025, 11, 10, 21, 17, 51, 436373), 'users_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-10 23:17:51,438", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-10 23:17:51,439", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-10 23:17:51,440", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-10 23:17:51,440", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 45.41s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-10 23:17:51,442", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-10 23:17:51,442", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 45.41s ago] {'id': UUID('6291dbfd-7342-4b6c-b252-a39c50f836c4'), 'user_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'phone_number': '+27763514028', 'message_id': 'SMc9f2b7798ae7e2759516ffbc3fa146ad', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'What\u2019s my balance', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-10 23:17:51,443", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-10 23:17:51,449", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-10 23:17:51,449", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-10 23:17:51,450", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 45.42s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-10 23:17:51,451", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-10 23:17:51,451", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 45.41s ago] {'user_id_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'param_1': 5}"}
{"asctime": "2025-11-10 23:17:53,134", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-10 23:17:53,140", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-10 23:17:53,140", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 45.03s ago] {'pk_1': UUID('6291dbfd-7342-4b6c-b252-a39c50f836c4')}"}
{"asctime": "2025-11-10 23:17:53,142", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-10 23:17:53,142", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 45.02s ago] {'ai_response': 'Your wallet balance is currently R0.00. If you need to top it up or do anything else, just let me know!', 'intent_detected': 'check_balance', 'entities_extracted': '{}', 'confidence_score': 0.95, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 10, 21, 17, 53, 138717), 'conversations_id': UUID('6291dbfd-7342-4b6c-b252-a39c50f836c4')}"}
{"asctime": "2025-11-10 23:17:53,143", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-10 23:17:54,113", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-10 23:17:54,114", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SM106f50d8eb9d9301e0169fc93e0ea051"}
{"asctime": "2025-11-10 23:18:04,176", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'SmsMessageSid': 'SM74c8e4ba9f2efdf3da518aedffe8fcdb', 'NumMedia': '0', 'ProfileName': 'Hello World!', 'MessageType': 'text', 'SmsSid': 'SM74c8e4ba9f2efdf3da518aedffe8fcdb', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': 'I want to top it up', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'SM74c8e4ba9f2efdf3da518aedffe8fcdb', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-11-10 23:18:04,177", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763514028"}
{"asctime": "2025-11-10 23:18:04,179", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-10 23:18:04,179", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-10 23:18:04,180", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 58.16s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-10 23:18:04,181", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-10 23:18:04,182", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 58.15s ago] {'last_active_at': datetime.datetime(2025, 11, 10, 21, 18, 4, 181484), 'users_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-10 23:18:04,183", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-10 23:18:04,185", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-10 23:18:04,185", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-10 23:18:04,185", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 58.15s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-10 23:18:04,187", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-10 23:18:04,187", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 58.15s ago] {'id': UUID('d217bba0-ebc2-4beb-b39e-da8b12fe50c5'), 'user_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'phone_number': '+27763514028', 'message_id': 'SM74c8e4ba9f2efdf3da518aedffe8fcdb', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'I want to top it up', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-10 23:18:04,188", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-10 23:18:04,192", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-10 23:18:04,193", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-10 23:18:04,193", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 58.16s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-10 23:18:04,195", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-10 23:18:04,195", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 58.15s ago] {'user_id_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'param_1': 5}"}
{"asctime": "2025-11-10 23:18:05,816", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-10 23:18:05,829", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-10 23:18:05,830", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 57.72s ago] {'pk_1': UUID('d217bba0-ebc2-4beb-b39e-da8b12fe50c5')}"}
{"asctime": "2025-11-10 23:18:05,831", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-10 23:18:05,831", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 57.71s ago] {'ai_response': \"I currently can't assist with topping up your wallet balance, but you can buy airtime or data bundles if you'd like! Just let me know what you need and the amount, and I'll help you with that! \ud83d\ude0a\", 'intent_detected': 'conversation', 'entities_extracted': '{}', 'confidence_score': 0.7, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 10, 21, 18, 5, 828682), 'conversations_id': UUID('d217bba0-ebc2-4beb-b39e-da8b12fe50c5')}"}
{"asctime": "2025-11-10 23:18:05,832", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-10 23:18:06,317", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-10 23:18:06,318", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SMaec3605d22a3dd9d762ca20a8c0790a7"}
{"asctime": "2025-11-10 23:19:03,957", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'MediaContentType0': 'image/jpeg', 'SmsMessageSid': 'MM6dbc94b37efb20d4103dd8d7f8ef3fe1', 'NumMedia': '1', 'ProfileName': 'Hello World!', 'MessageType': 'image', 'SmsSid': 'MM6dbc94b37efb20d4103dd8d7f8ef3fe1', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': 'Send 200 airtime to thabo', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'MM6dbc94b37efb20d4103dd8d7f8ef3fe1', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'MediaUrl0': 'https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages/MM6dbc94b37efb20d4103dd8d7f8ef3fe1/Media/MEb8015b2ec0f0f395f917bfe744f9242d', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-11-10 23:19:03,959", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763514028"}
{"asctime": "2025-11-10 23:19:03,962", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-10 23:19:03,963", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-10 23:19:03,963", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 117.9s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-10 23:19:03,966", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-10 23:19:03,967", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 117.9s ago] {'last_active_at': datetime.datetime(2025, 11, 10, 21, 19, 3, 965580), 'users_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-10 23:19:03,971", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-10 23:19:03,973", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-10 23:19:03,973", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-10 23:19:03,973", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 117.9s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-10 23:19:03,975", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-10 23:19:03,975", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 117.9s ago] {'id': UUID('170edc29-0c9c-496a-8e1c-2b4ab4fb232d'), 'user_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'phone_number': '+27763514028', 'message_id': 'MM6dbc94b37efb20d4103dd8d7f8ef3fe1', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'Send 200 airtime to thabo', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-10 23:19:03,976", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-10 23:19:03,977", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-10 23:19:03,978", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-10 23:19:03,978", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 117.9s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-10 23:19:03,979", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-10 23:19:03,979", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 117.9s ago] {'user_id_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'param_1': 5}"}
{"asctime": "2025-11-10 23:19:07,067", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-10 23:19:07,073", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-10 23:19:07,074", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 119s ago] {'pk_1': UUID('170edc29-0c9c-496a-8e1c-2b4ab4fb232d')}"}
{"asctime": "2025-11-10 23:19:07,075", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-10 23:19:07,076", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 119s ago] {'ai_response': 'Unfortunately, the maximum airtime amount I can help you purchase is R1000, but your current wallet balance is R0.00. You\u2019ll need to add funds to your wallet first to proceed with the airtime purchase.\\n\\nIf you want to buy airtime or data bundles, please let me know the amount and details! \ud83d\udc4d', 'intent_detected': 'buy_airtime', 'entities_extracted': '{\"amount\": 200.0, \"phone\": null, \"network\": null}', 'confidence_score': 0.9, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 10, 21, 19, 7, 72230), 'conversations_id': UUID('170edc29-0c9c-496a-8e1c-2b4ab4fb232d')}"}
{"asctime": "2025-11-10 23:19:07,077", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-10 23:19:08,081", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-10 23:19:08,082", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SM054da14377972f6782eab3b36ab16088"}
{"asctime": "2025-11-10 23:20:15,786", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'MediaContentType0': 'image/jpeg', 'SmsMessageSid': 'MMf582696f3b8c173142b88bf31d00ee6d', 'NumMedia': '1', 'ProfileName': 'Hello World!', 'MessageType': 'image', 'SmsSid': 'MMf582696f3b8c173142b88bf31d00ee6d', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': 'Buy 10r electric to the meter number in the pic', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'MMf582696f3b8c173142b88bf31d00ee6d', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'MediaUrl0': 'https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages/MMf582696f3b8c173142b88bf31d00ee6d/Media/ME7ad8e315c15cda0b8fc4966749b22455', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-11-10 23:20:15,789", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763514028"}
{"asctime": "2025-11-10 23:20:15,790", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-10 23:20:15,791", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-10 23:20:15,791", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 189.8s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-10 23:20:15,793", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-10 23:20:15,794", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 189.8s ago] {'last_active_at': datetime.datetime(2025, 11, 10, 21, 20, 15, 793459), 'users_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-10 23:20:15,794", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-10 23:20:15,801", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-10 23:20:15,803", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-10 23:20:15,804", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 189.8s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-10 23:20:15,806", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-10 23:20:15,806", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 189.8s ago] {'id': UUID('77af47b1-36aa-4051-801c-200f51863286'), 'user_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'phone_number': '+27763514028', 'message_id': 'MMf582696f3b8c173142b88bf31d00ee6d', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'Buy 10r electric to the meter number in the pic', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-10 23:20:15,807", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-10 23:20:15,809", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-10 23:20:15,809", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-10 23:20:15,809", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 189.8s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-10 23:20:15,810", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-10 23:20:15,810", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 189.8s ago] {'user_id_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'param_1': 5}"}
{"asctime": "2025-11-10 23:20:17,228", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-10 23:20:17,237", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-10 23:20:17,238", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 189.1s ago] {'pk_1': UUID('77af47b1-36aa-4051-801c-200f51863286')}"}
{"asctime": "2025-11-10 23:20:17,240", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-10 23:20:17,240", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 189.1s ago] {'ai_response': \"It looks like I can't view pictures, but I can help you buy electricity if you provide me with the 20-digit meter number. \\n\\nJust remember, you'll need to top up your wallet first, as your current balance is R0.00. Let me know how you'd like to proceed!\", 'intent_detected': 'buy_data', 'entities_extracted': '{\"amount\": null, \"phone\": null, \"network\": null}', 'confidence_score': 0.9, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 10, 21, 20, 17, 235705), 'conversations_id': UUID('77af47b1-36aa-4051-801c-200f51863286')}"}
{"asctime": "2025-11-10 23:20:17,241", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-10 23:20:18,173", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-10 23:20:18,175", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SM725689d988e99fb81f97c31c9b194008"}
{"asctime": "2025-11-10 23:20:50,335", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'MediaContentType0': 'audio/ogg', 'SmsMessageSid': 'MM4c2d143381722efd13c06c5f43ef787f', 'NumMedia': '1', 'ProfileName': 'Hello World!', 'MessageType': 'audio', 'SmsSid': 'MM4c2d143381722efd13c06c5f43ef787f', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': '', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'MM4c2d143381722efd13c06c5f43ef787f', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'MediaUrl0': 'https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages/MM4c2d143381722efd13c06c5f43ef787f/Media/ME59fb55fb0fa5f369f1d76d2b33875b78', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-11-10 23:20:50,336", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763514028"}
{"asctime": "2025-11-10 23:20:50,338", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-10 23:20:50,339", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-10 23:20:50,339", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 224.3s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-10 23:20:50,343", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-10 23:20:50,343", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 224.3s ago] {'last_active_at': datetime.datetime(2025, 11, 10, 21, 20, 50, 342225), 'users_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-10 23:20:50,344", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-10 23:20:50,346", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-10 23:20:50,347", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-10 23:20:50,347", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 224.3s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-10 23:20:50,351", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-10 23:20:50,351", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 224.3s ago] {'id': UUID('ad6d78f6-2b98-4076-ae91-c70041e90231'), 'user_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'phone_number': '+27763514028', 'message_id': 'MM4c2d143381722efd13c06c5f43ef787f', 'message_type': 'text', 'direction': 'inbound', 'message_text': '', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-10 23:20:50,353", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-10 23:20:50,354", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-10 23:20:50,354", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-10 23:20:50,354", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 224.3s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-10 23:20:50,356", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-10 23:20:50,356", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 224.3s ago] {'user_id_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'param_1': 5}"}
{"asctime": "2025-11-10 23:20:52,538", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-10 23:20:52,544", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-10 23:20:52,545", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 224.4s ago] {'pk_1': UUID('ad6d78f6-2b98-4076-ae91-c70041e90231')}"}
{"asctime": "2025-11-10 23:20:52,548", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-10 23:20:52,548", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 224.4s ago] {'ai_response': \"It seems like there was no response. If you need help with anything, like buying airtime, data, or paying for electricity, just let me know! I'm here to assist you! \ud83d\ude0a\", 'intent_detected': 'conversation', 'entities_extracted': '{}', 'confidence_score': 0.7, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 10, 21, 20, 52, 542922), 'conversations_id': UUID('ad6d78f6-2b98-4076-ae91-c70041e90231')}"}
{"asctime": "2025-11-10 23:20:52,550", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-10 23:20:53,228", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-10 23:20:53,230", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SMd4ab7b9a7a0804373ba7b2e53d07c286"}
{"asctime": "2025-11-10 23:31:17,206", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-11-10 23:31:17,760", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-11-10 23:31:17,760", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-11-10 23:31:17,846", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-11-10 23:31:17,847", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-10 23:31:17,847", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-11-10 23:31:17,847", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-10 23:31:17,848", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-11-10 23:31:17,848", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-10 23:31:17,849", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-10 23:31:17,850", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-10 23:31:17,850", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00012s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-10 23:31:17,852", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-10 23:31:17,852", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002077s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-10 23:31:17,853", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-10 23:31:17,853", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0025s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-10 23:31:17,854", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-10 23:31:17,854", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00009s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-10 23:31:17,854", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-10 23:31:17,854", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0009427s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-10 23:31:17,855", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-10 23:31:17,855", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001429s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-10 23:31:17,855", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-10 23:31:17,855", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-11-10 23:31:17,855", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-11-10 23:31:17,855", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-11-10 23:33:13,557", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'SmsMessageSid': 'SM3a393528a777afa89ab15b133a7e793d', 'NumMedia': '0', 'ProfileName': 'Hello World!', 'MessageType': 'text', 'SmsSid': 'SM3a393528a777afa89ab15b133a7e793d', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': 'Hi', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'SM3a393528a777afa89ab15b133a7e793d', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-11-10 23:33:13,558", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763514028"}
{"asctime": "2025-11-10 23:33:13,566", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-10 23:33:13,569", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-10 23:33:13,569", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00022s] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-10 23:33:13,575", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-10 23:33:13,575", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00015s] {'last_active_at': datetime.datetime(2025, 11, 10, 21, 33, 13, 573926), 'users_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-10 23:33:13,576", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-10 23:33:13,578", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-10 23:33:13,579", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-10 23:33:13,579", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00015s] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-10 23:33:13,582", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-10 23:33:13,582", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00026s] {'id': UUID('ec570347-bf93-41a3-97a7-083d93dd1335'), 'user_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'phone_number': '+27763514028', 'message_id': 'SM3a393528a777afa89ab15b133a7e793d', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'Hi', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-10 23:33:13,584", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-10 23:33:13,585", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-10 23:33:13,585", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-10 23:33:13,585", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.006102s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-10 23:33:13,587", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-10 23:33:13,587", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00013s] {'user_id_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'param_1': 5}"}
{"asctime": "2025-11-10 23:33:15,136", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-10 23:33:15,143", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-10 23:33:15,144", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00118s] {'pk_1': UUID('ec570347-bf93-41a3-97a7-083d93dd1335')}"}
{"asctime": "2025-11-10 23:33:15,146", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-10 23:33:15,147", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00043s] {'ai_response': 'Hey there! \ud83d\udc4b How can I help you today? Do you need airtime, data, or assistance with your electricity bill? Just let me know!', 'intent_detected': 'greeting', 'entities_extracted': '{}', 'confidence_score': 0.95, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 10, 21, 33, 15, 141115), 'conversations_id': UUID('ec570347-bf93-41a3-97a7-083d93dd1335')}"}
{"asctime": "2025-11-10 23:33:15,148", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-10 23:33:16,311", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-10 23:33:16,313", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SMbd29ae1e33764c3937ca2af1a60cc8b5"}
{"asctime": "2025-11-10 23:33:17,324", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-10 23:33:17,326", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SMc57455adf385b070361ee1aaf4a5aec9"}
{"asctime": "2025-11-10 23:33:54,448", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'MediaContentType0': 'image/jpeg', 'SmsMessageSid': 'MM37a732dc9bf9f30bf5e445d2b432ee09', 'NumMedia': '1', 'ProfileName': 'Hello World!', 'MessageType': 'image', 'SmsSid': 'MM37a732dc9bf9f30bf5e445d2b432ee09', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': 'Buy airtime for thabo', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'MM37a732dc9bf9f30bf5e445d2b432ee09', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'MediaUrl0': 'https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages/MM37a732dc9bf9f30bf5e445d2b432ee09/Media/ME15a245f11ef9468f7dc00a602883d637', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-11-10 23:33:54,450", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Parsed image message with media: https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages/MM37a732dc9bf9f30bf5e445d2b432ee09/Media/ME15a245f11ef9468f7dc00a602883d637"}
{"asctime": "2025-11-10 23:33:54,450", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing image message from +27763514028"}
{"asctime": "2025-11-10 23:33:54,451", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-10 23:33:54,452", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-10 23:33:54,452", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 40.88s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-10 23:33:54,454", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-10 23:33:54,454", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 40.88s ago] {'last_active_at': datetime.datetime(2025, 11, 10, 21, 33, 54, 453985), 'users_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-10 23:33:54,455", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-10 23:33:54,913", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: GET https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages/MM37a732dc9bf9f30bf5e445d2b432ee09/Media/ME15a245f11ef9468f7dc00a602883d637 \"HTTP/1.1 307 Temporary Redirect\""}
{"asctime": "2025-11-10 23:33:54,915", "name": "app.routers.whatsapp", "levelname": "ERROR", "message": "Media download error: Redirect response '307 Temporary Redirect' for url 'https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages/MM37a732dc9bf9f30bf5e445d2b432ee09/Media/ME15a245f11ef9468f7dc00a602883d637'\nRedirect location: 'https://mms.twiliocdn.com/AC6a10482bfc51f0846f64980cb7f1676e/6d73a58176052d2939b29e0c0dd4be5f?Expires=1762824834&Signature=PF0n5ves0Qsjq3wofkTcTLroDBf1Zcvzimp2Gu0~lsr-to4oR2DsguQ~ots4OUuHVjctZ~uqWg1OOBJEyVEHlwhobrkWT6WrtE~3yjh~ZteEPmXzADBPraycuZC-CulcTK~xtm8N4qJuiwkEuSnnxeB9HG3szQXJ7KHp2rCF66OGpo6mJMVJ6xpjBiXYjOxR2FDl9LyDiVHcB12BL-CEZ6Af3G5T0QHqW98ZnlU~~3XMnmpbeUGnxPdtZEz-X2iYaQ-VLDV2x54AFP9PTMEhTbDhu~Jw2IZt26oyMyJLVZVLKuCPLmCgDChAfzikDdobKiTw8LTvK6NkdjGzRai~eA__&Key-Pair-Id=APKAIRUDFXVKPONS3KUA'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/307"}
{"asctime": "2025-11-10 23:33:55,362", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-10 23:33:55,363", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SMbff21829c83623f193de998350a334b5"}
{"asctime": "2025-11-10 23:34:31,846", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'MediaContentType0': 'image/jpeg', 'SmsMessageSid': 'MM0404b445b997fd265b353e5a99890cfd', 'NumMedia': '1', 'ProfileName': 'Hello World!', 'MessageType': 'image', 'SmsSid': 'MM0404b445b997fd265b353e5a99890cfd', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': 'Buy airtime for this number', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'MM0404b445b997fd265b353e5a99890cfd', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'MediaUrl0': 'https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages/MM0404b445b997fd265b353e5a99890cfd/Media/ME05628198204798ac4e281b1a4e58db92', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-11-10 23:34:31,847", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Parsed image message with media: https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages/MM0404b445b997fd265b353e5a99890cfd/Media/ME05628198204798ac4e281b1a4e58db92"}
{"asctime": "2025-11-10 23:34:31,847", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing image message from +27763514028"}
{"asctime": "2025-11-10 23:34:31,849", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-10 23:34:31,849", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-10 23:34:31,849", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 78.28s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-10 23:34:31,851", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-10 23:34:31,851", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 78.28s ago] {'last_active_at': datetime.datetime(2025, 11, 10, 21, 34, 31, 850980), 'users_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-10 23:34:31,852", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-10 23:34:32,305", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: GET https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages/MM0404b445b997fd265b353e5a99890cfd/Media/ME05628198204798ac4e281b1a4e58db92 \"HTTP/1.1 307 Temporary Redirect\""}
{"asctime": "2025-11-10 23:34:32,308", "name": "app.routers.whatsapp", "levelname": "ERROR", "message": "Media download error: Redirect response '307 Temporary Redirect' for url 'https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages/MM0404b445b997fd265b353e5a99890cfd/Media/ME05628198204798ac4e281b1a4e58db92'\nRedirect location: 'https://mms.twiliocdn.com/AC6a10482bfc51f0846f64980cb7f1676e/21d9730532f51b588d288a2b9aec4aa8?Expires=1762824872&Signature=abj8T9-Nu3kDRwjD9vCWLa6WcAncc0dVjx1NUvugOM-5jrEAKSzl8sw0co9~3d3c3XLBEb8rC23GGo4Vco6cn6qOlyZ6qhhzB3Hw~ea-Zv-7MAebmMkNMmTQP5RNTkNXX9fQV0Ur66jUu2-vhXczIGYU5lt3Z2nkIL1AcLGeo2U4ucI-wJ9-InlqKDGfJ9WhbocazeRBDFRpAkj8dm47p7MZ3zyueOTou3rplr-1NMELDoiDUK7Kg5UlNuMMZYtJc6yS4hu6f2rJKG~eH~0Txw2leptPhCo9jU2tlJLyXnkV1A1A7ttkm0sLynCXNcfPKWFptsuDlegwLKn-FPFfGg__&Key-Pair-Id=APKAIRUDFXVKPONS3KUA'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/307"}
{"asctime": "2025-11-10 23:34:32,821", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-10 23:34:32,822", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SM0e554c3039c474b82ad99226474e24ac"}
{"asctime": "2025-11-10 23:34:45,064", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'MediaContentType0': 'audio/ogg', 'SmsMessageSid': 'MM1e200d0bb6a39711ee913c0073024b36', 'NumMedia': '1', 'ProfileName': 'Hello World!', 'MessageType': 'audio', 'SmsSid': 'MM1e200d0bb6a39711ee913c0073024b36', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': '', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'MM1e200d0bb6a39711ee913c0073024b36', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'MediaUrl0': 'https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages/MM1e200d0bb6a39711ee913c0073024b36/Media/ME522ad923e8ec4736e01520cf39b8864b', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-11-10 23:34:45,064", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Parsed audio message with media: https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages/MM1e200d0bb6a39711ee913c0073024b36/Media/ME522ad923e8ec4736e01520cf39b8864b"}
{"asctime": "2025-11-10 23:34:45,064", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing audio message from +27763514028"}
{"asctime": "2025-11-10 23:34:45,066", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-10 23:34:45,066", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-10 23:34:45,066", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 91.5s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-10 23:34:45,068", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-10 23:34:45,068", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 91.49s ago] {'last_active_at': datetime.datetime(2025, 11, 10, 21, 34, 45, 67961), 'users_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-10 23:34:45,069", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-10 23:34:45,480", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: GET https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages/MM1e200d0bb6a39711ee913c0073024b36/Media/ME522ad923e8ec4736e01520cf39b8864b \"HTTP/1.1 307 Temporary Redirect\""}
{"asctime": "2025-11-10 23:34:45,482", "name": "app.routers.whatsapp", "levelname": "ERROR", "message": "Media download error: Redirect response '307 Temporary Redirect' for url 'https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages/MM1e200d0bb6a39711ee913c0073024b36/Media/ME522ad923e8ec4736e01520cf39b8864b'\nRedirect location: 'https://mms.twiliocdn.com/AC6a10482bfc51f0846f64980cb7f1676e/5b07f00a6435b62c003713f72bef0ca2?Expires=1762824885&Signature=N6Aup8nOOZsG2e5L4P08--cjBMsPqlNRYmZuCCyDbSUt4cOGH3vpBz~8uSb3VzIY3x2vMDG9KdrL3II4mc7ICxIO7fK5~R4~3oLB3YnZvVlnlz2vWMH2On9-uD~JGrByCSo~d-~0~1G49yGcPCAapGT1NtFuzy9r3C5SYIKpRTHbaaIihSkbhozM9Ht-cc9H7W1moadhMTs-9Fe1wXIHx14IfLPLxpoluC9YUbQGnewTlIAd-5t80~Rcnc7dmqP3VrAL4NDuaHkANBO5QwAOiPLK6MXG6GpDq11d0dhxXQjHBPpThCnQzQLj3RAOB2tXHA2zYC0VV3DCkiiZxEHNrQ__&Key-Pair-Id=APKAIRUDFXVKPONS3KUA'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/307"}
{"asctime": "2025-11-10 23:34:45,911", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-10 23:34:45,913", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SMe1df60b59a32efd75ffd5ebdddc85aa5"}
{"asctime": "2025-11-11 08:30:19,887", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'SmsMessageSid': 'SMeb4ed47064657cdda228b884d7fe94ad', 'NumMedia': '0', 'ProfileName': 'Hello World!', 'MessageType': 'text', 'SmsSid': 'SMeb4ed47064657cdda228b884d7fe94ad', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': 'Hi', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'SMeb4ed47064657cdda228b884d7fe94ad', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-11-11 08:30:19,890", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763514028"}
{"asctime": "2025-11-11 08:30:19,896", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 08:30:19,897", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-11 08:30:19,898", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 3415s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-11 08:30:19,902", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-11 08:30:19,902", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 3415s ago] {'last_active_at': datetime.datetime(2025, 11, 11, 6, 30, 19, 901332), 'users_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-11 08:30:19,904", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-11 08:30:19,906", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 08:30:19,906", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-11 08:30:19,906", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 3415s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-11 08:30:19,908", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-11 08:30:19,908", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 3415s ago] {'id': UUID('3b2ed7fb-86a8-44fb-8848-5b4e4d164966'), 'user_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'phone_number': '+27763514028', 'message_id': 'SMeb4ed47064657cdda228b884d7fe94ad', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'Hi', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-11 08:30:19,910", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-11 08:30:19,911", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 08:30:19,911", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-11 08:30:19,912", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 3415s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-11 08:30:19,913", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-11 08:30:19,914", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 3415s ago] {'user_id_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'param_1': 5}"}
{"asctime": "2025-11-11 08:30:21,740", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-11 08:30:21,749", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-11 08:30:21,750", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 3415s ago] {'pk_1': UUID('3b2ed7fb-86a8-44fb-8848-5b4e4d164966')}"}
{"asctime": "2025-11-11 08:30:21,751", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-11 08:30:21,751", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 3415s ago] {'ai_response': 'Hi again! \ud83d\ude0a What can I assist you with today? Need airtime, data, or help with your electricity? Just let me know!', 'intent_detected': 'greeting', 'entities_extracted': '{}', 'confidence_score': 0.95, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 11, 6, 30, 21, 745909), 'conversations_id': UUID('3b2ed7fb-86a8-44fb-8848-5b4e4d164966')}"}
{"asctime": "2025-11-11 08:30:21,752", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-11 08:30:22,305", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-11 08:30:22,307", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SMf8202f8d6487c08fc215dc36a45576aa"}
{"asctime": "2025-11-11 08:30:23,226", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-11 08:30:23,227", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SMed998854de6be3b842a6dc67b9f8a1e6"}
{"asctime": "2025-11-11 08:30:38,464", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'MediaContentType0': 'audio/ogg', 'SmsMessageSid': 'MM68ff4f0801037b517bf377b307fa1ac6', 'NumMedia': '1', 'ProfileName': 'Hello World!', 'MessageType': 'audio', 'SmsSid': 'MM68ff4f0801037b517bf377b307fa1ac6', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': '', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'MM68ff4f0801037b517bf377b307fa1ac6', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'MediaUrl0': 'https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages/MM68ff4f0801037b517bf377b307fa1ac6/Media/ME595bc6da55709a9cb0b8e846c135352e', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-11-11 08:30:38,464", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Parsed audio message with media: https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages/MM68ff4f0801037b517bf377b307fa1ac6/Media/ME595bc6da55709a9cb0b8e846c135352e"}
{"asctime": "2025-11-11 08:30:38,465", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing audio message from +27763514028"}
{"asctime": "2025-11-11 08:30:38,466", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 08:30:38,468", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-11 08:30:38,469", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 3434s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-11 08:30:38,472", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-11 08:30:38,473", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 3434s ago] {'last_active_at': datetime.datetime(2025, 11, 11, 6, 30, 38, 472475), 'users_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-11 08:30:38,474", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-11 08:30:39,404", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: GET https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages/MM68ff4f0801037b517bf377b307fa1ac6/Media/ME595bc6da55709a9cb0b8e846c135352e \"HTTP/1.1 307 Temporary Redirect\""}
{"asctime": "2025-11-11 08:30:39,406", "name": "app.routers.whatsapp", "levelname": "ERROR", "message": "Media download error: Redirect response '307 Temporary Redirect' for url 'https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages/MM68ff4f0801037b517bf377b307fa1ac6/Media/ME595bc6da55709a9cb0b8e846c135352e'\nRedirect location: 'https://mms.twiliocdn.com/AC6a10482bfc51f0846f64980cb7f1676e/506a8078031378204e89433b68b91559?Expires=1762857039&Signature=NH-DFak~DNfKKImxeyTYPB5iNCqzDBRC6njVVmIBvN~YMu2wmfBCEef63zn9P9V3AEjreFZruEKbA8CFXouQgk88xss9Pb8J2Gc54gGACAtZkob1bX5xc1~r5E~w4vPRbjjRLkwGJZGqUbQj02qrcltKuy9OvttCiLs8biaYnpGzaifI0PbG-D2Umy4pN6ZuEnVPOwV3aCfs~-Bf~XHC3U48O6PVoumraMOsMswxp-alUvHkis-Y~9bbKCgXL0Cp64KmvwL54lL~cJkirctrTZd3Kndm4C~9-1ToNpEgGh2eH0MMA48Cg8dsSBMF2hQz43d5mIS0LQu78Jh58ZcmRQ__&Key-Pair-Id=APKAIRUDFXVKPONS3KUA'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/307"}
{"asctime": "2025-11-11 08:30:39,911", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-11 08:30:39,912", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SMea2edbf227bc2a6ad735f2a351960166"}
{"asctime": "2025-11-11 08:43:13,106", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-11-11 08:43:13,714", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-11-11 08:43:13,714", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-11-11 08:43:13,737", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-11-11 08:43:13,737", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-11 08:43:13,739", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-11-11 08:43:13,739", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-11 08:43:13,740", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-11-11 08:43:13,740", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-11 08:43:13,741", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 08:43:13,742", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-11 08:43:13,742", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00010s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-11 08:43:13,744", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-11 08:43:13,744", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002672s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-11 08:43:13,745", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-11 08:43:13,745", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.003293s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-11 08:43:13,746", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-11 08:43:13,746", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00009s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-11 08:43:13,747", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-11 08:43:13,747", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0008142s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-11 08:43:13,747", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-11 08:43:13,747", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001284s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-11 08:43:13,748", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-11 08:43:13,748", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-11-11 08:43:13,748", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-11-11 08:43:13,748", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-11-11 08:43:16,981", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-11-11 08:43:17,374", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-11-11 08:43:17,375", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-11-11 08:43:17,390", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-11-11 08:43:17,390", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-11 08:43:17,391", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-11-11 08:43:17,391", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-11 08:43:17,391", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-11-11 08:43:17,391", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-11 08:43:17,392", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 08:43:17,393", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-11 08:43:17,393", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00010s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-11 08:43:17,395", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-11 08:43:17,395", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002037s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-11 08:43:17,396", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-11 08:43:17,396", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002499s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-11 08:43:17,396", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-11 08:43:17,397", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00007s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-11 08:43:17,397", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-11 08:43:17,397", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0006652s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-11 08:43:17,398", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-11 08:43:17,398", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001315s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-11 08:43:17,398", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-11 08:43:17,398", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-11-11 08:43:17,398", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-11-11 08:43:17,398", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-11-11 08:43:51,984", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'SmsMessageSid': 'SM50e62de8f6d4f8c6356dc72d2a370213', 'NumMedia': '0', 'ProfileName': 'Hello World!', 'MessageType': 'text', 'SmsSid': 'SM50e62de8f6d4f8c6356dc72d2a370213', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': 'Hi', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'SM50e62de8f6d4f8c6356dc72d2a370213', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-11-11 08:43:51,985", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763514028"}
{"asctime": "2025-11-11 08:43:51,996", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 08:43:52,000", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-11 08:43:52,000", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00035s] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-11 08:43:52,005", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-11 08:43:52,005", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00015s] {'last_active_at': datetime.datetime(2025, 11, 11, 6, 43, 52, 4649), 'users_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-11 08:43:52,008", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-11 08:43:52,010", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 08:43:52,011", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-11 08:43:52,011", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00018s] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-11 08:43:52,014", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-11 08:43:52,015", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00030s] {'id': UUID('ff0aefc8-ac60-4943-ac33-6f943bfaa4e1'), 'user_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'phone_number': '+27763514028', 'message_id': 'SM50e62de8f6d4f8c6356dc72d2a370213', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'Hi', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-11 08:43:52,017", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-11 08:43:52,018", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 08:43:52,018", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-11 08:43:52,018", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.007363s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-11 08:43:52,021", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-11 08:43:52,021", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00016s] {'user_id_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'param_1': 5}"}
{"asctime": "2025-11-11 08:43:54,427", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-11 08:43:54,440", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-11 08:43:54,441", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00117s] {'pk_1': UUID('ff0aefc8-ac60-4943-ac33-6f943bfaa4e1')}"}
{"asctime": "2025-11-11 08:43:54,444", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-11 08:43:54,445", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00039s] {'ai_response': \"Hello! It seems like you're just saying hi. \ud83d\ude0a If you have any questions or need assistance, feel free to ask! I'm here to help!\", 'intent_detected': 'greeting', 'entities_extracted': '{}', 'confidence_score': 0.95, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 11, 6, 43, 54, 433489), 'conversations_id': UUID('ff0aefc8-ac60-4943-ac33-6f943bfaa4e1')}"}
{"asctime": "2025-11-11 08:43:54,447", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-11 08:43:55,002", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-11 08:43:55,003", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SM327a6d6a69224caee353e3600c1ed2f4"}
{"asctime": "2025-11-11 08:43:55,960", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-11 08:43:55,961", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SM573aaf185808c74d6ef1ffd832da279a"}
{"asctime": "2025-11-11 08:44:26,170", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'MediaContentType0': 'image/jpeg', 'SmsMessageSid': 'MMaaed7cd9975a13e8a260db6af3a08c95', 'NumMedia': '1', 'ProfileName': 'Hello World!', 'MessageType': 'image', 'SmsSid': 'MMaaed7cd9975a13e8a260db6af3a08c95', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': 'Buy 10r electricity for this meter number', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'MMaaed7cd9975a13e8a260db6af3a08c95', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'MediaUrl0': 'https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages/MMaaed7cd9975a13e8a260db6af3a08c95/Media/ME9ca7b114e851f8d66906777d1cb29763', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-11-11 08:44:26,172", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Parsed image message with media: https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages/MMaaed7cd9975a13e8a260db6af3a08c95/Media/ME9ca7b114e851f8d66906777d1cb29763"}
{"asctime": "2025-11-11 08:44:26,172", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing image message from +27763514028"}
{"asctime": "2025-11-11 08:44:26,174", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 08:44:26,175", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-11 08:44:26,175", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 34.18s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-11 08:44:26,178", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-11 08:44:26,178", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 34.17s ago] {'last_active_at': datetime.datetime(2025, 11, 11, 6, 44, 26, 177802), 'users_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-11 08:44:26,180", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-11 08:44:26,783", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: GET https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages/MMaaed7cd9975a13e8a260db6af3a08c95/Media/ME9ca7b114e851f8d66906777d1cb29763 \"HTTP/1.1 307 Temporary Redirect\""}
{"asctime": "2025-11-11 08:44:27,504", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: GET https://mms.twiliocdn.com/AC6a10482bfc51f0846f64980cb7f1676e/5b62a11ecbe0fe77caa91760f7e11b52?Expires=1762857866&Signature=D-YAku7JOvHI0DH99EQDyUgttdqzzpCW3hYYgK2Bc5vpAXp2bbUdb6rBrIvP~kk9vPxZhBUK8lxeObDSDRbO-dAbdlhbab9P96LAAqxSqludM~OkRe7MvWY3YlAVIDbIf2wZ9beTG57DLVBT0T~CNhk6AeaeshpROLYVjPmEDP5nwFNiCHbFmJ1mtbeH8~tooYaWoBFc4HOutoRardIcAyKHHZ1EQHFc3zDFacRaT1JDkplxfMv3wbmoQ0sonyUebY6QHE99oozFyS~2YeZLUBGet33PQP7uSE8cCr~zQkXWdRF~ifHwIyWT8M8Jp9afzf0saskLQXtAS6WB4eZONw__&Key-Pair-Id=APKAIRUDFXVKPONS3KUA \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-11 08:44:27,519", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Media downloaded: media/MMaaed7cd9975a13e8a260db6af3a08c95.jpg"}
{"asctime": "2025-11-11 08:44:27,536", "name": "app.services.ai_service", "levelname": "INFO", "message": "Processing image: media/MMaaed7cd9975a13e8a260db6af3a08c95.jpg"}
{"asctime": "2025-11-11 08:44:28,127", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 429 Too Many Requests\""}
{"asctime": "2025-11-11 08:44:28,134", "name": "openai._base_client", "levelname": "INFO", "message": "Retrying request to /chat/completions in 0.811407 seconds"}
{"asctime": "2025-11-11 08:44:29,854", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 429 Too Many Requests\""}
{"asctime": "2025-11-11 08:44:29,855", "name": "openai._base_client", "levelname": "INFO", "message": "Retrying request to /chat/completions in 1.767905 seconds"}
{"asctime": "2025-11-11 08:44:32,119", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 429 Too Many Requests\""}
{"asctime": "2025-11-11 08:44:32,121", "name": "app.services.ai_service", "levelname": "ERROR", "message": "Image processing error: Error code: 429 - {'error': {'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'}}"}
{"asctime": "2025-11-11 08:44:32,587", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-11 08:44:32,589", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SM851547193725557b20770c8380025b37"}
{"asctime": "2025-11-11 09:14:39,701", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'SmsMessageSid': 'SM72c4661ddc38677f1e436c50a4a31d3a', 'NumMedia': '0', 'ProfileName': 'Hello World!', 'MessageType': 'text', 'SmsSid': 'SM72c4661ddc38677f1e436c50a4a31d3a', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': 'Hi', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'SM72c4661ddc38677f1e436c50a4a31d3a', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-11-11 09:14:39,703", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763514028"}
{"asctime": "2025-11-11 09:14:39,708", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 09:14:39,709", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-11 09:14:39,709", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 1012s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-11 09:14:39,713", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-11 09:14:39,713", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 1012s ago] {'last_active_at': datetime.datetime(2025, 11, 11, 7, 14, 39, 712188), 'users_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-11 09:14:39,714", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-11 09:14:39,717", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 09:14:39,717", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-11 09:14:39,719", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 1012s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-11 09:14:39,721", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-11 09:14:39,721", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 1012s ago] {'id': UUID('8bbb807e-e334-46b2-93c6-93478f8ce117'), 'user_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'phone_number': '+27763514028', 'message_id': 'SM72c4661ddc38677f1e436c50a4a31d3a', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'Hi', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-11 09:14:39,722", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-11 09:14:39,723", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 09:14:39,724", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-11 09:14:39,724", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 1012s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-11 09:14:39,725", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-11 09:14:39,725", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 1012s ago] {'user_id_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'param_1': 5}"}
{"asctime": "2025-11-11 09:14:41,288", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-11 09:14:41,308", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-11 09:14:41,308", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 1011s ago] {'pk_1': UUID('8bbb807e-e334-46b2-93c6-93478f8ce117')}"}
{"asctime": "2025-11-11 09:14:41,310", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-11 09:14:41,310", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 1011s ago] {'ai_response': 'Hey there! \ud83d\ude0a How can I help you today? If you need anything or have questions, just let me know!', 'intent_detected': 'greeting', 'entities_extracted': '{}', 'confidence_score': 0.95, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 11, 7, 14, 41, 306511), 'conversations_id': UUID('8bbb807e-e334-46b2-93c6-93478f8ce117')}"}
{"asctime": "2025-11-11 09:14:41,311", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-11 09:14:41,776", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-11 09:14:41,776", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SM9117bcde5b0f703c7922f1496459a14c"}
{"asctime": "2025-11-11 09:14:42,211", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-11 09:14:42,211", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SM18d6569127af97c35ce14b6081eaaa90"}
{"asctime": "2025-11-11 09:15:02,621", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'MediaContentType0': 'image/jpeg', 'SmsMessageSid': 'MM0cb008ae3984c7322e6ebc4a901fa3e8', 'NumMedia': '1', 'ProfileName': 'Hello World!', 'MessageType': 'image', 'SmsSid': 'MM0cb008ae3984c7322e6ebc4a901fa3e8', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': 'Send r10 airtime to that number', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'MM0cb008ae3984c7322e6ebc4a901fa3e8', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'MediaUrl0': 'https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages/MM0cb008ae3984c7322e6ebc4a901fa3e8/Media/ME44a62d39c8aa27095128d3ccbf00a7ce', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-11-11 09:15:02,622", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Parsed image message with media: https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages/MM0cb008ae3984c7322e6ebc4a901fa3e8/Media/ME44a62d39c8aa27095128d3ccbf00a7ce"}
{"asctime": "2025-11-11 09:15:02,622", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing image message from +27763514028"}
{"asctime": "2025-11-11 09:15:02,623", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 09:15:02,624", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-11 09:15:02,624", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 1035s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-11 09:15:02,626", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-11 09:15:02,626", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 1035s ago] {'last_active_at': datetime.datetime(2025, 11, 11, 7, 15, 2, 625978), 'users_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-11 09:15:02,628", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-11 09:15:03,334", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: GET https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages/MM0cb008ae3984c7322e6ebc4a901fa3e8/Media/ME44a62d39c8aa27095128d3ccbf00a7ce \"HTTP/1.1 307 Temporary Redirect\""}
{"asctime": "2025-11-11 09:15:04,356", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: GET https://mms.twiliocdn.com/AC6a10482bfc51f0846f64980cb7f1676e/e609827a32c348c47fdd78af697e3ef0?Expires=1762859703&Signature=WBbw7wA2IZ3bQRCuxsbGA8Qi4W~fAheIonN9ZgJZtILdY0WMeX7iFauFXY3rIVpTgKHpfL2gtrFlsHvLOvEqbKbfSEFQSeItiBVuVo6thRrKQLmMDgzqDGY9QQRXPCSDgxCsuCC4ITD5UKX3~b39Xy6Of~l~88X3FztgezaGg8qNljP7NEidc9eFaZ3fUdZGJZAYvpTrYQMhDKQ6cUcw214HEX6X1sLRNSyfA4wQnmvv6m5KIPQFOZORjMX58T9JJNZajZNNssVyuJgDti1xeo4VntwAr4N0gcfA~YXrcs5oxKsAFKZFVcIwWL5dzjggDvP4W0TLErNNwLxmpPc0DQ__&Key-Pair-Id=APKAIRUDFXVKPONS3KUA \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-11 09:15:04,386", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Media downloaded: media/MM0cb008ae3984c7322e6ebc4a901fa3e8.jpg"}
{"asctime": "2025-11-11 09:15:04,406", "name": "app.services.ai_service", "levelname": "INFO", "message": "Processing image: media/MM0cb008ae3984c7322e6ebc4a901fa3e8.jpg"}
{"asctime": "2025-11-11 09:15:05,074", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 429 Too Many Requests\""}
{"asctime": "2025-11-11 09:15:05,076", "name": "openai._base_client", "levelname": "INFO", "message": "Retrying request to /chat/completions in 0.773595 seconds"}
{"asctime": "2025-11-11 09:15:06,303", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 429 Too Many Requests\""}
{"asctime": "2025-11-11 09:15:06,304", "name": "openai._base_client", "levelname": "INFO", "message": "Retrying request to /chat/completions in 1.973791 seconds"}
{"asctime": "2025-11-11 09:15:09,069", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 429 Too Many Requests\""}
{"asctime": "2025-11-11 09:15:09,071", "name": "app.services.ai_service", "levelname": "ERROR", "message": "Image processing error: Error code: 429 - {'error': {'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'}}"}
{"asctime": "2025-11-11 09:15:09,580", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-11 09:15:09,582", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SMdbe7a3f1579f9c5dc964d1e17735645a"}
{"asctime": "2025-11-11 09:23:08,700", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'SmsMessageSid': 'SMbb4023da9f94f71589014d6ea9038aeb', 'NumMedia': '0', 'ProfileName': 'Hello World!', 'MessageType': 'text', 'SmsSid': 'SMbb4023da9f94f71589014d6ea9038aeb', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': 'Hi', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'SMbb4023da9f94f71589014d6ea9038aeb', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-11-11 09:23:08,702", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763514028"}
{"asctime": "2025-11-11 09:23:08,705", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 09:23:08,706", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-11 09:23:08,707", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 1521s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-11 09:23:08,708", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-11 09:23:08,709", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 1521s ago] {'last_active_at': datetime.datetime(2025, 11, 11, 7, 23, 8, 708452), 'users_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-11 09:23:08,709", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-11 09:23:08,711", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 09:23:08,711", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-11 09:23:08,711", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 1521s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-11 09:23:08,712", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-11 09:23:08,713", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 1521s ago] {'id': UUID('2ed07d2b-a268-4405-8c29-99372f246d96'), 'user_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'phone_number': '+27763514028', 'message_id': 'SMbb4023da9f94f71589014d6ea9038aeb', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'Hi', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-11 09:23:08,713", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-11 09:23:08,714", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 09:23:08,714", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-11 09:23:08,714", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 1521s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-11 09:23:08,715", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-11 09:23:08,715", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 1521s ago] {'user_id_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'param_1': 5}"}
{"asctime": "2025-11-11 09:23:11,442", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-11 09:23:11,456", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-11 09:23:11,456", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 1521s ago] {'pk_1': UUID('2ed07d2b-a268-4405-8c29-99372f246d96')}"}
{"asctime": "2025-11-11 09:23:11,457", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-11 09:23:11,458", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 1521s ago] {'ai_response': \"Hi again! \ud83d\ude0a If there's something specific you need help with, just let me know! I'm here for you!\", 'intent_detected': 'greeting', 'entities_extracted': '{}', 'confidence_score': 0.95, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 11, 7, 23, 11, 455157), 'conversations_id': UUID('2ed07d2b-a268-4405-8c29-99372f246d96')}"}
{"asctime": "2025-11-11 09:23:11,458", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-11 09:23:12,032", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-11 09:23:12,033", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SMa3a09c7c3033950ff1feaf0d7aabe424"}
{"asctime": "2025-11-11 09:23:12,652", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-11 09:23:12,653", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SM5b46d55059a2f65c36073652879ff2f9"}
{"asctime": "2025-11-11 09:23:26,603", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'MediaContentType0': 'image/jpeg', 'SmsMessageSid': 'MMdf1646fc253f0c5904ff6ac118900eb5', 'NumMedia': '1', 'ProfileName': 'Hello World!', 'MessageType': 'image', 'SmsSid': 'MMdf1646fc253f0c5904ff6ac118900eb5', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': 'Send r10 airtime to that number', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'MMdf1646fc253f0c5904ff6ac118900eb5', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'MediaUrl0': 'https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages/MMdf1646fc253f0c5904ff6ac118900eb5/Media/ME4e0676f39be9bc4ab23b6ad299c2b222', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-11-11 09:23:26,604", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Parsed image message with media: https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages/MMdf1646fc253f0c5904ff6ac118900eb5/Media/ME4e0676f39be9bc4ab23b6ad299c2b222"}
{"asctime": "2025-11-11 09:23:26,604", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing image message from +27763514028"}
{"asctime": "2025-11-11 09:23:26,607", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 09:23:26,608", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-11 09:23:26,608", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 1539s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-11 09:23:26,616", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-11 09:23:26,616", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 1539s ago] {'last_active_at': datetime.datetime(2025, 11, 11, 7, 23, 26, 615927), 'users_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-11 09:23:26,618", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-11 09:23:27,069", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: GET https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages/MMdf1646fc253f0c5904ff6ac118900eb5/Media/ME4e0676f39be9bc4ab23b6ad299c2b222 \"HTTP/1.1 307 Temporary Redirect\""}
{"asctime": "2025-11-11 09:23:27,361", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: GET https://mms.twiliocdn.com/AC6a10482bfc51f0846f64980cb7f1676e/e609827a32c348c47fdd78af697e3ef0?Expires=1762860207&Signature=Z72vwLhWDS~tLnpdmVo9Gvar668xyvEU8x9y~qOwnQTLNF5OvN9q5JNQUB189nMAzoxrRKoQ6Oss5UkPc1GVLcl2-sLfc8oElylPYaFwAAtxaj0DuiEiee-LobYCs~zU153TGDGkKhSLAYGAozZFbS0WN6Y9wL7kWFNuvEJRcmxv7QeEIeHUE589yvupnFIZLTz1zYGBuirNRU-FsxR1WkoMNjxnCPJ2WUFPDjLmxuysD1FK~iScTxLhPR3KKvC72sUeqr5UmfKd5VujazsrrI-tAEKdiNg0fYYMWJ7joxVoLArKCFBcBRTh8olGmNf7BBXzkGWeOQ~yWrtwCyZBpA__&Key-Pair-Id=APKAIRUDFXVKPONS3KUA \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-11 09:23:27,373", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Media downloaded: media/MMdf1646fc253f0c5904ff6ac118900eb5.jpg"}
{"asctime": "2025-11-11 09:23:27,390", "name": "app.services.ai_service", "levelname": "INFO", "message": "Processing image: media/MMdf1646fc253f0c5904ff6ac118900eb5.jpg"}
{"asctime": "2025-11-11 09:23:29,903", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-11 09:23:29,907", "name": "app.services.ai_service", "levelname": "INFO", "message": "Image processed successfully: ```json\n{\n  \"meter_number\": \"123456789\"\n}\n```..."}
{"asctime": "2025-11-11 09:23:30,414", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-11 09:23:30,415", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SM9e063b4a8c33fb66f24d8c652441345d"}
{"asctime": "2025-11-11 09:23:30,418", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 09:23:30,419", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-11 09:23:30,419", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 1543s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-11 09:23:30,422", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-11 09:23:30,422", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 1543s ago] {'id': UUID('0633d164-9488-45f6-8f7a-48efe46bfcfb'), 'user_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'phone_number': '+27763514028', 'message_id': 'MMdf1646fc253f0c5904ff6ac118900eb5', 'message_type': 'image', 'direction': 'inbound', 'message_text': 'help', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-11 09:23:30,423", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-11 09:23:30,424", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 09:23:30,425", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-11 09:23:30,425", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 1543s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-11 09:23:30,426", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-11 09:23:30,426", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 1543s ago] {'user_id_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'param_1': 5}"}
{"asctime": "2025-11-11 09:23:32,778", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-11 09:23:32,785", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-11 09:23:32,785", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 1543s ago] {'pk_1': UUID('0633d164-9488-45f6-8f7a-48efe46bfcfb')}"}
{"asctime": "2025-11-11 09:23:32,786", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-11 09:23:32,786", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 1543s ago] {'ai_response': \"Of course! What do you need help with? Whether it's buying airtime, data, paying for electricity, or checking your balance, just let me know!\", 'intent_detected': 'help', 'entities_extracted': '{}', 'confidence_score': 0.95, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 11, 7, 23, 32, 784254), 'conversations_id': UUID('0633d164-9488-45f6-8f7a-48efe46bfcfb')}"}
{"asctime": "2025-11-11 09:23:32,787", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-11 09:23:33,281", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-11 09:23:33,282", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SM60d9002cacd1ad80b37a9a1e54d1d1a6"}
{"asctime": "2025-11-11 09:23:33,774", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-11 09:23:33,775", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SM432d3b1d52bb3e86c628b4c6cc27d938"}
{"asctime": "2025-11-11 09:31:41,924", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'MediaContentType0': 'audio/ogg', 'SmsMessageSid': 'MMe590230f9f4f2c1cd5b918c016b80747', 'NumMedia': '1', 'ProfileName': 'Hello World!', 'MessageType': 'audio', 'SmsSid': 'MMe590230f9f4f2c1cd5b918c016b80747', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': '', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'MMe590230f9f4f2c1cd5b918c016b80747', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'MediaUrl0': 'https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages/MMe590230f9f4f2c1cd5b918c016b80747/Media/ME9da6506e3e580203cb1c259d90d6add3', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-11-11 09:31:41,926", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Parsed audio message with media: https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages/MMe590230f9f4f2c1cd5b918c016b80747/Media/ME9da6506e3e580203cb1c259d90d6add3"}
{"asctime": "2025-11-11 09:31:41,927", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing audio message from +27763514028"}
{"asctime": "2025-11-11 09:31:41,940", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 09:31:41,941", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-11 09:31:41,942", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 2034s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-11 09:31:41,945", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-11 09:31:41,946", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 2034s ago] {'last_active_at': datetime.datetime(2025, 11, 11, 7, 31, 41, 944914), 'users_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-11 09:31:41,947", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-11 09:31:42,470", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: GET https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages/MMe590230f9f4f2c1cd5b918c016b80747/Media/ME9da6506e3e580203cb1c259d90d6add3 \"HTTP/1.1 307 Temporary Redirect\""}
{"asctime": "2025-11-11 09:31:43,064", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: GET https://mms.twiliocdn.com/AC6a10482bfc51f0846f64980cb7f1676e/0d307da3e6da562aad69b561bfd574fe?Expires=1762860702&Signature=PZ7SJaf58sRcHD-Rlrq18RSZVeapFaIKwF1-rP6JmnKZ9e7T-hybhvisdSBfWAzBQw9jo0JktIRgVrdGt2YHZKr-ZoJcDz7fFUCus3TOqxFfbbaU3X0cqpxUromzJGaKLYL233yqF~h~Ty1eZ27nUpEJA4tZwyQr7EV4dJS-T0THF1iOU1oUSkTHMzrg-py9gVQ2WehY~G5Czo-IwdVX7E6EZOh2OZ5pPe5TqMD8C62bsG1ci35EJXvi3eocjQMNun-mCD2WnBn5UlkztWvk5a~MBEM72r69dwWGGxTRG6IrrQpNytA2xVs4V-Rd86lX5nIfiRXSOgwXHdLzaKoxqA__&Key-Pair-Id=APKAIRUDFXVKPONS3KUA \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-11 09:31:43,066", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Media downloaded: media/MMe590230f9f4f2c1cd5b918c016b80747.ogg"}
{"asctime": "2025-11-11 09:31:43,077", "name": "app.services.ai_service", "levelname": "INFO", "message": "Transcribing voice note: media/MMe590230f9f4f2c1cd5b918c016b80747.ogg"}
{"asctime": "2025-11-11 09:31:45,269", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/audio/transcriptions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-11 09:31:45,271", "name": "app.services.ai_service", "levelname": "INFO", "message": "Voice note transcribed successfully: Hi, I would like to send an airtime. Can you do that for me?..."}
{"asctime": "2025-11-11 09:31:45,797", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-11 09:31:45,799", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SM77d3b2c7bdc0774fd097870ddfcb44a5"}
{"asctime": "2025-11-11 09:31:45,801", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 09:31:45,801", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-11 09:31:45,802", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 2038s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-11 09:31:45,804", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-11 09:31:45,804", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 2038s ago] {'id': UUID('6e08a8d9-4cb6-4879-aaa4-fe5aca4076ab'), 'user_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'phone_number': '+27763514028', 'message_id': 'MMe590230f9f4f2c1cd5b918c016b80747', 'message_type': 'audio', 'direction': 'inbound', 'message_text': 'Hi, I would like to send an airtime. Can you do that for me?', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-11 09:31:45,805", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-11 09:31:45,807", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 09:31:45,807", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-11 09:31:45,808", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 2038s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-11 09:31:45,810", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-11 09:31:45,810", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 2038s ago] {'user_id_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'param_1': 5}"}
{"asctime": "2025-11-11 09:31:48,518", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-11 09:31:48,525", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-11 09:31:48,526", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 2038s ago] {'pk_1': UUID('6e08a8d9-4cb6-4879-aaa4-fe5aca4076ab')}"}
{"asctime": "2025-11-11 09:31:48,528", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-11 09:31:48,528", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 2038s ago] {'ai_response': 'I can help you buy airtime, but I can\u2019t send it directly to someone else at the moment. Would you like to buy airtime for yourself? If so, please let me know the amount and your network (MTN, Vodacom, Cell C, or Telkom)!', 'intent_detected': 'buy_airtime', 'entities_extracted': '{\"amount\": null, \"phone\": null, \"network\": null}', 'confidence_score': 0.9, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 11, 7, 31, 48, 524281), 'conversations_id': UUID('6e08a8d9-4cb6-4879-aaa4-fe5aca4076ab')}"}
{"asctime": "2025-11-11 09:31:48,529", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-11 09:31:49,017", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-11 09:31:49,018", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SM09cf7eea3df7a08e5363b13fb6d11fd8"}
{"asctime": "2025-11-11 09:41:32,450", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-11-11 09:41:33,097", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-11-11 09:41:33,097", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-11-11 09:41:33,195", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-11-11 09:41:33,195", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-11 09:41:33,196", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-11-11 09:41:33,196", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-11 09:41:33,197", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-11-11 09:41:33,197", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-11 09:41:33,198", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 09:41:33,199", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-11 09:41:33,199", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00011s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-11 09:41:33,201", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-11 09:41:33,201", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.00192s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-11 09:41:33,201", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-11 09:41:33,201", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002368s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-11 09:41:33,202", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-11 09:41:33,202", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00009s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-11 09:41:33,203", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-11 09:41:33,203", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0007331s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-11 09:41:33,203", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-11 09:41:33,203", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001136s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-11 09:41:33,203", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-11 09:41:33,204", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-11-11 09:41:33,204", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-11-11 09:41:33,204", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-11-11 09:41:45,845", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-11-11 09:41:46,641", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-11-11 09:41:46,641", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-11-11 09:41:46,659", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-11-11 09:41:46,659", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-11 09:41:46,660", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-11-11 09:41:46,660", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-11 09:41:46,660", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-11-11 09:41:46,660", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-11 09:41:46,661", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 09:41:46,662", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-11 09:41:46,663", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00010s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-11 09:41:46,664", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-11 09:41:46,664", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002038s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-11 09:41:46,665", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-11 09:41:46,665", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002657s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-11 09:41:46,666", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-11 09:41:46,666", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00008s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-11 09:41:46,666", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-11 09:41:46,667", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0006574s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-11 09:41:46,667", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-11 09:41:46,667", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001238s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-11 09:41:46,667", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-11 09:41:46,668", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-11-11 09:41:46,668", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-11-11 09:41:46,668", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-11-11 09:42:47,496", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'MediaContentType0': 'image/jpeg', 'SmsMessageSid': 'MM86f212b620cc087caf0b39504c10c4ac', 'NumMedia': '1', 'ProfileName': 'Hello World!', 'MessageType': 'image', 'SmsSid': 'MM86f212b620cc087caf0b39504c10c4ac', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': 'Send 10 rand airtime', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'MM86f212b620cc087caf0b39504c10c4ac', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'MediaUrl0': 'https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages/MM86f212b620cc087caf0b39504c10c4ac/Media/ME098d6165dca63f53ef5de63ada4ca234', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-11-11 09:42:47,496", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Parsed image message with media: https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages/MM86f212b620cc087caf0b39504c10c4ac/Media/ME098d6165dca63f53ef5de63ada4ca234"}
{"asctime": "2025-11-11 09:42:47,496", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing image message from +27763514028"}
{"asctime": "2025-11-11 09:42:47,505", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 09:42:47,508", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-11 09:42:47,509", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00034s] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-11 09:42:47,514", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-11 09:42:47,514", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00018s] {'last_active_at': datetime.datetime(2025, 11, 11, 7, 42, 47, 513108), 'users_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-11 09:42:47,516", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-11 09:42:48,077", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: GET https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages/MM86f212b620cc087caf0b39504c10c4ac/Media/ME098d6165dca63f53ef5de63ada4ca234 \"HTTP/1.1 307 Temporary Redirect\""}
{"asctime": "2025-11-11 09:42:48,252", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: GET https://mms.twiliocdn.com/AC6a10482bfc51f0846f64980cb7f1676e/e609827a32c348c47fdd78af697e3ef0?Expires=1762861368&Signature=DR8XOQWC~Y5SPoIi4WCCzrQEqTuoMZNL0lWfDyHa0rGlhbnA9Yf1ebadwEkGGlEZiHtfVxfWbqchmjf1SDDsdCrq0TcGDQ9Wm31nzGmFeQ1on8BypahU~LsPCv8-fw9II5H8KCmmTTTkMZUV4Z-fNCGygxQfoICa7x4eD3GSpPBJqdwhC3bgeDoUyTixz5K7zLOtEjI~8xIsBWxLMjdVrM5JEXGjIpAl~BJz0xN-Horp3goZgQnMvoxbU1~o5sOomkstW1Boiz77YcFGZHHEZKjMyiDHrJ6Z-5yKx1F5UU2pkAkP7F9dWC3Vgi2WzmXdwLUtw1tqMC-90edX092p7g__&Key-Pair-Id=APKAIRUDFXVKPONS3KUA \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-11 09:42:48,270", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Media downloaded: media/MM86f212b620cc087caf0b39504c10c4ac.jpg"}
{"asctime": "2025-11-11 09:42:48,382", "name": "app.services.ai_service", "levelname": "INFO", "message": "Processing image: media/MM86f212b620cc087caf0b39504c10c4ac.jpg"}
{"asctime": "2025-11-11 09:42:51,304", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-11 09:42:51,310", "name": "app.services.ai_service", "levelname": "INFO", "message": "Image processed successfully: {\"type\": \"unknown\", \"confidence\": 0.4, \"description\": \"sequence of numbers, insufficient to identify..."}
{"asctime": "2025-11-11 09:42:51,814", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-11 09:42:51,816", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SMeaa664968a7e2ddbfadce0909f2cbfbb"}
{"asctime": "2025-11-11 09:43:46,884", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'MediaContentType0': 'image/jpeg', 'SmsMessageSid': 'MMcf5deb3fb1ec6c3d0346fe82dd014637', 'NumMedia': '1', 'ProfileName': 'Hello World!', 'MessageType': 'image', 'SmsSid': 'MMcf5deb3fb1ec6c3d0346fe82dd014637', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': 'Send 5 rand airtime', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'MMcf5deb3fb1ec6c3d0346fe82dd014637', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'MediaUrl0': 'https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages/MMcf5deb3fb1ec6c3d0346fe82dd014637/Media/MEd5064296ab2d64479cfa9e7a415a1aea', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-11-11 09:43:46,885", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Parsed image message with media: https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages/MMcf5deb3fb1ec6c3d0346fe82dd014637/Media/MEd5064296ab2d64479cfa9e7a415a1aea"}
{"asctime": "2025-11-11 09:43:46,885", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing image message from +27763514028"}
{"asctime": "2025-11-11 09:43:46,888", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 09:43:46,893", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-11 09:43:46,893", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 59.34s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-11 09:43:46,896", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-11 09:43:46,896", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 59.34s ago] {'last_active_at': datetime.datetime(2025, 11, 11, 7, 43, 46, 895436), 'users_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-11 09:43:46,897", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-11 09:43:47,458", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: GET https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages/MMcf5deb3fb1ec6c3d0346fe82dd014637/Media/MEd5064296ab2d64479cfa9e7a415a1aea \"HTTP/1.1 307 Temporary Redirect\""}
{"asctime": "2025-11-11 09:43:48,035", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: GET https://mms.twiliocdn.com/AC6a10482bfc51f0846f64980cb7f1676e/27f63f80e3e6b8f7c0928f2b739157e2?Expires=1762861427&Signature=gwYQMPswkUx1jdFI2-~fUlY3NJ6BXvuzU6npllyukAIN9T7lMAN1~sCKiaMf8LyMzF06GM5ijiHsp2MorX~CCDxjOuA8h1OzLPxKrtu3lAOs370R2PL0elkIOizmo95EZo9o3xfB29JQE4cuxIjbiBnYfIad07y8a4uzN7y2UCLHf3ZhMHStj2bc~Uam5nfdh40vfezYT-pBBiHDW3ozb7vMCos3R6kNv9vT5xYLb7hVRX1T3GhNDI2zMzf7Fbj~WTiP19y72l5JMwTD3wjIYbSk3iauYZw9PutV3XokHH-P3~3uG3Nke6B63W49SqHmfqCJZJJKOnSHI8A6YRl5dg__&Key-Pair-Id=APKAIRUDFXVKPONS3KUA \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-11 09:43:48,040", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Media downloaded: media/MMcf5deb3fb1ec6c3d0346fe82dd014637.jpg"}
{"asctime": "2025-11-11 09:43:48,051", "name": "app.services.ai_service", "levelname": "INFO", "message": "Processing image: media/MMcf5deb3fb1ec6c3d0346fe82dd014637.jpg"}
{"asctime": "2025-11-11 09:43:55,252", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-11 09:43:55,257", "name": "app.services.ai_service", "levelname": "INFO", "message": "Image processed successfully: {\"type\": \"meter_number\", \"meter_number\": \"62433142669\", \"provider\": \"Eskom\", \"confidence\": 0.95, \"de..."}
{"asctime": "2025-11-11 09:43:55,809", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-11 09:43:55,811", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SM5974e116419c69f01e7a7d33cf6df52b"}
{"asctime": "2025-11-11 09:43:55,815", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 09:43:55,818", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-11 09:43:55,818", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00053s] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-11 09:43:55,825", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-11 09:43:55,826", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00060s] {'id': UUID('c6ca1728-a774-4414-a40f-e9deba2b3d21'), 'user_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'phone_number': '+27763514028', 'message_id': 'MMcf5deb3fb1ec6c3d0346fe82dd014637', 'message_type': 'image', 'direction': 'inbound', 'message_text': 'buy electricity for meter 62433142669', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-11 09:43:55,830", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-11 09:43:55,832", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 09:43:55,832", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-11 09:43:55,833", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0149s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-11 09:43:55,835", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-11 09:43:55,835", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00023s] {'user_id_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'param_1': 5}"}
{"asctime": "2025-11-11 09:43:59,340", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-11 09:43:59,349", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-11 09:43:59,349", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00066s] {'pk_1': UUID('c6ca1728-a774-4414-a40f-e9deba2b3d21')}"}
{"asctime": "2025-11-11 09:43:59,351", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-11 09:43:59,352", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00036s] {'ai_response': \"I can help you with that! Just to confirm, please provide me with the prepaid token amount you'd like to purchase, and remember that there might be a ... (6 characters truncated) ... ce fee of 2-5%. \\n\\nAlso, since your wallet balance is currently R0.00, you'll need to top up your wallet first. Would you like assistance with that?\", 'intent_detected': 'buy_electricity', 'entities_extracted': '{\"amount\": 62433142669.0, \"meter_number\": \"62433142669\"}', 'confidence_score': 0.9, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 11, 7, 43, 59, 345279), 'conversations_id': UUID('c6ca1728-a774-4414-a40f-e9deba2b3d21')}"}
{"asctime": "2025-11-11 09:43:59,353", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-11 09:43:59,891", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-11 09:43:59,893", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SMd8b7f81cad845a9cc5a4e06815022f4f"}
{"asctime": "2025-11-11 09:44:59,670", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'MediaContentType0': 'audio/ogg', 'SmsMessageSid': 'MM81d20c74c47576e39c2c97abf28a4cf2', 'NumMedia': '1', 'ProfileName': 'Hello World!', 'MessageType': 'audio', 'SmsSid': 'MM81d20c74c47576e39c2c97abf28a4cf2', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': '', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'MM81d20c74c47576e39c2c97abf28a4cf2', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'MediaUrl0': 'https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages/MM81d20c74c47576e39c2c97abf28a4cf2/Media/MEe957d6826ca080bcffee977e95f88d4d', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-11-11 09:44:59,672", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Parsed audio message with media: https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages/MM81d20c74c47576e39c2c97abf28a4cf2/Media/MEe957d6826ca080bcffee977e95f88d4d"}
{"asctime": "2025-11-11 09:44:59,672", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing audio message from +27763514028"}
{"asctime": "2025-11-11 09:44:59,675", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 09:44:59,676", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-11 09:44:59,676", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 132.1s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-11 09:44:59,678", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-11 09:44:59,679", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 132.1s ago] {'last_active_at': datetime.datetime(2025, 11, 11, 7, 44, 59, 678326), 'users_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-11 09:44:59,679", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-11 09:45:00,275", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: GET https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages/MM81d20c74c47576e39c2c97abf28a4cf2/Media/MEe957d6826ca080bcffee977e95f88d4d \"HTTP/1.1 307 Temporary Redirect\""}
{"asctime": "2025-11-11 09:45:00,897", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: GET https://mms.twiliocdn.com/AC6a10482bfc51f0846f64980cb7f1676e/acfdc1034257baff1f331b523c5b178b?Expires=1762861500&Signature=FPTWovThoeR3~RgG5~NR2sVdH~F3vugOgooldDMM6HTeEiWWD-eO8rUoSUlhfGD-pO2zUJhBImk4I-AzdNExlv4A7-aQRwr2MoZaXRnkmlzM0H3mm5f0Kn8HvpWGuNT4UQTdIxwen3zA-kMaCmnAk6vR4hBR6~IQ1a006roG-xLmYF4DVUwKrMQg07HsYZSq8LOD8RNAK6xrEGsVEm7exclWsawkqlrX3qYPOt5JhEtbXgPy9dgpbrvgmc9Qxn2O01sRKQGuYVVQRettD38W6Ao16UC8qGxsB8wHHPfdolzcSJJdNReaUjHQVp3dhNFjTezKKGu-ftep-sBJT54ZVw__&Key-Pair-Id=APKAIRUDFXVKPONS3KUA \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-11 09:45:00,902", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Media downloaded: media/MM81d20c74c47576e39c2c97abf28a4cf2.ogg"}
{"asctime": "2025-11-11 09:45:00,913", "name": "app.services.ai_service", "levelname": "INFO", "message": "Transcribing voice note: media/MM81d20c74c47576e39c2c97abf28a4cf2.ogg"}
{"asctime": "2025-11-11 09:45:02,208", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/audio/transcriptions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-11 09:45:02,210", "name": "app.services.ai_service", "levelname": "INFO", "message": "Voice note transcribed successfully: Please send 10 round airtime to 0763524928...."}
{"asctime": "2025-11-11 09:45:02,730", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-11 09:45:02,731", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SM716c8a4c631b98a186c6f71ee562ea05"}
{"asctime": "2025-11-11 09:45:02,735", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 09:45:02,738", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-11 09:45:02,739", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 66.92s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-11 09:45:02,741", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-11 09:45:02,742", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 66.91s ago] {'id': UUID('2bcb4157-7f32-406d-bcb2-40ef9a88e747'), 'user_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'phone_number': '+27763514028', 'message_id': 'MM81d20c74c47576e39c2c97abf28a4cf2', 'message_type': 'audio', 'direction': 'inbound', 'message_text': 'Please send 10 round airtime to 0763524928.', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-11 09:45:02,743", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-11 09:45:02,744", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 09:45:02,745", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-11 09:45:02,745", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 66.93s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-11 09:45:02,746", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-11 09:45:02,747", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 66.91s ago] {'user_id_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'param_1': 5}"}
{"asctime": "2025-11-11 09:45:07,412", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-11 09:45:07,425", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-11 09:45:07,426", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 68.08s ago] {'pk_1': UUID('2bcb4157-7f32-406d-bcb2-40ef9a88e747')}"}
{"asctime": "2025-11-11 09:45:07,428", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-11 09:45:07,428", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 68.08s ago] {'ai_response': \"I can help you buy R10 airtime, but I can only process purchases for your own number. Since your wallet balance is R0.00, you'll need to add funds first. \\n\\nWould you like to top up your wallet or buy the airtime for yourself instead? Just let me know!\", 'intent_detected': 'buy_airtime', 'entities_extracted': '{\"amount\": 10.0, \"phone\": \"0763524928\", \"network\": null}', 'confidence_score': 0.9, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 11, 7, 45, 7, 423865), 'conversations_id': UUID('2bcb4157-7f32-406d-bcb2-40ef9a88e747')}"}
{"asctime": "2025-11-11 09:45:07,429", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-11 09:45:07,952", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-11 09:45:07,954", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SMab02ea05383210a1994375c25309000b"}
{"asctime": "2025-11-11 09:45:38,650", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'SmsMessageSid': 'SM12cef3d7e48bcf90e3fdd4236638c613', 'NumMedia': '0', 'ProfileName': 'Hello World!', 'MessageType': 'text', 'SmsSid': 'SM12cef3d7e48bcf90e3fdd4236638c613', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': 'What incompleted task do I have', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'SM12cef3d7e48bcf90e3fdd4236638c613', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-11-11 09:45:38,651", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763514028"}
{"asctime": "2025-11-11 09:45:38,653", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 09:45:38,653", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-11 09:45:38,654", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 171.1s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-11 09:45:38,655", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-11 09:45:38,656", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 171.1s ago] {'last_active_at': datetime.datetime(2025, 11, 11, 7, 45, 38, 655397), 'users_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-11 09:45:38,657", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-11 09:45:38,659", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 09:45:38,659", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-11 09:45:38,659", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 102.8s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-11 09:45:38,661", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-11 09:45:38,661", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 102.8s ago] {'id': UUID('aebcd39a-b3f7-43a3-8afe-df362828bb9a'), 'user_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'phone_number': '+27763514028', 'message_id': 'SM12cef3d7e48bcf90e3fdd4236638c613', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'What incompleted task do I have', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-11 09:45:38,662", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-11 09:45:38,663", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 09:45:38,663", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-11 09:45:38,664", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 102.8s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-11 09:45:38,665", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-11 09:45:38,665", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 102.8s ago] {'user_id_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'param_1': 5}"}
{"asctime": "2025-11-11 09:45:41,335", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-11 09:45:41,341", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-11 09:45:41,341", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 102s ago] {'pk_1': UUID('aebcd39a-b3f7-43a3-8afe-df362828bb9a')}"}
{"asctime": "2025-11-11 09:45:41,344", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-11 09:45:41,344", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 102s ago] {'ai_response': 'Your current status is \"pending_verification,\" which means that your account is not fully set up yet. Once your account is verified, you\\'ll be able to use all the features, including buying airtime and paying for electricity. \\n\\nIf you need help with the verification process, let me know!', 'intent_detected': 'conversation', 'entities_extracted': '{}', 'confidence_score': 0.7, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 11, 7, 45, 41, 339640), 'conversations_id': UUID('aebcd39a-b3f7-43a3-8afe-df362828bb9a')}"}
{"asctime": "2025-11-11 09:45:41,345", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-11 09:45:41,893", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-11 09:45:41,894", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SMc7db8cee7f63a18697509ebe0a30dcf1"}
{"asctime": "2025-11-11 09:45:58,541", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'SmsMessageSid': 'SM7e7013c8fa7f7a594ff3e95fd17b6767', 'NumMedia': '0', 'ProfileName': 'Hello World!', 'MessageType': 'text', 'SmsSid': 'SM7e7013c8fa7f7a594ff3e95fd17b6767', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': 'Yes I need help', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'SM7e7013c8fa7f7a594ff3e95fd17b6767', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-11-11 09:45:58,542", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763514028"}
{"asctime": "2025-11-11 09:45:58,543", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 09:45:58,544", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-11 09:45:58,544", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 191s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-11 09:45:58,546", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-11 09:45:58,546", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 191s ago] {'last_active_at': datetime.datetime(2025, 11, 11, 7, 45, 58, 546077), 'users_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-11 09:45:58,547", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-11 09:45:58,549", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 09:45:58,549", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-11 09:45:58,550", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 122.7s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-11 09:45:58,551", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-11 09:45:58,551", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 122.7s ago] {'id': UUID('2daac77a-8e12-46ed-896c-53f03097a5b2'), 'user_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'phone_number': '+27763514028', 'message_id': 'SM7e7013c8fa7f7a594ff3e95fd17b6767', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'Yes I need help', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-11 09:45:58,553", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-11 09:45:58,554", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 09:45:58,554", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-11 09:45:58,555", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 122.7s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-11 09:45:58,556", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-11 09:45:58,556", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 122.7s ago] {'user_id_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'param_1': 5}"}
{"asctime": "2025-11-11 09:46:01,203", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-11 09:46:01,209", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-11 09:46:01,210", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 121.9s ago] {'pk_1': UUID('2daac77a-8e12-46ed-896c-53f03097a5b2')}"}
{"asctime": "2025-11-11 09:46:01,212", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-11 09:46:01,212", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 121.9s ago] {'ai_response': 'To help you with the verification process, I recommend checking the email or message you received during registration. It may contain instructions or a link to verify your account.\\n\\nIf you\u2019re having trouble finding it, please let me know, and I can guide you through what to do next!', 'intent_detected': 'help', 'entities_extracted': '{}', 'confidence_score': 0.95, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 11, 7, 46, 1, 208082), 'conversations_id': UUID('2daac77a-8e12-46ed-896c-53f03097a5b2')}"}
{"asctime": "2025-11-11 09:46:01,213", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-11 09:46:01,819", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-11 09:46:01,820", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SM72bb9601fba14a99e07861b8b50e3977"}
{"asctime": "2025-11-11 09:46:02,440", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-11 09:46:02,444", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SM9771e8c4d48bff75052020ff22af4bc5"}
{"asctime": "2025-11-11 09:47:08,852", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'MediaContentType0': 'image/jpeg', 'SmsMessageSid': 'MM2e127a1cfb196712773ce649d1a6e12c', 'NumMedia': '1', 'ProfileName': 'Hello World!', 'MessageType': 'image', 'SmsSid': 'MM2e127a1cfb196712773ce649d1a6e12c', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': 'Send air time to thabo', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'MM2e127a1cfb196712773ce649d1a6e12c', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'MediaUrl0': 'https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages/MM2e127a1cfb196712773ce649d1a6e12c/Media/ME5f0bccc5f94e27c3a41528c74096365e', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-11-11 09:47:08,853", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Parsed image message with media: https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages/MM2e127a1cfb196712773ce649d1a6e12c/Media/ME5f0bccc5f94e27c3a41528c74096365e"}
{"asctime": "2025-11-11 09:47:08,853", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing image message from +27763514028"}
{"asctime": "2025-11-11 09:47:08,855", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 09:47:08,855", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-11 09:47:08,856", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 261.3s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-11 09:47:08,857", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-11 09:47:08,858", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 261.3s ago] {'last_active_at': datetime.datetime(2025, 11, 11, 7, 47, 8, 857469), 'users_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-11 09:47:08,859", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-11 09:47:09,398", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: GET https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages/MM2e127a1cfb196712773ce649d1a6e12c/Media/ME5f0bccc5f94e27c3a41528c74096365e \"HTTP/1.1 307 Temporary Redirect\""}
{"asctime": "2025-11-11 09:47:10,117", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: GET https://mms.twiliocdn.com/AC6a10482bfc51f0846f64980cb7f1676e/370bd385417bb5ae576ed8212dbb6103?Expires=1762861629&Signature=ja5gQXedseoqwXsCRqEI0bd7PCK5Ubqs-nkhLkIC19JIpbbPDD4FV5okzJrG9-hKPh~r0prtEx3gmiLRy6j4ORYabj~JZWu6n-edgstovWN-R8REaDnZzlpuUQ3jNzbU6vXiJJb3xi119Jv1bZUaY5rD6eVM-Obuhjt8lvOdThJU4F6~HBg3cFDY9n2wc7TdLjR-UIExOnOORCh53mIQdNvpvZQQwKhULv6GvXLNVDXJqQZ1r1cvyXt2XQzCxlXucfjdj8gGYEA53rls2kbrKW7Y4Lsd5IBzQ4g~tRighR364~y~NpFX0cO8MDeXuALJsZqS~m9t5Eh4whhppevAwA__&Key-Pair-Id=APKAIRUDFXVKPONS3KUA \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-11 09:47:10,129", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Media downloaded: media/MM2e127a1cfb196712773ce649d1a6e12c.jpg"}
{"asctime": "2025-11-11 09:47:10,144", "name": "app.services.ai_service", "levelname": "INFO", "message": "Processing image: media/MM2e127a1cfb196712773ce649d1a6e12c.jpg"}
{"asctime": "2025-11-11 09:47:13,396", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-11 09:47:13,400", "name": "app.services.ai_service", "levelname": "INFO", "message": "Image processed successfully: {\"type\": \"phone_number\", \"phone_number\": \"0763024043\", \"provider\": \"Unknown\", \"confidence\": 0.95, \"d..."}
{"asctime": "2025-11-11 09:47:13,887", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-11 09:47:13,888", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SMd87f08c8720aa134cd4ec34c1eda925c"}
{"asctime": "2025-11-11 09:47:13,891", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 09:47:13,892", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-11 09:47:13,893", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 198.1s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-11 09:47:13,895", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-11 09:47:13,896", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 198.1s ago] {'id': UUID('b793447f-a9d1-4d00-98f9-4efd503b962a'), 'user_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'phone_number': '+27763514028', 'message_id': 'MM2e127a1cfb196712773ce649d1a6e12c', 'message_type': 'image', 'direction': 'inbound', 'message_text': 'buy airtime for 0763024043', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-11 09:47:13,897", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-11 09:47:13,899", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 09:47:13,900", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-11 09:47:13,900", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 198.1s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-11 09:47:13,901", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-11 09:47:13,902", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 198.1s ago] {'user_id_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'param_1': 5}"}
{"asctime": "2025-11-11 09:47:16,175", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-11 09:47:16,186", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-11 09:47:16,186", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 196.8s ago] {'pk_1': UUID('b793447f-a9d1-4d00-98f9-4efd503b962a')}"}
{"asctime": "2025-11-11 09:47:16,188", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-11 09:47:16,188", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 196.8s ago] {'ai_response': 'I can help you buy airtime, but it looks like your wallet balance is R0.00 right now. You\u2019ll need to add funds to your wallet first.\\n\\nWould you like to top up your wallet? If so, please let me know how much you want to add!', 'intent_detected': 'buy_airtime', 'entities_extracted': '{\"amount\": 763024043.0, \"phone\": \"0763024043\", \"network\": null}', 'confidence_score': 0.9, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 11, 7, 47, 16, 184573), 'conversations_id': UUID('b793447f-a9d1-4d00-98f9-4efd503b962a')}"}
{"asctime": "2025-11-11 09:47:16,189", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-11 09:47:16,777", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-11 09:47:16,779", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SM189ae52e6d21ad5aada5f434e750bcba"}
{"asctime": "2025-11-11 09:47:43,835", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'SmsMessageSid': 'SMd560c1c583b1269db15b35e6b046978b', 'NumMedia': '0', 'ProfileName': 'Hello World!', 'MessageType': 'text', 'SmsSid': 'SMd560c1c583b1269db15b35e6b046978b', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': 'Can you add it to my beneficiary', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'SMd560c1c583b1269db15b35e6b046978b', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-11-11 09:47:43,835", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763514028"}
{"asctime": "2025-11-11 09:47:43,837", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 09:47:43,837", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-11 09:47:43,838", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 296.3s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-11 09:47:43,839", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-11 09:47:43,840", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 296.3s ago] {'last_active_at': datetime.datetime(2025, 11, 11, 7, 47, 43, 839427), 'users_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-11 09:47:43,841", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-11 09:47:43,842", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 09:47:43,843", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-11 09:47:43,843", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 228s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-11 09:47:43,844", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-11 09:47:43,844", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 228s ago] {'id': UUID('2215924e-26e8-486f-a0b3-ae3d73692f4e'), 'user_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'phone_number': '+27763514028', 'message_id': 'SMd560c1c583b1269db15b35e6b046978b', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'Can you add it to my beneficiary', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-11 09:47:43,845", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-11 09:47:43,846", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 09:47:43,847", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-11 09:47:43,847", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 228s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-11 09:47:43,848", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-11 09:47:43,848", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 228s ago] {'user_id_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'param_1': 5}"}
{"asctime": "2025-11-11 09:47:45,490", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-11 09:47:45,493", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-11 09:47:45,494", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 226.1s ago] {'pk_1': UUID('2215924e-26e8-486f-a0b3-ae3d73692f4e')}"}
{"asctime": "2025-11-11 09:47:45,495", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-11 09:47:45,495", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 226.1s ago] {'ai_response': \"Currently, I can't process money transfers or add beneficiaries since your account is still pending verification. \\n\\nOnce your account is verified, you'll be able to add beneficiaries and manage your wallet. If you need help with anything else in the meantime, feel free to ask!\", 'intent_detected': 'conversation', 'entities_extracted': '{}', 'confidence_score': 0.7, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 11, 7, 47, 45, 493005), 'conversations_id': UUID('2215924e-26e8-486f-a0b3-ae3d73692f4e')}"}
{"asctime": "2025-11-11 09:47:45,495", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-11 09:47:46,020", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-11 09:47:46,021", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SMb38c43ebe99330c95474d3e00845b83c"}
{"asctime": "2025-11-11 09:48:44,883", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'MediaContentType0': 'image/jpeg', 'SmsMessageSid': 'MM1481f6109227353895c787662008c03c', 'NumMedia': '1', 'ProfileName': 'Hello World!', 'MessageType': 'image', 'SmsSid': 'MM1481f6109227353895c787662008c03c', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': 'Send 10 rand airtime to that Telcom number', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'MM1481f6109227353895c787662008c03c', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'MediaUrl0': 'https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages/MM1481f6109227353895c787662008c03c/Media/ME49f7a510cdf4ef3b48163281a21534c0', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-11-11 09:48:44,885", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Parsed image message with media: https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages/MM1481f6109227353895c787662008c03c/Media/ME49f7a510cdf4ef3b48163281a21534c0"}
{"asctime": "2025-11-11 09:48:44,885", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing image message from +27763514028"}
{"asctime": "2025-11-11 09:48:44,887", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 09:48:44,887", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-11 09:48:44,888", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 357.3s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-11 09:48:44,889", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-11 09:48:44,890", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 357.3s ago] {'last_active_at': datetime.datetime(2025, 11, 11, 7, 48, 44, 889254), 'users_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-11 09:48:44,891", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-11 09:48:45,810", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: GET https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages/MM1481f6109227353895c787662008c03c/Media/ME49f7a510cdf4ef3b48163281a21534c0 \"HTTP/1.1 307 Temporary Redirect\""}
{"asctime": "2025-11-11 09:48:46,385", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: GET https://mms.twiliocdn.com/AC6a10482bfc51f0846f64980cb7f1676e/4cd858a55d67576b2289f8dbdcca1635?Expires=1762861725&Signature=bo0c3oxp0u88iPoPCSbjTBGr8iVxHvfMqSHasfotKNVpB~Yn0IJSQlcuSr-ylXL2O7UO8vPEOdhhGRxBvjU5dhSpZ~Cs7BruyEC5ibpAxceNaxAv2a5dlOnc7qO1uLT~6SW3f90qvImkNj4B3vHYEYGTOINrcAiggaH3w8vjM19GM9L1mZvoOpHDE9KhxNFOgMas3VVStXH700w4yupd7h6VbzxmYuJTUiiWjChqvCNmITAQxFlx3KFx0-NR6WQOoxhR9dpxDZi0S9jDx9Qn3tHIs05yrG2B2gs~MCBUvsYWNQeGMf-krlAGrt920brYmHSRgds46O2g8~Dqixc1tg__&Key-Pair-Id=APKAIRUDFXVKPONS3KUA \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-11 09:48:46,394", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Media downloaded: media/MM1481f6109227353895c787662008c03c.jpg"}
{"asctime": "2025-11-11 09:48:46,407", "name": "app.services.ai_service", "levelname": "INFO", "message": "Processing image: media/MM1481f6109227353895c787662008c03c.jpg"}
{"asctime": "2025-11-11 09:48:49,245", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-11 09:48:49,250", "name": "app.services.ai_service", "levelname": "INFO", "message": "Image processed successfully: {\"type\": \"phone_number\", \"phone_number\": \"0763024043\", \"provider\": \"Cell C\", \"confidence\": 0.95, \"de..."}
{"asctime": "2025-11-11 09:48:50,163", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-11 09:48:50,164", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SM6d8082d9b13ce58b79450edeabbe07d8"}
{"asctime": "2025-11-11 09:48:50,166", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 09:48:50,166", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-11 09:48:50,166", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 294.3s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-11 09:48:50,168", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-11 09:48:50,168", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 294.3s ago] {'id': UUID('aa120cc5-1de7-4461-9cb5-47f0a7fe376c'), 'user_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'phone_number': '+27763514028', 'message_id': 'MM1481f6109227353895c787662008c03c', 'message_type': 'image', 'direction': 'inbound', 'message_text': 'buy airtime for 0763024043', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-11 09:48:50,169", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-11 09:48:50,171", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 09:48:50,171", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-11 09:48:50,171", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 294.4s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-11 09:48:50,174", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-11 09:48:50,174", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 294.3s ago] {'user_id_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'param_1': 5}"}
{"asctime": "2025-11-11 09:48:53,532", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-11 09:48:53,540", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-11 09:48:53,540", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 294.2s ago] {'pk_1': UUID('aa120cc5-1de7-4461-9cb5-47f0a7fe376c')}"}
{"asctime": "2025-11-11 09:48:53,542", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-11 09:48:53,542", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 294.2s ago] {'ai_response': \"I can help you with that! However, your wallet balance is R0.00, so you'll need to add funds to your wallet before buying airtime.\\n\\nPlease let me know how much you'd like to add, and I'll guide you through the process!\", 'intent_detected': 'buy_airtime', 'entities_extracted': '{\"amount\": 763024043.0, \"phone\": \"0763024043\", \"network\": null}', 'confidence_score': 0.9, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 11, 7, 48, 53, 539114), 'conversations_id': UUID('aa120cc5-1de7-4461-9cb5-47f0a7fe376c')}"}
{"asctime": "2025-11-11 09:48:53,543", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-11 09:48:54,033", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-11 09:48:54,034", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SM2cad24a4336c22ae16a0e59d968164f7"}
{"asctime": "2025-11-11 09:49:24,172", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'MediaContentType0': 'image/jpeg', 'SmsMessageSid': 'MM327de07d255a10e2c9b67a838f9eb5ce', 'NumMedia': '1', 'ProfileName': 'Hello World!', 'MessageType': 'image', 'SmsSid': 'MM327de07d255a10e2c9b67a838f9eb5ce', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': 'Send 20 rand airtime', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'MM327de07d255a10e2c9b67a838f9eb5ce', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'MediaUrl0': 'https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages/MM327de07d255a10e2c9b67a838f9eb5ce/Media/ME6e8429bed67904d5432b91a0f1eeeadd', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-11-11 09:49:24,173", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Parsed image message with media: https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages/MM327de07d255a10e2c9b67a838f9eb5ce/Media/ME6e8429bed67904d5432b91a0f1eeeadd"}
{"asctime": "2025-11-11 09:49:24,173", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing image message from +27763514028"}
{"asctime": "2025-11-11 09:49:24,175", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 09:49:24,175", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-11 09:49:24,176", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 396.6s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-11 09:49:24,177", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-11 09:49:24,177", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 396.6s ago] {'last_active_at': datetime.datetime(2025, 11, 11, 7, 49, 24, 177247), 'users_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-11 09:49:24,178", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-11 09:49:24,661", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: GET https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages/MM327de07d255a10e2c9b67a838f9eb5ce/Media/ME6e8429bed67904d5432b91a0f1eeeadd \"HTTP/1.1 307 Temporary Redirect\""}
{"asctime": "2025-11-11 09:49:25,287", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: GET https://mms.twiliocdn.com/AC6a10482bfc51f0846f64980cb7f1676e/d55f310d8840e1f0401be525ca3a2ba8?Expires=1762861764&Signature=PixzB3WwuWDKd7wlIvAFuuyQ~8W19Izw9fJY736~WoGNBxfQrOnwIiiODx0EWENpqrtKZ2vVhhTVUUlYBSIUwUKpMgjqOE3RWdBvmpMgF7xOdAc-hPPlTilOa5T7RCdCfvgjfViPaKvfkPdrXfPacJnPoaqtdCMFFcBYIRR9CGaQxc8lNrC-pnrtji2xfi9AR-BSALR1aSlKc7EYE9KQU65YLZfBuakejB0HmkqPh2jNf7aUjMIjjrls4hq-Rtk82mr4p3d03uvaCiDoW1ipkSb8WDxxLXwdTgqUik-cI-NknBsJfsBDXsCzBp2YcOmzP~UjguY-hPwJoMxXvZ4tAQ__&Key-Pair-Id=APKAIRUDFXVKPONS3KUA \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-11 09:49:25,289", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Media downloaded: media/MM327de07d255a10e2c9b67a838f9eb5ce.jpg"}
{"asctime": "2025-11-11 09:49:25,300", "name": "app.services.ai_service", "levelname": "INFO", "message": "Processing image: media/MM327de07d255a10e2c9b67a838f9eb5ce.jpg"}
{"asctime": "2025-11-11 09:49:28,366", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-11 09:49:28,370", "name": "app.services.ai_service", "levelname": "INFO", "message": "Image processed successfully: {\"type\": \"phone_number\", \"phone_number\": \"0763024043\", \"provider\": \"Unknown\", \"confidence\": 0.95, \"d..."}
{"asctime": "2025-11-11 09:49:28,833", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-11 09:49:28,835", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SMd25a1f0c8d5ad69a370281a4d9864712"}
{"asctime": "2025-11-11 09:49:28,837", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 09:49:28,838", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-11 09:49:28,838", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 333s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-11 09:49:28,843", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-11 09:49:28,843", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 333s ago] {'id': UUID('3835ce87-6451-4b0d-af15-de461b7e0068'), 'user_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'phone_number': '+27763514028', 'message_id': 'MM327de07d255a10e2c9b67a838f9eb5ce', 'message_type': 'image', 'direction': 'inbound', 'message_text': 'buy airtime for 0763024043', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-11 09:49:28,844", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-11 09:49:28,846", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 09:49:28,846", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-11 09:49:28,846", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 333s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-11 09:49:28,848", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-11 09:49:28,848", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 333s ago] {'user_id_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'param_1': 5}"}
{"asctime": "2025-11-11 09:49:30,611", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-11 09:49:30,618", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-11 09:49:30,619", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 331.3s ago] {'pk_1': UUID('3835ce87-6451-4b0d-af15-de461b7e0068')}"}
{"asctime": "2025-11-11 09:49:30,621", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-11 09:49:30,621", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 331.3s ago] {'ai_response': \"I can assist you with buying airtime for 0763024043, but since your wallet balance is R0.00, you'll need to top up your wallet first. \\n\\nHow much would you like to add to your wallet? You can choose any amount, and then we can proceed with the airtime purchase!\", 'intent_detected': 'buy_airtime', 'entities_extracted': '{\"amount\": 763024043.0, \"phone\": \"0763024043\", \"network\": null}', 'confidence_score': 0.9, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 11, 7, 49, 30, 616720), 'conversations_id': UUID('3835ce87-6451-4b0d-af15-de461b7e0068')}"}
{"asctime": "2025-11-11 09:49:30,622", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-11 09:49:31,108", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-11 09:49:31,109", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SMea18abe6536f8f1ebdfbaa04eaadd328"}
{"asctime": "2025-11-11 09:51:13,529", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'SmsMessageSid': 'SM170ee85e1b6b230348d8a2d0fefc9b0f', 'NumMedia': '0', 'ProfileName': 'Hello World!', 'MessageType': 'text', 'SmsSid': 'SM170ee85e1b6b230348d8a2d0fefc9b0f', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': 'What\u2019s your name ?', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'SM170ee85e1b6b230348d8a2d0fefc9b0f', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-11-11 09:51:13,531", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763514028"}
{"asctime": "2025-11-11 09:51:13,548", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 09:51:13,551", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-11 09:51:13,552", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 506s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-11 09:51:13,555", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-11 09:51:13,555", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 506s ago] {'last_active_at': datetime.datetime(2025, 11, 11, 7, 51, 13, 554601), 'users_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-11 09:51:13,556", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-11 09:51:13,558", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 09:51:13,558", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-11 09:51:13,558", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 437.7s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-11 09:51:13,560", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-11 09:51:13,560", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 437.7s ago] {'id': UUID('293f751e-bd7d-4957-8ad8-c337d8f4ad0e'), 'user_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'phone_number': '+27763514028', 'message_id': 'SM170ee85e1b6b230348d8a2d0fefc9b0f', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'What\u2019s your name ?', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-11 09:51:13,561", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-11 09:51:13,562", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 09:51:13,562", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-11 09:51:13,562", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 437.7s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-11 09:51:13,563", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-11 09:51:13,563", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 437.7s ago] {'user_id_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'param_1': 5}"}
{"asctime": "2025-11-11 09:51:15,717", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-11 09:51:15,724", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-11 09:51:15,725", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 436.4s ago] {'pk_1': UUID('293f751e-bd7d-4957-8ad8-c337d8f4ad0e')}"}
{"asctime": "2025-11-11 09:51:15,726", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-11 09:51:15,726", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 436.4s ago] {'ai_response': \"I'm Cyrax, your friendly AI utility bill assistant! I'm here to help you with airtime, data bundles, electricity payments, and more. How can I assist you today?\", 'intent_detected': 'conversation', 'entities_extracted': '{}', 'confidence_score': 0.7, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 11, 7, 51, 15, 722969), 'conversations_id': UUID('293f751e-bd7d-4957-8ad8-c337d8f4ad0e')}"}
{"asctime": "2025-11-11 09:51:15,727", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-11 09:51:16,286", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-11 09:51:16,287", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SM522c270239f3665fdb3ce01cc445d32c"}
{"asctime": "2025-11-11 09:51:42,960", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'SmsMessageSid': 'SMf8d0b373ad341783875f872ed21b2ec1', 'NumMedia': '0', 'ProfileName': 'Hello World!', 'MessageType': 'text', 'SmsSid': 'SMf8d0b373ad341783875f872ed21b2ec1', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': 'Who created you', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'SMf8d0b373ad341783875f872ed21b2ec1', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-11-11 09:51:42,961", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763514028"}
{"asctime": "2025-11-11 09:51:42,963", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 09:51:42,964", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-11 09:51:42,965", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 535.4s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-11 09:51:42,967", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-11 09:51:42,967", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 535.4s ago] {'last_active_at': datetime.datetime(2025, 11, 11, 7, 51, 42, 966725), 'users_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-11 09:51:42,968", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-11 09:51:42,969", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 09:51:42,969", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-11 09:51:42,969", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 467.1s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-11 09:51:42,971", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-11 09:51:42,971", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 467.1s ago] {'id': UUID('83261215-a2b1-4fd8-9a46-ae70b0224eb6'), 'user_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'phone_number': '+27763514028', 'message_id': 'SMf8d0b373ad341783875f872ed21b2ec1', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'Who created you', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-11 09:51:42,973", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-11 09:51:42,974", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 09:51:42,974", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-11 09:51:42,974", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 467.2s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-11 09:51:42,975", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-11 09:51:42,976", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 467.1s ago] {'user_id_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'param_1': 5}"}
{"asctime": "2025-11-11 09:51:44,770", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-11 09:51:44,780", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-11 09:51:44,781", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 465.4s ago] {'pk_1': UUID('83261215-a2b1-4fd8-9a46-ae70b0224eb6')}"}
{"asctime": "2025-11-11 09:51:44,782", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-11 09:51:44,782", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 465.4s ago] {'ai_response': \"I was created by a team of developers who wanted to make it easier for people like you to manage utilities and mobile services. I'm here to help you with whatever you need! What's on your mind today?\", 'intent_detected': 'conversation', 'entities_extracted': '{}', 'confidence_score': 0.7, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 11, 7, 51, 44, 778663), 'conversations_id': UUID('83261215-a2b1-4fd8-9a46-ae70b0224eb6')}"}
{"asctime": "2025-11-11 09:51:44,783", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-11 09:51:45,298", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-11 09:51:45,298", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SM0ff4729839b14f1b08d4b4f2f27ffe17"}
{"asctime": "2025-11-11 09:53:17,020", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'MediaContentType0': 'image/jpeg', 'SmsMessageSid': 'MM835649f8fcdda0211335ec3fb36fa3fe', 'NumMedia': '1', 'ProfileName': 'Hello World!', 'MessageType': 'image', 'SmsSid': 'MM835649f8fcdda0211335ec3fb36fa3fe', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': 'Send 10 rand airtime to that number', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'MM835649f8fcdda0211335ec3fb36fa3fe', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'MediaUrl0': 'https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages/MM835649f8fcdda0211335ec3fb36fa3fe/Media/ME290852b6756a424b8ef357174afb8714', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-11-11 09:53:17,022", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Parsed image message with media: https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages/MM835649f8fcdda0211335ec3fb36fa3fe/Media/ME290852b6756a424b8ef357174afb8714"}
{"asctime": "2025-11-11 09:53:17,022", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing image message from +27763514028"}
{"asctime": "2025-11-11 09:53:17,024", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 09:53:17,025", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-11 09:53:17,025", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 629.5s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-11 09:53:17,027", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-11 09:53:17,027", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 629.5s ago] {'last_active_at': datetime.datetime(2025, 11, 11, 7, 53, 17, 27123), 'users_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-11 09:53:17,028", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-11 09:53:17,595", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: GET https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages/MM835649f8fcdda0211335ec3fb36fa3fe/Media/ME290852b6756a424b8ef357174afb8714 \"HTTP/1.1 307 Temporary Redirect\""}
{"asctime": "2025-11-11 09:53:18,191", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: GET https://mms.twiliocdn.com/AC6a10482bfc51f0846f64980cb7f1676e/ab6696518b5528b77f3be4f1fb58fc01?Expires=1762861997&Signature=SEu8QysSMfE2371XPBiqo5ZvtLSJ4NPid39MRhk1h~eOnIj1uaynKLTbFU4eI13AwMzKyny7IiZkSxwyJVQRJpXM77JT0u7yf9DVbB1k~-z2mBwLppa2rKDOukx2ei5nusNN1EJo3pr-hjKx7fAh6n82s9dvpYAb6J8FF-dLI~1oZI5njexDdwl31nSlanzWhf-MXvZa30E8vL9T6T2DmDpEBbs84ICJS1SY-Q6~0TAuZlQkOcNheMtkrzgaEjfW9BcNWB5hantTscfuIrG60HFhVdrh9JaJOAvXSyIvlCe7NngC767ijUhMpnwkhccrFTc-psWM8H6p~Z7jOuMcuQ__&Key-Pair-Id=APKAIRUDFXVKPONS3KUA \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-11 09:53:18,360", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Media downloaded: media/MM835649f8fcdda0211335ec3fb36fa3fe.jpg"}
{"asctime": "2025-11-11 09:53:18,381", "name": "app.services.ai_service", "levelname": "INFO", "message": "Processing image: media/MM835649f8fcdda0211335ec3fb36fa3fe.jpg"}
{"asctime": "2025-11-11 09:53:22,289", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-11 09:53:22,294", "name": "app.services.ai_service", "levelname": "INFO", "message": "Image processed successfully: {\"type\": \"phone_number\", \"phone_number\": \"+2349153238122\", \"provider\": \"Unknown\", \"confidence\": 0.95..."}
{"asctime": "2025-11-11 09:53:22,750", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-11 09:53:22,752", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SM7240518472f75d9f92cc3188eaaac72c"}
{"asctime": "2025-11-11 09:53:22,755", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 09:53:22,756", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-11 09:53:22,756", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 566.9s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-11 09:53:22,759", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-11 09:53:22,759", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 566.9s ago] {'id': UUID('5b84338c-2dd6-446b-8f01-bdd8c133746a'), 'user_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'phone_number': '+27763514028', 'message_id': 'MM835649f8fcdda0211335ec3fb36fa3fe', 'message_type': 'image', 'direction': 'inbound', 'message_text': 'buy airtime for +2349153238122', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-11 09:53:22,760", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-11 09:53:22,763", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 09:53:22,764", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-11 09:53:22,764", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 566.9s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-11 09:53:22,766", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-11 09:53:22,766", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 566.9s ago] {'user_id_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'param_1': 5}"}
{"asctime": "2025-11-11 09:53:24,918", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-11 09:53:24,931", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-11 09:53:24,931", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 565.6s ago] {'pk_1': UUID('5b84338c-2dd6-446b-8f01-bdd8c133746a')}"}
{"asctime": "2025-11-11 09:53:24,933", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-11 09:53:24,933", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 565.6s ago] {'ai_response': \"I can help you buy airtime, but it looks like that number is not a South African number. I can only assist with MTN, Vodacom, Cell C, or Telkom numbers in South Africa. \\n\\nIf you have a South African number you'd like to buy airtime for, please provide it!\", 'intent_detected': 'buy_airtime', 'entities_extracted': '{\"amount\": 2349153238122.0, \"phone\": null, \"network\": null}', 'confidence_score': 0.9, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 11, 7, 53, 24, 929752), 'conversations_id': UUID('5b84338c-2dd6-446b-8f01-bdd8c133746a')}"}
{"asctime": "2025-11-11 09:53:24,934", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-11 09:53:25,477", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-11 09:53:25,479", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SM7b9e1c89159c1d59988b82feff392755"}
{"asctime": "2025-11-11 09:54:32,184", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'MediaContentType0': 'audio/ogg', 'SmsMessageSid': 'MMcee235624a5cae01ea4a80879fddd236', 'NumMedia': '1', 'ProfileName': 'Hello World!', 'MessageType': 'audio', 'SmsSid': 'MMcee235624a5cae01ea4a80879fddd236', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': '', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'MMcee235624a5cae01ea4a80879fddd236', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'MediaUrl0': 'https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages/MMcee235624a5cae01ea4a80879fddd236/Media/MEdd3e2d548b202719acc015439422854d', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-11-11 09:54:32,185", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Parsed audio message with media: https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages/MMcee235624a5cae01ea4a80879fddd236/Media/MEdd3e2d548b202719acc015439422854d"}
{"asctime": "2025-11-11 09:54:32,186", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing audio message from +27763514028"}
{"asctime": "2025-11-11 09:54:32,188", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 09:54:32,188", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-11 09:54:32,188", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 704.6s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-11 09:54:32,190", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-11 09:54:32,190", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 704.6s ago] {'last_active_at': datetime.datetime(2025, 11, 11, 7, 54, 32, 189907), 'users_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-11 09:54:32,191", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-11 09:54:32,791", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: GET https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages/MMcee235624a5cae01ea4a80879fddd236/Media/MEdd3e2d548b202719acc015439422854d \"HTTP/1.1 307 Temporary Redirect\""}
{"asctime": "2025-11-11 09:54:33,822", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: GET https://mms.twiliocdn.com/AC6a10482bfc51f0846f64980cb7f1676e/5a96eae6c8a9a10d8313af8787dba84f?Expires=1762862072&Signature=In8GlETBhHvcKP6KPXrBKXWJM-DrBMvlEl2TP~uGY~OK76QHVVofU7qyuuoTE5WHkn8gHjobQ46lTrhpjMo5S-kh7ccPjPnvyessOTh9ZAMpa8KgMD9DkOLxH9Esc1WSL61V9l3xJ20TXcokCbQc-k85B24~tn4l1UNwjt88Bf8T2VrmjEN0lBgR84cD0gOFqTLIzSKvCDJU9Iwh40ZQ-Gs4eZdV4n4g5kzoqEzMGFtsPQvLhHHRNIvb2CpjhRxeOEX8uuQ6PT0Fg5AB898fHCoNdXYvYT4AIyDdzGOHPUVrTZ0jGwfMB4ijIBVVd1vDYuz9CwAa3yGXn3jiTUEixg__&Key-Pair-Id=APKAIRUDFXVKPONS3KUA \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-11 09:54:33,839", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Media downloaded: media/MMcee235624a5cae01ea4a80879fddd236.ogg"}
{"asctime": "2025-11-11 09:54:33,859", "name": "app.services.ai_service", "levelname": "INFO", "message": "Transcribing voice note: media/MMcee235624a5cae01ea4a80879fddd236.ogg"}
{"asctime": "2025-11-11 09:54:36,017", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/audio/transcriptions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-11 09:54:36,019", "name": "app.services.ai_service", "levelname": "INFO", "message": "Voice note transcribed successfully: Send 10 round airtime to 076 903 4491..."}
{"asctime": "2025-11-11 09:54:36,522", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-11 09:54:36,524", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SM8aadebb57acf715a32f770269853ee65"}
{"asctime": "2025-11-11 09:54:36,527", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 09:54:36,528", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-11 09:54:36,528", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 640.7s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-11 09:54:36,532", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-11 09:54:36,532", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 640.7s ago] {'id': UUID('6cd4c485-c9ff-4ff2-9926-0d8226e617a2'), 'user_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'phone_number': '+27763514028', 'message_id': 'MMcee235624a5cae01ea4a80879fddd236', 'message_type': 'audio', 'direction': 'inbound', 'message_text': 'Send 10 round airtime to 076 903 4491', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-11 09:54:36,533", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-11 09:54:36,535", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 09:54:36,536", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-11 09:54:36,536", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 640.7s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-11 09:54:36,538", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-11 09:54:36,538", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 640.7s ago] {'user_id_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'param_1': 5}"}
{"asctime": "2025-11-11 09:54:38,917", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-11 09:54:38,932", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-11 09:54:38,932", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 639.6s ago] {'pk_1': UUID('6cd4c485-c9ff-4ff2-9926-0d8226e617a2')}"}
{"asctime": "2025-11-11 09:54:38,934", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-11 09:54:38,934", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 639.6s ago] {'ai_response': 'Just to confirm, you want to buy R10 airtime for the number 076 903 4491, right? \\n\\nPlease note there\u2019s a small service fee of about 2-5%. Can you also provide your PIN for the transaction?', 'intent_detected': 'buy_airtime', 'entities_extracted': '{\"amount\": 10.0, \"phone\": \"0769034491\", \"network\": null}', 'confidence_score': 0.9, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 11, 7, 54, 38, 930389), 'conversations_id': UUID('6cd4c485-c9ff-4ff2-9926-0d8226e617a2')}"}
{"asctime": "2025-11-11 09:54:38,935", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-11 09:54:39,415", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-11 09:54:39,416", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SMf2f097704d5bc9b84d08d57a55985e98"}
{"asctime": "2025-11-11 09:56:16,351", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'SmsMessageSid': 'SM07aefcbdb5cf9c6807fcd4bcbde831c1', 'NumMedia': '0', 'ProfileName': 'Hello World!', 'MessageType': 'text', 'SmsSid': 'SM07aefcbdb5cf9c6807fcd4bcbde831c1', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': 'Who are you ?', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'SM07aefcbdb5cf9c6807fcd4bcbde831c1', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-11-11 09:56:16,352", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763514028"}
{"asctime": "2025-11-11 09:56:16,354", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 09:56:16,354", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-11 09:56:16,354", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 808.8s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-11 09:56:16,356", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-11 09:56:16,356", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 808.8s ago] {'last_active_at': datetime.datetime(2025, 11, 11, 7, 56, 16, 355815), 'users_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-11 09:56:16,356", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-11 09:56:16,358", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 09:56:16,358", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-11 09:56:16,358", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 740.5s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-11 09:56:16,359", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-11 09:56:16,359", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 740.5s ago] {'id': UUID('ad27d410-7943-4863-904a-41c5122d4211'), 'user_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'phone_number': '+27763514028', 'message_id': 'SM07aefcbdb5cf9c6807fcd4bcbde831c1', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'Who are you ?', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-11 09:56:16,360", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-11 09:56:16,361", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 09:56:16,361", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-11 09:56:16,361", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 740.5s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-11 09:56:16,362", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-11 09:56:16,363", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 740.5s ago] {'user_id_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'param_1': 5}"}
{"asctime": "2025-11-11 09:56:18,420", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-11 09:56:18,426", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-11 09:56:18,426", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 739.1s ago] {'pk_1': UUID('ad27d410-7943-4863-904a-41c5122d4211')}"}
{"asctime": "2025-11-11 09:56:18,428", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-11 09:56:18,428", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 739.1s ago] {'ai_response': \"I\u2019m Cyrax, your friendly utility bill assistant! I'm here to help you buy airtime, pay electricity bills, check your account balance, and more. Just let me know what you need, and I\u2019ll be happy to assist!\", 'intent_detected': 'conversation', 'entities_extracted': '{}', 'confidence_score': 0.7, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 11, 7, 56, 18, 424351), 'conversations_id': UUID('ad27d410-7943-4863-904a-41c5122d4211')}"}
{"asctime": "2025-11-11 09:56:18,429", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-11 09:56:18,982", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-11 09:56:18,984", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SMabfdcbba2790d9ae693b7544522d06f5"}
{"asctime": "2025-11-11 10:01:15,717", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'SmsMessageSid': 'SM515a4c31fe5c83d22cc39f3b62031fa8', 'NumMedia': '0', 'ProfileName': 'H', 'MessageType': 'text', 'SmsSid': 'SM515a4c31fe5c83d22cc39f3b62031fa8', 'WaId': '2349153238122', 'SmsStatus': 'received', 'Body': 'Hi', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'SM515a4c31fe5c83d22cc39f3b62031fa8', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"H\",\"WaId\":\"2349153238122\"}}}', 'From': 'whatsapp:+2349153238122', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-11-11 10:01:15,719", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +2349153238122"}
{"asctime": "2025-11-11 10:01:15,720", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 10:01:15,721", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-11 10:01:15,722", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 1108s ago] {'phone_number_1': '+2349153238122', 'param_1': 1}"}
{"asctime": "2025-11-11 10:01:15,726", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO users (id, phone_number, email, whatsapp_name, first_name, last_name, id_number, date_of_birth, nationality, address_line1, address_line2, city, province, postal_code, country, account_number, balance, status, pin_hash, pin_attempts, pin_locked_until, is_phone_verified, is_email_verified, is_id_verified, is_address_verified, is_fica_compliant, id_document_url, proof_of_residence_url, selfie_url, daily_limit, monthly_limit, daily_spent, monthly_spent, last_daily_reset, last_monthly_reset, preferred_language, notification_enabled, marketing_consent, user_metadata, referral_code, referred_by, created_at, updated_at, last_active_at, verified_at) VALUES (%(id)s::UUID, %(phone_number)s, %(email)s, %(whatsapp_name)s, %(first_name)s, %(last_name)s, %(id_number)s, %(date_of_birth)s, %(nationality)s, %(address_line1)s, %(address_line2)s, %(city)s, %(province)s, %(postal_code)s, %(country)s, %(account_number)s, %(balance)s, %(status)s, %(pin_hash)s, %(pin_attempts)s, %(pin_locked_until)s, %(is_phone_verified)s, %(is_email_verified)s, %(is_id_verified)s, %(is_address_verified)s, %(is_fica_compliant)s, %(id_document_url)s, %(proof_of_residence_url)s, %(selfie_url)s, %(daily_limit)s, %(monthly_limit)s, %(daily_spent)s, %(monthly_spent)s, now(), now(), %(preferred_language)s, %(notification_enabled)s, %(marketing_consent)s, %(user_metadata)s, %(referral_code)s, %(referred_by)s::UUID, now(), now(), now(), %(verified_at)s) RETURNING users.last_daily_reset, users.last_monthly_reset, users.created_at, users.updated_at, users.last_active_at"}
{"asctime": "2025-11-11 10:01:15,727", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00049s] {'id': UUID('042d1952-ed9e-4c16-8cea-f5954b854aff'), 'phone_number': '+2349153238122', 'email': None, 'whatsapp_name': 'H', 'first_name': None, 'last_name': None, 'id_number': None, 'date_of_birth': None, 'nationality': None, 'address_line1': None, 'address_line2': None, 'city': None, 'province': None, 'postal_code': None, 'country': 'South Africa', 'account_number': None, 'balance': 0.0, 'status': 'ACTIVE', 'pin_hash': None, 'pin_attempts': 0, 'pin_locked_until': None, 'is_phone_verified': False, 'is_email_verified': False, 'is_id_verified': False, 'is_address_verified': False, 'is_fica_compliant': False, 'id_document_url': None, 'proof_of_residence_url': None, 'selfie_url': None, 'daily_limit': 25000.0, 'monthly_limit': 100000.0, 'daily_spent': 0.0, 'monthly_spent': 0.0, 'preferred_language': 'en', 'notification_enabled': True, 'marketing_consent': False, 'user_metadata': '{}', 'referral_code': None, 'referred_by': None, 'verified_at': None}"}
{"asctime": "2025-11-11 10:01:15,729", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-11 10:01:15,730", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 10:01:15,732", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id, users.phone_number, users.email, users.whatsapp_name, users.first_name, users.last_name, users.id_number, users.date_of_birth, users.nationality, users.address_line1, users.address_line2, users.city, users.province, users.postal_code, users.country, users.account_number, users.balance, users.status, users.pin_hash, users.pin_attempts, users.pin_locked_until, users.is_phone_verified, users.is_email_verified, users.is_id_verified, users.is_address_verified, users.is_fica_compliant, users.id_document_url, users.proof_of_residence_url, users.selfie_url, users.daily_limit, users.monthly_limit, users.daily_spent, users.monthly_spent, users.last_daily_reset, users.last_monthly_reset, users.preferred_language, users.notification_enabled, users.marketing_consent, users.user_metadata, users.referral_code, users.referred_by, users.created_at, users.updated_at, users.last_active_at, users.verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-11 10:01:15,732", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00028s] {'pk_1': UUID('042d1952-ed9e-4c16-8cea-f5954b854aff')}"}
{"asctime": "2025-11-11 10:01:16,260", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-11 10:01:16,261", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +2349153238122: SMc33df1f0706d407eb3deda4f06075478"}
{"asctime": "2025-11-11 10:01:16,262", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "ROLLBACK"}
{"asctime": "2025-11-11 10:01:40,241", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'SmsMessageSid': 'SMd71aa4c0194d596f919499ca8040235e', 'NumMedia': '0', 'ProfileName': 'H', 'MessageType': 'text', 'SmsSid': 'SMd71aa4c0194d596f919499ca8040235e', 'WaId': '2349153238122', 'SmsStatus': 'received', 'Body': 'Buy airtime', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'SMd71aa4c0194d596f919499ca8040235e', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"H\",\"WaId\":\"2349153238122\"}}}', 'From': 'whatsapp:+2349153238122', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-11-11 10:01:40,242", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +2349153238122"}
{"asctime": "2025-11-11 10:01:40,246", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 10:01:40,247", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-11 10:01:40,247", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 1133s ago] {'phone_number_1': '+2349153238122', 'param_1': 1}"}
{"asctime": "2025-11-11 10:01:40,250", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-11 10:01:40,250", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 1133s ago] {'last_active_at': datetime.datetime(2025, 11, 11, 8, 1, 40, 249678), 'users_id': UUID('042d1952-ed9e-4c16-8cea-f5954b854aff')}"}
{"asctime": "2025-11-11 10:01:40,251", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-11 10:01:40,253", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 10:01:40,253", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-11 10:01:40,253", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 1064s ago] {'pk_1': UUID('042d1952-ed9e-4c16-8cea-f5954b854aff')}"}
{"asctime": "2025-11-11 10:01:40,255", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-11 10:01:40,255", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 1064s ago] {'id': UUID('77322f2e-635f-4496-8f22-fb316e55aeda'), 'user_id': UUID('042d1952-ed9e-4c16-8cea-f5954b854aff'), 'phone_number': '+2349153238122', 'message_id': 'SMd71aa4c0194d596f919499ca8040235e', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'Buy airtime', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-11 10:01:40,256", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-11 10:01:40,257", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 10:01:40,258", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-11 10:01:40,258", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 1064s ago] {'pk_1': UUID('042d1952-ed9e-4c16-8cea-f5954b854aff')}"}
{"asctime": "2025-11-11 10:01:40,260", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-11 10:01:40,260", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 1064s ago] {'user_id_1': UUID('042d1952-ed9e-4c16-8cea-f5954b854aff'), 'param_1': 5}"}
{"asctime": "2025-11-11 10:01:42,380", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-11 10:01:42,384", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-11 10:01:42,384", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 1063s ago] {'pk_1': UUID('77322f2e-635f-4496-8f22-fb316e55aeda')}"}
{"asctime": "2025-11-11 10:01:42,385", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-11 10:01:42,386", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 1063s ago] {'ai_response': \"It looks like your wallet balance is currently R0.00, so I can't help with buying airtime at the moment. Would you like to check your account balance or transaction history instead?\", 'intent_detected': 'buy_airtime', 'entities_extracted': '{\"amount\": null, \"phone\": null, \"network\": null}', 'confidence_score': 0.9, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 11, 8, 1, 42, 383723), 'conversations_id': UUID('77322f2e-635f-4496-8f22-fb316e55aeda')}"}
{"asctime": "2025-11-11 10:01:42,386", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-11 10:01:42,934", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-11 10:01:42,935", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +2349153238122: SMb1c0fff21a64055508210c4cef3479db"}
{"asctime": "2025-11-11 10:02:03,116", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'SmsMessageSid': 'SM60da3d917d64e426a9092c1b68991b9e', 'NumMedia': '0', 'ProfileName': 'H', 'MessageType': 'text', 'SmsSid': 'SM60da3d917d64e426a9092c1b68991b9e', 'WaId': '2349153238122', 'SmsStatus': 'received', 'Body': 'Account status', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'SM60da3d917d64e426a9092c1b68991b9e', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"H\",\"WaId\":\"2349153238122\"}}}', 'From': 'whatsapp:+2349153238122', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-11-11 10:02:03,116", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +2349153238122"}
{"asctime": "2025-11-11 10:02:03,117", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 10:02:03,117", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-11 10:02:03,117", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 1155s ago] {'phone_number_1': '+2349153238122', 'param_1': 1}"}
{"asctime": "2025-11-11 10:02:03,118", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-11 10:02:03,118", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 1155s ago] {'last_active_at': datetime.datetime(2025, 11, 11, 8, 2, 3, 118602), 'users_id': UUID('042d1952-ed9e-4c16-8cea-f5954b854aff')}"}
{"asctime": "2025-11-11 10:02:03,119", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-11 10:02:03,120", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 10:02:03,120", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-11 10:02:03,120", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 1087s ago] {'pk_1': UUID('042d1952-ed9e-4c16-8cea-f5954b854aff')}"}
{"asctime": "2025-11-11 10:02:03,121", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-11 10:02:03,121", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 1087s ago] {'id': UUID('3b85d3fb-bf32-4e0c-8820-2053b1b8279c'), 'user_id': UUID('042d1952-ed9e-4c16-8cea-f5954b854aff'), 'phone_number': '+2349153238122', 'message_id': 'SM60da3d917d64e426a9092c1b68991b9e', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'Account status', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-11 10:02:03,122", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-11 10:02:03,123", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 10:02:03,123", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-11 10:02:03,123", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 1087s ago] {'pk_1': UUID('042d1952-ed9e-4c16-8cea-f5954b854aff')}"}
{"asctime": "2025-11-11 10:02:03,126", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-11 10:02:03,126", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 1087s ago] {'user_id_1': UUID('042d1952-ed9e-4c16-8cea-f5954b854aff'), 'param_1': 5}"}
{"asctime": "2025-11-11 10:02:04,966", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-11 10:02:04,972", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-11 10:02:04,972", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 1086s ago] {'pk_1': UUID('3b85d3fb-bf32-4e0c-8820-2053b1b8279c')}"}
{"asctime": "2025-11-11 10:02:04,975", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-11 10:02:04,975", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 1086s ago] {'ai_response': \"Your current wallet balance is R0.00. It seems you don't have any funds available right now. Would you like help with anything else, like checking transaction history or planning a top-up?\", 'intent_detected': 'conversation', 'entities_extracted': '{}', 'confidence_score': 0.7, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 11, 8, 2, 4, 970114), 'conversations_id': UUID('3b85d3fb-bf32-4e0c-8820-2053b1b8279c')}"}
{"asctime": "2025-11-11 10:02:04,977", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-11 10:02:05,947", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-11 10:02:05,949", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +2349153238122: SM956b0dec652a7a6915260d045567d874"}
{"asctime": "2025-11-11 17:01:11,415", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'SmsMessageSid': 'SM0a2b08dd60bdd44ccde3dae45cfcedfd', 'NumMedia': '0', 'ProfileName': 'Hello World!', 'MessageType': 'text', 'SmsSid': 'SM0a2b08dd60bdd44ccde3dae45cfcedfd', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': 'Hi', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'SM0a2b08dd60bdd44ccde3dae45cfcedfd', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-11-11 17:01:11,417", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763514028"}
{"asctime": "2025-11-11 17:01:11,437", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 17:01:11,445", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-11 17:01:11,445", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 6179s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-11 17:01:11,451", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-11 17:01:11,451", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 6179s ago] {'last_active_at': datetime.datetime(2025, 11, 11, 15, 1, 11, 449828), 'users_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-11 17:01:11,454", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-11 17:01:11,456", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 17:01:11,456", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-11 17:01:11,456", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 6111s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-11 17:01:11,458", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-11 17:01:11,458", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 6111s ago] {'id': UUID('7ce22e51-a102-49cf-a6a4-9f72086c2f99'), 'user_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'phone_number': '+27763514028', 'message_id': 'SM0a2b08dd60bdd44ccde3dae45cfcedfd', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'Hi', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-11 17:01:11,459", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-11 17:01:11,460", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 17:01:11,460", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-11 17:01:11,460", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 6111s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-11 17:01:11,461", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-11 17:01:11,462", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 6111s ago] {'user_id_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'param_1': 5}"}
{"asctime": "2025-11-11 17:01:13,617", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-11 17:01:13,624", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-11 17:01:13,625", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 6110s ago] {'pk_1': UUID('7ce22e51-a102-49cf-a6a4-9f72086c2f99')}"}
{"asctime": "2025-11-11 17:01:13,626", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-11 17:01:13,627", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 6110s ago] {'ai_response': 'Hi there! How can I assist you today? \ud83d\ude0a', 'intent_detected': 'greeting', 'entities_extracted': '{}', 'confidence_score': 0.95, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 11, 15, 1, 13, 622974), 'conversations_id': UUID('7ce22e51-a102-49cf-a6a4-9f72086c2f99')}"}
{"asctime": "2025-11-11 17:01:13,628", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-11 17:01:14,265", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-11 17:01:14,266", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SM651f73f36c65eb290a44e77ee36acd89"}
{"asctime": "2025-11-11 17:01:14,766", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-11 17:01:14,767", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SM676cbf5c8ae21016125b3b17193649fd"}
{"asctime": "2025-11-11 17:04:23,802", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'MediaContentType0': 'image/jpeg', 'SmsMessageSid': 'MM53531d735c1f8308abbe699e9dd53682', 'NumMedia': '1', 'ProfileName': 'Hello World!', 'MessageType': 'image', 'SmsSid': 'MM53531d735c1f8308abbe699e9dd53682', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': 'Send r10 airtime', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'MM53531d735c1f8308abbe699e9dd53682', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'MediaUrl0': 'https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages/MM53531d735c1f8308abbe699e9dd53682/Media/ME9cb5e66406b94ba500a9b49d1fa86642', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-11-11 17:04:23,805", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Parsed image message with media: https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages/MM53531d735c1f8308abbe699e9dd53682/Media/ME9cb5e66406b94ba500a9b49d1fa86642"}
{"asctime": "2025-11-11 17:04:23,806", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing image message from +27763514028"}
{"asctime": "2025-11-11 17:04:23,812", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 17:04:23,813", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-11 17:04:23,814", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 6372s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-11 17:04:23,818", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-11 17:04:23,818", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 6372s ago] {'last_active_at': datetime.datetime(2025, 11, 11, 15, 4, 23, 817240), 'users_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-11 17:04:23,819", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-11 17:04:24,343", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: GET https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages/MM53531d735c1f8308abbe699e9dd53682/Media/ME9cb5e66406b94ba500a9b49d1fa86642 \"HTTP/1.1 307 Temporary Redirect\""}
{"asctime": "2025-11-11 17:04:25,025", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: GET https://mms.twiliocdn.com/AC6a10482bfc51f0846f64980cb7f1676e/71e25db0defb4059ed7d9ece801ff918?Expires=1762887864&Signature=ed4g0QwjyKNna-OQWGmZZZAC6OpexPwkHEyKHLMSlrnNCTH5UTkcIw--NWPVkhcgPuUQeSJ8LsqTW6KEEGBTc6XS84l~OoSEW~CENqE0dQzPX9~S7CyyJN8jXLpfJR42-7qS8ZQ5ObskWHYwCJoQH7nBlfM7i6GkagWL42m5MBuDxJwZVLlyZucXNItEGrbJgj-wCnNMe7XrxO5hNhWkoexL1V-VbKXeHOekP~N20jo7xZ8G9aGA4ccdOhdQ95NWJKJODfV6xK-wPEoDehQydVMhCML1tlk7uI-96zPjvYZGSEl0NJGr7NalUvHqmSrPmCq-yAp-qfU9pwlnROC8dw__&Key-Pair-Id=APKAIRUDFXVKPONS3KUA \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-11 17:04:25,147", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Media downloaded: media/MM53531d735c1f8308abbe699e9dd53682.jpg"}
{"asctime": "2025-11-11 17:04:25,175", "name": "app.services.ai_service", "levelname": "INFO", "message": "Processing image: media/MM53531d735c1f8308abbe699e9dd53682.jpg"}
{"asctime": "2025-11-11 17:04:29,344", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-11 17:04:29,349", "name": "app.services.ai_service", "levelname": "INFO", "message": "Image processed successfully: {\"type\": \"phone_number\", \"phone_number\": \"0739151447\", \"provider\": \"Unknown\", \"confidence\": 0.95, \"d..."}
{"asctime": "2025-11-11 17:04:29,867", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-11 17:04:29,867", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SMbd3292582f96cde139feb7d30b61f02a"}
{"asctime": "2025-11-11 17:04:29,868", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 17:04:29,869", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-11 17:04:29,869", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 6310s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-11 17:04:29,870", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-11 17:04:29,870", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 6310s ago] {'id': UUID('a6acbb46-7d36-48c1-952f-0fb1e827be60'), 'user_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'phone_number': '+27763514028', 'message_id': 'MM53531d735c1f8308abbe699e9dd53682', 'message_type': 'image', 'direction': 'inbound', 'message_text': 'buy airtime for 0739151447', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-11 17:04:29,870", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-11 17:04:29,871", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 17:04:29,871", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-11 17:04:29,871", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 6310s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-11 17:04:29,872", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-11 17:04:29,872", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 6310s ago] {'user_id_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'param_1': 5}"}
{"asctime": "2025-11-11 17:04:32,657", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-11 17:04:32,664", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-11 17:04:32,664", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 6309s ago] {'pk_1': UUID('a6acbb46-7d36-48c1-952f-0fb1e827be60')}"}
{"asctime": "2025-11-11 17:04:32,666", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-11 17:04:32,666", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 6309s ago] {'ai_response': 'How much airtime would you like to buy for the number 073 915 1447? You can choose between R5 and R1000. Just let me know!', 'intent_detected': 'buy_airtime', 'entities_extracted': '{\"amount\": 739151447.0, \"phone\": \"0739151447\", \"network\": null}', 'confidence_score': 0.9, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 11, 15, 4, 32, 662136), 'conversations_id': UUID('a6acbb46-7d36-48c1-952f-0fb1e827be60')}"}
{"asctime": "2025-11-11 17:04:32,670", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-11 17:04:33,393", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-11 17:04:33,394", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SM3422119dd5b900f4d1ee1c3e9f8fa2e1"}
{"asctime": "2025-11-11 17:04:46,799", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'SmsMessageSid': 'SM606c3475fe94e08fcb655b40dc482442', 'NumMedia': '0', 'ProfileName': 'Hello World!', 'MessageType': 'text', 'SmsSid': 'SM606c3475fe94e08fcb655b40dc482442', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': '5', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'SM606c3475fe94e08fcb655b40dc482442', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-11-11 17:04:46,799", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763514028"}
{"asctime": "2025-11-11 17:04:46,800", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 17:04:46,800", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-11 17:04:46,800", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 6395s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-11 17:04:46,801", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-11 17:04:46,801", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 6395s ago] {'last_active_at': datetime.datetime(2025, 11, 11, 15, 4, 46, 801314), 'users_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-11 17:04:46,801", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-11 17:04:46,802", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 17:04:46,803", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-11 17:04:46,803", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 6326s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-11 17:04:46,803", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-11 17:04:46,804", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 6326s ago] {'id': UUID('692591ba-805e-404a-bcd1-f903529014fd'), 'user_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'phone_number': '+27763514028', 'message_id': 'SM606c3475fe94e08fcb655b40dc482442', 'message_type': 'text', 'direction': 'inbound', 'message_text': '5', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-11 17:04:46,804", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-11 17:04:46,805", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 17:04:46,805", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-11 17:04:46,805", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 6326s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-11 17:04:46,805", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-11 17:04:46,806", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 6326s ago] {'user_id_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'param_1': 5}"}
{"asctime": "2025-11-11 17:04:49,195", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-11 17:04:49,202", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-11 17:04:49,203", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 6325s ago] {'pk_1': UUID('692591ba-805e-404a-bcd1-f903529014fd')}"}
{"asctime": "2025-11-11 17:04:49,204", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-11 17:04:49,205", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 6325s ago] {'ai_response': \"Just to confirm, you'd like to buy R5 airtime for the number 073 915 1447. \\n\\nPlease note that there will be a small service fee of around 2-5%. \\n\\nCan you please provide your PIN to proceed?\", 'intent_detected': 'conversation', 'entities_extracted': '{}', 'confidence_score': 0.7, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 11, 15, 4, 49, 200984), 'conversations_id': UUID('692591ba-805e-404a-bcd1-f903529014fd')}"}
{"asctime": "2025-11-11 17:04:49,206", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-11 17:04:49,733", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-11 17:04:49,734", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SMd4977c80e021e1d455511f4ad339051e"}
{"asctime": "2025-11-11 17:05:01,777", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'SmsMessageSid': 'SMe781b9b1c1c9cc2fe1ff776d306049c6', 'NumMedia': '0', 'ProfileName': 'Hello World!', 'MessageType': 'text', 'SmsSid': 'SMe781b9b1c1c9cc2fe1ff776d306049c6', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': '5691', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'SMe781b9b1c1c9cc2fe1ff776d306049c6', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-11-11 17:05:01,778", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763514028"}
{"asctime": "2025-11-11 17:05:01,779", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 17:05:01,780", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-11 17:05:01,780", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 6410s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-11 17:05:01,781", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-11 17:05:01,781", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 6410s ago] {'last_active_at': datetime.datetime(2025, 11, 11, 15, 5, 1, 781260), 'users_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-11 17:05:01,782", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-11 17:05:01,783", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 17:05:01,783", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-11 17:05:01,783", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 6341s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-11 17:05:01,784", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-11 17:05:01,784", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 6341s ago] {'id': UUID('58279271-7607-40df-87c1-47759eb1dc28'), 'user_id': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'phone_number': '+27763514028', 'message_id': 'SMe781b9b1c1c9cc2fe1ff776d306049c6', 'message_type': 'text', 'direction': 'inbound', 'message_text': '5691', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-11 17:05:01,785", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-11 17:05:01,785", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 17:05:01,785", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-11 17:05:01,786", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 6341s ago] {'pk_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac')}"}
{"asctime": "2025-11-11 17:05:01,787", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-11 17:05:01,787", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 6341s ago] {'user_id_1': UUID('d55d888e-4ff5-49b4-9d97-795cff228fac'), 'param_1': 5}"}
{"asctime": "2025-11-11 17:05:05,453", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-11 17:05:05,476", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-11 17:05:05,476", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 6342s ago] {'pk_1': UUID('58279271-7607-40df-87c1-47759eb1dc28')}"}
{"asctime": "2025-11-11 17:05:05,478", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-11 17:05:05,478", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 6342s ago] {'ai_response': \"Thanks for sharing your PIN! However, I noticed that your wallet balance is currently R0.00, so you won't be able to make this purchase right now. \\n\\nWould you like to check anything else or need assistance with something different? \ud83d\ude0a\", 'intent_detected': 'conversation', 'entities_extracted': '{}', 'confidence_score': 0.7, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 11, 15, 5, 5, 474473), 'conversations_id': UUID('58279271-7607-40df-87c1-47759eb1dc28')}"}
{"asctime": "2025-11-11 17:05:05,479", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-11 17:05:06,513", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-11 17:05:06,515", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SM8a31954c84d45c67ea63b17d4c3d88ac"}
{"asctime": "2025-11-11 17:24:07,426", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-11-11 17:24:08,070", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-11-11 17:24:08,070", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-11-11 17:24:08,148", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-11-11 17:24:08,149", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-11 17:24:08,149", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-11-11 17:24:08,149", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-11 17:24:08,150", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-11-11 17:24:08,150", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-11 17:24:08,151", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 17:24:08,152", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-11 17:24:08,152", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00012s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-11 17:24:08,154", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-11 17:24:08,154", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001834s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-11 17:24:08,154", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-11 17:24:08,154", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.00218s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-11 17:24:08,155", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-11 17:24:08,155", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00009s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-11 17:24:08,155", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-11 17:24:08,155", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0006268s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-11 17:24:08,156", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-11 17:24:08,156", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.00106s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-11 17:24:08,156", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-11 17:24:08,156", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-11-11 17:24:08,156", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-11-11 17:24:08,156", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-11-11 17:24:20,994", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-11-11 17:24:21,492", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-11-11 17:24:21,492", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-11-11 17:24:21,510", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-11-11 17:24:21,510", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-11 17:24:21,511", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-11-11 17:24:21,511", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-11 17:24:21,511", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-11-11 17:24:21,511", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-11 17:24:21,512", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 17:24:21,513", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-11 17:24:21,513", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00009s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-11 17:24:21,515", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-11 17:24:21,515", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002293s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-11 17:24:21,516", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-11 17:24:21,516", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002738s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-11 17:24:21,516", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-11 17:24:21,516", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00007s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-11 17:24:21,517", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-11 17:24:21,517", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0006264s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-11 17:24:21,521", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-11 17:24:21,521", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.004857s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-11 17:24:21,524", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-11 17:24:21,524", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-11-11 17:24:21,524", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-11-11 17:24:21,524", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-11-11 17:26:48,923", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-11-11 17:26:58,019", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-11-11 17:26:58,019", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-11-11 17:26:58,034", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-11-11 17:26:58,034", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-11 17:26:58,035", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-11-11 17:26:58,035", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-11 17:26:58,035", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-11-11 17:26:58,035", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-11 17:26:58,036", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 17:26:58,037", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-11 17:26:58,037", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00009s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-11 17:26:58,040", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-11 17:26:58,040", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002617s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-11 17:26:58,040", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-11 17:26:58,040", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.003108s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-11 17:26:58,041", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-11 17:26:58,041", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00006s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-11 17:26:58,042", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-11 17:26:58,042", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0006136s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-11 17:26:58,042", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-11 17:26:58,042", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001253s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-11 17:26:58,043", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-11 17:26:58,043", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-11-11 17:26:58,043", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-11-11 17:26:58,043", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-11-11 17:29:54,903", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-11-11 17:29:55,502", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-11-11 17:29:55,502", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-11-11 17:29:55,517", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-11-11 17:29:55,517", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-11 17:29:55,518", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-11-11 17:29:55,518", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-11 17:29:55,518", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-11-11 17:29:55,518", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-11 17:29:55,518", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 17:29:55,519", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-11 17:29:55,520", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00009s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-11 17:29:55,522", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-11 17:29:55,522", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002317s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-11 17:29:55,522", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-11 17:29:55,522", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.00283s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-11 17:29:55,523", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-11 17:29:55,523", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00007s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-11 17:29:55,524", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-11 17:29:55,524", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0006549s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-11 17:29:55,524", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-11 17:29:55,525", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001297s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-11 17:29:55,525", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-11 17:29:55,525", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-11-11 17:29:55,525", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-11-11 17:29:55,525", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-11-11 17:30:13,128", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'SmsMessageSid': 'SMa18115037f9db1462b96ed7fbd995b9e', 'NumMedia': '0', 'ProfileName': 'Hello World!', 'MessageType': 'text', 'SmsSid': 'SMa18115037f9db1462b96ed7fbd995b9e', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': 'Hi', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'SMa18115037f9db1462b96ed7fbd995b9e', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-11-11 17:30:13,129", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763514028"}
{"asctime": "2025-11-11 17:30:13,135", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 17:30:13,138", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-11 17:30:13,139", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00035s] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-11 17:30:14,285", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-11 17:30:14,286", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SM629956dfd582295f5b22dc55f455b086"}
{"asctime": "2025-11-11 17:30:14,287", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "ROLLBACK"}
{"asctime": "2025-11-11 17:30:23,435", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'SmsMessageSid': 'SM440b86adadcd109000cbdfc8eebe2fad', 'NumMedia': '0', 'ProfileName': 'Hello World!', 'MessageType': 'text', 'SmsSid': 'SM440b86adadcd109000cbdfc8eebe2fad', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': 'Register', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'SM440b86adadcd109000cbdfc8eebe2fad', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-11-11 17:30:23,435", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763514028"}
{"asctime": "2025-11-11 17:30:23,436", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 17:30:23,437", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-11 17:30:23,437", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 10.3s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-11 17:30:23,974", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-11 17:30:23,976", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SM5ac85d31e48287724d5e00c1a41405a4"}
{"asctime": "2025-11-11 17:30:23,977", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "ROLLBACK"}
{"asctime": "2025-11-11 17:45:08,899", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'SmsMessageSid': 'SMc680023f1d6ccaccdd6fe0115f699608', 'NumMedia': '0', 'ProfileName': 'Hello World!', 'MessageType': 'text', 'SmsSid': 'SMc680023f1d6ccaccdd6fe0115f699608', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': 'Kelvin Cole 9001011234567 5691', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'SMc680023f1d6ccaccdd6fe0115f699608', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-11-11 17:45:08,901", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763514028"}
{"asctime": "2025-11-11 17:45:08,906", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 17:45:08,907", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-11 17:45:08,908", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 895.8s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-11 17:45:09,506", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-11 17:45:09,508", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SM0e85a89b236bef66f35e5d40d63c5b25"}
{"asctime": "2025-11-11 17:45:09,509", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "ROLLBACK"}
{"asctime": "2025-11-11 17:45:24,442", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'SmsMessageSid': 'SM210addfd86dbcde6f072b908bed84ebc', 'NumMedia': '0', 'ProfileName': 'Hello World!', 'MessageType': 'text', 'SmsSid': 'SM210addfd86dbcde6f072b908bed84ebc', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': 'Register Kelvin Cole 9001011234567 5691', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'SM210addfd86dbcde6f072b908bed84ebc', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-11-11 17:45:24,443", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763514028"}
{"asctime": "2025-11-11 17:45:24,444", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 17:45:24,445", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-11 17:45:24,445", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 911.4s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-11 17:45:24,447", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-11 17:45:24,447", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 911.4s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-11 17:45:25,170", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-11 17:45:25,172", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SM74b28bddc89503f9ea966c1e64e97a34"}
{"asctime": "2025-11-11 17:45:25,173", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "ROLLBACK"}
{"asctime": "2025-11-11 17:45:31,821", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'SmsMessageSid': 'SM6ad0d035a2fa1c61aac5fa025f74329b', 'NumMedia': '0', 'ProfileName': 'Hello World!', 'MessageType': 'text', 'SmsSid': 'SM6ad0d035a2fa1c61aac5fa025f74329b', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': 'Hi', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'SM6ad0d035a2fa1c61aac5fa025f74329b', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-11-11 17:45:31,823", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763514028"}
{"asctime": "2025-11-11 17:45:31,824", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 17:45:31,825", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-11 17:45:31,825", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 918.8s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-11 17:45:32,342", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-11 17:45:32,343", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SMf5ddf8aa8cbc513ed22d7b6da4840ef5"}
{"asctime": "2025-11-11 17:45:32,344", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "ROLLBACK"}
{"asctime": "2025-11-11 17:45:41,320", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'SmsMessageSid': 'SM32cf3d14c8f13de5a1a7f07eacf1e273', 'NumMedia': '0', 'ProfileName': 'Hello World!', 'MessageType': 'text', 'SmsSid': 'SM32cf3d14c8f13de5a1a7f07eacf1e273', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': 'Buy airtime', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'SM32cf3d14c8f13de5a1a7f07eacf1e273', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-11-11 17:45:41,321", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763514028"}
{"asctime": "2025-11-11 17:45:41,322", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-11 17:45:41,323", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-11 17:45:41,323", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 928.3s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-11 17:45:41,813", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-11 17:45:41,815", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SM083043e0c52508279983f20257874741"}
{"asctime": "2025-11-11 17:45:41,816", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "ROLLBACK"}
{"asctime": "2025-11-13 04:31:15,674", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-11-13 04:31:16,702", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-11-13 04:31:16,702", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-11-13 04:31:16,814", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-11-13 04:31:16,814", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 04:31:16,816", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-11-13 04:31:16,816", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 04:31:16,817", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-11-13 04:31:16,817", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 04:31:16,818", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 04:31:16,820", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 04:31:16,820", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00016s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 04:31:16,821", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 04:31:16,821", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001636s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 04:31:16,822", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 04:31:16,822", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.00218s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 04:31:16,823", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 04:31:16,823", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00010s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 04:31:16,824", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 04:31:16,824", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0009158s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 04:31:16,824", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 04:31:16,824", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.00158s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 04:31:16,825", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 04:31:16,825", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-11-13 04:31:16,825", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-11-13 04:31:16,825", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-11-13 04:31:39,169", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'SmsMessageSid': 'SM74c9aa45bb35480e9928716e8fbacb93', 'NumMedia': '0', 'ProfileName': 'Hello World!', 'MessageType': 'text', 'SmsSid': 'SM74c9aa45bb35480e9928716e8fbacb93', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': 'Hi', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'SM74c9aa45bb35480e9928716e8fbacb93', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-11-13 04:31:39,170", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763514028"}
{"asctime": "2025-11-13 04:31:39,178", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 04:31:39,181", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 04:31:39,181", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00030s] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-13 04:31:40,183", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-13 04:31:40,184", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SM871393069748a8d26f75786001dadb6b"}
{"asctime": "2025-11-13 04:31:40,184", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "ROLLBACK"}
{"asctime": "2025-11-13 04:31:53,353", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'SmsMessageSid': 'SMdd1f40e839c6b114dfaa1764e9ed10aa', 'NumMedia': '0', 'ProfileName': 'Hello World!', 'MessageType': 'text', 'SmsSid': 'SMdd1f40e839c6b114dfaa1764e9ed10aa', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': 'Register', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'SMdd1f40e839c6b114dfaa1764e9ed10aa', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-11-13 04:31:53,354", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763514028"}
{"asctime": "2025-11-13 04:31:53,355", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 04:31:53,356", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 04:31:53,356", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 14.18s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-13 04:31:54,245", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-13 04:31:54,248", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SM83d02dea1c6a16fd19e81432d2695c89"}
{"asctime": "2025-11-13 04:31:54,249", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "ROLLBACK"}
{"asctime": "2025-11-13 04:34:07,817", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-11-13 04:34:08,399", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-11-13 04:34:08,399", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-11-13 04:34:08,424", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-11-13 04:34:08,424", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 04:34:08,425", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-11-13 04:34:08,425", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 04:34:08,426", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-11-13 04:34:08,426", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 04:34:08,426", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 04:34:08,427", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 04:34:08,427", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00009s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 04:34:08,430", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 04:34:08,430", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002758s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 04:34:08,430", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 04:34:08,430", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.003135s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 04:34:08,431", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 04:34:08,431", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00008s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 04:34:08,432", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 04:34:08,432", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0006668s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 04:34:08,432", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 04:34:08,432", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001195s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 04:34:08,433", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 04:34:08,433", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-11-13 04:34:08,433", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-11-13 04:34:08,433", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-11-13 04:34:27,733", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-11-13 04:34:28,240", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-11-13 04:34:28,240", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-11-13 04:34:28,258", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-11-13 04:34:28,258", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 04:34:28,259", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-11-13 04:34:28,259", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 04:34:28,259", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-11-13 04:34:28,259", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 04:34:28,260", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 04:34:28,262", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 04:34:28,262", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00014s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 04:34:28,263", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 04:34:28,263", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001601s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 04:34:28,264", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 04:34:28,264", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002181s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 04:34:28,264", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 04:34:28,265", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00007s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 04:34:28,265", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 04:34:28,265", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0006298s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 04:34:28,266", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 04:34:28,266", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.00112s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 04:34:28,266", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 04:34:28,266", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-11-13 04:34:28,266", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-11-13 04:34:28,266", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-11-13 04:34:39,726", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'SmsMessageSid': 'SM6faddb61d9a583ae177c7111cb2101e5', 'NumMedia': '0', 'ProfileName': 'Hello World!', 'MessageType': 'text', 'SmsSid': 'SM6faddb61d9a583ae177c7111cb2101e5', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': 'Hi', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'SM6faddb61d9a583ae177c7111cb2101e5', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-11-13 04:34:39,727", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763514028"}
{"asctime": "2025-11-13 04:34:39,736", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 04:34:39,739", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 04:34:39,739", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00025s] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-13 04:34:40,691", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-13 04:34:40,693", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SMa3083c2fa6c2dc97601784139949a232"}
{"asctime": "2025-11-13 04:34:40,694", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "ROLLBACK"}
{"asctime": "2025-11-13 04:34:47,899", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'SmsMessageSid': 'SMe5b94baebf534b92b89be51eeee91b56', 'NumMedia': '0', 'ProfileName': 'Hello World!', 'MessageType': 'text', 'SmsSid': 'SMe5b94baebf534b92b89be51eeee91b56', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': 'Register', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'SMe5b94baebf534b92b89be51eeee91b56', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-11-13 04:34:47,899", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763514028"}
{"asctime": "2025-11-13 04:34:47,901", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 04:34:47,901", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 04:34:47,901", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 8.163s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-13 04:34:48,403", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-13 04:34:48,404", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SMfd949e922d2aa197d86b477d102cc6a6"}
{"asctime": "2025-11-13 04:34:48,405", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "ROLLBACK"}
{"asctime": "2025-11-13 04:35:12,777", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'SmsMessageSid': 'SM5ce2a64f30039d7d0e4b7d277c379566', 'NumMedia': '0', 'ProfileName': 'Hello World!', 'MessageType': 'text', 'SmsSid': 'SM5ce2a64f30039d7d0e4b7d277c379566', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': 'REGISTER Kelvin Cole 9001011234567', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'SM5ce2a64f30039d7d0e4b7d277c379566', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-11-13 04:35:12,778", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763514028"}
{"asctime": "2025-11-13 04:35:12,779", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 04:35:12,780", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 04:35:12,780", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 33.04s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-13 04:35:12,782", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 04:35:12,782", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 33.04s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-13 04:35:13,389", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-13 04:35:13,391", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SMf3adb05f9b961bbce41cf565a7d7e10d"}
{"asctime": "2025-11-13 04:35:13,392", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "ROLLBACK"}
{"asctime": "2025-11-13 04:35:20,222", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'SmsMessageSid': 'SM1857878fcc8044699083d667654cdc66', 'NumMedia': '0', 'ProfileName': 'Hello World!', 'MessageType': 'text', 'SmsSid': 'SM1857878fcc8044699083d667654cdc66', 'WaId': '27763514028', 'SmsStatus': 'received', 'Body': 'Hi', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'SM1857878fcc8044699083d667654cdc66', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World!\",\"WaId\":\"27763514028\"}}}', 'From': 'whatsapp:+27763514028', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-11-13 04:35:20,223", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763514028"}
{"asctime": "2025-11-13 04:35:20,224", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 04:35:20,225", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 04:35:20,225", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 40.49s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-13 04:35:20,797", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-13 04:35:20,799", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763514028: SM878717ed1e40f0d283ffad0ed5b0b2d0"}
{"asctime": "2025-11-13 04:35:20,800", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "ROLLBACK"}
{"asctime": "2025-11-13 04:36:07,560", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'SmsMessageSid': 'SM3a4d021e2d176855a0b28ffa5e9d89db', 'NumMedia': '0', 'ProfileName': 'Hello World', 'MessageType': 'text', 'SmsSid': 'SM3a4d021e2d176855a0b28ffa5e9d89db', 'WaId': '27763024044', 'SmsStatus': 'received', 'Body': 'Hi', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'SM3a4d021e2d176855a0b28ffa5e9d89db', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World\",\"WaId\":\"27763024044\"}}}', 'From': 'whatsapp:+27763024044', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-11-13 04:36:07,561", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763024044"}
{"asctime": "2025-11-13 04:36:07,563", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 04:36:07,563", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 04:36:07,563", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 87.83s ago] {'phone_number_1': '+27763024044', 'param_1': 1}"}
{"asctime": "2025-11-13 04:36:07,576", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO users (id, phone_number, email, whatsapp_name, first_name, last_name, id_number, date_of_birth, nationality, address_line1, address_line2, city, province, postal_code, country, account_number, balance, status, pin_hash, pin_attempts, pin_locked_until, is_phone_verified, is_email_verified, is_id_verified, is_address_verified, is_fica_compliant, id_document_url, proof_of_residence_url, selfie_url, daily_limit, monthly_limit, daily_spent, monthly_spent, last_daily_reset, last_monthly_reset, preferred_language, notification_enabled, marketing_consent, user_metadata, referral_code, referred_by, created_at, updated_at, last_active_at, verified_at) VALUES (%(id)s::UUID, %(phone_number)s, %(email)s, %(whatsapp_name)s, %(first_name)s, %(last_name)s, %(id_number)s, %(date_of_birth)s, %(nationality)s, %(address_line1)s, %(address_line2)s, %(city)s, %(province)s, %(postal_code)s, %(country)s, %(account_number)s, %(balance)s, %(status)s, %(pin_hash)s, %(pin_attempts)s, %(pin_locked_until)s, %(is_phone_verified)s, %(is_email_verified)s, %(is_id_verified)s, %(is_address_verified)s, %(is_fica_compliant)s, %(id_document_url)s, %(proof_of_residence_url)s, %(selfie_url)s, %(daily_limit)s, %(monthly_limit)s, %(daily_spent)s, %(monthly_spent)s, now(), now(), %(preferred_language)s, %(notification_enabled)s, %(marketing_consent)s, %(user_metadata)s, %(referral_code)s, %(referred_by)s::UUID, now(), now(), now(), %(verified_at)s) RETURNING users.last_daily_reset, users.last_monthly_reset, users.created_at, users.updated_at, users.last_active_at"}
{"asctime": "2025-11-13 04:36:07,576", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00088s] {'id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'phone_number': '+27763024044', 'email': None, 'whatsapp_name': 'Hello World', 'first_name': None, 'last_name': None, 'id_number': None, 'date_of_birth': None, 'nationality': None, 'address_line1': None, 'address_line2': None, 'city': None, 'province': None, 'postal_code': None, 'country': 'South Africa', 'account_number': None, 'balance': 0.0, 'status': 'PENDING_VERIFICATION', 'pin_hash': None, 'pin_attempts': 0, 'pin_locked_until': None, 'is_phone_verified': False, 'is_email_verified': False, 'is_id_verified': False, 'is_address_verified': False, 'is_fica_compliant': False, 'id_document_url': None, 'proof_of_residence_url': None, 'selfie_url': None, 'daily_limit': 25000.0, 'monthly_limit': 100000.0, 'daily_spent': 0.0, 'monthly_spent': 0.0, 'preferred_language': 'en', 'notification_enabled': True, 'marketing_consent': False, 'user_metadata': '{}', 'referral_code': None, 'referred_by': None, 'verified_at': None}"}
{"asctime": "2025-11-13 04:36:07,581", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 04:36:07,584", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 04:36:07,585", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id, users.phone_number, users.email, users.whatsapp_name, users.first_name, users.last_name, users.id_number, users.date_of_birth, users.nationality, users.address_line1, users.address_line2, users.city, users.province, users.postal_code, users.country, users.account_number, users.balance, users.status, users.pin_hash, users.pin_attempts, users.pin_locked_until, users.is_phone_verified, users.is_email_verified, users.is_id_verified, users.is_address_verified, users.is_fica_compliant, users.id_document_url, users.proof_of_residence_url, users.selfie_url, users.daily_limit, users.monthly_limit, users.daily_spent, users.monthly_spent, users.last_daily_reset, users.last_monthly_reset, users.preferred_language, users.notification_enabled, users.marketing_consent, users.user_metadata, users.referral_code, users.referred_by, users.created_at, users.updated_at, users.last_active_at, users.verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 04:36:07,585", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00022s] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 04:36:08,173", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-13 04:36:08,175", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763024044: SM2f5944d4dfa82dc3b06ea830422e2d1f"}
{"asctime": "2025-11-13 04:36:08,176", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "ROLLBACK"}
{"asctime": "2025-11-13 04:36:24,135", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'SmsMessageSid': 'SM642b569e5f841535a49314e123bc8a5b', 'NumMedia': '0', 'ProfileName': 'Hello World', 'MessageType': 'text', 'SmsSid': 'SM642b569e5f841535a49314e123bc8a5b', 'WaId': '27763024044', 'SmsStatus': 'received', 'Body': 'Yes', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'SM642b569e5f841535a49314e123bc8a5b', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World\",\"WaId\":\"27763024044\"}}}', 'From': 'whatsapp:+27763024044', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-11-13 04:36:24,136", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763024044"}
{"asctime": "2025-11-13 04:36:24,138", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 04:36:24,138", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 04:36:24,138", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 104.4s ago] {'phone_number_1': '+27763024044', 'param_1': 1}"}
{"asctime": "2025-11-13 04:36:24,575", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-13 04:36:24,576", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763024044: SM0a29c62e229decd6b228ee1d515a79d7"}
{"asctime": "2025-11-13 04:36:24,577", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "ROLLBACK"}
{"asctime": "2025-11-13 04:36:49,382", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'SmsMessageSid': 'SMf22529f5fe98f2d8d68d4a1b4ea60aa0', 'NumMedia': '0', 'ProfileName': 'Hello World', 'MessageType': 'text', 'SmsSid': 'SMf22529f5fe98f2d8d68d4a1b4ea60aa0', 'WaId': '27763024044', 'SmsStatus': 'received', 'Body': 'REGISTER SAM ALTMAN\\n9001011234567', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'SMf22529f5fe98f2d8d68d4a1b4ea60aa0', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World\",\"WaId\":\"27763024044\"}}}', 'From': 'whatsapp:+27763024044', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-11-13 04:36:49,384", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763024044"}
{"asctime": "2025-11-13 04:36:49,385", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 04:36:49,386", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 04:36:49,386", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 129.6s ago] {'phone_number_1': '+27763024044', 'param_1': 1}"}
{"asctime": "2025-11-13 04:36:49,388", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 04:36:49,388", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 129.6s ago] {'phone_number_1': '+27763024044', 'param_1': 1}"}
{"asctime": "2025-11-13 04:36:49,391", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id_number = %(id_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 04:36:49,391", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00040s] {'id_number_1': '9001011234567', 'param_1': 1}"}
{"asctime": "2025-11-13 04:36:49,398", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET first_name=%(first_name)s, last_name=%(last_name)s, id_number=%(id_number)s, date_of_birth=%(date_of_birth)s, status=%(status)s, is_phone_verified=%(is_phone_verified)s, is_id_verified=%(is_id_verified)s, is_fica_compliant=%(is_fica_compliant)s, updated_at=now(), verified_at=%(verified_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-13 04:36:49,398", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00041s] {'first_name': 'SAM', 'last_name': 'ALTMAN', 'id_number': '9001011234567', 'date_of_birth': datetime.date(1990, 1, 1), 'status': 'ACTIVE', 'is_phone_verified': True, 'is_id_verified': True, 'is_fica_compliant': True, 'verified_at': datetime.datetime(2025, 11, 13, 4, 36, 49, 396532), 'users_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 04:36:49,401", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 04:36:49,402", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 04:36:49,403", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id, users.phone_number, users.email, users.whatsapp_name, users.first_name, users.last_name, users.id_number, users.date_of_birth, users.nationality, users.address_line1, users.address_line2, users.city, users.province, users.postal_code, users.country, users.account_number, users.balance, users.status, users.pin_hash, users.pin_attempts, users.pin_locked_until, users.is_phone_verified, users.is_email_verified, users.is_id_verified, users.is_address_verified, users.is_fica_compliant, users.id_document_url, users.proof_of_residence_url, users.selfie_url, users.daily_limit, users.monthly_limit, users.daily_spent, users.monthly_spent, users.last_daily_reset, users.last_monthly_reset, users.preferred_language, users.notification_enabled, users.marketing_consent, users.user_metadata, users.referral_code, users.referred_by, users.created_at, users.updated_at, users.last_active_at, users.verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 04:36:49,403", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 41.82s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 04:36:49,404", "name": "app.services.onboarding_service", "levelname": "INFO", "message": "User onboarded successfully: +27763024044"}
{"asctime": "2025-11-13 04:36:50,052", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-13 04:36:50,054", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763024044: SM737b31e97f51439e454badda75e602ac"}
{"asctime": "2025-11-13 04:36:50,562", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-13 04:36:50,563", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763024044: SMe545dd5525027f33fe169414056ada3d"}
{"asctime": "2025-11-13 04:36:50,564", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "ROLLBACK"}
{"asctime": "2025-11-13 04:37:16,798", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'SmsMessageSid': 'SMd47d85c80e68f2350b9690865e4ea506', 'NumMedia': '0', 'ProfileName': 'Hello World', 'MessageType': 'text', 'SmsSid': 'SMd47d85c80e68f2350b9690865e4ea506', 'WaId': '27763024044', 'SmsStatus': 'received', 'Body': 'Buy air time', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'SMd47d85c80e68f2350b9690865e4ea506', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World\",\"WaId\":\"27763024044\"}}}', 'From': 'whatsapp:+27763024044', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-11-13 04:37:16,799", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763024044"}
{"asctime": "2025-11-13 04:37:16,800", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 04:37:16,801", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 04:37:16,801", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 157.1s ago] {'phone_number_1': '+27763024044', 'param_1': 1}"}
{"asctime": "2025-11-13 04:37:16,803", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-13 04:37:16,803", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00030s] {'last_active_at': datetime.datetime(2025, 11, 13, 2, 37, 16, 802603), 'users_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 04:37:16,805", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 04:37:16,806", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 04:37:16,813", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 04:37:16,814", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00041s] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 04:37:16,817", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-13 04:37:16,817", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00043s] {'id': UUID('d78caf52-043a-4535-a77a-9b9f2e4a950f'), 'user_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'phone_number': '+27763024044', 'message_id': 'SMd47d85c80e68f2350b9690865e4ea506', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'Buy air time', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-13 04:37:16,822", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 04:37:16,823", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 04:37:16,824", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 04:37:16,824", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.01063s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 04:37:16,827", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 04:37:16,827", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00031s] {'user_id_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'param_1': 5}"}
{"asctime": "2025-11-13 04:37:20,054", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 04:37:20,064", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 04:37:20,064", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00066s] {'pk_1': UUID('d78caf52-043a-4535-a77a-9b9f2e4a950f')}"}
{"asctime": "2025-11-13 04:37:20,067", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-13 04:37:20,067", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00028s] {'ai_response': 'Hey Sam! I see you have a wallet balance of R0.00, which means you\u2019ll need to top up before buying airtime. Would you like to check how to add funds to your wallet?', 'intent_detected': 'conversation', 'entities_extracted': '{}', 'confidence_score': 0.7, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 13, 2, 37, 20, 60405), 'conversations_id': UUID('d78caf52-043a-4535-a77a-9b9f2e4a950f')}"}
{"asctime": "2025-11-13 04:37:20,069", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 04:37:20,660", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-13 04:37:20,661", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763024044: SMfab892ad291598f06a0c6a09a85f8adc"}
{"asctime": "2025-11-13 04:37:32,469", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'SmsMessageSid': 'SM8e6b9080bdb0dee76367476c29ebadcb', 'NumMedia': '0', 'ProfileName': 'Hello World', 'MessageType': 'text', 'SmsSid': 'SM8e6b9080bdb0dee76367476c29ebadcb', 'WaId': '27763024044', 'SmsStatus': 'received', 'Body': 'Add funds', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'SM8e6b9080bdb0dee76367476c29ebadcb', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World\",\"WaId\":\"27763024044\"}}}', 'From': 'whatsapp:+27763024044', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-11-13 04:37:32,470", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763024044"}
{"asctime": "2025-11-13 04:37:32,471", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 04:37:32,474", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 04:37:32,474", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 172.7s ago] {'phone_number_1': '+27763024044', 'param_1': 1}"}
{"asctime": "2025-11-13 04:37:32,476", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-13 04:37:32,476", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 15.67s ago] {'last_active_at': datetime.datetime(2025, 11, 13, 2, 37, 32, 476226), 'users_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 04:37:32,477", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 04:37:32,478", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 04:37:32,479", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 04:37:32,479", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 15.67s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 04:37:32,480", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-13 04:37:32,480", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 15.66s ago] {'id': UUID('9c024989-ab8a-412d-baea-10dc0d5c9afb'), 'user_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'phone_number': '+27763024044', 'message_id': 'SM8e6b9080bdb0dee76367476c29ebadcb', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'Add funds', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-13 04:37:32,481", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 04:37:32,482", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 04:37:32,482", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 04:37:32,482", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 15.67s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 04:37:32,484", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 04:37:32,484", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 15.66s ago] {'user_id_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'param_1': 5}"}
{"asctime": "2025-11-13 04:37:35,111", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 04:37:35,119", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 04:37:35,119", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 15.06s ago] {'pk_1': UUID('9c024989-ab8a-412d-baea-10dc0d5c9afb')}"}
{"asctime": "2025-11-13 04:37:35,121", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-13 04:37:35,121", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 15.05s ago] {'ai_response': \"Unfortunately, I can't assist with adding funds to your wallet just yet. But once our money transfer services are live, you'll be able to do that easily! \\n\\nIn the meantime, if there's anything else you need help with, just let me know!\", 'intent_detected': 'conversation', 'entities_extracted': '{}', 'confidence_score': 0.7, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 13, 2, 37, 35, 117069), 'conversations_id': UUID('9c024989-ab8a-412d-baea-10dc0d5c9afb')}"}
{"asctime": "2025-11-13 04:37:35,123", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 04:37:35,621", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-13 04:37:35,622", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763024044: SM1de3bd5b019bdbfd2549bf918c913538"}
{"asctime": "2025-11-13 04:38:04,859", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'SmsMessageSid': 'SM55cabd756c7b0ea38a8ae6bc20f79a3a', 'NumMedia': '0', 'ProfileName': 'Hello World', 'MessageType': 'text', 'SmsSid': 'SM55cabd756c7b0ea38a8ae6bc20f79a3a', 'WaId': '27763024044', 'SmsStatus': 'received', 'Body': 'What\u2019s your name and who created you ?', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'SM55cabd756c7b0ea38a8ae6bc20f79a3a', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World\",\"WaId\":\"27763024044\"}}}', 'From': 'whatsapp:+27763024044', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-11-13 04:38:04,859", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763024044"}
{"asctime": "2025-11-13 04:38:04,861", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 04:38:04,862", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 04:38:04,862", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 205.1s ago] {'phone_number_1': '+27763024044', 'param_1': 1}"}
{"asctime": "2025-11-13 04:38:04,863", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-13 04:38:04,864", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 48.06s ago] {'last_active_at': datetime.datetime(2025, 11, 13, 2, 38, 4, 863599), 'users_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 04:38:04,865", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 04:38:04,866", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 04:38:04,866", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 04:38:04,866", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 48.05s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 04:38:04,868", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-13 04:38:04,868", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 48.05s ago] {'id': UUID('4a67258b-9c15-4e45-83b3-53f92502d34e'), 'user_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'phone_number': '+27763024044', 'message_id': 'SM55cabd756c7b0ea38a8ae6bc20f79a3a', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'What\u2019s your name and who created you ?', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-13 04:38:04,869", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 04:38:04,870", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 04:38:04,870", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 04:38:04,871", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 48.06s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 04:38:04,872", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 04:38:04,872", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 48.05s ago] {'user_id_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'param_1': 5}"}
{"asctime": "2025-11-13 04:38:08,100", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 04:38:08,107", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 04:38:08,108", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 48.04s ago] {'pk_1': UUID('4a67258b-9c15-4e45-83b3-53f92502d34e')}"}
{"asctime": "2025-11-13 04:38:08,109", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-13 04:38:08,109", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 48.04s ago] {'ai_response': \"I'm Cyrax, your friendly utility bill assistant! I was created to help you with things like buying airtime, data bundles, and paying electricity bills. My goal is to make your life easier! If you have any questions or need assistance, just ask! \ud83d\ude0a\", 'intent_detected': 'conversation', 'entities_extracted': '{}', 'confidence_score': 0.7, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 13, 2, 38, 8, 105562), 'conversations_id': UUID('4a67258b-9c15-4e45-83b3-53f92502d34e')}"}
{"asctime": "2025-11-13 04:38:08,110", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 04:38:08,581", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-13 04:38:08,582", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763024044: SM59a3ea266e33fbde58742de72c57f54d"}
{"asctime": "2025-11-13 04:38:54,496", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'MediaContentType0': 'image/jpeg', 'SmsMessageSid': 'MM4d4224fef1988cbf0b2819ed9132f34c', 'NumMedia': '1', 'ProfileName': 'Hello World', 'MessageType': 'image', 'SmsSid': 'MM4d4224fef1988cbf0b2819ed9132f34c', 'WaId': '27763024044', 'SmsStatus': 'received', 'Body': 'Buy 20rand electricity for this meter number', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'MM4d4224fef1988cbf0b2819ed9132f34c', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World\",\"WaId\":\"27763024044\"}}}', 'From': 'whatsapp:+27763024044', 'MediaUrl0': 'https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages/MM4d4224fef1988cbf0b2819ed9132f34c/Media/ME04065b097b9a000db5f421c81794caa0', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-11-13 04:38:54,499", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Parsed image message with media: https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages/MM4d4224fef1988cbf0b2819ed9132f34c/Media/ME04065b097b9a000db5f421c81794caa0"}
{"asctime": "2025-11-13 04:38:54,499", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing image message from +27763024044"}
{"asctime": "2025-11-13 04:38:54,504", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 04:38:54,506", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 04:38:54,506", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 254.8s ago] {'phone_number_1': '+27763024044', 'param_1': 1}"}
{"asctime": "2025-11-13 04:38:54,509", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-13 04:38:54,509", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 97.71s ago] {'last_active_at': datetime.datetime(2025, 11, 13, 2, 38, 54, 508649), 'users_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 04:38:54,511", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 04:38:54,951", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: GET https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages/MM4d4224fef1988cbf0b2819ed9132f34c/Media/ME04065b097b9a000db5f421c81794caa0 \"HTTP/1.1 307 Temporary Redirect\""}
{"asctime": "2025-11-13 04:38:55,552", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: GET https://mms.twiliocdn.com/AC6a10482bfc51f0846f64980cb7f1676e/e9fb08b386c98bc8e9db267a31f6f660?Expires=1763015937&Signature=g3MEwZQ66rnxSBCHp05P~p-tXgxC~uc7yNVtdzt0KwnbO4WeOqnoHezWtra-OqPatNxDkDIqjQ6ZyHDBZc0m4JxiC6wxcL3Kwe-fZI~nnkzpof~gGkGlX40EAQg2DNibSqvX4K2L~jGD8Ze7~bC0csYttu6bmm0shjn~q1c4AA0mPKx3afoPnMnqcaOGXcGKl-Aausd~YNBx0zyecZ98bvptLABQZOf8CZc1KZa26wueez6p7OwYGG8CyOV23IqJj8kjJSU7f0XhwOQ75zQ-Wv~OZgAicB8Ri-BXQgImLkBM7HrTuL5CyEBsG~0LXwAbBOfmW8Ba6N5tRqGf1V9~Pw__&Key-Pair-Id=APKAIRUDFXVKPONS3KUA \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 04:38:55,554", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Media downloaded: media/MM4d4224fef1988cbf0b2819ed9132f34c.jpg"}
{"asctime": "2025-11-13 04:38:55,563", "name": "app.services.ai_service", "levelname": "INFO", "message": "Processing image: media/MM4d4224fef1988cbf0b2819ed9132f34c.jpg"}
{"asctime": "2025-11-13 04:38:57,851", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 04:38:57,856", "name": "app.services.ai_service", "levelname": "INFO", "message": "Image processed successfully: {\"type\": \"account_number\", \"account_number\": \"1232071854\", \"provider\": \"Unknown\", \"confidence\": 0.95..."}
{"asctime": "2025-11-13 04:38:58,834", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-13 04:38:58,836", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763024044: SM4d9977995082d373f020fe27c1869f1a"}
{"asctime": "2025-11-13 04:38:58,839", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 04:38:58,840", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 04:38:58,840", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 102s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 04:38:58,843", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-13 04:38:58,843", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 102s ago] {'id': UUID('1beab695-6464-4f31-9337-354dcd432a02'), 'user_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'phone_number': '+27763024044', 'message_id': 'MM4d4224fef1988cbf0b2819ed9132f34c', 'message_type': 'image', 'direction': 'inbound', 'message_text': 'pay Unknown bill for account 1232071854 amount ', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-13 04:38:58,845", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 04:38:58,846", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 04:38:58,846", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 04:38:58,847", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 102s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 04:38:58,848", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 04:38:58,849", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 102s ago] {'user_id_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'param_1': 5}"}
{"asctime": "2025-11-13 04:39:01,842", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 04:39:01,850", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 04:39:01,850", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 101.8s ago] {'pk_1': UUID('1beab695-6464-4f31-9337-354dcd432a02')}"}
{"asctime": "2025-11-13 04:39:01,852", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-13 04:39:01,852", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 101.8s ago] {'ai_response': \"I can help you with that, but first, I need to confirm a few details:\\n\\n1. What amount would you like to pay for the unknown bill? (Please specify the amount)\\n2. Can you provide your PIN for security?\\n\\nLet me know, and I'll proceed!\", 'intent_detected': 'conversation', 'entities_extracted': '{}', 'confidence_score': 0.7, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 13, 2, 39, 1, 848628), 'conversations_id': UUID('1beab695-6464-4f31-9337-354dcd432a02')}"}
{"asctime": "2025-11-13 04:39:01,853", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 04:39:02,859", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-13 04:39:02,860", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763024044: SM500c88b1da37b9f976f7cce7ec68941a"}
{"asctime": "2025-11-13 04:39:42,818", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'SmsMessageSid': 'SM2bedbe43bf9641a550c152c6ede55564', 'NumMedia': '0', 'ProfileName': 'Hello World', 'MessageType': 'text', 'SmsSid': 'SM2bedbe43bf9641a550c152c6ede55564', 'WaId': '27763024044', 'SmsStatus': 'received', 'Body': 'I don\u2019t have a pin and yes I\u2019d like to buy electricyy', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'SM2bedbe43bf9641a550c152c6ede55564', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World\",\"WaId\":\"27763024044\"}}}', 'From': 'whatsapp:+27763024044', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-11-13 04:39:42,820", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763024044"}
{"asctime": "2025-11-13 04:39:42,822", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 04:39:42,822", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 04:39:42,822", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 303.1s ago] {'phone_number_1': '+27763024044', 'param_1': 1}"}
{"asctime": "2025-11-13 04:39:42,824", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-13 04:39:42,824", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 146s ago] {'last_active_at': datetime.datetime(2025, 11, 13, 2, 39, 42, 824208), 'users_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 04:39:42,825", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 04:39:42,827", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 04:39:42,827", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 04:39:42,827", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 146s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 04:39:42,829", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-13 04:39:42,829", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 146s ago] {'id': UUID('e0cb243f-a0c5-4b99-bc7b-fb9e6866f8b4'), 'user_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'phone_number': '+27763024044', 'message_id': 'SM2bedbe43bf9641a550c152c6ede55564', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'I don\u2019t have a pin and yes I\u2019d like to buy electricyy', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-13 04:39:42,830", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 04:39:42,831", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 04:39:42,831", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 04:39:42,832", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 146s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 04:39:42,833", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 04:39:42,833", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 146s ago] {'user_id_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'param_1': 5}"}
{"asctime": "2025-11-13 04:39:45,607", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 04:39:45,620", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 04:39:45,620", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 145.6s ago] {'pk_1': UUID('e0cb243f-a0c5-4b99-bc7b-fb9e6866f8b4')}"}
{"asctime": "2025-11-13 04:39:45,622", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-13 04:39:45,622", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 145.6s ago] {'ai_response': \"No worries! To pay for prepaid electricity, I need a 20-digit token code after the transaction. \\n\\nHowever, I can only assist you with payments if you provide your PIN for security reasons. If you don't have a PIN, you may need to set one up. \\n\\nLet me know how you'd like to proceed!\", 'intent_detected': 'conversation', 'entities_extracted': '{}', 'confidence_score': 0.7, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 13, 2, 39, 45, 618417), 'conversations_id': UUID('e0cb243f-a0c5-4b99-bc7b-fb9e6866f8b4')}"}
{"asctime": "2025-11-13 04:39:45,623", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 04:39:46,060", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-13 04:39:46,061", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763024044: SMe5d8c9819a0f531df2034d0646005bfd"}
{"asctime": "2025-11-13 04:40:06,150", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'SmsMessageSid': 'SM5cea23b17f6ab11c18fa9c44188b9dda', 'NumMedia': '0', 'ProfileName': 'Hello World', 'MessageType': 'text', 'SmsSid': 'SM5cea23b17f6ab11c18fa9c44188b9dda', 'WaId': '27763024044', 'SmsStatus': 'received', 'Body': 'Yes', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'SM5cea23b17f6ab11c18fa9c44188b9dda', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World\",\"WaId\":\"27763024044\"}}}', 'From': 'whatsapp:+27763024044', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-11-13 04:40:06,151", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763024044"}
{"asctime": "2025-11-13 04:40:06,152", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 04:40:06,153", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 04:40:06,153", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 326.4s ago] {'phone_number_1': '+27763024044', 'param_1': 1}"}
{"asctime": "2025-11-13 04:40:06,155", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-13 04:40:06,155", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 169.4s ago] {'last_active_at': datetime.datetime(2025, 11, 13, 2, 40, 6, 154676), 'users_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 04:40:06,156", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 04:40:06,157", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 04:40:06,158", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 04:40:06,158", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 169.3s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 04:40:06,159", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-13 04:40:06,160", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 169.3s ago] {'id': UUID('35c38573-a537-4e27-b9a3-98aa36ba7519'), 'user_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'phone_number': '+27763024044', 'message_id': 'SM5cea23b17f6ab11c18fa9c44188b9dda', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'Yes', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-13 04:40:06,161", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 04:40:06,161", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 04:40:06,162", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 04:40:06,162", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 169.4s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 04:40:06,163", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 04:40:06,163", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 169.3s ago] {'user_id_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'param_1': 5}"}
{"asctime": "2025-11-13 04:40:07,794", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 04:40:07,801", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 04:40:07,801", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 167.7s ago] {'pk_1': UUID('35c38573-a537-4e27-b9a3-98aa36ba7519')}"}
{"asctime": "2025-11-13 04:40:07,803", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-13 04:40:07,803", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 167.7s ago] {'ai_response': \"Great! To set up your PIN, please provide a 4-digit number that you'd like to use as your PIN. Once you have that, I can help you pay for your prepaid electricity. \ud83d\ude0a\", 'intent_detected': 'conversation', 'entities_extracted': '{}', 'confidence_score': 0.7, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 13, 2, 40, 7, 799042), 'conversations_id': UUID('35c38573-a537-4e27-b9a3-98aa36ba7519')}"}
{"asctime": "2025-11-13 04:40:07,805", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 04:40:08,740", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-13 04:40:08,742", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763024044: SM7bdd544f15d91393ee6d4b4483d8e8ea"}
{"asctime": "2025-11-13 04:40:17,926", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'SmsMessageSid': 'SMb0b271e20a9ee4105f1d8a63587bd3bf', 'NumMedia': '0', 'ProfileName': 'Hello World', 'MessageType': 'text', 'SmsSid': 'SMb0b271e20a9ee4105f1d8a63587bd3bf', 'WaId': '27763024044', 'SmsStatus': 'received', 'Body': '5691', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'SMb0b271e20a9ee4105f1d8a63587bd3bf', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World\",\"WaId\":\"27763024044\"}}}', 'From': 'whatsapp:+27763024044', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-11-13 04:40:17,927", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763024044"}
{"asctime": "2025-11-13 04:40:17,928", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 04:40:17,929", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 04:40:17,929", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 338.2s ago] {'phone_number_1': '+27763024044', 'param_1': 1}"}
{"asctime": "2025-11-13 04:40:17,930", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-13 04:40:17,930", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 181.1s ago] {'last_active_at': datetime.datetime(2025, 11, 13, 2, 40, 17, 930336), 'users_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 04:40:17,931", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 04:40:17,933", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 04:40:17,933", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 04:40:17,933", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 181.1s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 04:40:17,935", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-13 04:40:17,935", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 181.1s ago] {'id': UUID('337de49f-640a-4155-9820-5802c89cb4f0'), 'user_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'phone_number': '+27763024044', 'message_id': 'SMb0b271e20a9ee4105f1d8a63587bd3bf', 'message_type': 'text', 'direction': 'inbound', 'message_text': '5691', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-13 04:40:17,936", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 04:40:17,937", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 04:40:17,937", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 04:40:17,937", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 181.1s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 04:40:17,939", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 04:40:17,939", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 181.1s ago] {'user_id_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'param_1': 5}"}
{"asctime": "2025-11-13 04:40:20,553", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 04:40:20,564", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 04:40:20,564", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 180.5s ago] {'pk_1': UUID('337de49f-640a-4155-9820-5802c89cb4f0')}"}
{"asctime": "2025-11-13 04:40:20,566", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-13 04:40:20,566", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 180.5s ago] {'ai_response': \"Thank you! I've noted your PIN as **5691**. \\n\\nNow, please provide the amount you'd like to pay for the prepaid electricity and the 20-digit token code. \", 'intent_detected': 'conversation', 'entities_extracted': '{}', 'confidence_score': 0.7, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 13, 2, 40, 20, 562296), 'conversations_id': UUID('337de49f-640a-4155-9820-5802c89cb4f0')}"}
{"asctime": "2025-11-13 04:40:20,568", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 04:40:21,508", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-13 04:40:21,509", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763024044: SMde56d766564ecf84fcc154f5e891f5a3"}
{"asctime": "2025-11-13 04:40:38,359", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'SmsMessageSid': 'SM278b2ef45c94560a39929269a3073b34', 'NumMedia': '0', 'ProfileName': 'Hello World', 'MessageType': 'text', 'SmsSid': 'SM278b2ef45c94560a39929269a3073b34', 'WaId': '27763024044', 'SmsStatus': 'received', 'Body': 'Can I send a picture of the token code ?', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'SM278b2ef45c94560a39929269a3073b34', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World\",\"WaId\":\"27763024044\"}}}', 'From': 'whatsapp:+27763024044', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-11-13 04:40:38,362", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763024044"}
{"asctime": "2025-11-13 04:40:38,364", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 04:40:38,364", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 04:40:38,365", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 358.6s ago] {'phone_number_1': '+27763024044', 'param_1': 1}"}
{"asctime": "2025-11-13 04:40:38,366", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-13 04:40:38,367", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 201.6s ago] {'last_active_at': datetime.datetime(2025, 11, 13, 2, 40, 38, 366464), 'users_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 04:40:38,367", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 04:40:38,368", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 04:40:38,369", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 04:40:38,369", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 201.6s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 04:40:38,370", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-13 04:40:38,371", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 201.6s ago] {'id': UUID('52b6c945-c72e-4744-aab0-6ac0f76c4900'), 'user_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'phone_number': '+27763024044', 'message_id': 'SM278b2ef45c94560a39929269a3073b34', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'Can I send a picture of the token code ?', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-13 04:40:38,372", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 04:40:38,373", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 04:40:38,373", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 04:40:38,373", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 201.6s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 04:40:38,374", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 04:40:38,375", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 201.5s ago] {'user_id_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'param_1': 5}"}
{"asctime": "2025-11-13 04:40:40,757", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 04:40:40,771", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 04:40:40,772", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 200.7s ago] {'pk_1': UUID('52b6c945-c72e-4744-aab0-6ac0f76c4900')}"}
{"asctime": "2025-11-13 04:40:40,773", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-13 04:40:40,774", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 200.7s ago] {'ai_response': \"I'm unable to process images, but you can type out the 20-digit token code here. Once I have that, I can assist you with the payment! \ud83d\ude0a\", 'intent_detected': 'buy_electricity', 'entities_extracted': '{\"amount\": null, \"meter_number\": null}', 'confidence_score': 0.9, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 13, 2, 40, 40, 769579), 'conversations_id': UUID('52b6c945-c72e-4744-aab0-6ac0f76c4900')}"}
{"asctime": "2025-11-13 04:40:40,774", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 04:40:41,270", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-13 04:40:41,272", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763024044: SMdf5da8e448c487087baff37610b17727"}
{"asctime": "2025-11-13 04:41:21,209", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'SmsMessageSid': 'SM37534231b9b93b577053017949d5913b', 'NumMedia': '0', 'ProfileName': 'Hello World', 'MessageType': 'text', 'SmsSid': 'SM37534231b9b93b577053017949d5913b', 'WaId': '27763024044', 'SmsStatus': 'received', 'Body': 'What do you mean you are unable to process image \u2026. But you told me earlier that you can', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'SM37534231b9b93b577053017949d5913b', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World\",\"WaId\":\"27763024044\"}}}', 'From': 'whatsapp:+27763024044', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-11-13 04:41:21,209", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763024044"}
{"asctime": "2025-11-13 04:41:21,211", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 04:41:21,211", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 04:41:21,211", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 401.5s ago] {'phone_number_1': '+27763024044', 'param_1': 1}"}
{"asctime": "2025-11-13 04:41:21,213", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-13 04:41:21,213", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 244.4s ago] {'last_active_at': datetime.datetime(2025, 11, 13, 2, 41, 21, 212948), 'users_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 04:41:21,214", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 04:41:21,215", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 04:41:21,216", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 04:41:21,216", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 244.4s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 04:41:21,217", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-13 04:41:21,218", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 244.4s ago] {'id': UUID('ddf40b59-0f32-4e52-abe1-7ddcb1fecbfe'), 'user_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'phone_number': '+27763024044', 'message_id': 'SM37534231b9b93b577053017949d5913b', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'What do you mean you are unable to process image \u2026. But you told me earlier that you can', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-13 04:41:21,219", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 04:41:21,220", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 04:41:21,220", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 04:41:21,221", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 244.4s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 04:41:21,222", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 04:41:21,222", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 244.4s ago] {'user_id_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'param_1': 5}"}
{"asctime": "2025-11-13 04:41:24,106", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 04:41:24,113", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 04:41:24,113", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 244.1s ago] {'pk_1': UUID('ddf40b59-0f32-4e52-abe1-7ddcb1fecbfe')}"}
{"asctime": "2025-11-13 04:41:24,115", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-13 04:41:24,115", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 244s ago] {'ai_response': \"I apologize for any confusion! I can't actually view images, but I can definitely help you out if you type the token code here. Just let me know the code, and we'll get your electricity payment sorted! \ud83d\ude0a\", 'intent_detected': 'conversation', 'entities_extracted': '{}', 'confidence_score': 0.7, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 13, 2, 41, 24, 111176), 'conversations_id': UUID('ddf40b59-0f32-4e52-abe1-7ddcb1fecbfe')}"}
{"asctime": "2025-11-13 04:41:24,116", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 04:41:24,605", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-13 04:41:24,607", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763024044: SMfd17f6bb9ee1fadf09413f3f35421e9b"}
{"asctime": "2025-11-13 04:41:31,831", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'SmsMessageSid': 'SMadbbfe9e37fab35a797a7b452e60b06b', 'NumMedia': '0', 'ProfileName': 'Hello World', 'MessageType': 'text', 'SmsSid': 'SMadbbfe9e37fab35a797a7b452e60b06b', 'WaId': '27763024044', 'SmsStatus': 'received', 'Body': 'Send me my account details', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'SMadbbfe9e37fab35a797a7b452e60b06b', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World\",\"WaId\":\"27763024044\"}}}', 'From': 'whatsapp:+27763024044', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-11-13 04:41:31,832", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763024044"}
{"asctime": "2025-11-13 04:41:31,834", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 04:41:31,835", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 04:41:31,835", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 412.1s ago] {'phone_number_1': '+27763024044', 'param_1': 1}"}
{"asctime": "2025-11-13 04:41:31,836", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-13 04:41:31,836", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 255s ago] {'last_active_at': datetime.datetime(2025, 11, 13, 2, 41, 31, 836308), 'users_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 04:41:31,837", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 04:41:31,838", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 04:41:31,839", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 04:41:31,839", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 255s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 04:41:31,840", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-13 04:41:31,840", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 255s ago] {'id': UUID('3b5e8607-844b-4c65-85e1-331b0ecdbc4d'), 'user_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'phone_number': '+27763024044', 'message_id': 'SMadbbfe9e37fab35a797a7b452e60b06b', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'Send me my account details', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-13 04:41:31,841", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 04:41:31,842", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 04:41:31,842", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 04:41:31,843", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 255s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 04:41:31,844", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 04:41:31,844", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 255s ago] {'user_id_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'param_1': 5}"}
{"asctime": "2025-11-13 04:41:34,118", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 04:41:34,133", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 04:41:34,134", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 254.1s ago] {'pk_1': UUID('3b5e8607-844b-4c65-85e1-331b0ecdbc4d')}"}
{"asctime": "2025-11-13 04:41:34,135", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-13 04:41:34,135", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 254.1s ago] {'ai_response': 'Your account details are as follows:\\n\\n- **Name:** Sam Altman\\n- **Wallet Balance:** R0.00\\n- **Phone:** +27763024044\\n\\nIf you need any more assistance or specific information, just let me know! \ud83d\ude0a', 'intent_detected': 'conversation', 'entities_extracted': '{}', 'confidence_score': 0.7, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 13, 2, 41, 34, 132254), 'conversations_id': UUID('3b5e8607-844b-4c65-85e1-331b0ecdbc4d')}"}
{"asctime": "2025-11-13 04:41:34,136", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 04:41:34,723", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-13 04:41:34,724", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763024044: SMe3d4b1602761c84571482d17b555a0d2"}
{"asctime": "2025-11-13 04:43:44,123", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'MediaContentType0': 'audio/ogg', 'SmsMessageSid': 'MM8262db285547fe9bdc028eaf04f7ba63', 'NumMedia': '1', 'ProfileName': 'Hello World', 'MessageType': 'audio', 'SmsSid': 'MM8262db285547fe9bdc028eaf04f7ba63', 'WaId': '27763024044', 'SmsStatus': 'received', 'Body': '', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'MM8262db285547fe9bdc028eaf04f7ba63', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World\",\"WaId\":\"27763024044\"}}}', 'From': 'whatsapp:+27763024044', 'MediaUrl0': 'https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages/MM8262db285547fe9bdc028eaf04f7ba63/Media/ME1e2ee07400ed94cf9a63af99c617a47f', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-11-13 04:43:44,126", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Parsed audio message with media: https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages/MM8262db285547fe9bdc028eaf04f7ba63/Media/ME1e2ee07400ed94cf9a63af99c617a47f"}
{"asctime": "2025-11-13 04:43:44,126", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing audio message from +27763024044"}
{"asctime": "2025-11-13 04:43:44,131", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 04:43:44,133", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 04:43:44,133", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 544.4s ago] {'phone_number_1': '+27763024044', 'param_1': 1}"}
{"asctime": "2025-11-13 04:43:44,136", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-13 04:43:44,136", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 387.3s ago] {'last_active_at': datetime.datetime(2025, 11, 13, 2, 43, 44, 135521), 'users_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 04:43:44,137", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 04:43:44,540", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: GET https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages/MM8262db285547fe9bdc028eaf04f7ba63/Media/ME1e2ee07400ed94cf9a63af99c617a47f \"HTTP/1.1 307 Temporary Redirect\""}
{"asctime": "2025-11-13 04:43:45,079", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: GET https://mms.twiliocdn.com/AC6a10482bfc51f0846f64980cb7f1676e/05afefb3525c78e6235bbcfbed1f2b76?Expires=1763016226&Signature=Z9-FgZa6dEyl3L5Ejt6SWbd9j-nN3jUxmPXRb-OwtEPKLyLz4qOBVg95iyKg8IpAakWjbFDw5G66rU~p-A6WEKXagC6PZZXlklVOxcg8Bc2V0ldF3~bETZIXG1EcuRw44zMJEyqA5G-Q6Yyh5PPZ3gZk~oXKWK7m9NIEeceAFfmvFn~JyIEVztKD7rR1N21gP5TuGNGeU62WaWSPKM4N1GSIyNfrXYCDZWFiaRGjPoYxTMqVNmQF2qUN4Q5A3a6uaGy7GxGwVRR55EpXTU6QvpU0ie6qtOmy9xqEskWfqKPXXzscziQD3Zx2eo28bH1WWWMyxKYEoQn~OHuYCPXd7A__&Key-Pair-Id=APKAIRUDFXVKPONS3KUA \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 04:43:45,083", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Media downloaded: media/MM8262db285547fe9bdc028eaf04f7ba63.ogg"}
{"asctime": "2025-11-13 04:43:45,102", "name": "app.services.ai_service", "levelname": "INFO", "message": "Transcribing voice note: media/MM8262db285547fe9bdc028eaf04f7ba63.ogg"}
{"asctime": "2025-11-13 04:43:47,316", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/audio/transcriptions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 04:43:47,323", "name": "app.services.ai_service", "levelname": "INFO", "message": "Voice note transcribed successfully: Can you send 20 Rand airtime for me right now?..."}
{"asctime": "2025-11-13 04:43:47,842", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-13 04:43:47,843", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763024044: SM5dbe5123ba878d7fce04b0843791f919"}
{"asctime": "2025-11-13 04:43:47,846", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 04:43:47,847", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 04:43:47,847", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 391s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 04:43:47,850", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-13 04:43:47,850", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 391s ago] {'id': UUID('253a4e1f-a0c5-455d-bfee-45eb1d7db30a'), 'user_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'phone_number': '+27763024044', 'message_id': 'MM8262db285547fe9bdc028eaf04f7ba63', 'message_type': 'audio', 'direction': 'inbound', 'message_text': 'Can you send 20 Rand airtime for me right now?', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-13 04:43:47,852", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 04:43:47,853", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 04:43:47,853", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 04:43:47,854", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 391s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 04:43:47,855", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 04:43:47,856", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 391s ago] {'user_id_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'param_1': 5}"}
{"asctime": "2025-11-13 04:43:49,376", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 04:43:49,384", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 04:43:49,384", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 389.3s ago] {'pk_1': UUID('253a4e1f-a0c5-455d-bfee-45eb1d7db30a')}"}
{"asctime": "2025-11-13 04:43:49,385", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-13 04:43:49,386", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 389.3s ago] {'ai_response': \"I see that your wallet balance is currently R0.00, which means you'll need to add funds before I can purchase airtime for you. \\n\\nOnce you have funds in your wallet, I can help you buy R20 airtime. Let me know if you need help with anything else! \ud83d\ude0a\", 'intent_detected': 'buy_airtime', 'entities_extracted': '{\"amount\": 20.0, \"phone\": null, \"network\": null}', 'confidence_score': 0.9, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 13, 2, 43, 49, 382365), 'conversations_id': UUID('253a4e1f-a0c5-455d-bfee-45eb1d7db30a')}"}
{"asctime": "2025-11-13 04:43:49,386", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 04:43:49,890", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-13 04:43:49,891", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763024044: SMdbf645495df9566c27d561e236d01f13"}
{"asctime": "2025-11-13 04:44:48,266", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {'SmsMessageSid': 'SMc7912b0798ee84eba591bacd3bde621b', 'NumMedia': '0', 'ProfileName': 'Hello World', 'MessageType': 'text', 'SmsSid': 'SMc7912b0798ee84eba591bacd3bde621b', 'WaId': '27763024044', 'SmsStatus': 'received', 'Body': 'How do I add money to my account ?', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'SMc7912b0798ee84eba591bacd3bde621b', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World\",\"WaId\":\"27763024044\"}}}', 'From': 'whatsapp:+27763024044', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-11-13 04:44:48,268", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763024044"}
{"asctime": "2025-11-13 04:44:48,270", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 04:44:48,270", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 04:44:48,270", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 608.5s ago] {'phone_number_1': '+27763024044', 'param_1': 1}"}
{"asctime": "2025-11-13 04:44:48,272", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-13 04:44:48,272", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 451.5s ago] {'last_active_at': datetime.datetime(2025, 11, 13, 2, 44, 48, 272174), 'users_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 04:44:48,273", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 04:44:48,275", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 04:44:48,275", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 04:44:48,275", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 451.5s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 04:44:48,277", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-13 04:44:48,277", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 451.5s ago] {'id': UUID('bb699cca-325f-4108-a123-e03693408990'), 'user_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'phone_number': '+27763024044', 'message_id': 'SMc7912b0798ee84eba591bacd3bde621b', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'How do I add money to my account ?', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-13 04:44:48,278", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 04:44:48,279", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 04:44:48,279", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 04:44:48,279", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 451.5s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 04:44:48,281", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 04:44:48,281", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 451.5s ago] {'user_id_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'param_1': 5}"}
{"asctime": "2025-11-13 04:44:49,691", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 04:44:49,698", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 04:44:49,698", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 449.6s ago] {'pk_1': UUID('bb699cca-325f-4108-a123-e03693408990')}"}
{"asctime": "2025-11-13 04:44:49,700", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-13 04:44:49,700", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 449.6s ago] {'ai_response': \"Currently, adding money to your account isn't available yet as we're working on getting our banking license. But once it's ready, you'll be able to load funds easily!\\n\\nIn the meantime, if you have any other questions or need assistance with something else, just let me know! \ud83d\ude0a\", 'intent_detected': 'check_balance', 'entities_extracted': '{}', 'confidence_score': 0.95, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 13, 2, 44, 49, 696379), 'conversations_id': UUID('bb699cca-325f-4108-a123-e03693408990')}"}
{"asctime": "2025-11-13 04:44:49,701", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 04:44:50,203", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 201 Created\""}
{"asctime": "2025-11-13 04:44:50,205", "name": "app.services.twilio_service", "levelname": "INFO", "message": "Message sent to +27763024044: SM1825c8f3b4fc6ff440a39c001c3f64fa"}
{"asctime": "2025-11-13 04:52:34,058", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-11-13 04:52:34,649", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-11-13 04:52:34,649", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-11-13 04:52:34,671", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-11-13 04:52:34,671", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 04:52:34,672", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-11-13 04:52:34,672", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 04:52:34,672", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-11-13 04:52:34,673", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 04:52:34,674", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 04:52:34,676", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 04:52:34,677", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00019s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 04:52:34,678", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 04:52:34,678", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001927s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 04:52:34,679", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 04:52:34,679", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002514s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 04:52:34,680", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 04:52:34,680", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00011s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 04:52:34,681", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 04:52:34,681", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0006375s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 04:52:34,681", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 04:52:34,681", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001049s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 04:52:34,681", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 04:52:34,681", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-11-13 04:52:34,681", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-11-13 04:52:34,682", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-11-13 04:52:41,757", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-11-13 04:52:42,151", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-11-13 04:52:42,151", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-11-13 04:52:42,167", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-11-13 04:52:42,167", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 04:52:42,167", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-11-13 04:52:42,167", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 04:52:42,168", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-11-13 04:52:42,168", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 04:52:42,169", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 04:52:42,170", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 04:52:42,170", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00010s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 04:52:42,171", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 04:52:42,171", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001761s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 04:52:42,172", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 04:52:42,172", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.00208s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 04:52:42,172", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 04:52:42,173", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00007s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 04:52:42,173", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 04:52:42,173", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0004872s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 04:52:42,173", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 04:52:42,173", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0009124s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 04:52:42,174", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 04:52:42,174", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-11-13 04:52:42,174", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-11-13 04:52:42,174", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-11-13 04:54:55,499", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-11-13 04:54:56,079", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-11-13 04:54:56,079", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-11-13 04:54:56,098", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-11-13 04:54:56,098", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 04:54:56,098", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-11-13 04:54:56,098", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 04:54:56,099", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-11-13 04:54:56,099", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 04:54:56,100", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 04:54:56,101", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 04:54:56,101", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00010s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 04:54:56,102", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 04:54:56,102", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001086s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 04:54:56,102", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 04:54:56,102", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001411s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 04:54:56,103", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 04:54:56,103", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00012s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 04:54:56,104", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 04:54:56,104", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.000552s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 04:54:56,104", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 04:54:56,104", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0009355s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 04:54:56,104", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 04:54:56,105", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-11-13 04:54:56,105", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-11-13 04:54:56,105", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-11-13 04:55:12,283", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-11-13 04:55:12,781", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-11-13 04:55:12,782", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-11-13 04:55:12,799", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-11-13 04:55:12,799", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 04:55:12,800", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-11-13 04:55:12,800", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 04:55:12,801", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-11-13 04:55:12,801", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 04:55:12,801", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 04:55:12,803", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 04:55:12,803", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00010s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 04:55:12,805", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 04:55:12,805", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002016s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 04:55:12,805", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 04:55:12,805", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.00247s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 04:55:12,806", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 04:55:12,806", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00009s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 04:55:12,807", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 04:55:12,807", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0007465s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 04:55:12,807", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 04:55:12,807", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001238s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 04:55:12,808", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 04:55:12,808", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-11-13 04:55:12,808", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-11-13 04:55:12,808", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-11-13 04:56:19,225", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-11-13 04:56:19,793", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-11-13 04:56:19,793", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-11-13 04:56:19,809", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-11-13 04:56:19,810", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 04:56:19,810", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-11-13 04:56:19,810", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 04:56:19,811", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-11-13 04:56:19,811", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 04:56:19,812", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 04:56:19,813", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 04:56:19,813", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00011s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 04:56:19,815", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 04:56:19,815", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002192s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 04:56:19,815", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 04:56:19,816", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002498s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 04:56:19,816", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 04:56:19,816", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00007s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 04:56:19,817", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 04:56:19,817", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0006241s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 04:56:19,817", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 04:56:19,817", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001029s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 04:56:19,818", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 04:56:19,818", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-11-13 04:56:19,818", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-11-13 04:56:19,818", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-11-13 04:58:53,867", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-11-13 04:59:34,529", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-11-13 04:59:34,530", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-11-13 04:59:34,633", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-11-13 04:59:34,634", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 04:59:34,634", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-11-13 04:59:34,634", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 04:59:34,635", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-11-13 04:59:34,635", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 04:59:34,636", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 04:59:34,638", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 04:59:34,638", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00015s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 04:59:34,642", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 04:59:34,642", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.004599s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 04:59:34,643", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 04:59:34,643", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.005084s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 04:59:34,644", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 04:59:34,644", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00011s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 04:59:34,645", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 04:59:34,645", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001363s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 04:59:34,646", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 04:59:34,646", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002002s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 04:59:34,646", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 04:59:34,646", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-11-13 04:59:34,646", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-11-13 04:59:34,646", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-11-13 05:16:13,199", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-11-13 05:16:13,738", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-11-13 05:16:13,738", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-11-13 05:16:13,757", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-11-13 05:16:13,757", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 05:16:13,758", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-11-13 05:16:13,758", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 05:16:13,759", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-11-13 05:16:13,759", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 05:16:13,759", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 05:16:13,761", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 05:16:13,761", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00010s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 05:16:13,763", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 05:16:13,763", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002475s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 05:16:13,763", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 05:16:13,764", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002976s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 05:16:13,764", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 05:16:13,764", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00007s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 05:16:13,765", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 05:16:13,765", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0006275s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 05:16:13,766", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 05:16:13,766", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001212s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 05:16:13,766", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 05:16:13,767", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-11-13 05:16:13,767", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-11-13 05:16:13,767", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-11-13 05:25:11,714", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-11-13 05:25:12,244", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-11-13 05:25:12,244", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-11-13 05:25:12,263", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-11-13 05:25:12,264", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 05:25:12,264", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-11-13 05:25:12,264", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 05:25:12,264", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-11-13 05:25:12,264", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 05:25:12,265", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 05:25:12,267", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 05:25:12,267", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00011s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 05:25:12,269", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 05:25:12,269", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002184s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 05:25:12,269", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 05:25:12,269", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002649s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 05:25:12,270", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 05:25:12,270", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00008s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 05:25:12,271", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 05:25:12,271", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.000765s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 05:25:12,271", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 05:25:12,271", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001351s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 05:25:12,272", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 05:25:12,272", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-11-13 05:25:12,272", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-11-13 05:25:12,272", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-11-13 05:29:40,092", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-11-13 05:29:40,666", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-11-13 05:29:40,666", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-11-13 05:29:40,764", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-11-13 05:29:40,765", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 05:29:40,765", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-11-13 05:29:40,765", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 05:29:40,766", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-11-13 05:29:40,766", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 05:29:40,767", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 05:29:40,769", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 05:29:40,769", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00016s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 05:29:40,772", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 05:29:40,772", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.003518s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 05:29:40,773", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 05:29:40,773", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.004258s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 05:29:40,774", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 05:29:40,774", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00010s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 05:29:40,775", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 05:29:40,775", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001019s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 05:29:40,776", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 05:29:40,776", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001619s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 05:29:40,778", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 05:29:40,779", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-11-13 05:29:40,779", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-11-13 05:29:40,779", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-11-13 05:31:21,643", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-11-13 05:31:22,182", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-11-13 05:31:22,182", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-11-13 05:31:22,206", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-11-13 05:31:22,206", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 05:31:22,206", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-11-13 05:31:22,207", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 05:31:22,207", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-11-13 05:31:22,207", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 05:31:22,208", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 05:31:22,209", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 05:31:22,209", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00009s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 05:31:22,211", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 05:31:22,211", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.00203s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 05:31:22,211", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 05:31:22,211", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002496s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 05:31:22,212", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 05:31:22,212", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00007s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 05:31:22,213", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 05:31:22,213", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0007368s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 05:31:22,213", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 05:31:22,213", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001132s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 05:31:22,213", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 05:31:22,214", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-11-13 05:31:22,214", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-11-13 05:31:22,214", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-11-13 05:31:43,247", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-11-13 05:31:43,700", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-11-13 05:31:43,700", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-11-13 05:31:43,716", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-11-13 05:31:43,716", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 05:31:43,716", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-11-13 05:31:43,716", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 05:31:43,717", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-11-13 05:31:43,717", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 05:31:43,718", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 05:31:43,719", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 05:31:43,719", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00009s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 05:31:43,720", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 05:31:43,721", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001849s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 05:31:43,721", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 05:31:43,721", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002261s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 05:31:43,722", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 05:31:43,722", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00007s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 05:31:43,722", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 05:31:43,722", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0004692s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 05:31:43,723", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 05:31:43,723", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001077s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 05:31:43,723", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 05:31:43,723", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-11-13 05:31:43,723", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-11-13 05:31:43,723", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-11-13 05:37:33,695", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-11-13 05:37:34,283", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-11-13 05:37:34,283", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-11-13 05:37:34,304", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-11-13 05:37:34,304", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 05:37:34,305", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-11-13 05:37:34,305", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 05:37:34,305", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-11-13 05:37:34,305", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 05:37:34,306", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 05:37:34,307", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 05:37:34,307", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00011s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 05:37:34,309", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 05:37:34,309", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002136s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 05:37:34,310", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 05:37:34,310", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002632s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 05:37:34,311", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 05:37:34,311", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00007s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 05:37:34,311", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 05:37:34,311", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0008591s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 05:37:34,312", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 05:37:34,312", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001517s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 05:37:34,313", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 05:37:34,313", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-11-13 05:37:34,313", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-11-13 05:37:34,313", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-11-13 05:40:34,796", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-11-13 05:40:35,438", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-11-13 05:40:35,438", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-11-13 05:40:35,458", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-11-13 05:40:35,459", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 05:40:35,462", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-11-13 05:40:35,462", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 05:40:35,462", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-11-13 05:40:35,462", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 05:40:35,463", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 05:40:35,464", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 05:40:35,464", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00010s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 05:40:35,466", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 05:40:35,466", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001672s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 05:40:35,466", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 05:40:35,466", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002028s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 05:40:35,469", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 05:40:35,469", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00007s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 05:40:35,471", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 05:40:35,471", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002758s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 05:40:35,481", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 05:40:35,481", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.01212s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 05:40:35,487", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 05:40:35,489", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-11-13 05:40:35,489", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-11-13 05:40:35,489", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-11-13 05:40:43,397", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-11-13 05:40:43,896", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-11-13 05:40:43,896", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-11-13 05:40:43,916", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-11-13 05:40:43,916", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 05:40:43,917", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-11-13 05:40:43,917", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 05:40:43,917", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-11-13 05:40:43,917", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 05:40:43,918", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 05:40:43,919", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 05:40:43,919", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00011s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 05:40:43,921", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 05:40:43,921", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001987s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 05:40:43,921", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 05:40:43,921", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002338s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 05:40:43,922", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 05:40:43,922", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00007s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 05:40:43,923", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 05:40:43,923", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0005761s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 05:40:43,923", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 05:40:43,923", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.00103s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 05:40:43,924", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 05:40:43,924", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-11-13 05:40:43,924", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-11-13 05:40:43,924", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-11-13 05:42:12,902", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-11-13 05:42:13,734", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-11-13 05:42:13,734", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-11-13 05:42:13,752", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-11-13 05:42:13,752", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 05:42:13,753", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-11-13 05:42:13,753", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 05:42:13,753", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-11-13 05:42:13,753", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 05:42:13,754", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 05:42:13,755", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 05:42:13,755", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00010s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 05:42:13,757", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 05:42:13,757", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001869s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 05:42:13,757", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 05:42:13,757", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002237s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 05:42:13,758", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 05:42:13,758", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00007s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 05:42:13,759", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 05:42:13,759", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0006321s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 05:42:13,759", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 05:42:13,759", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.00116s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 05:42:13,760", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 05:42:13,760", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-11-13 05:42:13,760", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-11-13 05:42:13,760", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-11-13 05:43:03,397", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-11-13 05:43:03,956", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-11-13 05:43:03,956", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-11-13 05:43:03,976", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-11-13 05:43:03,976", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 05:43:03,977", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-11-13 05:43:03,977", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 05:43:03,977", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-11-13 05:43:03,977", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 05:43:03,978", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 05:43:03,979", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 05:43:03,979", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00017s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 05:43:03,981", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 05:43:03,981", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002479s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 05:43:03,982", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 05:43:03,982", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.003036s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 05:43:03,983", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 05:43:03,983", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00007s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 05:43:03,983", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 05:43:03,983", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0006624s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 05:43:03,984", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 05:43:03,984", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001294s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 05:43:03,984", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 05:43:03,985", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-11-13 05:43:03,985", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-11-13 05:43:03,985", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-11-13 05:45:47,712", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-11-13 05:45:48,287", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-11-13 05:45:48,287", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-11-13 05:45:48,304", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-11-13 05:45:48,305", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 05:45:48,305", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-11-13 05:45:48,305", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 05:45:48,306", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-11-13 05:45:48,306", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 05:45:48,307", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 05:45:48,308", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 05:45:48,308", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00009s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 05:45:48,310", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 05:45:48,310", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002614s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 05:45:48,311", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 05:45:48,311", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.00315s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 05:45:48,312", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 05:45:48,312", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00007s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 05:45:48,312", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 05:45:48,312", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0006464s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 05:45:48,313", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 05:45:48,313", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001222s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 05:45:48,313", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 05:45:48,313", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-11-13 05:45:48,313", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-11-13 05:45:48,313", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-11-13 05:57:08,534", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-11-13 05:57:09,090", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-11-13 05:57:09,090", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-11-13 05:57:09,108", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-11-13 05:57:09,108", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 05:57:09,109", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-11-13 05:57:09,109", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 05:57:09,109", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-11-13 05:57:09,109", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 05:57:09,110", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 05:57:09,111", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 05:57:09,111", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00009s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 05:57:09,115", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 05:57:09,115", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.003778s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 05:57:09,115", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 05:57:09,115", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.004325s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 05:57:09,116", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 05:57:09,116", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00007s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 05:57:09,117", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 05:57:09,117", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0006642s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 05:57:09,118", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 05:57:09,118", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001255s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 05:57:09,118", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 05:57:09,118", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-11-13 05:57:09,118", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-11-13 05:57:09,118", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-11-13 09:08:21,723", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-11-13 09:08:22,333", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-11-13 09:08:22,333", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-11-13 09:08:22,352", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-11-13 09:08:22,352", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 09:08:22,353", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-11-13 09:08:22,353", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 09:08:22,353", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-11-13 09:08:22,353", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 09:08:22,354", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 09:08:22,355", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 09:08:22,355", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00009s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 09:08:22,357", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 09:08:22,357", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002424s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 09:08:22,358", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 09:08:22,358", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002862s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 09:08:22,359", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 09:08:22,359", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00011s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 09:08:22,359", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 09:08:22,359", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0006989s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 09:08:22,360", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 09:08:22,360", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001278s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 09:08:22,360", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 09:08:22,361", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-11-13 09:08:22,361", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-11-13 09:08:22,361", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-11-13 09:19:09,150", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-11-13 09:19:09,975", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-11-13 09:19:09,975", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-11-13 09:19:09,994", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-11-13 09:19:09,994", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 09:19:09,995", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-11-13 09:19:09,995", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 09:19:09,995", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-11-13 09:19:09,995", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 09:19:09,997", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 09:19:09,998", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 09:19:09,998", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00010s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 09:19:09,999", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 09:19:09,999", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001158s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 09:19:09,999", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 09:19:09,999", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001487s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 09:19:10,000", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 09:19:10,000", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00007s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 09:19:10,001", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 09:19:10,001", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0006347s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 09:19:10,001", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 09:19:10,001", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.00103s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 09:19:10,001", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 09:19:10,001", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-11-13 09:19:10,001", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-11-13 09:19:10,001", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-11-13 09:19:17,426", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook verification: responding with challenge"}
{"asctime": "2025-11-13 09:19:34,181", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {}"}
{"asctime": "2025-11-13 09:19:34,182", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from "}
{"asctime": "2025-11-13 09:19:34,194", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 09:19:34,198", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 09:19:34,198", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00038s] {'phone_number_1': '', 'param_1': 1}"}
{"asctime": "2025-11-13 09:19:34,209", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO users (id, phone_number, email, whatsapp_name, first_name, last_name, id_number, date_of_birth, nationality, address_line1, address_line2, city, province, postal_code, country, account_number, balance, status, pin_hash, pin_attempts, pin_locked_until, is_phone_verified, is_email_verified, is_id_verified, is_address_verified, is_fica_compliant, id_document_url, proof_of_residence_url, selfie_url, daily_limit, monthly_limit, daily_spent, monthly_spent, last_daily_reset, last_monthly_reset, preferred_language, notification_enabled, marketing_consent, user_metadata, referral_code, referred_by, created_at, updated_at, last_active_at, verified_at) VALUES (%(id)s::UUID, %(phone_number)s, %(email)s, %(whatsapp_name)s, %(first_name)s, %(last_name)s, %(id_number)s, %(date_of_birth)s, %(nationality)s, %(address_line1)s, %(address_line2)s, %(city)s, %(province)s, %(postal_code)s, %(country)s, %(account_number)s, %(balance)s, %(status)s, %(pin_hash)s, %(pin_attempts)s, %(pin_locked_until)s, %(is_phone_verified)s, %(is_email_verified)s, %(is_id_verified)s, %(is_address_verified)s, %(is_fica_compliant)s, %(id_document_url)s, %(proof_of_residence_url)s, %(selfie_url)s, %(daily_limit)s, %(monthly_limit)s, %(daily_spent)s, %(monthly_spent)s, now(), now(), %(preferred_language)s, %(notification_enabled)s, %(marketing_consent)s, %(user_metadata)s, %(referral_code)s, %(referred_by)s::UUID, now(), now(), now(), %(verified_at)s) RETURNING users.last_daily_reset, users.last_monthly_reset, users.created_at, users.updated_at, users.last_active_at"}
{"asctime": "2025-11-13 09:19:34,209", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00056s] {'id': UUID('e24c5e41-4799-41e8-bba3-4afc9ba8010f'), 'phone_number': '', 'email': None, 'whatsapp_name': '', 'first_name': None, 'last_name': None, 'id_number': None, 'date_of_birth': None, 'nationality': None, 'address_line1': None, 'address_line2': None, 'city': None, 'province': None, 'postal_code': None, 'country': 'South Africa', 'account_number': None, 'balance': 0.0, 'status': 'PENDING_VERIFICATION', 'pin_hash': None, 'pin_attempts': 0, 'pin_locked_until': None, 'is_phone_verified': False, 'is_email_verified': False, 'is_id_verified': False, 'is_address_verified': False, 'is_fica_compliant': False, 'id_document_url': None, 'proof_of_residence_url': None, 'selfie_url': None, 'daily_limit': 25000.0, 'monthly_limit': 100000.0, 'daily_spent': 0.0, 'monthly_spent': 0.0, 'preferred_language': 'en', 'notification_enabled': True, 'marketing_consent': False, 'user_metadata': '{}', 'referral_code': None, 'referred_by': None, 'verified_at': None}"}
{"asctime": "2025-11-13 09:19:34,214", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 09:19:34,216", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 09:19:34,217", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id, users.phone_number, users.email, users.whatsapp_name, users.first_name, users.last_name, users.id_number, users.date_of_birth, users.nationality, users.address_line1, users.address_line2, users.city, users.province, users.postal_code, users.country, users.account_number, users.balance, users.status, users.pin_hash, users.pin_attempts, users.pin_locked_until, users.is_phone_verified, users.is_email_verified, users.is_id_verified, users.is_address_verified, users.is_fica_compliant, users.id_document_url, users.proof_of_residence_url, users.selfie_url, users.daily_limit, users.monthly_limit, users.daily_spent, users.monthly_spent, users.last_daily_reset, users.last_monthly_reset, users.preferred_language, users.notification_enabled, users.marketing_consent, users.user_metadata, users.referral_code, users.referred_by, users.created_at, users.updated_at, users.last_active_at, users.verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 09:19:34,217", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00012s] {'pk_1': UUID('e24c5e41-4799-41e8-bba3-4afc9ba8010f')}"}
{"asctime": "2025-11-13 09:19:34,822", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 400 Bad Request\""}
{"asctime": "2025-11-13 09:19:34,824", "name": "app.services.twilio_service", "levelname": "ERROR", "message": "Twilio API error: {\"code\":21211,\"message\":\"The 'To' number whatsapp:+ is not a valid phone number.\",\"more_info\":\"https://www.twilio.com/docs/errors/21211\",\"status\":400}"}
{"asctime": "2025-11-13 09:19:34,824", "name": "app.routers.whatsapp", "levelname": "ERROR", "message": "Message processing error: Client error '400 Bad Request' for url 'https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400", "exc_info": "Traceback (most recent call last):\n  File \"/Users/explosive/projects/cyrax/app/routers/whatsapp.py\", line 110, in process_message\n    await send_welcome_message_new_user(phone_number, from_name)\n  File \"/Users/explosive/projects/cyrax/app/routers/whatsapp.py\", line 348, in send_welcome_message_new_user\n    await twilio_whatsapp.send_message(phone_number, welcome)\n  File \"/Users/explosive/projects/cyrax/app/services/twilio_service.py\", line 67, in send_message\n    response.raise_for_status()\n  File \"/Users/explosive/projects/cyrax/venv/lib/python3.11/site-packages/httpx/_models.py\", line 758, in raise_for_status\n    raise HTTPStatusError(message, request=request, response=self)\nhttpx.HTTPStatusError: Client error '400 Bad Request' for url 'https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400"}
{"asctime": "2025-11-13 09:19:35,199", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {}"}
{"asctime": "2025-11-13 09:19:35,199", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from "}
{"asctime": "2025-11-13 09:19:35,209", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 09:19:35,209", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 09:19:35,209", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 1.011s ago] {'phone_number_1': '', 'param_1': 1}"}
{"asctime": "2025-11-13 09:19:35,270", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 400 Bad Request\""}
{"asctime": "2025-11-13 09:19:35,270", "name": "app.services.twilio_service", "levelname": "ERROR", "message": "Twilio API error: {\"code\":21211,\"message\":\"The 'To' number whatsapp:+ is not a valid phone number.\",\"more_info\":\"https://www.twilio.com/docs/errors/21211\",\"status\":400}"}
{"asctime": "2025-11-13 09:19:35,270", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "ROLLBACK"}
{"asctime": "2025-11-13 09:19:35,271", "name": "app.main", "levelname": "ERROR", "message": "Unhandled exception: Client error '400 Bad Request' for url 'https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400", "exc_info": "Traceback (most recent call last):\n  File \"/Users/explosive/projects/cyrax/app/routers/whatsapp.py\", line 110, in process_message\n    await send_welcome_message_new_user(phone_number, from_name)\n  File \"/Users/explosive/projects/cyrax/app/routers/whatsapp.py\", line 348, in send_welcome_message_new_user\n    await twilio_whatsapp.send_message(phone_number, welcome)\n  File \"/Users/explosive/projects/cyrax/app/services/twilio_service.py\", line 67, in send_message\n    response.raise_for_status()\n  File \"/Users/explosive/projects/cyrax/venv/lib/python3.11/site-packages/httpx/_models.py\", line 758, in raise_for_status\n    raise HTTPStatusError(message, request=request, response=self)\nhttpx.HTTPStatusError: Client error '400 Bad Request' for url 'https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/Users/explosive/projects/cyrax/venv/lib/python3.11/site-packages/starlette/middleware/errors.py\", line 162, in __call__\n    await self.app(scope, receive, _send)\n  File \"/Users/explosive/projects/cyrax/venv/lib/python3.11/site-packages/starlette/middleware/cors.py\", line 83, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/explosive/projects/cyrax/venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py\", line 79, in __call__\n    raise exc\n  File \"/Users/explosive/projects/cyrax/venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py\", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File \"/Users/explosive/projects/cyrax/venv/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py\", line 20, in __call__\n    raise e\n  File \"/Users/explosive/projects/cyrax/venv/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py\", line 17, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/explosive/projects/cyrax/venv/lib/python3.11/site-packages/starlette/routing.py\", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File \"/Users/explosive/projects/cyrax/venv/lib/python3.11/site-packages/starlette/routing.py\", line 276, in handle\n    await self.app(scope, receive, send)\n  File \"/Users/explosive/projects/cyrax/venv/lib/python3.11/site-packages/starlette/routing.py\", line 69, in app\n    await response(scope, receive, send)\n  File \"/Users/explosive/projects/cyrax/venv/lib/python3.11/site-packages/starlette/responses.py\", line 174, in __call__\n    await self.background()\n  File \"/Users/explosive/projects/cyrax/venv/lib/python3.11/site-packages/starlette/background.py\", line 43, in __call__\n    await task()\n  File \"/Users/explosive/projects/cyrax/venv/lib/python3.11/site-packages/starlette/background.py\", line 26, in __call__\n    await self.func(*self.args, **self.kwargs)\n  File \"/Users/explosive/projects/cyrax/app/routers/whatsapp.py\", line 317, in process_message\n    await twilio_whatsapp.send_message(\n  File \"/Users/explosive/projects/cyrax/app/services/twilio_service.py\", line 67, in send_message\n    response.raise_for_status()\n  File \"/Users/explosive/projects/cyrax/venv/lib/python3.11/site-packages/httpx/_models.py\", line 758, in raise_for_status\n    raise HTTPStatusError(message, request=request, response=self)\nhttpx.HTTPStatusError: Client error '400 Bad Request' for url 'https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400"}
{"asctime": "2025-11-13 09:19:35,667", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 400 Bad Request\""}
{"asctime": "2025-11-13 09:19:35,669", "name": "app.services.twilio_service", "levelname": "ERROR", "message": "Twilio API error: {\"code\":21211,\"message\":\"The 'To' number whatsapp:+ is not a valid phone number.\",\"more_info\":\"https://www.twilio.com/docs/errors/21211\",\"status\":400}"}
{"asctime": "2025-11-13 09:19:35,670", "name": "app.routers.whatsapp", "levelname": "ERROR", "message": "Message processing error: Client error '400 Bad Request' for url 'https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400", "exc_info": "Traceback (most recent call last):\n  File \"/Users/explosive/projects/cyrax/app/routers/whatsapp.py\", line 132, in process_message\n    await twilio_whatsapp.send_message(phone_number, status_msg)\n  File \"/Users/explosive/projects/cyrax/app/services/twilio_service.py\", line 67, in send_message\n    response.raise_for_status()\n  File \"/Users/explosive/projects/cyrax/venv/lib/python3.11/site-packages/httpx/_models.py\", line 758, in raise_for_status\n    raise HTTPStatusError(message, request=request, response=self)\nhttpx.HTTPStatusError: Client error '400 Bad Request' for url 'https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400"}
{"asctime": "2025-11-13 09:19:36,098", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 400 Bad Request\""}
{"asctime": "2025-11-13 09:19:36,100", "name": "app.services.twilio_service", "levelname": "ERROR", "message": "Twilio API error: {\"code\":21211,\"message\":\"The 'To' number whatsapp:+ is not a valid phone number.\",\"more_info\":\"https://www.twilio.com/docs/errors/21211\",\"status\":400}"}
{"asctime": "2025-11-13 09:19:36,101", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "ROLLBACK"}
{"asctime": "2025-11-13 09:19:36,101", "name": "app.main", "levelname": "ERROR", "message": "Unhandled exception: Client error '400 Bad Request' for url 'https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400", "exc_info": "Traceback (most recent call last):\n  File \"/Users/explosive/projects/cyrax/app/routers/whatsapp.py\", line 132, in process_message\n    await twilio_whatsapp.send_message(phone_number, status_msg)\n  File \"/Users/explosive/projects/cyrax/app/services/twilio_service.py\", line 67, in send_message\n    response.raise_for_status()\n  File \"/Users/explosive/projects/cyrax/venv/lib/python3.11/site-packages/httpx/_models.py\", line 758, in raise_for_status\n    raise HTTPStatusError(message, request=request, response=self)\nhttpx.HTTPStatusError: Client error '400 Bad Request' for url 'https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/Users/explosive/projects/cyrax/venv/lib/python3.11/site-packages/starlette/middleware/errors.py\", line 162, in __call__\n    await self.app(scope, receive, _send)\n  File \"/Users/explosive/projects/cyrax/venv/lib/python3.11/site-packages/starlette/middleware/cors.py\", line 83, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/explosive/projects/cyrax/venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py\", line 79, in __call__\n    raise exc\n  File \"/Users/explosive/projects/cyrax/venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py\", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File \"/Users/explosive/projects/cyrax/venv/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py\", line 20, in __call__\n    raise e\n  File \"/Users/explosive/projects/cyrax/venv/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py\", line 17, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/explosive/projects/cyrax/venv/lib/python3.11/site-packages/starlette/routing.py\", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File \"/Users/explosive/projects/cyrax/venv/lib/python3.11/site-packages/starlette/routing.py\", line 276, in handle\n    await self.app(scope, receive, send)\n  File \"/Users/explosive/projects/cyrax/venv/lib/python3.11/site-packages/starlette/routing.py\", line 69, in app\n    await response(scope, receive, send)\n  File \"/Users/explosive/projects/cyrax/venv/lib/python3.11/site-packages/starlette/responses.py\", line 174, in __call__\n    await self.background()\n  File \"/Users/explosive/projects/cyrax/venv/lib/python3.11/site-packages/starlette/background.py\", line 43, in __call__\n    await task()\n  File \"/Users/explosive/projects/cyrax/venv/lib/python3.11/site-packages/starlette/background.py\", line 26, in __call__\n    await self.func(*self.args, **self.kwargs)\n  File \"/Users/explosive/projects/cyrax/app/routers/whatsapp.py\", line 317, in process_message\n    await twilio_whatsapp.send_message(\n  File \"/Users/explosive/projects/cyrax/app/services/twilio_service.py\", line 67, in send_message\n    response.raise_for_status()\n  File \"/Users/explosive/projects/cyrax/venv/lib/python3.11/site-packages/httpx/_models.py\", line 758, in raise_for_status\n    raise HTTPStatusError(message, request=request, response=self)\nhttpx.HTTPStatusError: Client error '400 Bad Request' for url 'https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400"}
{"asctime": "2025-11-13 09:19:36,950", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received: {}"}
{"asctime": "2025-11-13 09:19:36,951", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from "}
{"asctime": "2025-11-13 09:19:36,952", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 09:19:36,953", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 09:19:36,953", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 2.755s ago] {'phone_number_1': '', 'param_1': 1}"}
{"asctime": "2025-11-13 09:19:37,414", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 400 Bad Request\""}
{"asctime": "2025-11-13 09:19:37,415", "name": "app.services.twilio_service", "levelname": "ERROR", "message": "Twilio API error: {\"code\":21211,\"message\":\"The 'To' number whatsapp:+ is not a valid phone number.\",\"more_info\":\"https://www.twilio.com/docs/errors/21211\",\"status\":400}"}
{"asctime": "2025-11-13 09:19:37,416", "name": "app.routers.whatsapp", "levelname": "ERROR", "message": "Message processing error: Client error '400 Bad Request' for url 'https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400", "exc_info": "Traceback (most recent call last):\n  File \"/Users/explosive/projects/cyrax/app/routers/whatsapp.py\", line 132, in process_message\n    await twilio_whatsapp.send_message(phone_number, status_msg)\n  File \"/Users/explosive/projects/cyrax/app/services/twilio_service.py\", line 67, in send_message\n    response.raise_for_status()\n  File \"/Users/explosive/projects/cyrax/venv/lib/python3.11/site-packages/httpx/_models.py\", line 758, in raise_for_status\n    raise HTTPStatusError(message, request=request, response=self)\nhttpx.HTTPStatusError: Client error '400 Bad Request' for url 'https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400"}
{"asctime": "2025-11-13 09:19:37,948", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json \"HTTP/1.1 400 Bad Request\""}
{"asctime": "2025-11-13 09:19:37,949", "name": "app.services.twilio_service", "levelname": "ERROR", "message": "Twilio API error: {\"code\":21211,\"message\":\"The 'To' number whatsapp:+ is not a valid phone number.\",\"more_info\":\"https://www.twilio.com/docs/errors/21211\",\"status\":400}"}
{"asctime": "2025-11-13 09:19:37,950", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "ROLLBACK"}
{"asctime": "2025-11-13 09:19:37,951", "name": "app.main", "levelname": "ERROR", "message": "Unhandled exception: Client error '400 Bad Request' for url 'https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400", "exc_info": "Traceback (most recent call last):\n  File \"/Users/explosive/projects/cyrax/app/routers/whatsapp.py\", line 132, in process_message\n    await twilio_whatsapp.send_message(phone_number, status_msg)\n  File \"/Users/explosive/projects/cyrax/app/services/twilio_service.py\", line 67, in send_message\n    response.raise_for_status()\n  File \"/Users/explosive/projects/cyrax/venv/lib/python3.11/site-packages/httpx/_models.py\", line 758, in raise_for_status\n    raise HTTPStatusError(message, request=request, response=self)\nhttpx.HTTPStatusError: Client error '400 Bad Request' for url 'https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/Users/explosive/projects/cyrax/venv/lib/python3.11/site-packages/starlette/middleware/errors.py\", line 162, in __call__\n    await self.app(scope, receive, _send)\n  File \"/Users/explosive/projects/cyrax/venv/lib/python3.11/site-packages/starlette/middleware/cors.py\", line 83, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/explosive/projects/cyrax/venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py\", line 79, in __call__\n    raise exc\n  File \"/Users/explosive/projects/cyrax/venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py\", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File \"/Users/explosive/projects/cyrax/venv/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py\", line 20, in __call__\n    raise e\n  File \"/Users/explosive/projects/cyrax/venv/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py\", line 17, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/explosive/projects/cyrax/venv/lib/python3.11/site-packages/starlette/routing.py\", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File \"/Users/explosive/projects/cyrax/venv/lib/python3.11/site-packages/starlette/routing.py\", line 276, in handle\n    await self.app(scope, receive, send)\n  File \"/Users/explosive/projects/cyrax/venv/lib/python3.11/site-packages/starlette/routing.py\", line 69, in app\n    await response(scope, receive, send)\n  File \"/Users/explosive/projects/cyrax/venv/lib/python3.11/site-packages/starlette/responses.py\", line 174, in __call__\n    await self.background()\n  File \"/Users/explosive/projects/cyrax/venv/lib/python3.11/site-packages/starlette/background.py\", line 43, in __call__\n    await task()\n  File \"/Users/explosive/projects/cyrax/venv/lib/python3.11/site-packages/starlette/background.py\", line 26, in __call__\n    await self.func(*self.args, **self.kwargs)\n  File \"/Users/explosive/projects/cyrax/app/routers/whatsapp.py\", line 317, in process_message\n    await twilio_whatsapp.send_message(\n  File \"/Users/explosive/projects/cyrax/app/services/twilio_service.py\", line 67, in send_message\n    response.raise_for_status()\n  File \"/Users/explosive/projects/cyrax/venv/lib/python3.11/site-packages/httpx/_models.py\", line 758, in raise_for_status\n    raise HTTPStatusError(message, request=request, response=self)\nhttpx.HTTPStatusError: Client error '400 Bad Request' for url 'https://api.twilio.com/2010-04-01/Accounts/AC6a10482bfc51f0846f64980cb7f1676e/Messages.json'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400"}
{"asctime": "2025-11-13 09:29:39,053", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-11-13 09:29:39,686", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-11-13 09:29:39,686", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-11-13 09:29:39,704", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-11-13 09:29:39,704", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 09:29:39,704", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-11-13 09:29:39,704", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 09:29:39,705", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-11-13 09:29:39,705", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 09:29:39,705", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 09:29:39,706", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 09:29:39,706", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00010s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 09:29:39,707", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 09:29:39,707", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001428s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 09:29:39,708", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 09:29:39,708", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001777s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 09:29:39,709", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 09:29:39,709", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00007s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 09:29:39,709", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 09:29:39,709", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0007041s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 09:29:39,710", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 09:29:39,710", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001191s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 09:29:39,710", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 09:29:39,710", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-11-13 09:29:39,710", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-11-13 09:29:39,710", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-11-13 09:29:51,991", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-11-13 09:29:52,494", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-11-13 09:29:52,494", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-11-13 09:29:52,511", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-11-13 09:29:52,511", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 09:29:52,512", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-11-13 09:29:52,512", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 09:29:52,513", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-11-13 09:29:52,513", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 09:29:52,513", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 09:29:52,514", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 09:29:52,514", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00009s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 09:29:52,517", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 09:29:52,517", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002467s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 09:29:52,517", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 09:29:52,517", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.00291s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 09:29:52,518", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 09:29:52,518", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00008s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 09:29:52,518", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 09:29:52,519", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0006322s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 09:29:52,519", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 09:29:52,519", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001071s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 09:29:52,519", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 09:29:52,519", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-11-13 09:29:52,519", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-11-13 09:29:52,519", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-11-13 09:40:35,698", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-11-13 09:40:36,496", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-11-13 09:40:36,496", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-11-13 09:40:36,515", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-11-13 09:40:36,515", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 09:40:36,516", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-11-13 09:40:36,516", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 09:40:36,516", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-11-13 09:40:36,516", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 09:40:36,517", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 09:40:36,518", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 09:40:36,518", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00009s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 09:40:36,520", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 09:40:36,520", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001882s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 09:40:36,520", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 09:40:36,520", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002278s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 09:40:36,521", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 09:40:36,521", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00010s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 09:40:36,522", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 09:40:36,522", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001254s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 09:40:36,523", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 09:40:36,523", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001979s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 09:40:36,523", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 09:40:36,523", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-11-13 09:40:36,523", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-11-13 09:40:36,523", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-11-13 09:46:48,044", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (Form): {'SmsMessageSid': 'SM9dc29a6624a4e626d3914ea4f78ffabb', 'NumMedia': '0', 'ProfileName': 'Hello World', 'MessageType': 'text', 'SmsSid': 'SM9dc29a6624a4e626d3914ea4f78ffabb', 'WaId': '27763024044', 'SmsStatus': 'received', 'Body': 'Hi', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'SM9dc29a6624a4e626d3914ea4f78ffabb', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World\",\"WaId\":\"27763024044\"}}}', 'From': 'whatsapp:+27763024044', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-11-13 09:46:48,045", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from "}
{"asctime": "2025-11-13 09:46:48,054", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 09:46:48,057", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 09:46:48,058", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00041s] {'phone_number_1': '', 'param_1': 1}"}
{"asctime": "2025-11-13 09:46:48,922", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 09:46:48,924", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to : Success"}
{"asctime": "2025-11-13 09:46:48,925", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "ROLLBACK"}
{"asctime": "2025-11-13 09:48:50,842", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World'}, 'wa_id': '27763024044'}], 'messages': [{'from': '27763024044', 'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQUE0OTE3OEQyOTM2NTlDMjBFNAA=', 'timestamp': '1763020129', 'text': {'body': 'Ho'}, 'type': 'text'}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 09:48:50,845", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from "}
{"asctime": "2025-11-13 09:48:50,889", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 09:48:50,891", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 09:48:50,891", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 122.8s ago] {'phone_number_1': '', 'param_1': 1}"}
{"asctime": "2025-11-13 09:48:51,836", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 09:48:51,838", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to : Success"}
{"asctime": "2025-11-13 09:48:51,839", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "ROLLBACK"}
{"asctime": "2025-11-13 09:52:01,553", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-11-13 09:52:02,113", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-11-13 09:52:02,113", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-11-13 09:52:02,132", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-11-13 09:52:02,132", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 09:52:02,133", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-11-13 09:52:02,133", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 09:52:02,134", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-11-13 09:52:02,134", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 09:52:02,134", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 09:52:02,135", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 09:52:02,135", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00009s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 09:52:02,137", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 09:52:02,137", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002193s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 09:52:02,138", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 09:52:02,138", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002646s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 09:52:02,139", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 09:52:02,139", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00006s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 09:52:02,139", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 09:52:02,139", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0006135s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 09:52:02,140", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 09:52:02,140", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001243s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 09:52:02,140", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 09:52:02,140", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-11-13 09:52:02,140", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-11-13 09:52:02,140", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-11-13 09:52:13,452", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World'}, 'wa_id': '27763024044'}], 'messages': [{'from': '27763024044', 'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQTdGMUEzODhDNUMyQThGRUI0RgA=', 'timestamp': '1763020332', 'text': {'body': 'Hi'}, 'type': 'text'}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 09:52:13,452", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763024044"}
{"asctime": "2025-11-13 09:52:13,463", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 09:52:13,468", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 09:52:13,468", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00040s] {'phone_number_1': '+27763024044', 'param_1': 1}"}
{"asctime": "2025-11-13 09:52:13,473", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-13 09:52:13,473", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00017s] {'last_active_at': datetime.datetime(2025, 11, 13, 7, 52, 13, 471943), 'users_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 09:52:13,477", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 09:52:13,481", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 09:52:13,482", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 09:52:13,483", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00023s] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 09:52:13,485", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-13 09:52:13,485", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00016s] {'id': UUID('bc215bf1-f3f5-41d6-ae23-3412a7de9ac7'), 'user_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'phone_number': '+27763024044', 'message_id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQTdGMUEzODhDNUMyQThGRUI0RgA=', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'Hi', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-13 09:52:13,489", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 09:52:13,490", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 09:52:13,490", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 09:52:13,490", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.007658s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 09:52:13,493", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 09:52:13,493", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00019s] {'user_id_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'param_1': 5}"}
{"asctime": "2025-11-13 09:52:15,573", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 09:52:15,584", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 09:52:15,584", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00068s] {'pk_1': UUID('bc215bf1-f3f5-41d6-ae23-3412a7de9ac7')}"}
{"asctime": "2025-11-13 09:52:15,587", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-13 09:52:15,587", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00038s] {'ai_response': 'Hey there, Sam! How can I assist you today? \ud83d\ude0a', 'intent_detected': 'greeting', 'entities_extracted': '{}', 'confidence_score': 0.95, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 13, 7, 52, 15, 580589), 'conversations_id': UUID('bc215bf1-f3f5-41d6-ae23-3412a7de9ac7')}"}
{"asctime": "2025-11-13 09:52:15,590", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 09:52:16,652", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 09:52:16,654", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763024044: Success"}
{"asctime": "2025-11-13 09:52:18,639", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': 'b501b89f-6bc9-4807-a17f-34195b5e3622', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763024044', 'wa_id': '27763024044'}], 'messages': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJGRkNGQkM5MjEwREI5MUI3QjcA'}]}}"}
{"asctime": "2025-11-13 09:52:18,891", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 09:52:18,892", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763024044: Success"}
{"asctime": "2025-11-13 09:52:19,375", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJGRkNGQkM5MjEwREI5MUI3QjcA', 'status': 'sent', 'timestamp': '1763020338', 'recipient_id': '27763024044', 'conversation': {'id': 'c2aeae793de1998f6d7b2857aa5cc952', 'expiration_timestamp': '1763020338', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 09:52:19,726", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJGRkNGQkM5MjEwREI5MUI3QjcA', 'status': 'delivered', 'timestamp': '1763020338', 'recipient_id': '27763024044', 'conversation': {'id': 'c2aeae793de1998f6d7b2857aa5cc952', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 09:52:19,915", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJGRkNGQkM5MjEwREI5MUI3QjcA', 'status': 'read', 'timestamp': '1763020338', 'recipient_id': '27763024044', 'conversation': {'id': 'c2aeae793de1998f6d7b2857aa5cc952', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 09:52:20,221", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '55da834d-d59e-4cf4-aef2-fa5a809d08dd', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763024044', 'wa_id': '27763024044'}], 'messages': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBIwM0JCQzM2MDI1NzdBNzU0RjYA'}]}}"}
{"asctime": "2025-11-13 09:52:21,213", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBIwM0JCQzM2MDI1NzdBNzU0RjYA', 'status': 'sent', 'timestamp': '1763020340', 'recipient_id': '27763024044', 'conversation': {'id': '3039fee1c9f988e2751f7859f156e175', 'expiration_timestamp': '1763020340', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 09:52:21,672", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBIwM0JCQzM2MDI1NzdBNzU0RjYA', 'status': 'delivered', 'timestamp': '1763020340', 'recipient_id': '27763024044', 'conversation': {'id': '3039fee1c9f988e2751f7859f156e175', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 09:52:21,958", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBIwM0JCQzM2MDI1NzdBNzU0RjYA', 'status': 'read', 'timestamp': '1763020340', 'recipient_id': '27763024044', 'conversation': {'id': '3039fee1c9f988e2751f7859f156e175', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 09:52:53,519", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World'}, 'wa_id': '27763024044'}], 'messages': [{'from': '27763024044', 'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQTlBREQ3OTFBOThGQUYxMkQ1RQA=', 'timestamp': '1763020372', 'text': {'body': 'What\u2019s my account balance ?'}, 'type': 'text'}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 09:52:53,520", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763024044"}
{"asctime": "2025-11-13 09:52:53,521", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 09:52:53,521", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 09:52:53,522", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 40.05s ago] {'phone_number_1': '+27763024044', 'param_1': 1}"}
{"asctime": "2025-11-13 09:52:53,523", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-13 09:52:53,523", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 40.05s ago] {'last_active_at': datetime.datetime(2025, 11, 13, 7, 52, 53, 522830), 'users_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 09:52:53,523", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 09:52:53,524", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 09:52:53,525", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 09:52:53,525", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 40.04s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 09:52:53,527", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-13 09:52:53,527", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 40.04s ago] {'id': UUID('8b9b2b64-6a72-48b3-8966-1911bc0ea501'), 'user_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'phone_number': '+27763024044', 'message_id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQTlBREQ3OTFBOThGQUYxMkQ1RQA=', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'What\u2019s my account balance ?', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-13 09:52:53,528", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 09:52:53,529", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 09:52:53,530", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 09:52:53,530", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 40.05s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 09:52:53,531", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 09:52:53,531", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 40.04s ago] {'user_id_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'param_1': 5}"}
{"asctime": "2025-11-13 09:52:55,902", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 09:52:55,910", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 09:52:55,912", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 40.33s ago] {'pk_1': UUID('8b9b2b64-6a72-48b3-8966-1911bc0ea501')}"}
{"asctime": "2025-11-13 09:52:55,914", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-13 09:52:55,915", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 40.33s ago] {'ai_response': 'Your current account balance is R0.00. If you need help with anything else, just let me know! \ud83d\ude0a', 'intent_detected': 'check_balance', 'entities_extracted': '{}', 'confidence_score': 0.95, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 13, 7, 52, 55, 907449), 'conversations_id': UUID('8b9b2b64-6a72-48b3-8966-1911bc0ea501')}"}
{"asctime": "2025-11-13 09:52:55,916", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 09:52:57,113", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 09:52:57,115", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763024044: Success"}
{"asctime": "2025-11-13 09:52:58,655", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': 'a4afeab0-0fd1-4ef1-ab82-b81c6e03c4db', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763024044', 'wa_id': '27763024044'}], 'messages': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI0MDU4OTY2NUI2MTAzQTQwREUA'}]}}"}
{"asctime": "2025-11-13 09:52:59,521", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI0MDU4OTY2NUI2MTAzQTQwREUA', 'status': 'sent', 'timestamp': '1763020378', 'recipient_id': '27763024044', 'conversation': {'id': 'e8c2ae91eee53222f11e156949cf9188', 'expiration_timestamp': '1763020378', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 09:53:00,482", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI0MDU4OTY2NUI2MTAzQTQwREUA', 'status': 'delivered', 'timestamp': '1763020379', 'recipient_id': '27763024044', 'conversation': {'id': 'e8c2ae91eee53222f11e156949cf9188', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 09:53:00,483", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI0MDU4OTY2NUI2MTAzQTQwREUA', 'status': 'read', 'timestamp': '1763020379', 'recipient_id': '27763024044', 'conversation': {'id': 'e8c2ae91eee53222f11e156949cf9188', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 09:53:08,001", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World'}, 'wa_id': '27763024044'}], 'messages': [{'from': '27763024044', 'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQUQxRDJCNUFDNTc2RTc4RUQ5RAA=', 'timestamp': '1763020387', 'text': {'body': 'What\u2019s my account status'}, 'type': 'text'}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 09:53:08,001", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763024044"}
{"asctime": "2025-11-13 09:53:08,003", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 09:53:08,004", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 09:53:08,004", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 54.54s ago] {'phone_number_1': '+27763024044', 'param_1': 1}"}
{"asctime": "2025-11-13 09:53:08,006", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-13 09:53:08,006", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 54.53s ago] {'last_active_at': datetime.datetime(2025, 11, 13, 7, 53, 8, 6151), 'users_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 09:53:08,009", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 09:53:08,013", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 09:53:08,014", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 09:53:08,014", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 54.53s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 09:53:08,016", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-13 09:53:08,016", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 54.53s ago] {'id': UUID('6fc3c654-9186-4af8-87d4-bce93a4e4e12'), 'user_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'phone_number': '+27763024044', 'message_id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQUQxRDJCNUFDNTc2RTc4RUQ5RAA=', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'What\u2019s my account status', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-13 09:53:08,017", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 09:53:08,018", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 09:53:08,018", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 09:53:08,018", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 54.54s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 09:53:08,021", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 09:53:08,021", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 54.53s ago] {'user_id_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'param_1': 5}"}
{"asctime": "2025-11-13 09:53:09,168", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 09:53:09,175", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 09:53:09,178", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 53.6s ago] {'pk_1': UUID('6fc3c654-9186-4af8-87d4-bce93a4e4e12')}"}
{"asctime": "2025-11-13 09:53:09,180", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-13 09:53:09,181", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 53.59s ago] {'ai_response': \"Your account status is active! If there's anything specific you'd like to do or check, feel free to ask! \ud83d\ude0a\", 'intent_detected': 'conversation', 'entities_extracted': '{}', 'confidence_score': 0.7, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 13, 7, 53, 9, 173828), 'conversations_id': UUID('6fc3c654-9186-4af8-87d4-bce93a4e4e12')}"}
{"asctime": "2025-11-13 09:53:09,182", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 09:53:10,310", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 09:53:10,311", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763024044: Success"}
{"asctime": "2025-11-13 09:53:11,537", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '1be3cf4a-72bf-4122-849a-8784ba8301ad', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763024044', 'wa_id': '27763024044'}], 'messages': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI0REI5QkExODBCOTA5RURBNTkA'}]}}"}
{"asctime": "2025-11-13 09:53:12,668", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI0REI5QkExODBCOTA5RURBNTkA', 'status': 'sent', 'timestamp': '1763020391', 'recipient_id': '27763024044', 'conversation': {'id': '5fb96d88b7da1e801996f1f4f008559f', 'expiration_timestamp': '1763020391', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 09:53:13,000", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI0REI5QkExODBCOTA5RURBNTkA', 'status': 'read', 'timestamp': '1763020392', 'recipient_id': '27763024044', 'conversation': {'id': '5fb96d88b7da1e801996f1f4f008559f', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 09:53:13,080", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI0REI5QkExODBCOTA5RURBNTkA', 'status': 'delivered', 'timestamp': '1763020392', 'recipient_id': '27763024044', 'conversation': {'id': '5fb96d88b7da1e801996f1f4f008559f', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 09:53:37,217", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World'}, 'wa_id': '27763024044'}], 'messages': [{'from': '27763024044', 'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQUE3OTlFMkZGMTQyN0ZFNDYxRAA=', 'timestamp': '1763020416', 'text': {'body': 'Who created you'}, 'type': 'text'}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 09:53:37,218", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763024044"}
{"asctime": "2025-11-13 09:53:37,220", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 09:53:37,221", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 09:53:37,221", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 83.75s ago] {'phone_number_1': '+27763024044', 'param_1': 1}"}
{"asctime": "2025-11-13 09:53:37,224", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-13 09:53:37,224", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 83.75s ago] {'last_active_at': datetime.datetime(2025, 11, 13, 7, 53, 37, 223844), 'users_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 09:53:37,225", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 09:53:37,227", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 09:53:37,228", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 09:53:37,228", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 83.75s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 09:53:37,230", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-13 09:53:37,230", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 83.75s ago] {'id': UUID('717dfa76-8a37-4b1d-ae58-0382f8e2a5e7'), 'user_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'phone_number': '+27763024044', 'message_id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQUE3OTlFMkZGMTQyN0ZFNDYxRAA=', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'Who created you', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-13 09:53:37,233", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 09:53:37,235", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 09:53:37,236", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 09:53:37,236", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 83.76s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 09:53:37,238", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 09:53:37,239", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 83.75s ago] {'user_id_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'param_1': 5}"}
{"asctime": "2025-11-13 09:53:38,973", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 09:53:38,982", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 09:53:38,983", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 83.4s ago] {'pk_1': UUID('717dfa76-8a37-4b1d-ae58-0382f8e2a5e7')}"}
{"asctime": "2025-11-13 09:53:38,984", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-13 09:53:38,984", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 83.4s ago] {'ai_response': 'I was created by a team of talented developers to help you with your utility bills and more! \ud83d\ude0a If you have any questions or need assistance, just let me know!', 'intent_detected': 'conversation', 'entities_extracted': '{}', 'confidence_score': 0.7, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 13, 7, 53, 38, 980466), 'conversations_id': UUID('717dfa76-8a37-4b1d-ae58-0382f8e2a5e7')}"}
{"asctime": "2025-11-13 09:53:38,985", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 09:53:40,062", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 09:53:40,064", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763024044: Success"}
{"asctime": "2025-11-13 09:53:41,646", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '361d86e4-3f42-41a4-b68a-3b59fc62d8b6', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763024044', 'wa_id': '27763024044'}], 'messages': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI2M0M3N0Y4NzAyRDQxQ0EwOEYA'}]}}"}
{"asctime": "2025-11-13 09:53:42,329", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI2M0M3N0Y4NzAyRDQxQ0EwOEYA', 'status': 'sent', 'timestamp': '1763020421', 'recipient_id': '27763024044', 'conversation': {'id': '0098e097a4a54dd3102271fcf69d4899', 'expiration_timestamp': '1763020421', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 09:53:43,081", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI2M0M3N0Y4NzAyRDQxQ0EwOEYA', 'status': 'delivered', 'timestamp': '1763020422', 'recipient_id': '27763024044', 'conversation': {'id': '0098e097a4a54dd3102271fcf69d4899', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 09:53:43,082", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI2M0M3N0Y4NzAyRDQxQ0EwOEYA', 'status': 'read', 'timestamp': '1763020422', 'recipient_id': '27763024044', 'conversation': {'id': '0098e097a4a54dd3102271fcf69d4899', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 09:53:54,247", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World'}, 'wa_id': '27763024044'}], 'messages': [{'from': '27763024044', 'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQUYyNzBCQjBEOTIyQTNDNEQwMgA=', 'timestamp': '1763020433', 'text': {'body': 'Who are you'}, 'type': 'text'}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 09:53:54,247", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763024044"}
{"asctime": "2025-11-13 09:53:54,249", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 09:53:54,249", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 09:53:54,250", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 100.8s ago] {'phone_number_1': '+27763024044', 'param_1': 1}"}
{"asctime": "2025-11-13 09:53:54,251", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-13 09:53:54,252", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 100.8s ago] {'last_active_at': datetime.datetime(2025, 11, 13, 7, 53, 54, 251387), 'users_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 09:53:54,254", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 09:53:54,255", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 09:53:54,256", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 09:53:54,256", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 100.8s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 09:53:54,260", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-13 09:53:54,260", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 100.8s ago] {'id': UUID('b501b8d0-1806-41c5-8370-983f11875183'), 'user_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'phone_number': '+27763024044', 'message_id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQUYyNzBCQjBEOTIyQTNDNEQwMgA=', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'Who are you', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-13 09:53:54,262", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 09:53:54,263", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 09:53:54,264", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 09:53:54,264", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 100.8s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 09:53:54,266", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 09:53:54,266", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 100.8s ago] {'user_id_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'param_1': 5}"}
{"asctime": "2025-11-13 09:54:03,686", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 09:54:03,697", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 09:54:03,698", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 108.1s ago] {'pk_1': UUID('b501b8d0-1806-41c5-8370-983f11875183')}"}
{"asctime": "2025-11-13 09:54:03,700", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-13 09:54:03,700", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 108.1s ago] {'ai_response': \"I'm Cyrax, your friendly AI utility bill assistant! I'm here to help you with buying airtime, data bundles, paying electricity bills, checking your balance, and viewing transaction history. Just let me know what you need! \ud83d\ude0a\", 'intent_detected': 'conversation', 'entities_extracted': '{}', 'confidence_score': 0.7, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 13, 7, 54, 3, 694782), 'conversations_id': UUID('b501b8d0-1806-41c5-8370-983f11875183')}"}
{"asctime": "2025-11-13 09:54:03,702", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 09:54:04,742", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 09:54:04,744", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763024044: Success"}
{"asctime": "2025-11-13 09:54:06,529", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': 'bc5124b4-34ac-482d-adfe-2a69c941e69c', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763024044', 'wa_id': '27763024044'}], 'messages': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBIyQTQ4NjBBQUFCNzFEMTgyMTUA'}]}}"}
{"asctime": "2025-11-13 09:54:07,746", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBIyQTQ4NjBBQUFCNzFEMTgyMTUA', 'status': 'sent', 'timestamp': '1763020446', 'recipient_id': '27763024044', 'conversation': {'id': 'f6bed98478a2ab63b479dee983331982', 'expiration_timestamp': '1763020446', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 09:54:08,281", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBIyQTQ4NjBBQUFCNzFEMTgyMTUA', 'status': 'read', 'timestamp': '1763020447', 'recipient_id': '27763024044', 'conversation': {'id': 'f6bed98478a2ab63b479dee983331982', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 09:54:08,447", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBIyQTQ4NjBBQUFCNzFEMTgyMTUA', 'status': 'delivered', 'timestamp': '1763020447', 'recipient_id': '27763024044', 'conversation': {'id': 'f6bed98478a2ab63b479dee983331982', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 09:54:23,730", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World'}, 'wa_id': '27763024044'}], 'messages': [{'from': '27763024044', 'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQUNERjMxMEFFNDcyNTBENkI1QQA=', 'timestamp': '1763020462', 'text': {'body': 'Send 10 rand airtime to thabo'}, 'type': 'text'}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 09:54:23,732", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763024044"}
{"asctime": "2025-11-13 09:54:23,733", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 09:54:23,734", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 09:54:23,734", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 130.3s ago] {'phone_number_1': '+27763024044', 'param_1': 1}"}
{"asctime": "2025-11-13 09:54:23,736", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-13 09:54:23,736", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 130.3s ago] {'last_active_at': datetime.datetime(2025, 11, 13, 7, 54, 23, 735896), 'users_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 09:54:23,737", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 09:54:23,738", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 09:54:23,739", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 09:54:23,739", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 130.3s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 09:54:23,741", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-13 09:54:23,744", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 130.3s ago] {'id': UUID('6afec9c0-3286-402c-bed0-dd0b51cd404c'), 'user_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'phone_number': '+27763024044', 'message_id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQUNERjMxMEFFNDcyNTBENkI1QQA=', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'Send 10 rand airtime to thabo', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-13 09:54:23,747", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 09:54:23,748", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 09:54:23,749", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 09:54:23,749", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 130.3s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 09:54:23,750", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 09:54:23,751", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 130.3s ago] {'user_id_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'param_1': 5}"}
{"asctime": "2025-11-13 09:54:25,576", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 09:54:25,583", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 09:54:25,584", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 130s ago] {'pk_1': UUID('6afec9c0-3286-402c-bed0-dd0b51cd404c')}"}
{"asctime": "2025-11-13 09:54:25,585", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-13 09:54:25,585", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 130s ago] {'ai_response': \"Your current wallet balance is R0.00, so I can't process the airtime purchase right now. \\n\\nWould you like to add funds to your wallet first? Let me know how I can assist you! \ud83d\ude0a\", 'intent_detected': 'buy_airtime', 'entities_extracted': '{\"amount\": 10.0, \"phone\": null, \"network\": null}', 'confidence_score': 0.9, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 13, 7, 54, 25, 581573), 'conversations_id': UUID('6afec9c0-3286-402c-bed0-dd0b51cd404c')}"}
{"asctime": "2025-11-13 09:54:25,586", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 09:54:26,589", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 09:54:26,593", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763024044: Success"}
{"asctime": "2025-11-13 09:54:28,188", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '511b1af1-2498-4f91-8eee-f638c024a86a', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763024044', 'wa_id': '27763024044'}], 'messages': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI0N0QxMjhDQ0JCQUM1QjNGQUYA'}]}}"}
{"asctime": "2025-11-13 09:54:28,997", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI0N0QxMjhDQ0JCQUM1QjNGQUYA', 'status': 'sent', 'timestamp': '1763020468', 'recipient_id': '27763024044', 'conversation': {'id': 'f10df46d82fa458abb776dab15629c93', 'expiration_timestamp': '1763020468', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 09:54:29,870", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI0N0QxMjhDQ0JCQUM1QjNGQUYA', 'status': 'delivered', 'timestamp': '1763020469', 'recipient_id': '27763024044', 'conversation': {'id': 'f10df46d82fa458abb776dab15629c93', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 09:54:29,971", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI0N0QxMjhDQ0JCQUM1QjNGQUYA', 'status': 'read', 'timestamp': '1763020469', 'recipient_id': '27763024044', 'conversation': {'id': 'f10df46d82fa458abb776dab15629c93', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 09:54:34,981", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World'}, 'wa_id': '27763024044'}], 'messages': [{'from': '27763024044', 'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQUVBRTQyODIwMjczNENGQTdBQQA=', 'timestamp': '1763020474', 'text': {'body': 'Yes'}, 'type': 'text'}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 09:54:34,983", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763024044"}
{"asctime": "2025-11-13 09:54:34,984", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 09:54:34,985", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 09:54:34,985", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 141.5s ago] {'phone_number_1': '+27763024044', 'param_1': 1}"}
{"asctime": "2025-11-13 09:54:34,986", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-13 09:54:34,987", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 141.5s ago] {'last_active_at': datetime.datetime(2025, 11, 13, 7, 54, 34, 986542), 'users_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 09:54:34,987", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 09:54:34,988", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 09:54:34,988", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 09:54:34,988", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 141.5s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 09:54:34,989", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-13 09:54:34,989", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 141.5s ago] {'id': UUID('84a941ff-53c3-4ff2-8e3b-09a8c62b5467'), 'user_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'phone_number': '+27763024044', 'message_id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQUVBRTQyODIwMjczNENGQTdBQQA=', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'Yes', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-13 09:54:34,991", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 09:54:34,992", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 09:54:34,993", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 09:54:34,993", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 141.5s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 09:54:34,994", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 09:54:34,994", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 141.5s ago] {'user_id_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'param_1': 5}"}
{"asctime": "2025-11-13 09:54:38,230", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 09:54:38,250", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 09:54:38,251", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 142.7s ago] {'pk_1': UUID('84a941ff-53c3-4ff2-8e3b-09a8c62b5467')}"}
{"asctime": "2025-11-13 09:54:38,252", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-13 09:54:38,253", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 142.7s ago] {'ai_response': 'Great! How much would you like to add to your wallet? Just remember, the minimum amount is R5. You can choose any amount up to R1000! \ud83d\ude0a', 'intent_detected': 'conversation', 'entities_extracted': '{}', 'confidence_score': 0.7, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 13, 7, 54, 38, 248817), 'conversations_id': UUID('84a941ff-53c3-4ff2-8e3b-09a8c62b5467')}"}
{"asctime": "2025-11-13 09:54:38,254", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 09:54:39,293", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 09:54:39,295", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763024044: Success"}
{"asctime": "2025-11-13 09:54:40,712", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '2d465466-c183-4411-be9e-ecc9e2299785', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763024044', 'wa_id': '27763024044'}], 'messages': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJGQ0VENjY0RUNCQkMyOUMyODQA'}]}}"}
{"asctime": "2025-11-13 09:54:41,855", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJGQ0VENjY0RUNCQkMyOUMyODQA', 'status': 'sent', 'timestamp': '1763020480', 'recipient_id': '27763024044', 'conversation': {'id': '0e1570094a6f8f9c41f515f50880bc17', 'expiration_timestamp': '1763020480', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 09:54:42,247", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJGQ0VENjY0RUNCQkMyOUMyODQA', 'status': 'read', 'timestamp': '1763020481', 'recipient_id': '27763024044', 'conversation': {'id': '0e1570094a6f8f9c41f515f50880bc17', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 09:54:42,276", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJGQ0VENjY0RUNCQkMyOUMyODQA', 'status': 'delivered', 'timestamp': '1763020481', 'recipient_id': '27763024044', 'conversation': {'id': '0e1570094a6f8f9c41f515f50880bc17', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 09:54:50,728", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World'}, 'wa_id': '27763024044'}], 'messages': [{'from': '27763024044', 'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQTQ1RUYxQTVENzQ0QjRCNDNENQA=', 'timestamp': '1763020489', 'text': {'body': '50'}, 'type': 'text'}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 09:54:50,729", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763024044"}
{"asctime": "2025-11-13 09:54:50,730", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 09:54:50,731", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 09:54:50,731", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 157.3s ago] {'phone_number_1': '+27763024044', 'param_1': 1}"}
{"asctime": "2025-11-13 09:54:50,733", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-13 09:54:50,733", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 157.3s ago] {'last_active_at': datetime.datetime(2025, 11, 13, 7, 54, 50, 732863), 'users_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 09:54:50,734", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 09:54:50,736", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 09:54:50,736", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 09:54:50,736", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 157.3s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 09:54:50,738", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-13 09:54:50,738", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 157.3s ago] {'id': UUID('0b7c2eed-74f2-4d95-8a03-a7ef46ce629a'), 'user_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'phone_number': '+27763024044', 'message_id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQTQ1RUYxQTVENzQ0QjRCNDNENQA=', 'message_type': 'text', 'direction': 'inbound', 'message_text': '50', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-13 09:54:50,739", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 09:54:50,745", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 09:54:50,746", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 09:54:50,747", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 157.3s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 09:54:50,748", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 09:54:50,749", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 157.3s ago] {'user_id_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'param_1': 5}"}
{"asctime": "2025-11-13 09:54:52,708", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 09:54:52,713", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 09:54:52,714", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 157.1s ago] {'pk_1': UUID('0b7c2eed-74f2-4d95-8a03-a7ef46ce629a')}"}
{"asctime": "2025-11-13 09:54:52,715", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-13 09:54:52,715", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 157.1s ago] {'ai_response': 'To add R50 to your wallet, I need your PIN for security. Please share your PIN so I can process the transaction! \ud83d\udd12', 'intent_detected': 'conversation', 'entities_extracted': '{}', 'confidence_score': 0.7, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 13, 7, 54, 52, 712735), 'conversations_id': UUID('0b7c2eed-74f2-4d95-8a03-a7ef46ce629a')}"}
{"asctime": "2025-11-13 09:54:52,715", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 09:54:53,830", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 09:54:53,832", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763024044: Success"}
{"asctime": "2025-11-13 09:54:55,387", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '00754a34-a63b-4f7a-9abf-af1f1372f876', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763024044', 'wa_id': '27763024044'}], 'messages': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJFRUEwOTkyQTE3RjM3NzA2OTAA'}]}}"}
{"asctime": "2025-11-13 09:54:55,894", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJFRUEwOTkyQTE3RjM3NzA2OTAA', 'status': 'sent', 'timestamp': '1763020495', 'recipient_id': '27763024044', 'conversation': {'id': '0649a708c7686febebdfd72cad5173ea', 'expiration_timestamp': '1763020495', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 09:54:56,725", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJFRUEwOTkyQTE3RjM3NzA2OTAA', 'status': 'delivered', 'timestamp': '1763020495', 'recipient_id': '27763024044', 'conversation': {'id': '0649a708c7686febebdfd72cad5173ea', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 09:54:56,764", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJFRUEwOTkyQTE3RjM3NzA2OTAA', 'status': 'read', 'timestamp': '1763020495', 'recipient_id': '27763024044', 'conversation': {'id': '0649a708c7686febebdfd72cad5173ea', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 09:55:03,361", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World'}, 'wa_id': '27763024044'}], 'messages': [{'from': '27763024044', 'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQTU1REMyQjA1NEY5RjZBNzIwOQA=', 'timestamp': '1763020502', 'text': {'body': '5691'}, 'type': 'text'}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 09:55:03,362", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763024044"}
{"asctime": "2025-11-13 09:55:03,363", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 09:55:03,364", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 09:55:03,364", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 169.9s ago] {'phone_number_1': '+27763024044', 'param_1': 1}"}
{"asctime": "2025-11-13 09:55:03,366", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-13 09:55:03,367", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 169.9s ago] {'last_active_at': datetime.datetime(2025, 11, 13, 7, 55, 3, 366382), 'users_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 09:55:03,368", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 09:55:03,370", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 09:55:03,370", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 09:55:03,370", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 169.9s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 09:55:03,372", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-13 09:55:03,376", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 169.9s ago] {'id': UUID('39b8b02e-e634-4e6b-af49-2375a79e634f'), 'user_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'phone_number': '+27763024044', 'message_id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQTU1REMyQjA1NEY5RjZBNzIwOQA=', 'message_type': 'text', 'direction': 'inbound', 'message_text': '5691', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-13 09:55:03,378", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 09:55:03,380", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 09:55:03,380", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 09:55:03,380", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 169.9s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 09:55:03,381", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 09:55:03,381", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 169.9s ago] {'user_id_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'param_1': 5}"}
{"asctime": "2025-11-13 09:55:05,426", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 09:55:05,437", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 09:55:05,438", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 169.9s ago] {'pk_1': UUID('39b8b02e-e634-4e6b-af49-2375a79e634f')}"}
{"asctime": "2025-11-13 09:55:05,441", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-13 09:55:05,442", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 169.9s ago] {'ai_response': \"Just to confirm, you want to add R50 to your wallet. There will be a small service fee of 2-5% applied. \\n\\nIs that all good? Please confirm, and I'll proceed! \ud83d\ude0a\", 'intent_detected': 'conversation', 'entities_extracted': '{}', 'confidence_score': 0.7, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 13, 7, 55, 5, 435880), 'conversations_id': UUID('39b8b02e-e634-4e6b-af49-2375a79e634f')}"}
{"asctime": "2025-11-13 09:55:05,443", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 09:55:06,429", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 09:55:06,431", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763024044: Success"}
{"asctime": "2025-11-13 09:55:07,654", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '6eae5a31-22f9-4f18-9038-b8ba594c934b', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763024044', 'wa_id': '27763024044'}], 'messages': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBIzNzE3Rjc3M0ZEODk2QzNGNjMA'}]}}"}
{"asctime": "2025-11-13 09:55:08,549", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBIzNzE3Rjc3M0ZEODk2QzNGNjMA', 'status': 'sent', 'timestamp': '1763020507', 'recipient_id': '27763024044', 'conversation': {'id': '33c9f88b36ad0314fbcfcb74eb0ec444', 'expiration_timestamp': '1763020507', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 09:55:09,313", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBIzNzE3Rjc3M0ZEODk2QzNGNjMA', 'status': 'delivered', 'timestamp': '1763020508', 'recipient_id': '27763024044', 'conversation': {'id': '33c9f88b36ad0314fbcfcb74eb0ec444', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 09:55:09,317", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBIzNzE3Rjc3M0ZEODk2QzNGNjMA', 'status': 'read', 'timestamp': '1763020508', 'recipient_id': '27763024044', 'conversation': {'id': '33c9f88b36ad0314fbcfcb74eb0ec444', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 09:55:14,042", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World'}, 'wa_id': '27763024044'}], 'messages': [{'from': '27763024044', 'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQUJCRDZBQjNFMDJCMzBGRURCNQA=', 'timestamp': '1763020513', 'text': {'body': 'Yes'}, 'type': 'text'}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 09:55:14,042", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763024044"}
{"asctime": "2025-11-13 09:55:14,044", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 09:55:14,045", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 09:55:14,045", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 180.6s ago] {'phone_number_1': '+27763024044', 'param_1': 1}"}
{"asctime": "2025-11-13 09:55:14,046", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-13 09:55:14,047", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 180.6s ago] {'last_active_at': datetime.datetime(2025, 11, 13, 7, 55, 14, 46499), 'users_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 09:55:14,047", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 09:55:14,050", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 09:55:14,050", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 09:55:14,050", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 180.6s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 09:55:14,052", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-13 09:55:14,052", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 180.6s ago] {'id': UUID('9804623c-0c7d-42ee-845e-e8866bbef11e'), 'user_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'phone_number': '+27763024044', 'message_id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQUJCRDZBQjNFMDJCMzBGRURCNQA=', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'Yes', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-13 09:55:14,054", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 09:55:14,055", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 09:55:14,059", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 09:55:14,059", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 180.6s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 09:55:14,063", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 09:55:14,063", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 180.6s ago] {'user_id_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'param_1': 5}"}
{"asctime": "2025-11-13 09:55:17,637", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 09:55:17,644", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 09:55:17,644", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 182.1s ago] {'pk_1': UUID('9804623c-0c7d-42ee-845e-e8866bbef11e')}"}
{"asctime": "2025-11-13 09:55:17,648", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-13 09:55:17,648", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 182.1s ago] {'ai_response': \"Thanks for confirming! I'll go ahead and add R50 to your wallet. \\n\\nPlease hold on while I process that... \\n\\n\ud83d\udd12 Processing your transaction... \\n\\n ... (33 characters truncated) ... wallet balance is R0.00. You'll need to top up your wallet before purchasing airtime or data. \\n\\nWould you like to know how to top up your wallet? \ud83d\ude0a\", 'intent_detected': 'conversation', 'entities_extracted': '{}', 'confidence_score': 0.7, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 13, 7, 55, 17, 642274), 'conversations_id': UUID('9804623c-0c7d-42ee-845e-e8866bbef11e')}"}
{"asctime": "2025-11-13 09:55:17,651", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 09:55:18,709", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 09:55:18,711", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763024044: Success"}
{"asctime": "2025-11-13 09:55:19,983", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': 'e4fad2c5-6692-464a-b17f-e30d9d87a4bc', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763024044', 'wa_id': '27763024044'}], 'messages': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJEN0FEOTExNjFFNTE5MTIyQzQA'}]}}"}
{"asctime": "2025-11-13 09:55:20,828", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJEN0FEOTExNjFFNTE5MTIyQzQA', 'status': 'sent', 'timestamp': '1763020520', 'recipient_id': '27763024044', 'conversation': {'id': 'a83d0ce7d64f4b809df3d2ae7951f8d4', 'expiration_timestamp': '1763020520', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 09:55:21,444", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJEN0FEOTExNjFFNTE5MTIyQzQA', 'status': 'read', 'timestamp': '1763020520', 'recipient_id': '27763024044', 'conversation': {'id': 'a83d0ce7d64f4b809df3d2ae7951f8d4', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 09:55:21,595", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJEN0FEOTExNjFFNTE5MTIyQzQA', 'status': 'delivered', 'timestamp': '1763020520', 'recipient_id': '27763024044', 'conversation': {'id': 'a83d0ce7d64f4b809df3d2ae7951f8d4', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 09:55:44,488", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World'}, 'wa_id': '27763024044'}], 'messages': [{'from': '27763024044', 'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQURENTZCRjlGRDk2QjAwQjc2MAA=', 'timestamp': '1763020543', 'text': {'body': 'No'}, 'type': 'text'}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 09:55:44,489", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763024044"}
{"asctime": "2025-11-13 09:55:44,492", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 09:55:44,493", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 09:55:44,493", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 211s ago] {'phone_number_1': '+27763024044', 'param_1': 1}"}
{"asctime": "2025-11-13 09:55:44,496", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-13 09:55:44,496", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 211s ago] {'last_active_at': datetime.datetime(2025, 11, 13, 7, 55, 44, 495562), 'users_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 09:55:44,498", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 09:55:44,499", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 09:55:44,500", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 09:55:44,500", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 211s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 09:55:44,506", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-13 09:55:44,506", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 211s ago] {'id': UUID('2b581b41-78ae-4575-be94-0ed9708858dd'), 'user_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'phone_number': '+27763024044', 'message_id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQURENTZCRjlGRDk2QjAwQjc2MAA=', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'No', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-13 09:55:44,509", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 09:55:44,511", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 09:55:44,511", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 09:55:44,511", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 211s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 09:55:44,513", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 09:55:44,513", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 211s ago] {'user_id_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'param_1': 5}"}
{"asctime": "2025-11-13 09:55:45,855", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 09:55:45,863", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 09:55:45,863", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 210.3s ago] {'pk_1': UUID('2b581b41-78ae-4575-be94-0ed9708858dd')}"}
{"asctime": "2025-11-13 09:55:45,866", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-13 09:55:45,866", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 210.3s ago] {'ai_response': \"No worries, Sam! If you need help with anything else or decide to top up your wallet later, just let me know. I'm here to help! \ud83d\ude0a\", 'intent_detected': 'conversation', 'entities_extracted': '{}', 'confidence_score': 0.7, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 13, 7, 55, 45, 861069), 'conversations_id': UUID('2b581b41-78ae-4575-be94-0ed9708858dd')}"}
{"asctime": "2025-11-13 09:55:45,867", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 09:55:46,980", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 09:55:46,982", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763024044: Success"}
{"asctime": "2025-11-13 09:55:48,754", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '01e7abf2-bdb7-4e55-84d6-a6f9c4695baa', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763024044', 'wa_id': '27763024044'}], 'messages': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI1QUU0Mjk4MTgxMTI3RjEwOEYA'}]}}"}
{"asctime": "2025-11-13 09:55:49,558", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI1QUU0Mjk4MTgxMTI3RjEwOEYA', 'status': 'sent', 'timestamp': '1763020548', 'recipient_id': '27763024044', 'conversation': {'id': 'a8296e8bdcf80fb6470fa6ad42108668', 'expiration_timestamp': '1763020548', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 09:55:50,198", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI1QUU0Mjk4MTgxMTI3RjEwOEYA', 'status': 'read', 'timestamp': '1763020549', 'recipient_id': '27763024044', 'conversation': {'id': 'a8296e8bdcf80fb6470fa6ad42108668', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 09:55:50,303", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI1QUU0Mjk4MTgxMTI3RjEwOEYA', 'status': 'delivered', 'timestamp': '1763020549', 'recipient_id': '27763024044', 'conversation': {'id': 'a8296e8bdcf80fb6470fa6ad42108668', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 10:46:45,075", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World!'}, 'wa_id': '27763514028'}], 'messages': [{'from': '27763514028', 'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgASGBQzQTA1QkU1QTA1QjhDREMxQzlCMwA=', 'timestamp': '1763023603', 'text': {'body': 'Hi'}, 'type': 'text'}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 10:46:45,078", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763514028"}
{"asctime": "2025-11-13 10:46:45,094", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 10:46:45,095", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 10:46:45,096", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 3272s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-13 10:46:46,226", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 10:46:46,227", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763514028: Success"}
{"asctime": "2025-11-13 10:46:46,228", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "ROLLBACK"}
{"asctime": "2025-11-13 10:46:48,082", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': 'a6d2fe1a-1028-4fd9-b9ad-23d85f4a2f7b', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763514028', 'wa_id': '27763514028'}], 'messages': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBJBQ0FBNjI4REY2QkI2QTcyMDUA'}]}}"}
{"asctime": "2025-11-13 10:46:49,213", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBJBQ0FBNjI4REY2QkI2QTcyMDUA', 'status': 'sent', 'timestamp': '1763023608', 'recipient_id': '27763514028', 'conversation': {'id': 'b5b08876e2e64afb694df2f7829c6fd0', 'expiration_timestamp': '1763023608', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 10:46:49,868", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBJBQ0FBNjI4REY2QkI2QTcyMDUA', 'status': 'delivered', 'timestamp': '1763023608', 'recipient_id': '27763514028', 'conversation': {'id': 'b5b08876e2e64afb694df2f7829c6fd0', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 10:46:50,300", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBJBQ0FBNjI4REY2QkI2QTcyMDUA', 'status': 'read', 'timestamp': '1763023608', 'recipient_id': '27763514028', 'conversation': {'id': 'b5b08876e2e64afb694df2f7829c6fd0', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 10:47:03,072", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World!'}, 'wa_id': '27763514028'}], 'messages': [{'from': '27763514028', 'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgASGBQzQTFFMTgwREU2MjZDQTE4REMzNgA=', 'timestamp': '1763023621', 'text': {'body': 'Dgsa'}, 'type': 'text'}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 10:47:03,076", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763514028"}
{"asctime": "2025-11-13 10:47:03,079", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 10:47:03,080", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 10:47:03,080", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 3290s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-13 10:47:04,157", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 10:47:04,157", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763514028: Success"}
{"asctime": "2025-11-13 10:47:04,157", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "ROLLBACK"}
{"asctime": "2025-11-13 10:47:06,003", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': 'ca985f36-bc64-4b34-bf5c-009661483096', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763514028', 'wa_id': '27763514028'}], 'messages': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBIyRDQ5MDMyRDk5QUI1QTRCN0YA'}]}}"}
{"asctime": "2025-11-13 10:47:06,822", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBIyRDQ5MDMyRDk5QUI1QTRCN0YA', 'status': 'sent', 'timestamp': '1763023626', 'recipient_id': '27763514028', 'conversation': {'id': '2134870b230558bffa6fd666839737cb', 'expiration_timestamp': '1763023626', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 10:47:07,997", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI0RTY3QTU1Njg2QTQ5OTMxMDMA', 'status': 'sent', 'timestamp': '1763023627', 'recipient_id': '27763514028', 'biz_opaque_callback_data': '{\"data\":\"Ym90X2ZhbGxiYWNrLmJvdFF1ZXN0aW9uLjY5MTM3ZWRjMWI5ODQ1YzAyZDRhZGMzOS4wLjA=\"}', 'conversation': {'id': '59ff625a4e876bf7e3f6c81ae53dd77c', 'expiration_timestamp': '1763023627', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 10:47:08,076", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBIyRDQ5MDMyRDk5QUI1QTRCN0YA', 'status': 'delivered', 'timestamp': '1763023626', 'recipient_id': '27763514028', 'conversation': {'id': '2134870b230558bffa6fd666839737cb', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 10:47:08,146", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBIyRDQ5MDMyRDk5QUI1QTRCN0YA', 'status': 'read', 'timestamp': '1763023626', 'recipient_id': '27763514028', 'conversation': {'id': '2134870b230558bffa6fd666839737cb', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 10:47:08,869", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI0RTY3QTU1Njg2QTQ5OTMxMDMA', 'status': 'read', 'timestamp': '1763023627', 'recipient_id': '27763514028', 'biz_opaque_callback_data': '{\"data\":\"Ym90X2ZhbGxiYWNrLmJvdFF1ZXN0aW9uLjY5MTM3ZWRjMWI5ODQ1YzAyZDRhZGMzOS4wLjA=\"}', 'conversation': {'id': '59ff625a4e876bf7e3f6c81ae53dd77c', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 10:47:08,997", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI0RTY3QTU1Njg2QTQ5OTMxMDMA', 'status': 'delivered', 'timestamp': '1763023627', 'recipient_id': '27763514028', 'biz_opaque_callback_data': '{\"data\":\"Ym90X2ZhbGxiYWNrLmJvdFF1ZXN0aW9uLjY5MTM3ZWRjMWI5ODQ1YzAyZDRhZGMzOS4wLjA=\"}', 'conversation': {'id': '59ff625a4e876bf7e3f6c81ae53dd77c', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 10:50:47,745", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-11-13 10:50:48,369", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-11-13 10:50:48,369", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-11-13 10:50:48,480", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-11-13 10:50:48,481", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 10:50:48,483", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-11-13 10:50:48,483", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 10:50:48,484", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-11-13 10:50:48,484", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 10:50:48,484", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 10:50:48,487", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 10:50:48,487", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00020s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 10:50:48,489", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 10:50:48,489", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001811s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 10:50:48,489", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 10:50:48,489", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002367s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 10:50:48,490", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 10:50:48,490", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00009s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 10:50:48,491", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 10:50:48,491", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0006369s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 10:50:48,491", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 10:50:48,491", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001237s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 10:50:48,492", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 10:50:48,492", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-11-13 10:50:48,492", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-11-13 10:50:48,492", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-11-13 10:51:07,712", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-11-13 10:51:08,227", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-11-13 10:51:08,227", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-11-13 10:51:08,244", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-11-13 10:51:08,245", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 10:51:08,246", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-11-13 10:51:08,246", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 10:51:08,246", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-11-13 10:51:08,246", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 10:51:08,246", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 10:51:08,247", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 10:51:08,248", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00009s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 10:51:08,250", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 10:51:08,250", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.00273s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 10:51:08,251", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 10:51:08,251", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.003137s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 10:51:08,251", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 10:51:08,252", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00011s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 10:51:08,253", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 10:51:08,253", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.00169s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 10:51:08,254", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 10:51:08,254", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.00237s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 10:51:08,254", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 10:51:08,254", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-11-13 10:51:08,254", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-11-13 10:51:08,254", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-11-13 10:51:17,881", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World'}, 'wa_id': '27763024044'}], 'messages': [{'from': '27763024044', 'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQUYzNkRFMzU5OENGNTE2QTJEMwA=', 'timestamp': '1763023877', 'text': {'body': 'Hi'}, 'type': 'text'}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 10:51:17,882", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763024044"}
{"asctime": "2025-11-13 10:51:17,888", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 10:51:17,894", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 10:51:17,894", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00035s] {'phone_number_1': '+27763024044', 'param_1': 1}"}
{"asctime": "2025-11-13 10:51:17,898", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-13 10:51:17,898", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00016s] {'last_active_at': datetime.datetime(2025, 11, 13, 8, 51, 17, 897753), 'users_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 10:51:17,901", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 10:51:17,904", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 10:51:17,904", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 10:51:17,905", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00014s] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 10:51:17,906", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-13 10:51:17,906", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00027s] {'id': UUID('2ff3846c-fe42-4c90-95e6-483bd587ad45'), 'user_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'phone_number': '+27763024044', 'message_id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQUYzNkRFMzU5OENGNTE2QTJEMwA=', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'Hi', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-13 10:51:17,908", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 10:51:17,909", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 10:51:17,909", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 10:51:17,909", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.00439s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 10:51:17,910", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 10:51:17,910", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00016s] {'user_id_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'param_1': 5}"}
{"asctime": "2025-11-13 10:51:20,178", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 10:51:20,183", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 10:51:20,184", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00034s] {'pk_1': UUID('2ff3846c-fe42-4c90-95e6-483bd587ad45')}"}
{"asctime": "2025-11-13 10:51:20,185", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-13 10:51:20,185", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00017s] {'ai_response': \"Hey, Sam! How's it going? What can I assist you with today? \ud83d\ude0a\", 'intent_detected': 'greeting', 'entities_extracted': '{}', 'confidence_score': 0.95, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 13, 8, 51, 20, 182059), 'conversations_id': UUID('2ff3846c-fe42-4c90-95e6-483bd587ad45')}"}
{"asctime": "2025-11-13 10:51:20,187", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 10:51:21,238", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 10:51:21,239", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763024044: Success"}
{"asctime": "2025-11-13 10:51:22,238", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 10:51:22,240", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763024044: Success"}
{"asctime": "2025-11-13 10:51:22,719", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': 'ac5c333d-46ba-4398-ae0c-1e1b8040c178', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763024044', 'wa_id': '27763024044'}], 'messages': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBIyNzM0Q0I3NjJDREY2M0IxQzUA'}]}}"}
{"asctime": "2025-11-13 10:51:23,582", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '3b0cfdde-cbf2-4d9a-a3db-9510eadb41e0', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763024044', 'wa_id': '27763024044'}], 'messages': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJGQkMxRDQwMjVFOTRFRDAwQTQA'}]}}"}
{"asctime": "2025-11-13 10:51:23,712", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBIyNzM0Q0I3NjJDREY2M0IxQzUA', 'status': 'sent', 'timestamp': '1763023882', 'recipient_id': '27763024044', 'conversation': {'id': 'e1bbdcfd6a52538ecffe47dc96890b68', 'expiration_timestamp': '1763023883', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 10:51:24,295", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJGQkMxRDQwMjVFOTRFRDAwQTQA', 'status': 'sent', 'timestamp': '1763023883', 'recipient_id': '27763024044', 'conversation': {'id': 'ea5c486cf454331b6452b1f1b3d7052b', 'expiration_timestamp': '1763023883', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 10:51:24,337", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBIyNzM0Q0I3NjJDREY2M0IxQzUA', 'status': 'delivered', 'timestamp': '1763023883', 'recipient_id': '27763024044', 'conversation': {'id': 'e1bbdcfd6a52538ecffe47dc96890b68', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 10:51:24,777", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBIyNzM0Q0I3NjJDREY2M0IxQzUA', 'status': 'read', 'timestamp': '1763023883', 'recipient_id': '27763024044', 'conversation': {'id': 'e1bbdcfd6a52538ecffe47dc96890b68', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 10:51:25,081", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJGQkMxRDQwMjVFOTRFRDAwQTQA', 'status': 'read', 'timestamp': '1763023884', 'recipient_id': '27763024044', 'conversation': {'id': 'ea5c486cf454331b6452b1f1b3d7052b', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 10:51:25,088", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJGQkMxRDQwMjVFOTRFRDAwQTQA', 'status': 'delivered', 'timestamp': '1763023884', 'recipient_id': '27763024044', 'conversation': {'id': 'ea5c486cf454331b6452b1f1b3d7052b', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 10:51:48,010", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World'}, 'wa_id': '27763024044'}], 'messages': [{'from': '27763024044', 'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQTZFMUE5MEUxMzQxQTY5MzQ2NQA=', 'timestamp': '1763023907', 'text': {'body': 'What are my today\u2019s transactions'}, 'type': 'text'}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 10:51:48,012", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763024044"}
{"asctime": "2025-11-13 10:51:48,013", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 10:51:48,014", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 10:51:48,014", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 30.12s ago] {'phone_number_1': '+27763024044', 'param_1': 1}"}
{"asctime": "2025-11-13 10:51:48,016", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-13 10:51:48,016", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 30.12s ago] {'last_active_at': datetime.datetime(2025, 11, 13, 8, 51, 48, 15998), 'users_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 10:51:48,017", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 10:51:48,018", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 10:51:48,019", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 10:51:48,019", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 30.11s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 10:51:48,020", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-13 10:51:48,020", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 30.11s ago] {'id': UUID('86972686-adc3-434c-a243-e38003cb14ee'), 'user_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'phone_number': '+27763024044', 'message_id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQTZFMUE5MEUxMzQxQTY5MzQ2NQA=', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'What are my today\u2019s transactions', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-13 10:51:48,022", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 10:51:48,023", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 10:51:48,023", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 10:51:48,023", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 30.12s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 10:51:48,024", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 10:51:48,025", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 30.11s ago] {'user_id_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'param_1': 5}"}
{"asctime": "2025-11-13 10:51:50,267", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 10:51:50,274", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 10:51:50,275", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 30.09s ago] {'pk_1': UUID('86972686-adc3-434c-a243-e38003cb14ee')}"}
{"asctime": "2025-11-13 10:51:50,276", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-13 10:51:50,276", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 30.09s ago] {'ai_response': \"It looks like you don't have any transactions recorded since your wallet balance is currently R0.00. If you've made any transactions previously, please let me know, and I'll do my best to assist you! \ud83d\ude0a\", 'intent_detected': 'transaction_history', 'entities_extracted': '{}', 'confidence_score': 0.9, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 13, 8, 51, 50, 272586), 'conversations_id': UUID('86972686-adc3-434c-a243-e38003cb14ee')}"}
{"asctime": "2025-11-13 10:51:50,277", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 10:51:51,374", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 10:51:51,375", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763024044: Success"}
{"asctime": "2025-11-13 10:51:52,823", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': 'c7806217-cb5b-4489-b882-8d829ff0571b', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763024044', 'wa_id': '27763024044'}], 'messages': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI4M0M2QjhBM0Y4NUZFRjY1QTgA'}]}}"}
{"asctime": "2025-11-13 10:51:53,638", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI4M0M2QjhBM0Y4NUZFRjY1QTgA', 'status': 'sent', 'timestamp': '1763023913', 'recipient_id': '27763024044', 'conversation': {'id': 'fd6824331501cf31802419c380e6d6fa', 'expiration_timestamp': '1763023913', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 10:51:54,263", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI4M0M2QjhBM0Y4NUZFRjY1QTgA', 'status': 'delivered', 'timestamp': '1763023913', 'recipient_id': '27763024044', 'conversation': {'id': 'fd6824331501cf31802419c380e6d6fa', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 10:51:54,427", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI4M0M2QjhBM0Y4NUZFRjY1QTgA', 'status': 'read', 'timestamp': '1763023913', 'recipient_id': '27763024044', 'conversation': {'id': 'fd6824331501cf31802419c380e6d6fa', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 10:52:26,101", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World'}, 'wa_id': '27763024044'}], 'messages': [{'from': '27763024044', 'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQUYwQjBGNzgzODE2MzZBMDBGQgA=', 'timestamp': '1763023945', 'text': {'body': 'Why should I use you for my utility payments ?'}, 'type': 'text'}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 10:52:26,103", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763024044"}
{"asctime": "2025-11-13 10:52:26,105", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 10:52:26,105", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 10:52:26,106", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 68.21s ago] {'phone_number_1': '+27763024044', 'param_1': 1}"}
{"asctime": "2025-11-13 10:52:26,107", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-13 10:52:26,107", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 68.21s ago] {'last_active_at': datetime.datetime(2025, 11, 13, 8, 52, 26, 107373), 'users_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 10:52:26,108", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 10:52:26,109", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 10:52:26,110", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 10:52:26,110", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 68.21s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 10:52:26,111", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-13 10:52:26,111", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 68.21s ago] {'id': UUID('605f3e1d-c124-4944-9512-dfca231ca6ab'), 'user_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'phone_number': '+27763024044', 'message_id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQUYwQjBGNzgzODE2MzZBMDBGQgA=', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'Why should I use you for my utility payments ?', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-13 10:52:26,112", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 10:52:26,113", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 10:52:26,113", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 10:52:26,114", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 68.21s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 10:52:26,115", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 10:52:26,115", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 68.21s ago] {'user_id_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'param_1': 5}"}
{"asctime": "2025-11-13 10:52:31,690", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 10:52:31,697", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 10:52:31,697", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 71.51s ago] {'pk_1': UUID('605f3e1d-c124-4944-9512-dfca231ca6ab')}"}
{"asctime": "2025-11-13 10:52:31,699", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-13 10:52:31,699", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 71.51s ago] {'ai_response': 'Great question, Sam! Here\u2019s why using me for your utility payments is a good choice:\\n\\n1. **Convenience**: You can easily pay your electricity bills ... (544 characters truncated) ... lities, making it easy for you to manage your utilities.\\n\\nIf you have any specific questions or need assistance with a payment, just let me know! \ud83d\ude0a', 'intent_detected': 'conversation', 'entities_extracted': '{}', 'confidence_score': 0.7, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 13, 8, 52, 31, 694992), 'conversations_id': UUID('605f3e1d-c124-4944-9512-dfca231ca6ab')}"}
{"asctime": "2025-11-13 10:52:31,700", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 10:52:32,784", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 10:52:32,785", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763024044: Success"}
{"asctime": "2025-11-13 10:52:34,439", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '163dac3a-cc3d-440a-b835-9e94226b1403', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763024044', 'wa_id': '27763024044'}], 'messages': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJEQkNBODA4MTNDOTA2REY4RTgA'}]}}"}
{"asctime": "2025-11-13 10:52:35,841", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJEQkNBODA4MTNDOTA2REY4RTgA', 'status': 'sent', 'timestamp': '1763023954', 'recipient_id': '27763024044', 'conversation': {'id': 'e4954d68df3462a48372e13ce8d2a76d', 'expiration_timestamp': '1763023954', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 10:52:35,967", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJEQkNBODA4MTNDOTA2REY4RTgA', 'status': 'delivered', 'timestamp': '1763023955', 'recipient_id': '27763024044', 'conversation': {'id': 'e4954d68df3462a48372e13ce8d2a76d', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 10:52:36,045", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJEQkNBODA4MTNDOTA2REY4RTgA', 'status': 'read', 'timestamp': '1763023955', 'recipient_id': '27763024044', 'conversation': {'id': 'e4954d68df3462a48372e13ce8d2a76d', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 10:53:07,861", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World'}, 'wa_id': '27763024044'}], 'messages': [{'from': '27763024044', 'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQURBNUI5OUQ0OEVDM0QwNkM1RAA=', 'timestamp': '1763023986', 'type': 'audio', 'audio': {'mime_type': 'audio/ogg; codecs=opus', 'sha256': 'Ysg0gn39zdVocDNrHoMET/sWZpX+fXPOIlrQxizCtEU=', 'id': '1149651600704150', 'voice': True}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 10:53:07,863", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing audio message from +27763024044"}
{"asctime": "2025-11-13 10:53:07,865", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 10:53:07,866", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 10:53:07,866", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 110s ago] {'phone_number_1': '+27763024044', 'param_1': 1}"}
{"asctime": "2025-11-13 10:53:07,868", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-13 10:53:07,869", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 110s ago] {'last_active_at': datetime.datetime(2025, 11, 13, 8, 53, 7, 868278), 'users_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 10:53:07,869", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 10:53:09,004", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 10:53:09,004", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763024044: Success"}
{"asctime": "2025-11-13 10:53:10,537", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': 'add2e211-45ce-4f98-870c-f85bbf53571b', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763024044', 'wa_id': '27763024044'}], 'messages': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBIwQTFCNzVBQUU4NUZBQ0JFQzQA'}]}}"}
{"asctime": "2025-11-13 10:53:11,741", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBIwQTFCNzVBQUU4NUZBQ0JFQzQA', 'status': 'sent', 'timestamp': '1763023990', 'recipient_id': '27763024044', 'conversation': {'id': 'bcde419918511fc92e76a739700fa232', 'expiration_timestamp': '1763023990', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 10:53:11,954", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBIwQTFCNzVBQUU4NUZBQ0JFQzQA', 'status': 'delivered', 'timestamp': '1763023991', 'recipient_id': '27763024044', 'conversation': {'id': 'bcde419918511fc92e76a739700fa232', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 10:53:12,097", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBIwQTFCNzVBQUU4NUZBQ0JFQzQA', 'status': 'read', 'timestamp': '1763023991', 'recipient_id': '27763024044', 'conversation': {'id': 'bcde419918511fc92e76a739700fa232', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 10:53:49,465", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World'}, 'wa_id': '27763024044'}], 'messages': [{'from': '27763024044', 'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQUI1QUNFN0U3NTcyQUY4MkNBOQA=', 'timestamp': '1763024027', 'type': 'image', 'image': {'caption': 'Send 5 rand airtime to that number', 'mime_type': 'image/jpeg', 'sha256': 'rQ5PsSefK/H4RG4qnTtOD1cEnxh2RJ63FosCXW3073w=', 'id': '859563410343465'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 10:53:49,466", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing image message from +27763024044"}
{"asctime": "2025-11-13 10:53:49,467", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 10:53:49,467", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 10:53:49,468", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 151.6s ago] {'phone_number_1': '+27763024044', 'param_1': 1}"}
{"asctime": "2025-11-13 10:53:49,468", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-13 10:53:49,469", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 151.6s ago] {'last_active_at': datetime.datetime(2025, 11, 13, 8, 53, 49, 468730), 'users_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 10:53:49,469", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 10:53:50,476", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 10:53:50,477", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763024044: Success"}
{"asctime": "2025-11-13 10:53:51,728", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '279b1eed-7f19-4ffe-847f-580532c4d610', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763024044', 'wa_id': '27763024044'}], 'messages': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJDOUQ2MkVBMDE1M0U1RkU0MjQA'}]}}"}
{"asctime": "2025-11-13 10:53:53,386", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJDOUQ2MkVBMDE1M0U1RkU0MjQA', 'status': 'delivered', 'timestamp': '1763024032', 'recipient_id': '27763024044', 'conversation': {'id': '8117edcac7415f14865e52ab8f4008b7', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 10:53:53,444", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJDOUQ2MkVBMDE1M0U1RkU0MjQA', 'status': 'sent', 'timestamp': '1763024032', 'recipient_id': '27763024044', 'conversation': {'id': '8117edcac7415f14865e52ab8f4008b7', 'expiration_timestamp': '1763024032', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 10:53:53,464", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJDOUQ2MkVBMDE1M0U1RkU0MjQA', 'status': 'read', 'timestamp': '1763024032', 'recipient_id': '27763024044', 'conversation': {'id': '8117edcac7415f14865e52ab8f4008b7', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:00:37,526", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World'}, 'wa_id': '27763024044'}], 'messages': [{'from': '27763024044', 'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQUJFMjhBMDAzODVEMjI5ODFDNgA=', 'timestamp': '1763024436', 'text': {'body': 'Really ?'}, 'type': 'text'}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:00:37,529", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763024044"}
{"asctime": "2025-11-13 11:00:37,533", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 11:00:37,534", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 11:00:37,534", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 559.5s ago] {'phone_number_1': '+27763024044', 'param_1': 1}"}
{"asctime": "2025-11-13 11:00:37,537", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-13 11:00:37,537", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 559.5s ago] {'last_active_at': datetime.datetime(2025, 11, 13, 9, 0, 37, 536993), 'users_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 11:00:37,538", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 11:00:37,540", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 11:00:37,541", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 11:00:37,541", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 559.5s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 11:00:37,542", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-13 11:00:37,542", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 559.5s ago] {'id': UUID('f8c6c818-7ef8-41f3-83a4-415d43634eb0'), 'user_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'phone_number': '+27763024044', 'message_id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQUJFMjhBMDAzODVEMjI5ODFDNgA=', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'Really ?', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-13 11:00:37,543", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 11:00:37,544", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 11:00:37,545", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 11:00:37,545", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 559.5s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 11:00:37,546", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 11:00:37,546", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 559.5s ago] {'user_id_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'param_1': 5}"}
{"asctime": "2025-11-13 11:00:39,742", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 11:00:39,760", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 11:00:39,760", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 559.5s ago] {'pk_1': UUID('f8c6c818-7ef8-41f3-83a4-415d43634eb0')}"}
{"asctime": "2025-11-13 11:00:39,762", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-13 11:00:39,762", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 559.5s ago] {'ai_response': 'Absolutely! I\u2019m here to make your life easier when it comes to managing your utility payments and buying airtime. If you have any doubts or need help with something specific, just ask! \ud83d\ude0a', 'intent_detected': 'conversation', 'entities_extracted': '{}', 'confidence_score': 0.7, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 13, 9, 0, 39, 758877), 'conversations_id': UUID('f8c6c818-7ef8-41f3-83a4-415d43634eb0')}"}
{"asctime": "2025-11-13 11:00:39,762", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 11:00:40,867", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 11:00:40,868", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763024044: Success"}
{"asctime": "2025-11-13 11:00:42,376", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '93ec0519-6dab-4ef2-ab8f-205f43a16eee', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763024044', 'wa_id': '27763024044'}], 'messages': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBIzRjVFQTZBRjcxMUIzQkI5RDgA'}]}}"}
{"asctime": "2025-11-13 11:00:43,341", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBIzRjVFQTZBRjcxMUIzQkI5RDgA', 'status': 'sent', 'timestamp': '1763024442', 'recipient_id': '27763024044', 'conversation': {'id': '3fa45b0e57072cd73bc1a14c5d2f49a4', 'expiration_timestamp': '1763024442', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:00:43,666", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBIzRjVFQTZBRjcxMUIzQkI5RDgA', 'status': 'delivered', 'timestamp': '1763024443', 'recipient_id': '27763024044', 'conversation': {'id': '3fa45b0e57072cd73bc1a14c5d2f49a4', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:00:45,765", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBIzRjVFQTZBRjcxMUIzQkI5RDgA', 'status': 'read', 'timestamp': '1763024444', 'recipient_id': '27763024044', 'conversation': {'id': '3fa45b0e57072cd73bc1a14c5d2f49a4', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:08:21,924", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-11-13 11:08:22,495", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-11-13 11:08:22,495", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-11-13 11:08:22,586", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-11-13 11:08:22,587", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 11:08:22,588", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-11-13 11:08:22,588", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 11:08:22,588", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-11-13 11:08:22,588", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 11:08:22,589", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 11:08:22,590", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 11:08:22,590", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00012s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 11:08:22,592", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 11:08:22,592", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002046s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 11:08:22,592", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 11:08:22,593", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002401s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 11:08:22,594", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 11:08:22,594", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00014s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 11:08:22,595", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 11:08:22,595", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001034s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 11:08:22,595", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 11:08:22,596", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001607s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 11:08:22,596", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 11:08:22,596", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-11-13 11:08:22,596", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-11-13 11:08:22,596", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-11-13 11:08:40,496", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-11-13 11:08:41,022", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-11-13 11:08:41,022", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-11-13 11:08:41,041", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-11-13 11:08:41,041", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 11:08:41,042", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-11-13 11:08:41,042", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 11:08:41,042", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-11-13 11:08:41,042", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 11:08:41,043", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 11:08:41,044", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 11:08:41,044", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00013s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 11:08:41,046", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 11:08:41,046", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001769s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 11:08:41,046", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 11:08:41,046", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002415s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 11:08:41,047", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 11:08:41,047", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00007s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 11:08:41,048", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 11:08:41,048", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0007126s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 11:08:41,049", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 11:08:41,049", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0012s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 11:08:41,049", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 11:08:41,049", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-11-13 11:08:41,049", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-11-13 11:08:41,049", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-11-13 11:09:08,902", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World'}, 'wa_id': '27763024044'}], 'messages': [{'from': '27763024044', 'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQUNFNDQzMUIyRDI2OUYzNzg5RQA=', 'timestamp': '1763024946', 'type': 'image', 'image': {'caption': 'Send 10 rand airtime to that number', 'mime_type': 'image/jpeg', 'sha256': 'YIRX8S4C058kHx4wH1vW09HeTEIhXdiWz0DNxvY9Sgk=', 'id': '1908176006742118'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:09:08,904", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=image, media_id=1908176006742118"}
{"asctime": "2025-11-13 11:09:08,904", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing image message from +27763024044"}
{"asctime": "2025-11-13 11:09:08,917", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 11:09:08,921", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 11:09:08,921", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00034s] {'phone_number_1': '+27763024044', 'param_1': 1}"}
{"asctime": "2025-11-13 11:09:08,927", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-13 11:09:08,927", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00016s] {'last_active_at': datetime.datetime(2025, 11, 13, 9, 9, 8, 925790), 'users_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 11:09:08,932", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 11:09:08,933", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Fetching media URL for ID: 1908176006742118"}
{"asctime": "2025-11-13 11:09:10,444", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: GET https://crm.cyraxtechnologies.com/api/meta/v19.0/1908176006742118 \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 11:09:10,511", "name": "app.services.whatsapp_api_service", "levelname": "ERROR", "message": "Failed to get media URL: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte"}
{"asctime": "2025-11-13 11:09:10,512", "name": "app.routers.whatsapp", "levelname": "ERROR", "message": "Failed to get media URL from media_id"}
{"asctime": "2025-11-13 11:09:11,496", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 11:09:11,498", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763024044: Success"}
{"asctime": "2025-11-13 11:09:13,173", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '887ad5e9-e67e-43bc-b338-9409c6799183', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763024044', 'wa_id': '27763024044'}], 'messages': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI4QTA4RkZERDAyOTREOTY3RDcA'}]}}"}
{"asctime": "2025-11-13 11:09:13,814", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI4QTA4RkZERDAyOTREOTY3RDcA', 'status': 'sent', 'timestamp': '1763024953', 'recipient_id': '27763024044', 'conversation': {'id': 'f9a37c9d0f5c761684821bcba718e168', 'expiration_timestamp': '1763024953', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:09:15,248", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI4QTA4RkZERDAyOTREOTY3RDcA', 'status': 'read', 'timestamp': '1763024953', 'recipient_id': '27763024044', 'conversation': {'id': 'f9a37c9d0f5c761684821bcba718e168', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:09:15,503", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI4QTA4RkZERDAyOTREOTY3RDcA', 'status': 'delivered', 'timestamp': '1763024953', 'recipient_id': '27763024044', 'conversation': {'id': 'f9a37c9d0f5c761684821bcba718e168', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:09:15,565", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI4QTA4RkZERDAyOTREOTY3RDcA', 'status': 'delivered', 'timestamp': '1763024954', 'recipient_id': '27763024044', 'conversation': {'id': 'f9a37c9d0f5c761684821bcba718e168', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:09:26,308", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World'}, 'wa_id': '27763024044'}], 'messages': [{'from': '27763024044', 'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQTA2QkZFRkZBREU2NjZCNTY0NQA=', 'timestamp': '1763024964', 'type': 'audio', 'audio': {'mime_type': 'audio/ogg; codecs=opus', 'sha256': '7Mz451vYTS3Q/pD/dSNPsu7wXfgia5B1x3TJXsuZrkM=', 'id': '820885367247585', 'voice': True}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:09:26,309", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=audio, media_id=820885367247585"}
{"asctime": "2025-11-13 11:09:26,312", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing audio message from +27763024044"}
{"asctime": "2025-11-13 11:09:26,313", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 11:09:26,314", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 11:09:26,314", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 17.39s ago] {'phone_number_1': '+27763024044', 'param_1': 1}"}
{"asctime": "2025-11-13 11:09:26,322", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-13 11:09:26,322", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 17.4s ago] {'last_active_at': datetime.datetime(2025, 11, 13, 9, 9, 26, 321580), 'users_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 11:09:26,323", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 11:09:26,324", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Fetching media URL for ID: 820885367247585"}
{"asctime": "2025-11-13 11:09:27,652", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: GET https://crm.cyraxtechnologies.com/api/meta/v19.0/820885367247585 \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 11:09:27,654", "name": "app.services.whatsapp_api_service", "levelname": "ERROR", "message": "Failed to get media URL: 'utf-8' codec can't decode byte 0x80 in position 40: invalid start byte"}
{"asctime": "2025-11-13 11:09:27,654", "name": "app.routers.whatsapp", "levelname": "ERROR", "message": "Failed to get media URL from media_id"}
{"asctime": "2025-11-13 11:09:28,713", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 11:09:28,715", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763024044: Success"}
{"asctime": "2025-11-13 11:09:29,965", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '173ac2eb-7b81-4ed6-bdbf-00383bc43cd9', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763024044', 'wa_id': '27763024044'}], 'messages': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI5QzM0M0QyNTI4RjBGNkE4QTQA'}]}}"}
{"asctime": "2025-11-13 11:09:31,122", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI5QzM0M0QyNTI4RjBGNkE4QTQA', 'status': 'sent', 'timestamp': '1763024970', 'recipient_id': '27763024044', 'conversation': {'id': '49725a712704ad8632ac5937ba8a42d1', 'expiration_timestamp': '1763024970', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:09:31,302", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI5QzM0M0QyNTI4RjBGNkE4QTQA', 'status': 'delivered', 'timestamp': '1763024970', 'recipient_id': '27763024044', 'conversation': {'id': '49725a712704ad8632ac5937ba8a42d1', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:09:31,545", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI5QzM0M0QyNTI4RjBGNkE4QTQA', 'status': 'read', 'timestamp': '1763024970', 'recipient_id': '27763024044', 'conversation': {'id': '49725a712704ad8632ac5937ba8a42d1', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:12:14,116", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-11-13 11:12:14,694", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-11-13 11:12:14,695", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-11-13 11:12:14,718", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-11-13 11:12:14,719", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 11:12:14,722", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-11-13 11:12:14,722", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 11:12:14,723", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-11-13 11:12:14,723", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 11:12:14,723", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 11:12:14,724", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 11:12:14,724", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00009s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 11:12:14,726", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 11:12:14,726", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002265s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 11:12:14,727", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 11:12:14,727", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002668s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 11:12:14,728", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 11:12:14,728", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00007s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 11:12:14,728", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 11:12:14,728", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0005366s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 11:12:14,728", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 11:12:14,728", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0008831s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 11:12:14,729", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 11:12:14,729", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-11-13 11:12:14,729", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-11-13 11:12:14,729", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-11-13 11:12:41,934", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World'}, 'wa_id': '27763024044'}], 'messages': [{'from': '27763024044', 'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQTkxOUVFNTNEMzlFNjYzRjcwMgA=', 'timestamp': '1763025160', 'type': 'image', 'image': {'caption': 'Send 10 Rand airtime', 'mime_type': 'image/jpeg', 'sha256': 'dHdXhiG4Pw8kT3NHBKtI3JkM68+WXZmimqbK9bbQG68=', 'id': '25066871186284836'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:12:41,935", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=image, media_id=25066871186284836"}
{"asctime": "2025-11-13 11:12:41,935", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing image message from +27763024044"}
{"asctime": "2025-11-13 11:12:41,943", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 11:12:41,946", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 11:12:41,947", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00032s] {'phone_number_1': '+27763024044', 'param_1': 1}"}
{"asctime": "2025-11-13 11:12:41,950", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-13 11:12:41,950", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00020s] {'last_active_at': datetime.datetime(2025, 11, 13, 9, 12, 41, 949524), 'users_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 11:12:41,952", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 11:12:41,953", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Fetching media URL for ID: 25066871186284836"}
{"asctime": "2025-11-13 11:12:41,953", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Media URL constructed: https://crm.cyraxtechnologies.com/api/meta/v19.0/25066871186284836"}
{"asctime": "2025-11-13 11:12:43,426", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: GET https://crm.cyraxtechnologies.com/api/meta/v19.0/25066871186284836 \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 11:12:43,663", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Media downloaded: media/wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQTkxOUVFNTNEMzlFNjYzRjcwMgA=.jpg"}
{"asctime": "2025-11-13 11:12:43,774", "name": "app.services.ai_service", "levelname": "INFO", "message": "Processing image: media/wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQTkxOUVFNTNEMzlFNjYzRjcwMgA=.jpg with caption: "}
{"asctime": "2025-11-13 11:12:47,802", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 11:12:47,812", "name": "app.services.ai_service", "levelname": "INFO", "message": "Image processed successfully: {\"type\": \"unknown\", \"confidence\": 0.4, \"description\": \"barcode with unknown significance, cannot ide..."}
{"asctime": "2025-11-13 11:12:48,807", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 11:12:48,810", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763024044: Success"}
{"asctime": "2025-11-13 11:12:50,447", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '08a633c0-aebb-4f03-905d-ec858ccc5f9f', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763024044', 'wa_id': '27763024044'}], 'messages': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI0OTIwQzA1NzFFQUNGRDkxMjYA'}]}}"}
{"asctime": "2025-11-13 11:12:51,280", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI0OTIwQzA1NzFFQUNGRDkxMjYA', 'status': 'sent', 'timestamp': '1763025170', 'recipient_id': '27763024044', 'conversation': {'id': '86e806c705e7e06cb675cdb983087b5f', 'expiration_timestamp': '1763025170', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:12:51,990", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI0OTIwQzA1NzFFQUNGRDkxMjYA', 'status': 'delivered', 'timestamp': '1763025170', 'recipient_id': '27763024044', 'conversation': {'id': '86e806c705e7e06cb675cdb983087b5f', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:12:52,429", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI0OTIwQzA1NzFFQUNGRDkxMjYA', 'status': 'read', 'timestamp': '1763025171', 'recipient_id': '27763024044', 'conversation': {'id': '86e806c705e7e06cb675cdb983087b5f', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:13:19,482", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World'}, 'wa_id': '27763024044'}], 'messages': [{'from': '27763024044', 'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQUJCN0NGMkUwRDRERkE3NTE4OAA=', 'timestamp': '1763025197', 'type': 'audio', 'audio': {'mime_type': 'audio/ogg; codecs=opus', 'sha256': 'K8F7U4SVoNTlDwEwqkST/jzot/2X4FGwBkwGrh4o6Ik=', 'id': '1169477694624151', 'voice': True}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:13:19,484", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=audio, media_id=1169477694624151"}
{"asctime": "2025-11-13 11:13:19,484", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing audio message from +27763024044"}
{"asctime": "2025-11-13 11:13:19,486", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 11:13:19,487", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 11:13:19,487", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 37.54s ago] {'phone_number_1': '+27763024044', 'param_1': 1}"}
{"asctime": "2025-11-13 11:13:19,489", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-13 11:13:19,489", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 37.54s ago] {'last_active_at': datetime.datetime(2025, 11, 13, 9, 13, 19, 488946), 'users_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 11:13:19,490", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 11:13:19,491", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Fetching media URL for ID: 1169477694624151"}
{"asctime": "2025-11-13 11:13:19,491", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Media URL constructed: https://crm.cyraxtechnologies.com/api/meta/v19.0/1169477694624151"}
{"asctime": "2025-11-13 11:13:20,943", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: GET https://crm.cyraxtechnologies.com/api/meta/v19.0/1169477694624151 \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 11:13:20,949", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Media downloaded: media/wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQUJCN0NGMkUwRDRERkE3NTE4OAA=.ogg"}
{"asctime": "2025-11-13 11:13:20,961", "name": "app.services.ai_service", "levelname": "INFO", "message": "Transcribing voice note: media/wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQUJCN0NGMkUwRDRERkE3NTE4OAA=.ogg"}
{"asctime": "2025-11-13 11:13:23,088", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/audio/transcriptions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 11:13:23,092", "name": "app.services.ai_service", "levelname": "INFO", "message": "Voice note transcribed successfully: Can you send 10 round airtime to 076-321-4098?..."}
{"asctime": "2025-11-13 11:13:23,095", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 11:13:23,099", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 11:13:23,099", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00069s] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 11:13:23,105", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-13 11:13:23,105", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00076s] {'id': UUID('6850dc86-14d4-4dc5-bcf0-262c38bb18c6'), 'user_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'phone_number': '+27763024044', 'message_id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQUJCN0NGMkUwRDRERkE3NTE4OAA=', 'message_type': 'audio', 'direction': 'inbound', 'message_text': 'Can you send 10 round airtime to 076-321-4098?', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-13 11:13:23,110", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 11:13:23,112", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 11:13:23,112", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 11:13:23,112", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.01363s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 11:13:23,115", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 11:13:23,116", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00022s] {'user_id_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'param_1': 5}"}
{"asctime": "2025-11-13 11:13:24,574", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 11:13:24,585", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 11:13:24,585", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00073s] {'pk_1': UUID('6850dc86-14d4-4dc5-bcf0-262c38bb18c6')}"}
{"asctime": "2025-11-13 11:13:24,588", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-13 11:13:24,588", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00046s] {'ai_response': \"It looks like your wallet balance is currently R0.00, so you won't be able to purchase airtime right now. \\n\\nIf you can add some funds to your wallet, I\u2019d be happy to help you send the R10 airtime! Let me know if you need assistance with anything else! \ud83d\ude0a\", 'intent_detected': 'buy_airtime', 'entities_extracted': '{\"amount\": 10.0, \"phone\": null, \"network\": null}', 'confidence_score': 0.9, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 13, 9, 13, 24, 580647), 'conversations_id': UUID('6850dc86-14d4-4dc5-bcf0-262c38bb18c6')}"}
{"asctime": "2025-11-13 11:13:24,591", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 11:13:25,621", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 11:13:25,622", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763024044: Success"}
{"asctime": "2025-11-13 11:13:26,822", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '0420dad0-a16b-475e-b14c-7f451fb78bed', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763024044', 'wa_id': '27763024044'}], 'messages': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBIzRTJBMkJDRjIxNEE2Qjg5QTQA'}]}}"}
{"asctime": "2025-11-13 11:13:27,698", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBIzRTJBMkJDRjIxNEE2Qjg5QTQA', 'status': 'sent', 'timestamp': '1763025206', 'recipient_id': '27763024044', 'conversation': {'id': '9dd6237b2f74e697e9c4e9e1a1cad3fc', 'expiration_timestamp': '1763025207', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:13:28,154", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBIzRTJBMkJDRjIxNEE2Qjg5QTQA', 'status': 'delivered', 'timestamp': '1763025207', 'recipient_id': '27763024044', 'conversation': {'id': '9dd6237b2f74e697e9c4e9e1a1cad3fc', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:13:28,812", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBIzRTJBMkJDRjIxNEE2Qjg5QTQA', 'status': 'read', 'timestamp': '1763025207', 'recipient_id': '27763024044', 'conversation': {'id': '9dd6237b2f74e697e9c4e9e1a1cad3fc', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:13:50,019", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World'}, 'wa_id': '27763024044'}], 'messages': [{'from': '27763024044', 'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQTkzMEJCNDZBREQ5QjY0NjgyNgA=', 'timestamp': '1763025228', 'type': 'audio', 'audio': {'mime_type': 'audio/ogg; codecs=opus', 'sha256': 'kvhNfVcC0X+qbR2CaiJmVkCgKFdC86tz8iZCJtQd3rw=', 'id': '1319741536590161', 'voice': True}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:13:50,019", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=audio, media_id=1319741536590161"}
{"asctime": "2025-11-13 11:13:50,020", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing audio message from +27763024044"}
{"asctime": "2025-11-13 11:13:50,022", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 11:13:50,023", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 11:13:50,024", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 68s ago] {'phone_number_1': '+27763024044', 'param_1': 1}"}
{"asctime": "2025-11-13 11:13:50,026", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-13 11:13:50,027", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 68s ago] {'last_active_at': datetime.datetime(2025, 11, 13, 9, 13, 50, 26399), 'users_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 11:13:50,028", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 11:13:50,028", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Fetching media URL for ID: 1319741536590161"}
{"asctime": "2025-11-13 11:13:50,029", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Media URL constructed: https://crm.cyraxtechnologies.com/api/meta/v19.0/1319741536590161"}
{"asctime": "2025-11-13 11:13:52,185", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: GET https://crm.cyraxtechnologies.com/api/meta/v19.0/1319741536590161 \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 11:13:52,195", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Media downloaded: media/wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQTkzMEJCNDZBREQ5QjY0NjgyNgA=.ogg"}
{"asctime": "2025-11-13 11:13:52,204", "name": "app.services.ai_service", "levelname": "INFO", "message": "Transcribing voice note: media/wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQTkzMEJCNDZBREQ5QjY0NjgyNgA=.ogg"}
{"asctime": "2025-11-13 11:13:54,096", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/audio/transcriptions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 11:13:54,098", "name": "app.services.ai_service", "levelname": "INFO", "message": "Voice note transcribed successfully: Can you send 100 Rand ATM for me right now?..."}
{"asctime": "2025-11-13 11:13:54,101", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 11:13:54,102", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 11:13:54,103", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 31s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 11:13:54,108", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-13 11:13:54,109", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 31s ago] {'id': UUID('40383d20-cff0-48b2-8a4c-3b316f744572'), 'user_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'phone_number': '+27763024044', 'message_id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQTkzMEJCNDZBREQ5QjY0NjgyNgA=', 'message_type': 'audio', 'direction': 'inbound', 'message_text': 'Can you send 100 Rand ATM for me right now?', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-13 11:13:54,112", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 11:13:54,115", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 11:13:54,116", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 11:13:54,117", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 31.02s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 11:13:54,119", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 11:13:54,119", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 31s ago] {'user_id_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'param_1': 5}"}
{"asctime": "2025-11-13 11:13:56,341", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 11:13:56,352", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 11:13:56,352", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 31.77s ago] {'pk_1': UUID('40383d20-cff0-48b2-8a4c-3b316f744572')}"}
{"asctime": "2025-11-13 11:13:56,354", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-13 11:13:56,355", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 31.77s ago] {'ai_response': \"I can't send money directly to an ATM just yet because I'm waiting for my banking license. \\n\\nHowever, I can help you with buying airtime or paying bills if you have funds available in your wallet. If you have any other questions or need assistance, just let me know! \ud83d\ude0a\", 'intent_detected': 'conversation', 'entities_extracted': '{}', 'confidence_score': 0.7, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 13, 9, 13, 56, 350042), 'conversations_id': UUID('40383d20-cff0-48b2-8a4c-3b316f744572')}"}
{"asctime": "2025-11-13 11:13:56,361", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 11:13:57,360", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 11:13:57,362", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763024044: Success"}
{"asctime": "2025-11-13 11:13:58,851", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '6770caaa-6938-47aa-993b-67bcd58b2fb1', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763024044', 'wa_id': '27763024044'}], 'messages': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI4NTJBOTMzNUM4QTFCNjQzMjcA'}]}}"}
{"asctime": "2025-11-13 11:13:59,701", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI4NTJBOTMzNUM4QTFCNjQzMjcA', 'status': 'sent', 'timestamp': '1763025238', 'recipient_id': '27763024044', 'conversation': {'id': '69e089a5eecb675a75364eb22e83d8b8', 'expiration_timestamp': '1763025239', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:14:00,127", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI4NTJBOTMzNUM4QTFCNjQzMjcA', 'status': 'delivered', 'timestamp': '1763025239', 'recipient_id': '27763024044', 'conversation': {'id': '69e089a5eecb675a75364eb22e83d8b8', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:14:00,456", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI4NTJBOTMzNUM4QTFCNjQzMjcA', 'status': 'read', 'timestamp': '1763025239', 'recipient_id': '27763024044', 'conversation': {'id': '69e089a5eecb675a75364eb22e83d8b8', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:14:16,635", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World'}, 'wa_id': '27763024044'}], 'messages': [{'from': '27763024044', 'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQTBDQTlEQzdBNTIyOUM2Q0JGMQA=', 'timestamp': '1763025254', 'type': 'audio', 'audio': {'mime_type': 'audio/ogg; codecs=opus', 'sha256': 'QR63x5+WKlJvQF4EYPzWb0Up4C9b5fS9yE/gKByRUxw=', 'id': '1065691998910565', 'voice': True}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:14:16,636", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=audio, media_id=1065691998910565"}
{"asctime": "2025-11-13 11:14:16,637", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing audio message from +27763024044"}
{"asctime": "2025-11-13 11:14:16,645", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 11:14:16,652", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 11:14:16,653", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 94.63s ago] {'phone_number_1': '+27763024044', 'param_1': 1}"}
{"asctime": "2025-11-13 11:14:16,654", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-13 11:14:16,656", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 94.62s ago] {'last_active_at': datetime.datetime(2025, 11, 13, 9, 14, 16, 654424), 'users_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 11:14:16,658", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 11:14:16,659", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Fetching media URL for ID: 1065691998910565"}
{"asctime": "2025-11-13 11:14:16,659", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Media URL constructed: https://crm.cyraxtechnologies.com/api/meta/v19.0/1065691998910565"}
{"asctime": "2025-11-13 11:14:18,221", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: GET https://crm.cyraxtechnologies.com/api/meta/v19.0/1065691998910565 \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 11:14:18,233", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Media downloaded: media/wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQTBDQTlEQzdBNTIyOUM2Q0JGMQA=.ogg"}
{"asctime": "2025-11-13 11:14:18,249", "name": "app.services.ai_service", "levelname": "INFO", "message": "Transcribing voice note: media/wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQTBDQTlEQzdBNTIyOUM2Q0JGMQA=.ogg"}
{"asctime": "2025-11-13 11:14:20,278", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/audio/transcriptions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 11:14:20,280", "name": "app.services.ai_service", "levelname": "INFO", "message": "Voice note transcribed successfully: Can you buy 20 rand airtime for me right now?..."}
{"asctime": "2025-11-13 11:14:20,283", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 11:14:20,284", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 11:14:20,284", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 57.18s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 11:14:20,287", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-13 11:14:20,288", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 57.18s ago] {'id': UUID('866fed2d-46a9-4b0f-80a1-5c244bd66bc6'), 'user_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'phone_number': '+27763024044', 'message_id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQTBDQTlEQzdBNTIyOUM2Q0JGMQA=', 'message_type': 'audio', 'direction': 'inbound', 'message_text': 'Can you buy 20 rand airtime for me right now?', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-13 11:14:20,295", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 11:14:20,297", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 11:14:20,297", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 11:14:20,298", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 57.2s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 11:14:20,300", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 11:14:20,300", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 57.18s ago] {'user_id_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'param_1': 5}"}
{"asctime": "2025-11-13 11:14:22,117", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 11:14:22,126", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 11:14:22,126", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 57.54s ago] {'pk_1': UUID('866fed2d-46a9-4b0f-80a1-5c244bd66bc6')}"}
{"asctime": "2025-11-13 11:14:22,128", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-13 11:14:22,128", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 57.54s ago] {'ai_response': \"Your wallet balance is currently R0.00, so I can't process the R20 airtime purchase right now. \\n\\nIf you can top up your wallet, I\u2019d be more than happy to help you with that airtime! Let me know if there\u2019s anything else I can assist you with! \ud83d\ude0a\", 'intent_detected': 'buy_airtime', 'entities_extracted': '{\"amount\": 20.0, \"phone\": null, \"network\": null}', 'confidence_score': 0.9, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 13, 9, 14, 22, 124219), 'conversations_id': UUID('866fed2d-46a9-4b0f-80a1-5c244bd66bc6')}"}
{"asctime": "2025-11-13 11:14:22,129", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 11:14:23,164", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 11:14:23,166", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763024044: Success"}
{"asctime": "2025-11-13 11:14:24,606", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '1d4f0f47-00a0-40f4-a6d1-6c0e0b315001', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763024044', 'wa_id': '27763024044'}], 'messages': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI1NEJEMkE3MzdENzA5MjMzQzYA'}]}}"}
{"asctime": "2025-11-13 11:14:25,895", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI1NEJEMkE3MzdENzA5MjMzQzYA', 'status': 'sent', 'timestamp': '1763025264', 'recipient_id': '27763024044', 'conversation': {'id': 'b0cf5ea255729ce262a38bf8a462c6cd', 'expiration_timestamp': '1763025264', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:14:25,896", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI1NEJEMkE3MzdENzA5MjMzQzYA', 'status': 'delivered', 'timestamp': '1763025264', 'recipient_id': '27763024044', 'conversation': {'id': 'b0cf5ea255729ce262a38bf8a462c6cd', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:14:29,050", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI1NEJEMkE3MzdENzA5MjMzQzYA', 'status': 'read', 'timestamp': '1763025268', 'recipient_id': '27763024044', 'conversation': {'id': 'b0cf5ea255729ce262a38bf8a462c6cd', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:15:28,260", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World'}, 'wa_id': '27763024044'}], 'messages': [{'from': '27763024044', 'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQTUzRDJFQTc0NkZCOEY5NkM2NAA=', 'timestamp': '1763025326', 'type': 'image', 'image': {'caption': 'Buy electricity for this meter', 'mime_type': 'image/jpeg', 'sha256': 'Fzg8EGTfxC4MxBDefBrsFFYOeJYsGnzJaJksN++4JgM=', 'id': '2065705240842602'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:15:28,261", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=image, media_id=2065705240842602"}
{"asctime": "2025-11-13 11:15:28,262", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing image message from +27763024044"}
{"asctime": "2025-11-13 11:15:28,267", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 11:15:28,268", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 11:15:28,268", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 166.2s ago] {'phone_number_1': '+27763024044', 'param_1': 1}"}
{"asctime": "2025-11-13 11:15:28,272", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-13 11:15:28,272", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 166.2s ago] {'last_active_at': datetime.datetime(2025, 11, 13, 9, 15, 28, 271612), 'users_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 11:15:28,275", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 11:15:28,282", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Fetching media URL for ID: 2065705240842602"}
{"asctime": "2025-11-13 11:15:28,283", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Media URL constructed: https://crm.cyraxtechnologies.com/api/meta/v19.0/2065705240842602"}
{"asctime": "2025-11-13 11:15:29,848", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: GET https://crm.cyraxtechnologies.com/api/meta/v19.0/2065705240842602 \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 11:15:29,854", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Media downloaded: media/wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQTUzRDJFQTc0NkZCOEY5NkM2NAA=.jpg"}
{"asctime": "2025-11-13 11:15:29,876", "name": "app.services.ai_service", "levelname": "INFO", "message": "Processing image: media/wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQTUzRDJFQTc0NkZCOEY5NkM2NAA=.jpg with caption: "}
{"asctime": "2025-11-13 11:15:32,344", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 11:15:32,347", "name": "app.services.ai_service", "levelname": "INFO", "message": "Image processed successfully: {\"type\": \"account_number\", \"account_number\": \"1232071854\", \"provider\": \"Unknown\", \"confidence\": 0.9,..."}
{"asctime": "2025-11-13 11:15:33,315", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 11:15:33,317", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763024044: Success"}
{"asctime": "2025-11-13 11:15:33,319", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 11:15:33,324", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 11:15:33,324", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 130.2s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 11:15:33,327", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-13 11:15:33,328", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 130.2s ago] {'id': UUID('aa5d0d9d-3ebc-4736-a943-016c93740186'), 'user_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'phone_number': '+27763024044', 'message_id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQTUzRDJFQTc0NkZCOEY5NkM2NAA=', 'message_type': 'image', 'direction': 'inbound', 'message_text': 'pay Unknown bill for account 1232071854 amount ', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-13 11:15:33,329", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 11:15:33,331", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 11:15:33,332", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 11:15:33,332", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 130.2s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 11:15:33,334", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 11:15:33,334", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 130.2s ago] {'user_id_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'param_1': 5}"}
{"asctime": "2025-11-13 11:15:34,981", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '6f5f9718-0576-4075-8a0a-ba3968a77ab5', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763024044', 'wa_id': '27763024044'}], 'messages': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBIxRTA1REI3RjcxREUxMENFREIA'}]}}"}
{"asctime": "2025-11-13 11:15:35,531", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 11:15:35,537", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 11:15:35,537", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 131s ago] {'pk_1': UUID('aa5d0d9d-3ebc-4736-a943-016c93740186')}"}
{"asctime": "2025-11-13 11:15:35,544", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-13 11:15:35,545", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 131s ago] {'ai_response': \"It seems like you're looking to pay an unknown bill, but I need a bit more information. \\n\\nCould you please confirm the amount you want to pay for a ... (30 characters truncated) ... , just a reminder, your wallet balance is currently R0.00, so you'll need to add funds to your wallet first. Let me know how you'd like to proceed! \ud83d\ude0a\", 'intent_detected': 'conversation', 'entities_extracted': '{}', 'confidence_score': 0.7, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 13, 9, 15, 35, 535682), 'conversations_id': UUID('aa5d0d9d-3ebc-4736-a943-016c93740186')}"}
{"asctime": "2025-11-13 11:15:35,549", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 11:15:35,741", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBIxRTA1REI3RjcxREUxMENFREIA', 'status': 'sent', 'timestamp': '1763025334', 'recipient_id': '27763024044', 'conversation': {'id': '7a9ac2ac4e72f520eaec00353efe5a53', 'expiration_timestamp': '1763025335', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:15:36,025", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBIxRTA1REI3RjcxREUxMENFREIA', 'status': 'delivered', 'timestamp': '1763025335', 'recipient_id': '27763024044', 'conversation': {'id': '7a9ac2ac4e72f520eaec00353efe5a53', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:15:36,555", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 11:15:36,558", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763024044: Success"}
{"asctime": "2025-11-13 11:15:37,811", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': 'e8262e49-b9cc-4802-961d-c6f5161c1ddb', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763024044', 'wa_id': '27763024044'}], 'messages': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJGMEZEQzlBMjczNDk3QTY0RTkA'}]}}"}
{"asctime": "2025-11-13 11:15:38,077", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBIxRTA1REI3RjcxREUxMENFREIA', 'status': 'read', 'timestamp': '1763025336', 'recipient_id': '27763024044', 'conversation': {'id': '7a9ac2ac4e72f520eaec00353efe5a53', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:15:38,704", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJGMEZEQzlBMjczNDk3QTY0RTkA', 'status': 'sent', 'timestamp': '1763025337', 'recipient_id': '27763024044', 'conversation': {'id': '7d0bbe210e355f42fca4b84ac5224d90', 'expiration_timestamp': '1763025337', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:15:39,027", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJGMEZEQzlBMjczNDk3QTY0RTkA', 'status': 'delivered', 'timestamp': '1763025338', 'recipient_id': '27763024044', 'conversation': {'id': '7d0bbe210e355f42fca4b84ac5224d90', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:15:39,359", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJGMEZEQzlBMjczNDk3QTY0RTkA', 'status': 'read', 'timestamp': '1763025338', 'recipient_id': '27763024044', 'conversation': {'id': '7d0bbe210e355f42fca4b84ac5224d90', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:16:52,694", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World'}, 'wa_id': '27763024044'}], 'messages': [{'from': '27763024044', 'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQUUwMkM3MDlBMUM0RTdEOEFBRgA=', 'timestamp': '1763025410', 'type': 'image', 'image': {'caption': 'Send airtime', 'mime_type': 'image/jpeg', 'sha256': 'zHja3FexK/BLlhu5dOI6pvi53VhpzMdR2xp5wqzrwU8=', 'id': '1385429679825256'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:16:52,696", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=image, media_id=1385429679825256"}
{"asctime": "2025-11-13 11:16:52,696", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing image message from +27763024044"}
{"asctime": "2025-11-13 11:16:52,699", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 11:16:52,700", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 11:16:52,701", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 250.7s ago] {'phone_number_1': '+27763024044', 'param_1': 1}"}
{"asctime": "2025-11-13 11:16:52,703", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-13 11:16:52,703", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 250.7s ago] {'last_active_at': datetime.datetime(2025, 11, 13, 9, 16, 52, 702680), 'users_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 11:16:52,704", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 11:16:52,708", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Fetching media URL for ID: 1385429679825256"}
{"asctime": "2025-11-13 11:16:52,708", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Media URL constructed: https://crm.cyraxtechnologies.com/api/meta/v19.0/1385429679825256"}
{"asctime": "2025-11-13 11:16:54,501", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: GET https://crm.cyraxtechnologies.com/api/meta/v19.0/1385429679825256 \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 11:16:54,505", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Media downloaded: media/wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQUUwMkM3MDlBMUM0RTdEOEFBRgA=.jpg"}
{"asctime": "2025-11-13 11:16:54,525", "name": "app.services.ai_service", "levelname": "INFO", "message": "Processing image: media/wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQUUwMkM3MDlBMUM0RTdEOEFBRgA=.jpg with caption: "}
{"asctime": "2025-11-13 11:16:57,478", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 11:16:57,483", "name": "app.services.ai_service", "levelname": "INFO", "message": "Image processed successfully: {\"type\": \"phone_number\", \"phone_number\": \"+2349153238122\", \"provider\": \"Unknown\", \"confidence\": 0.85..."}
{"asctime": "2025-11-13 11:16:59,714", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 11:16:59,716", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763024044: Success"}
{"asctime": "2025-11-13 11:16:59,719", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 11:16:59,719", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 11:16:59,720", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 216.6s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 11:16:59,722", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-13 11:16:59,722", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 216.6s ago] {'id': UUID('ddcb386b-8c31-4a03-8eec-1db049673393'), 'user_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'phone_number': '+27763024044', 'message_id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQUUwMkM3MDlBMUM0RTdEOEFBRgA=', 'message_type': 'image', 'direction': 'inbound', 'message_text': 'buy airtime for +2349153238122', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-13 11:16:59,724", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 11:16:59,725", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 11:16:59,725", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 11:16:59,725", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 216.6s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 11:16:59,727", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 11:16:59,728", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 216.6s ago] {'user_id_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'param_1': 5}"}
{"asctime": "2025-11-13 11:17:01,268", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '619f3255-1bcd-432a-bc45-af1a25957877', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763024044', 'wa_id': '27763024044'}], 'messages': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJCMUY1MEI5RTdDNTU5QjhCRjEA'}]}}"}
{"asctime": "2025-11-13 11:17:01,855", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJCMUY1MEI5RTdDNTU5QjhCRjEA', 'status': 'sent', 'timestamp': '1763025421', 'recipient_id': '27763024044', 'conversation': {'id': '6581c24bc8472cde51cf5eea6ead58af', 'expiration_timestamp': '1763025421', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:17:02,258", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJCMUY1MEI5RTdDNTU5QjhCRjEA', 'status': 'delivered', 'timestamp': '1763025421', 'recipient_id': '27763024044', 'conversation': {'id': '6581c24bc8472cde51cf5eea6ead58af', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:17:02,924", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJCMUY1MEI5RTdDNTU5QjhCRjEA', 'status': 'read', 'timestamp': '1763025421', 'recipient_id': '27763024044', 'conversation': {'id': '6581c24bc8472cde51cf5eea6ead58af', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:17:03,084", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 11:17:03,091", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 11:17:03,092", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 218.5s ago] {'pk_1': UUID('ddcb386b-8c31-4a03-8eec-1db049673393')}"}
{"asctime": "2025-11-13 11:17:03,094", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-13 11:17:03,094", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 218.5s ago] {'ai_response': \"I can help you buy airtime, but it looks like the number you've provided (+2349153238122) is not a South African number. I can only assist with South ... (11 characters truncated) ... tworks like MTN, Vodacom, Cell C, or Telkom.\\n\\nIf you have a South African number, please let me know, along with the amount you want to purchase! \ud83d\ude0a\", 'intent_detected': 'buy_airtime', 'entities_extracted': '{\"amount\": 2349153238122.0, \"phone\": null, \"network\": null}', 'confidence_score': 0.9, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 13, 9, 17, 3, 89362), 'conversations_id': UUID('ddcb386b-8c31-4a03-8eec-1db049673393')}"}
{"asctime": "2025-11-13 11:17:03,096", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 11:17:04,119", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 11:17:04,120", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763024044: Success"}
{"asctime": "2025-11-13 11:17:05,580", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': 'da0f5b27-9bf7-49b4-9dec-08309a48cbb8', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763024044', 'wa_id': '27763024044'}], 'messages': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI2QzcxMzY5RUVFQjgxMkQyNUMA'}]}}"}
{"asctime": "2025-11-13 11:17:06,492", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI2QzcxMzY5RUVFQjgxMkQyNUMA', 'status': 'sent', 'timestamp': '1763025425', 'recipient_id': '27763024044', 'conversation': {'id': '08639ce8974613b2668a446368c06bab', 'expiration_timestamp': '1763025425', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:17:06,764", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI2QzcxMzY5RUVFQjgxMkQyNUMA', 'status': 'delivered', 'timestamp': '1763025425', 'recipient_id': '27763024044', 'conversation': {'id': '08639ce8974613b2668a446368c06bab', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:17:07,229", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI2QzcxMzY5RUVFQjgxMkQyNUMA', 'status': 'read', 'timestamp': '1763025426', 'recipient_id': '27763024044', 'conversation': {'id': '08639ce8974613b2668a446368c06bab', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:17:39,927", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World'}, 'wa_id': '27763024044'}], 'messages': [{'from': '27763024044', 'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQUU0QUYwMEEzNTAwRTUzQ0Y2MQA=', 'timestamp': '1763025458', 'type': 'image', 'image': {'caption': 'Send airtime', 'mime_type': 'image/jpeg', 'sha256': 'PDwz+nhJ9L2TWNAvEeM7HpLMHoTXpDhpbUr5MCUK4ZM=', 'id': '1387238396382442'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:17:39,929", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=image, media_id=1387238396382442"}
{"asctime": "2025-11-13 11:17:39,929", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing image message from +27763024044"}
{"asctime": "2025-11-13 11:17:39,931", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 11:17:39,931", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 11:17:39,931", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 297.9s ago] {'phone_number_1': '+27763024044', 'param_1': 1}"}
{"asctime": "2025-11-13 11:17:39,933", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-13 11:17:39,933", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 297.9s ago] {'last_active_at': datetime.datetime(2025, 11, 13, 9, 17, 39, 933175), 'users_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 11:17:39,934", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 11:17:39,935", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Fetching media URL for ID: 1387238396382442"}
{"asctime": "2025-11-13 11:17:39,936", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Media URL constructed: https://crm.cyraxtechnologies.com/api/meta/v19.0/1387238396382442"}
{"asctime": "2025-11-13 11:17:41,865", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: GET https://crm.cyraxtechnologies.com/api/meta/v19.0/1387238396382442 \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 11:17:42,110", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Media downloaded: media/wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQUU0QUYwMEEzNTAwRTUzQ0Y2MQA=.jpg"}
{"asctime": "2025-11-13 11:17:42,129", "name": "app.services.ai_service", "levelname": "INFO", "message": "Processing image: media/wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQUU0QUYwMEEzNTAwRTUzQ0Y2MQA=.jpg with caption: "}
{"asctime": "2025-11-13 11:17:46,011", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 11:17:46,012", "name": "app.services.ai_service", "levelname": "INFO", "message": "Image processed successfully: {\"type\": \"phone_number\", \"phone_number\": \"0761905479\", \"provider\": \"Unknown\", \"confidence\": 0.95, \"d..."}
{"asctime": "2025-11-13 11:17:47,021", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 11:17:47,023", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763024044: Success"}
{"asctime": "2025-11-13 11:17:47,025", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 11:17:47,026", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 11:17:47,026", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 263.9s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 11:17:47,027", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-13 11:17:47,028", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 263.9s ago] {'id': UUID('476cefc0-ae4b-48fd-af09-5f5286823a98'), 'user_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'phone_number': '+27763024044', 'message_id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQUU0QUYwMEEzNTAwRTUzQ0Y2MQA=', 'message_type': 'image', 'direction': 'inbound', 'message_text': 'buy airtime for 0761905479', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-13 11:17:47,029", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 11:17:47,030", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 11:17:47,030", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 11:17:47,030", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 263.9s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 11:17:47,032", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 11:17:47,032", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 263.9s ago] {'user_id_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'param_1': 5}"}
{"asctime": "2025-11-13 11:17:48,500", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 11:17:48,509", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 11:17:48,509", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 263.9s ago] {'pk_1': UUID('476cefc0-ae4b-48fd-af09-5f5286823a98')}"}
{"asctime": "2025-11-13 11:17:48,512", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-13 11:17:48,512", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 263.9s ago] {'ai_response': \"How much airtime would you like to buy for the number 0761905479? The amounts can range from R5 to R1000. Just let me know the amount, and I'll help you with the purchase! \ud83d\ude0a\", 'intent_detected': 'buy_airtime', 'entities_extracted': '{\"amount\": 761905479.0, \"phone\": \"0761905479\", \"network\": null}', 'confidence_score': 0.9, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 13, 9, 17, 48, 505776), 'conversations_id': UUID('476cefc0-ae4b-48fd-af09-5f5286823a98')}"}
{"asctime": "2025-11-13 11:17:48,513", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 11:17:48,622", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '4017d99c-4488-41f2-b838-190427688ae0', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763024044', 'wa_id': '27763024044'}], 'messages': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI3NzlGNUVCQTM1MkM5NkU3NTMA'}]}}"}
{"asctime": "2025-11-13 11:17:49,586", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 11:17:49,591", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763024044: Success"}
{"asctime": "2025-11-13 11:17:49,752", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI3NzlGNUVCQTM1MkM5NkU3NTMA', 'status': 'sent', 'timestamp': '1763025468', 'recipient_id': '27763024044', 'conversation': {'id': '4918bc71a2ad3588a2d9fc26d5da1364', 'expiration_timestamp': '1763025468', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:17:49,953", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI3NzlGNUVCQTM1MkM5NkU3NTMA', 'status': 'delivered', 'timestamp': '1763025468', 'recipient_id': '27763024044', 'conversation': {'id': '4918bc71a2ad3588a2d9fc26d5da1364', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:17:50,386", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI3NzlGNUVCQTM1MkM5NkU3NTMA', 'status': 'read', 'timestamp': '1763025469', 'recipient_id': '27763024044', 'conversation': {'id': '4918bc71a2ad3588a2d9fc26d5da1364', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:17:51,012", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '20436112-8f06-4b9c-88a7-8cf77ce6c798', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763024044', 'wa_id': '27763024044'}], 'messages': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI4RjRDOERBMzBBMTlCNkFDQzMA'}]}}"}
{"asctime": "2025-11-13 11:17:51,941", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI4RjRDOERBMzBBMTlCNkFDQzMA', 'status': 'sent', 'timestamp': '1763025471', 'recipient_id': '27763024044', 'conversation': {'id': 'a1fb7221588e2e46901a30322869f66a', 'expiration_timestamp': '1763025471', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:17:52,318", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI4RjRDOERBMzBBMTlCNkFDQzMA', 'status': 'delivered', 'timestamp': '1763025471', 'recipient_id': '27763024044', 'conversation': {'id': 'a1fb7221588e2e46901a30322869f66a', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:17:52,721", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI4RjRDOERBMzBBMTlCNkFDQzMA', 'status': 'read', 'timestamp': '1763025471', 'recipient_id': '27763024044', 'conversation': {'id': 'a1fb7221588e2e46901a30322869f66a', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:18:00,237", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World'}, 'wa_id': '27763024044'}], 'messages': [{'from': '27763024044', 'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQUQ2RTE4Q0FEQzdEMjQ1NEY3MwA=', 'timestamp': '1763025479', 'text': {'body': '10'}, 'type': 'text'}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:18:00,238", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=text, media_id=none"}
{"asctime": "2025-11-13 11:18:00,238", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763024044"}
{"asctime": "2025-11-13 11:18:00,241", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 11:18:00,241", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 11:18:00,241", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 318.2s ago] {'phone_number_1': '+27763024044', 'param_1': 1}"}
{"asctime": "2025-11-13 11:18:00,243", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-13 11:18:00,243", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 318.2s ago] {'last_active_at': datetime.datetime(2025, 11, 13, 9, 18, 0, 243305), 'users_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 11:18:00,244", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 11:18:00,245", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 11:18:00,245", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 11:18:00,245", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 277.1s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 11:18:00,246", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-13 11:18:00,246", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 277.1s ago] {'id': UUID('61e2a30a-1277-4f39-a2ad-d93a95e164ac'), 'user_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'phone_number': '+27763024044', 'message_id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQUQ2RTE4Q0FEQzdEMjQ1NEY3MwA=', 'message_type': 'text', 'direction': 'inbound', 'message_text': '10', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-13 11:18:00,247", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 11:18:00,248", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 11:18:00,248", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 11:18:00,248", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 277.1s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 11:18:00,249", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 11:18:00,249", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 277.1s ago] {'user_id_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'param_1': 5}"}
{"asctime": "2025-11-13 11:18:02,392", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 11:18:02,394", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 11:18:02,394", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 277.8s ago] {'pk_1': UUID('61e2a30a-1277-4f39-a2ad-d93a95e164ac')}"}
{"asctime": "2025-11-13 11:18:02,395", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-13 11:18:02,395", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 277.8s ago] {'ai_response': 'Great! Just to confirm, you want to buy R10 airtime for the number 0761905479. \\n\\nPlease note that there is a small service fee of about 2-5%.\\n\\nCould you provide your PIN to proceed with the purchase? \ud83d\ude0a', 'intent_detected': 'conversation', 'entities_extracted': '{}', 'confidence_score': 0.7, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 13, 9, 18, 2, 394020), 'conversations_id': UUID('61e2a30a-1277-4f39-a2ad-d93a95e164ac')}"}
{"asctime": "2025-11-13 11:18:02,396", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 11:18:03,511", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 11:18:03,512", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763024044: Success"}
{"asctime": "2025-11-13 11:18:04,873", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '309b4c1c-dc59-4234-b7d0-01ccb07ee91c', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763024044', 'wa_id': '27763024044'}], 'messages': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI0ODQ4MTY1MkNGOTFDOEIwMjQA'}]}}"}
{"asctime": "2025-11-13 11:18:05,682", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI0ODQ4MTY1MkNGOTFDOEIwMjQA', 'status': 'sent', 'timestamp': '1763025484', 'recipient_id': '27763024044', 'conversation': {'id': '84a44ac2cbd980f51b642d895e7a7e94', 'expiration_timestamp': '1763025484', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:18:05,967", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI0ODQ4MTY1MkNGOTFDOEIwMjQA', 'status': 'delivered', 'timestamp': '1763025485', 'recipient_id': '27763024044', 'conversation': {'id': '84a44ac2cbd980f51b642d895e7a7e94', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:18:06,108", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI0ODQ4MTY1MkNGOTFDOEIwMjQA', 'status': 'read', 'timestamp': '1763025485', 'recipient_id': '27763024044', 'conversation': {'id': '84a44ac2cbd980f51b642d895e7a7e94', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:27:31,861", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-11-13 11:27:32,439", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-11-13 11:27:32,439", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-11-13 11:27:32,529", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-11-13 11:27:32,529", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 11:27:32,530", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-11-13 11:27:32,530", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 11:27:32,530", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-11-13 11:27:32,530", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 11:27:32,531", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 11:27:32,532", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 11:27:32,532", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00012s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 11:27:32,534", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 11:27:32,535", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002448s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 11:27:32,535", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 11:27:32,535", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002958s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 11:27:32,536", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 11:27:32,536", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00010s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 11:27:32,537", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 11:27:32,537", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0008033s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 11:27:32,537", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 11:27:32,538", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001479s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 11:27:32,538", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 11:27:32,538", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-11-13 11:27:32,538", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-11-13 11:27:32,538", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-11-13 11:27:50,948", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-11-13 11:27:51,483", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-11-13 11:27:51,483", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-11-13 11:27:51,502", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-11-13 11:27:51,502", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 11:27:51,503", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-11-13 11:27:51,503", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 11:27:51,503", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-11-13 11:27:51,503", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 11:27:51,504", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 11:27:51,505", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 11:27:51,505", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00010s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 11:27:51,507", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 11:27:51,508", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.00263s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 11:27:51,508", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 11:27:51,508", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.00343s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 11:27:51,509", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 11:27:51,509", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00008s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 11:27:51,510", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 11:27:51,510", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0008367s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 11:27:51,511", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 11:27:51,511", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001447s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 11:27:51,511", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 11:27:51,511", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-11-13 11:27:51,511", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-11-13 11:27:51,511", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-11-13 11:28:08,501", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-11-13 11:28:09,042", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-11-13 11:28:09,042", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-11-13 11:28:09,060", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-11-13 11:28:09,060", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 11:28:09,061", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-11-13 11:28:09,061", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 11:28:09,061", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-11-13 11:28:09,061", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-13 11:28:09,061", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 11:28:09,063", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 11:28:09,063", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00010s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 11:28:09,064", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 11:28:09,064", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001997s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 11:28:09,065", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 11:28:09,065", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002473s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 11:28:09,066", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 11:28:09,066", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00006s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 11:28:09,066", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 11:28:09,066", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0006167s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 11:28:09,067", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-13 11:28:09,067", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001201s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-13 11:28:09,067", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 11:28:09,067", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-11-13 11:28:09,067", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-11-13 11:28:09,068", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-11-13 11:28:16,703", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World'}, 'wa_id': '27763024044'}], 'messages': [{'from': '27763024044', 'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQTFDREI5MkQwNUFDRkMxNzIxNgA=', 'timestamp': '1763026095', 'text': {'body': 'Hi'}, 'type': 'text'}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:28:16,703", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=text, media_id=none"}
{"asctime": "2025-11-13 11:28:16,704", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763024044"}
{"asctime": "2025-11-13 11:28:16,712", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 11:28:16,715", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 11:28:16,715", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00032s] {'phone_number_1': '+27763024044', 'param_1': 1}"}
{"asctime": "2025-11-13 11:28:16,719", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-13 11:28:16,720", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00085s] {'last_active_at': datetime.datetime(2025, 11, 13, 9, 28, 16, 718097), 'users_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 11:28:16,721", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 11:28:16,723", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 11:28:16,725", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 11:28:16,725", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00043s] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 11:28:16,730", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-13 11:28:16,730", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00027s] {'id': UUID('e41b9f81-2b28-400e-b07c-6b2be93007ef'), 'user_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'phone_number': '+27763024044', 'message_id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQTFDREI5MkQwNUFDRkMxNzIxNgA=', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'Hi', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-13 11:28:16,732", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 11:28:16,733", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 11:28:16,733", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 11:28:16,733", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.008368s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 11:28:16,735", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 11:28:16,735", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00014s] {'user_id_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'param_1': 5}"}
{"asctime": "2025-11-13 11:28:18,449", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 11:28:18,468", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 11:28:18,468", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00056s] {'pk_1': UUID('e41b9f81-2b28-400e-b07c-6b2be93007ef')}"}
{"asctime": "2025-11-13 11:28:18,470", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-13 11:28:18,470", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00013s] {'ai_response': \"Hi there! \ud83d\ude0a How can I assist you today? If you're looking to buy airtime, pay a bill, or check your balance, just let me know!\", 'intent_detected': 'greeting', 'entities_extracted': '{}', 'confidence_score': 0.95, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 13, 9, 28, 18, 465726), 'conversations_id': UUID('e41b9f81-2b28-400e-b07c-6b2be93007ef')}"}
{"asctime": "2025-11-13 11:28:18,471", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 11:28:19,490", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 11:28:19,490", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763024044: Success"}
{"asctime": "2025-11-13 11:28:20,581", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 11:28:20,583", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763024044: Success"}
{"asctime": "2025-11-13 11:28:21,258", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '915041d9-ea94-431b-a5c3-c18204847184', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763024044', 'wa_id': '27763024044'}], 'messages': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJERTIwOTNENzYzOEQwNDU4RDIA'}]}}"}
{"asctime": "2025-11-13 11:28:21,860", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '35cedae7-2f78-40eb-987b-56fda40160ee', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763024044', 'wa_id': '27763024044'}], 'messages': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI3RDVBNDc4NUIxNDgxRTk1M0UA'}]}}"}
{"asctime": "2025-11-13 11:28:22,117", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJERTIwOTNENzYzOEQwNDU4RDIA', 'status': 'sent', 'timestamp': '1763026101', 'recipient_id': '27763024044', 'conversation': {'id': '1155a6d6e622844ec503d58a02d948a1', 'expiration_timestamp': '1763026101', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:28:22,356", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJERTIwOTNENzYzOEQwNDU4RDIA', 'status': 'delivered', 'timestamp': '1763026101', 'recipient_id': '27763024044', 'conversation': {'id': '1155a6d6e622844ec503d58a02d948a1', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:28:22,643", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJERTIwOTNENzYzOEQwNDU4RDIA', 'status': 'read', 'timestamp': '1763026101', 'recipient_id': '27763024044', 'conversation': {'id': '1155a6d6e622844ec503d58a02d948a1', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:28:22,703", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI3RDVBNDc4NUIxNDgxRTk1M0UA', 'status': 'sent', 'timestamp': '1763026101', 'recipient_id': '27763024044', 'conversation': {'id': '72a10e4355520814cf7f569ce13b382e', 'expiration_timestamp': '1763026102', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:28:23,114", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI3RDVBNDc4NUIxNDgxRTk1M0UA', 'status': 'delivered', 'timestamp': '1763026102', 'recipient_id': '27763024044', 'conversation': {'id': '72a10e4355520814cf7f569ce13b382e', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:28:23,443", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI3RDVBNDc4NUIxNDgxRTk1M0UA', 'status': 'read', 'timestamp': '1763026102', 'recipient_id': '27763024044', 'conversation': {'id': '72a10e4355520814cf7f569ce13b382e', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:28:36,991", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World'}, 'wa_id': '27763024044'}], 'messages': [{'from': '27763024044', 'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQTNERjlFMTM2QUQzOTU5MTRCRgA=', 'timestamp': '1763026116', 'text': {'body': 'Buy 10 rand airtime for 0763420098'}, 'type': 'text'}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:28:36,992", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=text, media_id=none"}
{"asctime": "2025-11-13 11:28:36,993", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763024044"}
{"asctime": "2025-11-13 11:28:36,994", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 11:28:36,995", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 11:28:36,995", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 20.28s ago] {'phone_number_1': '+27763024044', 'param_1': 1}"}
{"asctime": "2025-11-13 11:28:37,000", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-13 11:28:37,001", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 20.28s ago] {'last_active_at': datetime.datetime(2025, 11, 13, 9, 28, 37, 407), 'users_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 11:28:37,002", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 11:28:37,007", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 11:28:37,008", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 11:28:37,008", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 20.28s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 11:28:37,010", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-13 11:28:37,010", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 20.28s ago] {'id': UUID('f146ad23-9f5a-45f2-bf10-960b7d4f3d3c'), 'user_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'phone_number': '+27763024044', 'message_id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQTNERjlFMTM2QUQzOTU5MTRCRgA=', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'Buy 10 rand airtime for 0763420098', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-13 11:28:37,011", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 11:28:37,012", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 11:28:37,013", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 11:28:37,013", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 20.28s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 11:28:37,015", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 11:28:37,015", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 20.28s ago] {'user_id_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'param_1': 5}"}
{"asctime": "2025-11-13 11:28:38,651", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 11:28:38,658", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 11:28:38,659", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 20.18s ago] {'pk_1': UUID('f146ad23-9f5a-45f2-bf10-960b7d4f3d3c')}"}
{"asctime": "2025-11-13 11:28:38,660", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-13 11:28:38,661", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 20.18s ago] {'ai_response': 'Just to confirm, you want to buy R10 airtime for the number 0763420098. \\n\\nPlease provide your PIN so I can proceed with the purchase! \ud83d\ude0a', 'intent_detected': 'buy_airtime', 'entities_extracted': '{\"amount\": 763420098.0, \"phone\": \"0763420098\", \"network\": null}', 'confidence_score': 0.9, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 13, 9, 28, 38, 656587), 'conversations_id': UUID('f146ad23-9f5a-45f2-bf10-960b7d4f3d3c')}"}
{"asctime": "2025-11-13 11:28:38,662", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 11:28:39,712", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 11:28:39,714", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763024044: Success"}
{"asctime": "2025-11-13 11:28:41,137", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '66eef79a-432b-4139-85cb-f3fcf5d7da8a', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763024044', 'wa_id': '27763024044'}], 'messages': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBIzNUQxODM5RURCQ0RCMDVFNEQA'}]}}"}
{"asctime": "2025-11-13 11:28:42,001", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBIzNUQxODM5RURCQ0RCMDVFNEQA', 'status': 'sent', 'timestamp': '1763026121', 'recipient_id': '27763024044', 'conversation': {'id': 'aa1bd27743ba4ee2bc26db8b27fce0f6', 'expiration_timestamp': '1763026121', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:28:42,254", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBIzNUQxODM5RURCQ0RCMDVFNEQA', 'status': 'delivered', 'timestamp': '1763026121', 'recipient_id': '27763024044', 'conversation': {'id': 'aa1bd27743ba4ee2bc26db8b27fce0f6', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:28:42,490", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBIzNUQxODM5RURCQ0RCMDVFNEQA', 'status': 'read', 'timestamp': '1763026121', 'recipient_id': '27763024044', 'conversation': {'id': 'aa1bd27743ba4ee2bc26db8b27fce0f6', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:29:03,219", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World'}, 'wa_id': '27763024044'}], 'messages': [{'from': '27763024044', 'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQTk0RDBEMTNBRjFEQzkyRUM5MAA=', 'timestamp': '1763026142', 'text': {'body': 'No'}, 'type': 'text'}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:29:03,224", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=text, media_id=none"}
{"asctime": "2025-11-13 11:29:03,226", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763024044"}
{"asctime": "2025-11-13 11:29:03,250", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 11:29:03,251", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 11:29:03,251", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 46.5s ago] {'phone_number_1': '+27763024044', 'param_1': 1}"}
{"asctime": "2025-11-13 11:29:03,254", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-13 11:29:03,254", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 46.5s ago] {'last_active_at': datetime.datetime(2025, 11, 13, 9, 29, 3, 254273), 'users_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 11:29:03,255", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 11:29:03,257", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 11:29:03,257", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 11:29:03,257", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 46.5s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 11:29:03,259", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-13 11:29:03,259", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 46.49s ago] {'id': UUID('559055c8-79d9-4c9a-af9d-0ec1c1ea2e4a'), 'user_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'phone_number': '+27763024044', 'message_id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQTk0RDBEMTNBRjFEQzkyRUM5MAA=', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'No', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-13 11:29:03,260", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 11:29:03,261", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 11:29:03,261", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 11:29:03,261", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 46.5s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 11:29:03,262", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 11:29:03,263", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 46.49s ago] {'user_id_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'param_1': 5}"}
{"asctime": "2025-11-13 11:29:04,844", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 11:29:04,881", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 11:29:04,882", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 46.38s ago] {'pk_1': UUID('559055c8-79d9-4c9a-af9d-0ec1c1ea2e4a')}"}
{"asctime": "2025-11-13 11:29:04,884", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-13 11:29:04,885", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 46.38s ago] {'ai_response': 'No problem! If you need anything else or have another request, just let me know! \ud83d\ude0a', 'intent_detected': 'conversation', 'entities_extracted': '{}', 'confidence_score': 0.7, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 13, 9, 29, 4, 879907), 'conversations_id': UUID('559055c8-79d9-4c9a-af9d-0ec1c1ea2e4a')}"}
{"asctime": "2025-11-13 11:29:04,887", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 11:29:05,926", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 11:29:05,928", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763024044: Success"}
{"asctime": "2025-11-13 11:29:07,405", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '497566f6-e885-4d6e-ac5e-361f9b822c0e', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763024044', 'wa_id': '27763024044'}], 'messages': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJFMUZCNzI3MzhBNjI2QjJDNjgA'}]}}"}
{"asctime": "2025-11-13 11:29:08,438", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJFMUZCNzI3MzhBNjI2QjJDNjgA', 'status': 'sent', 'timestamp': '1763026147', 'recipient_id': '27763024044', 'conversation': {'id': '097b4e60f88e818702fe03c3623e74b0', 'expiration_timestamp': '1763026147', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:29:08,860", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJFMUZCNzI3MzhBNjI2QjJDNjgA', 'status': 'delivered', 'timestamp': '1763026147', 'recipient_id': '27763024044', 'conversation': {'id': '097b4e60f88e818702fe03c3623e74b0', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:29:08,979", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJFMUZCNzI3MzhBNjI2QjJDNjgA', 'status': 'read', 'timestamp': '1763026148', 'recipient_id': '27763024044', 'conversation': {'id': '097b4e60f88e818702fe03c3623e74b0', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:29:09,670", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJFMUZCNzI3MzhBNjI2QjJDNjgA', 'status': 'delivered', 'timestamp': '1763026148', 'recipient_id': '27763024044', 'conversation': {'id': '097b4e60f88e818702fe03c3623e74b0', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:29:41,232", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World'}, 'wa_id': '27763024044'}], 'messages': [{'from': '27763024044', 'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQTA5RTBFQjdCMUUwOEE4N0IzNQA=', 'timestamp': '1763026179', 'type': 'image', 'image': {'caption': 'Send airtime', 'mime_type': 'image/jpeg', 'sha256': 'vQ2JpzifdCeEvacjS+YHnBQGsPC+9qbuHnJffYwdKx8=', 'id': '1306094191293238'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:29:41,233", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=image, media_id=1306094191293238"}
{"asctime": "2025-11-13 11:29:41,233", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing image message from +27763024044"}
{"asctime": "2025-11-13 11:29:41,234", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 11:29:41,234", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 11:29:41,234", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 84.48s ago] {'phone_number_1': '+27763024044', 'param_1': 1}"}
{"asctime": "2025-11-13 11:29:41,235", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-13 11:29:41,235", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 84.48s ago] {'last_active_at': datetime.datetime(2025, 11, 13, 9, 29, 41, 235575), 'users_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 11:29:41,236", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 11:29:41,236", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Fetching media URL for ID: 1306094191293238"}
{"asctime": "2025-11-13 11:29:41,236", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Media URL constructed: https://crm.cyraxtechnologies.com/api/meta/v19.0/1306094191293238"}
{"asctime": "2025-11-13 11:29:43,143", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: GET https://crm.cyraxtechnologies.com/api/meta/v19.0/1306094191293238 \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 11:29:43,227", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Media downloaded: media/wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQTA5RTBFQjdCMUUwOEE4N0IzNQA=.jpg"}
{"asctime": "2025-11-13 11:29:43,240", "name": "app.services.ai_service", "levelname": "INFO", "message": "Processing image: media/wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQTA5RTBFQjdCMUUwOEE4N0IzNQA=.jpg with caption: "}
{"asctime": "2025-11-13 11:29:49,751", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 11:29:49,755", "name": "app.services.ai_service", "levelname": "INFO", "message": "Image processed successfully: {\"type\": \"phone_number\", \"phone_number\": \"0761905479\", \"provider\": \"Unknown\", \"confidence\": 0.95, \"d..."}
{"asctime": "2025-11-13 11:29:50,836", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 11:29:50,837", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763024044: Success"}
{"asctime": "2025-11-13 11:29:50,839", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 11:29:50,839", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 11:29:50,840", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 94.07s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 11:29:50,842", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-13 11:29:50,842", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 94.07s ago] {'id': UUID('8d3543be-aa0b-4f82-ab40-bdd36277fc43'), 'user_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'phone_number': '+27763024044', 'message_id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQTA5RTBFQjdCMUUwOEE4N0IzNQA=', 'message_type': 'image', 'direction': 'inbound', 'message_text': 'buy airtime for 0761905479', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-13 11:29:50,843", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 11:29:50,844", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 11:29:50,844", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 11:29:50,844", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 94.08s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 11:29:50,846", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 11:29:50,846", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 94.07s ago] {'user_id_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'param_1': 5}"}
{"asctime": "2025-11-13 11:29:52,589", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '035d59da-15b9-4940-9ced-c7a858e30d55', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763024044', 'wa_id': '27763024044'}], 'messages': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBIxMzI1Nzg0NURDRDMwNzEwOTcA'}]}}"}
{"asctime": "2025-11-13 11:29:53,019", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 11:29:53,025", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 11:29:53,025", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 94.52s ago] {'pk_1': UUID('8d3543be-aa0b-4f82-ab40-bdd36277fc43')}"}
{"asctime": "2025-11-13 11:29:53,027", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-13 11:29:53,027", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 94.52s ago] {'ai_response': 'Got it! How much airtime would you like to buy for the number 0761905479? You can choose any amount from R5 to R1000. \ud83d\ude0a', 'intent_detected': 'buy_airtime', 'entities_extracted': '{\"amount\": 761905479.0, \"phone\": \"0761905479\", \"network\": null}', 'confidence_score': 0.9, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 13, 9, 29, 53, 23254), 'conversations_id': UUID('8d3543be-aa0b-4f82-ab40-bdd36277fc43')}"}
{"asctime": "2025-11-13 11:29:53,028", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 11:29:53,359", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBIxMzI1Nzg0NURDRDMwNzEwOTcA', 'status': 'sent', 'timestamp': '1763026192', 'recipient_id': '27763024044', 'conversation': {'id': '5762e53b23a41815c54faece4dd6543a', 'expiration_timestamp': '1763026192', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:29:53,538", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBIxMzI1Nzg0NURDRDMwNzEwOTcA', 'status': 'delivered', 'timestamp': '1763026192', 'recipient_id': '27763024044', 'conversation': {'id': '5762e53b23a41815c54faece4dd6543a', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:29:53,863", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBIxMzI1Nzg0NURDRDMwNzEwOTcA', 'status': 'read', 'timestamp': '1763026192', 'recipient_id': '27763024044', 'conversation': {'id': '5762e53b23a41815c54faece4dd6543a', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:29:54,172", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 11:29:54,174", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763024044: Success"}
{"asctime": "2025-11-13 11:29:55,510", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '3fac06d3-9073-40fd-9cef-31c12666b1be', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763024044', 'wa_id': '27763024044'}], 'messages': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJGMEM3NDQ3QUFFRTMzNkNGNjAA'}]}}"}
{"asctime": "2025-11-13 11:29:56,457", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJGMEM3NDQ3QUFFRTMzNkNGNjAA', 'status': 'sent', 'timestamp': '1763026195', 'recipient_id': '27763024044', 'conversation': {'id': '349c12fb938da918595f4c94cfb81307', 'expiration_timestamp': '1763026195', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:29:56,717", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJGMEM3NDQ3QUFFRTMzNkNGNjAA', 'status': 'delivered', 'timestamp': '1763026195', 'recipient_id': '27763024044', 'conversation': {'id': '349c12fb938da918595f4c94cfb81307', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:29:57,091", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJGMEM3NDQ3QUFFRTMzNkNGNjAA', 'status': 'delivered', 'timestamp': '1763026196', 'recipient_id': '27763024044', 'conversation': {'id': '349c12fb938da918595f4c94cfb81307', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:29:57,169", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJGMEM3NDQ3QUFFRTMzNkNGNjAA', 'status': 'read', 'timestamp': '1763026196', 'recipient_id': '27763024044', 'conversation': {'id': '349c12fb938da918595f4c94cfb81307', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:30:02,132", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World'}, 'wa_id': '27763024044'}], 'messages': [{'from': '27763024044', 'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQTk3QzZGQkIyQUY1NTQ5RjkzQgA=', 'timestamp': '1763026201', 'text': {'body': '10'}, 'type': 'text'}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:30:02,133", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=text, media_id=none"}
{"asctime": "2025-11-13 11:30:02,133", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763024044"}
{"asctime": "2025-11-13 11:30:02,135", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 11:30:02,135", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 11:30:02,135", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 105.4s ago] {'phone_number_1': '+27763024044', 'param_1': 1}"}
{"asctime": "2025-11-13 11:30:02,137", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-13 11:30:02,137", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 105.4s ago] {'last_active_at': datetime.datetime(2025, 11, 13, 9, 30, 2, 137098), 'users_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 11:30:02,138", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 11:30:02,140", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 11:30:02,140", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 11:30:02,140", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 105.4s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 11:30:02,142", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-13 11:30:02,142", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 105.4s ago] {'id': UUID('eb66488c-6935-4b04-9a79-bee068a32e5f'), 'user_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'phone_number': '+27763024044', 'message_id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQTk3QzZGQkIyQUY1NTQ5RjkzQgA=', 'message_type': 'text', 'direction': 'inbound', 'message_text': '10', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-13 11:30:02,143", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 11:30:02,144", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 11:30:02,144", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 11:30:02,144", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 105.4s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 11:30:02,146", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 11:30:02,146", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 105.4s ago] {'user_id_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'param_1': 5}"}
{"asctime": "2025-11-13 11:30:03,456", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 11:30:03,463", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 11:30:03,463", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 105s ago] {'pk_1': UUID('eb66488c-6935-4b04-9a79-bee068a32e5f')}"}
{"asctime": "2025-11-13 11:30:03,465", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-13 11:30:03,465", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 105s ago] {'ai_response': 'Just to confirm, you want to buy R10 airtime for the number 0761905479. \\n\\nPlease provide your PIN to proceed! \ud83d\ude0a', 'intent_detected': 'conversation', 'entities_extracted': '{}', 'confidence_score': 0.7, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 13, 9, 30, 3, 461376), 'conversations_id': UUID('eb66488c-6935-4b04-9a79-bee068a32e5f')}"}
{"asctime": "2025-11-13 11:30:03,466", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 11:30:04,541", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 11:30:04,543", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763024044: Success"}
{"asctime": "2025-11-13 11:30:06,094", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '1920922c-4139-418c-b6e4-4ea9de6a11b6', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763024044', 'wa_id': '27763024044'}], 'messages': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBIzOTFDMUE4MERDREM1OTdBRDQA'}]}}"}
{"asctime": "2025-11-13 11:30:06,954", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBIzOTFDMUE4MERDREM1OTdBRDQA', 'status': 'sent', 'timestamp': '1763026205', 'recipient_id': '27763024044', 'conversation': {'id': 'c75715049380b765cf848281b14fb5ad', 'expiration_timestamp': '1763026206', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:30:06,976", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBIzOTFDMUE4MERDREM1OTdBRDQA', 'status': 'delivered', 'timestamp': '1763026206', 'recipient_id': '27763024044', 'conversation': {'id': 'c75715049380b765cf848281b14fb5ad', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:30:07,470", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBIzOTFDMUE4MERDREM1OTdBRDQA', 'status': 'read', 'timestamp': '1763026206', 'recipient_id': '27763024044', 'conversation': {'id': 'c75715049380b765cf848281b14fb5ad', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:30:13,685", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World'}, 'wa_id': '27763024044'}], 'messages': [{'from': '27763024044', 'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQUU3MTcwQjY2Q0NDQzk5QzJGOQA=', 'timestamp': '1763026212', 'text': {'body': '5691'}, 'type': 'text'}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:30:13,686", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=text, media_id=none"}
{"asctime": "2025-11-13 11:30:13,686", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763024044"}
{"asctime": "2025-11-13 11:30:13,687", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 11:30:13,688", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 11:30:13,688", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 116.9s ago] {'phone_number_1': '+27763024044', 'param_1': 1}"}
{"asctime": "2025-11-13 11:30:13,690", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-13 11:30:13,690", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 116.9s ago] {'last_active_at': datetime.datetime(2025, 11, 13, 9, 30, 13, 689768), 'users_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 11:30:13,691", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 11:30:13,693", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 11:30:13,694", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 11:30:13,694", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 116.9s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 11:30:13,696", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-13 11:30:13,696", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 116.9s ago] {'id': UUID('e165c236-32bf-4322-8b7e-8de5cd60c9ef'), 'user_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'phone_number': '+27763024044', 'message_id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQUU3MTcwQjY2Q0NDQzk5QzJGOQA=', 'message_type': 'text', 'direction': 'inbound', 'message_text': '5691', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-13 11:30:13,698", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 11:30:13,699", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 11:30:13,699", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 11:30:13,699", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 116.9s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 11:30:13,701", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 11:30:13,701", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 116.9s ago] {'user_id_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'param_1': 5}"}
{"asctime": "2025-11-13 11:30:15,470", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 11:30:15,481", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 11:30:15,481", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 117s ago] {'pk_1': UUID('e165c236-32bf-4322-8b7e-8de5cd60c9ef')}"}
{"asctime": "2025-11-13 11:30:15,483", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-13 11:30:15,483", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 117s ago] {'ai_response': \"Thanks for providing the PIN! \\n\\nUnfortunately, your wallet balance is R0.00, so I can't process the airtime purchase. \\n\\nWould you like to check your wallet balance or do something else? \ud83d\ude0a\", 'intent_detected': 'conversation', 'entities_extracted': '{}', 'confidence_score': 0.7, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 13, 9, 30, 15, 479155), 'conversations_id': UUID('e165c236-32bf-4322-8b7e-8de5cd60c9ef')}"}
{"asctime": "2025-11-13 11:30:15,484", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 11:30:16,477", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 11:30:16,478", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763024044: Success"}
{"asctime": "2025-11-13 11:30:18,063", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '1ba3575e-aa86-441a-8c93-8e8c6deb6f2d', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763024044', 'wa_id': '27763024044'}], 'messages': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJGRjc4QjA5RTQyN0ZEOUVEMjYA'}]}}"}
{"asctime": "2025-11-13 11:30:18,902", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJGRjc4QjA5RTQyN0ZEOUVEMjYA', 'status': 'sent', 'timestamp': '1763026218', 'recipient_id': '27763024044', 'conversation': {'id': '2f5f153680b3a3816f0e8b5885555d57', 'expiration_timestamp': '1763026218', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:30:19,279", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJGRjc4QjA5RTQyN0ZEOUVEMjYA', 'status': 'delivered', 'timestamp': '1763026218', 'recipient_id': '27763024044', 'conversation': {'id': '2f5f153680b3a3816f0e8b5885555d57', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:30:19,789", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJGRjc4QjA5RTQyN0ZEOUVEMjYA', 'status': 'read', 'timestamp': '1763026218', 'recipient_id': '27763024044', 'conversation': {'id': '2f5f153680b3a3816f0e8b5885555d57', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:32:47,788", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World'}, 'wa_id': '27763024044'}], 'messages': [{'from': '27763024044', 'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQUJFMkQ2QjA1NTY4RTFGMEM2NQA=', 'timestamp': '1763026366', 'type': 'image', 'image': {'caption': 'Buy 10 rand airtime for this number', 'mime_type': 'image/jpeg', 'sha256': 'vQ2JpzifdCeEvacjS+YHnBQGsPC+9qbuHnJffYwdKx8=', 'id': '2320699821706687'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:32:47,789", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=image, media_id=2320699821706687"}
{"asctime": "2025-11-13 11:32:47,790", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing image message from +27763024044"}
{"asctime": "2025-11-13 11:32:47,794", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 11:32:47,797", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 11:32:47,798", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 271s ago] {'phone_number_1': '+27763024044', 'param_1': 1}"}
{"asctime": "2025-11-13 11:32:47,802", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-13 11:32:47,802", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 271s ago] {'last_active_at': datetime.datetime(2025, 11, 13, 9, 32, 47, 801851), 'users_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 11:32:47,803", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 11:32:47,804", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Fetching media URL for ID: 2320699821706687"}
{"asctime": "2025-11-13 11:32:47,805", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Media URL constructed: https://crm.cyraxtechnologies.com/api/meta/v19.0/2320699821706687"}
{"asctime": "2025-11-13 11:32:49,425", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: GET https://crm.cyraxtechnologies.com/api/meta/v19.0/2320699821706687 \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 11:32:49,516", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Media downloaded: media/wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQUJFMkQ2QjA1NTY4RTFGMEM2NQA=.jpg"}
{"asctime": "2025-11-13 11:32:49,534", "name": "app.services.ai_service", "levelname": "INFO", "message": "Processing image: media/wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQUJFMkQ2QjA1NTY4RTFGMEM2NQA=.jpg with caption: "}
{"asctime": "2025-11-13 11:32:52,888", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 11:32:52,892", "name": "app.services.ai_service", "levelname": "INFO", "message": "Image processed successfully: {\"type\": \"phone_number\", \"phone_number\": \"0761905479\", \"provider\": \"Unknown\", \"confidence\": 0.9, \"de..."}
{"asctime": "2025-11-13 11:32:54,005", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 11:32:54,007", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763024044: Success"}
{"asctime": "2025-11-13 11:32:54,010", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 11:32:54,011", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 11:32:54,011", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 277.2s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 11:32:54,014", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-13 11:32:54,014", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 277.2s ago] {'id': UUID('83147bd4-12cd-4ae9-b133-dc69a0d860ed'), 'user_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'phone_number': '+27763024044', 'message_id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQUJFMkQ2QjA1NTY4RTFGMEM2NQA=', 'message_type': 'image', 'direction': 'inbound', 'message_text': 'buy airtime for 0761905479', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-13 11:32:54,016", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 11:32:54,018", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 11:32:54,018", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 11:32:54,018", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 277.2s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-13 11:32:54,020", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 11:32:54,020", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 277.2s ago] {'user_id_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'param_1': 5}"}
{"asctime": "2025-11-13 11:32:55,639", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 11:32:55,660", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-13 11:32:55,660", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 277.1s ago] {'pk_1': UUID('83147bd4-12cd-4ae9-b133-dc69a0d860ed')}"}
{"asctime": "2025-11-13 11:32:55,662", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-13 11:32:55,662", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 277.1s ago] {'ai_response': \"I can help you buy airtime, but your wallet balance is currently R0.00. \\n\\nYou'll need to top up your wallet first. Would you like assistance with that? \ud83d\ude0a\", 'intent_detected': 'buy_airtime', 'entities_extracted': '{\"amount\": 761905479.0, \"phone\": \"0761905479\", \"network\": null}', 'confidence_score': 0.9, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 13, 9, 32, 55, 659447), 'conversations_id': UUID('83147bd4-12cd-4ae9-b133-dc69a0d860ed')}"}
{"asctime": "2025-11-13 11:32:55,662", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-13 11:32:55,684", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '8527698c-1931-4aac-842d-2ab19b4f4709', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763024044', 'wa_id': '27763024044'}], 'messages': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJFRUNGQzk5RjI1RDhCMDQ5MTIA'}]}}"}
{"asctime": "2025-11-13 11:32:56,531", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJFRUNGQzk5RjI1RDhCMDQ5MTIA', 'status': 'sent', 'timestamp': '1763026375', 'recipient_id': '27763024044', 'conversation': {'id': '2f3a46d849adafa391fc27f36eb99458', 'expiration_timestamp': '1763026375', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:32:56,615", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 11:32:56,617", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763024044: Success"}
{"asctime": "2025-11-13 11:32:56,841", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJFRUNGQzk5RjI1RDhCMDQ5MTIA', 'status': 'delivered', 'timestamp': '1763026375', 'recipient_id': '27763024044', 'conversation': {'id': '2f3a46d849adafa391fc27f36eb99458', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:32:57,670", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJFRUNGQzk5RjI1RDhCMDQ5MTIA', 'status': 'read', 'timestamp': '1763026376', 'recipient_id': '27763024044', 'conversation': {'id': '2f3a46d849adafa391fc27f36eb99458', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:32:58,097", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': 'd5e43618-4487-4c0b-9f1e-beb13580a855', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763024044', 'wa_id': '27763024044'}], 'messages': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI1NEU4OUEzQkY4MzJBN0UxRUMA'}]}}"}
{"asctime": "2025-11-13 11:32:58,891", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI1NEU4OUEzQkY4MzJBN0UxRUMA', 'status': 'sent', 'timestamp': '1763026378', 'recipient_id': '27763024044', 'conversation': {'id': '81e509ed0f18f17d5aff853600da0793', 'expiration_timestamp': '1763026378', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:32:59,321", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI1NEU4OUEzQkY4MzJBN0UxRUMA', 'status': 'delivered', 'timestamp': '1763026378', 'recipient_id': '27763024044', 'conversation': {'id': '81e509ed0f18f17d5aff853600da0793', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 11:32:59,698", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI1NEU4OUEzQkY4MzJBN0UxRUMA', 'status': 'read', 'timestamp': '1763026378', 'recipient_id': '27763024044', 'conversation': {'id': '81e509ed0f18f17d5aff853600da0793', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 14:46:36,452", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (Form): {'SmsMessageSid': 'SMe8392f8e86bc8665addb78ca8599ed5b', 'NumMedia': '0', 'ProfileName': 'Hello World', 'MessageType': 'text', 'SmsSid': 'SMe8392f8e86bc8665addb78ca8599ed5b', 'WaId': '27763024044', 'SmsStatus': 'received', 'Body': 'You need to upload and sign a public key to a phone number before you can send or publish a flow.', 'To': 'whatsapp:+14155238886', 'NumSegments': '1', 'ReferralNumMedia': '0', 'MessageSid': 'SMe8392f8e86bc8665addb78ca8599ed5b', 'AccountSid': 'AC6a10482bfc51f0846f64980cb7f1676e', 'ChannelMetadata': '{\"type\":\"whatsapp\",\"data\":{\"context\":{\"ProfileName\":\"Hello World\",\"WaId\":\"27763024044\"}}}', 'From': 'whatsapp:+27763024044', 'ApiVersion': '2010-04-01'}"}
{"asctime": "2025-11-13 14:53:48,758", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBJDMTlBQjk5OTg2MjY2QjQ4RDcA', 'status': 'sent', 'timestamp': '1763038427', 'recipient_id': '27763514028', 'biz_opaque_callback_data': 'Mjc3NjkwMzQ0OTEuMjc3NjM1MTQwMjg=', 'conversation': {'id': 'cb96f9030e5ddf3c4c42d1b72689ae7f', 'expiration_timestamp': '1763038427', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 14:53:49,846", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBJDMTlBQjk5OTg2MjY2QjQ4RDcA', 'status': 'delivered', 'timestamp': '1763038427', 'recipient_id': '27763514028', 'biz_opaque_callback_data': 'Mjc3NjkwMzQ0OTEuMjc3NjM1MTQwMjg=', 'conversation': {'id': 'cb96f9030e5ddf3c4c42d1b72689ae7f', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 14:53:55,920", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBJDMTlBQjk5OTg2MjY2QjQ4RDcA', 'status': 'read', 'timestamp': '1763038434', 'recipient_id': '27763514028', 'biz_opaque_callback_data': 'Mjc3NjkwMzQ0OTEuMjc3NjM1MTQwMjg=', 'conversation': {'id': 'cb96f9030e5ddf3c4c42d1b72689ae7f', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 14:54:03,674", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World!'}, 'wa_id': '27763514028'}], 'messages': [{'context': {'from': '27769034491', 'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBJDMTlBQjk5OTg2MjY2QjQ4RDcA'}, 'from': '27763514028', 'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgASGBQzQTBEQ0YxMTAwQjAyODExNDNCRgA=', 'timestamp': '1763038442', 'type': 'interactive', 'interactive': {'type': 'nfm_reply', 'nfm_reply': {'response_json': '{\"SCREEN_MQ\":{\"v\":\"0.1\"},\"flow_uid\":\"6913860b2cfe508e46e70a36\",\"flow_token\":\"7e0f3995-2716-4c26-b749-22a488e19d9c\"}', 'body': 'Sent', 'name': 'flow'}}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 14:54:03,674", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=interactive, media_id=none"}
{"asctime": "2025-11-13 14:54:03,675", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing interactive message from +27763514028"}
{"asctime": "2025-11-13 14:54:03,682", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 14:54:03,684", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 14:54:03,684", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 2979s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-13 14:54:04,763", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 14:54:04,765", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763514028: Success"}
{"asctime": "2025-11-13 14:54:04,766", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "ROLLBACK"}
{"asctime": "2025-11-13 14:54:06,547", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '2d6b9cca-fbf7-484d-ac9f-8065a329f812', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763514028', 'wa_id': '27763514028'}], 'messages': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI1NUJDQzk4NEVGOEU0MkNGOEUA'}]}}"}
{"asctime": "2025-11-13 14:54:07,755", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI1NUJDQzk4NEVGOEU0MkNGOEUA', 'status': 'sent', 'timestamp': '1763038446', 'recipient_id': '27763514028', 'conversation': {'id': '85ea86091592057d1320a674ecbee932', 'expiration_timestamp': '1763038446', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 14:54:08,475", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI1NUJDQzk4NEVGOEU0MkNGOEUA', 'status': 'delivered', 'timestamp': '1763038447', 'recipient_id': '27763514028', 'conversation': {'id': '85ea86091592057d1320a674ecbee932', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 14:54:11,615", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI1NUJDQzk4NEVGOEU0MkNGOEUA', 'status': 'read', 'timestamp': '1763038450', 'recipient_id': '27763514028', 'conversation': {'id': '85ea86091592057d1320a674ecbee932', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 14:55:24,062", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI3MzA0QTcwRTU1MURBNEI4N0YA', 'status': 'sent', 'timestamp': '1763038522', 'recipient_id': '27763514028', 'biz_opaque_callback_data': 'Mjc3NjkwMzQ0OTEuMjc3NjM1MTQwMjg=', 'conversation': {'id': 'a8790192e29107f38eeb78a982213306', 'expiration_timestamp': '1763038522', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 14:55:24,152", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI3MzA0QTcwRTU1MURBNEI4N0YA', 'status': 'delivered', 'timestamp': '1763038522', 'recipient_id': '27763514028', 'biz_opaque_callback_data': 'Mjc3NjkwMzQ0OTEuMjc3NjM1MTQwMjg=', 'conversation': {'id': 'a8790192e29107f38eeb78a982213306', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 14:55:24,183", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI3MzA0QTcwRTU1MURBNEI4N0YA', 'status': 'read', 'timestamp': '1763038522', 'recipient_id': '27763514028', 'biz_opaque_callback_data': 'Mjc3NjkwMzQ0OTEuMjc3NjM1MTQwMjg=', 'conversation': {'id': 'a8790192e29107f38eeb78a982213306', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 15:04:33,136", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World!'}, 'wa_id': '27763514028'}], 'messages': [{'context': {'from': '27769034491', 'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI1OEJEMTE3OEQ5NDQ5MTFEM0MA'}, 'from': '27763514028', 'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgASGBQzQUI3QzZFMTUzNDdDOTZEMjcyRQA=', 'timestamp': '1763039071', 'type': 'interactive', 'interactive': {'type': 'list_reply', 'list_reply': {'id': '69137edc1b9845c02d4adc39-2-list_2', 'title': '\ud83c\udfe0 Property Consulting', 'description': 'Get legal guidance on buying, selling, or investing in property.'}}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 15:04:33,138", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=interactive, media_id=none"}
{"asctime": "2025-11-13 15:04:33,138", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing interactive message from +27763514028"}
{"asctime": "2025-11-13 15:04:33,143", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-13 15:04:33,145", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-13 15:04:33,146", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 3608s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-13 15:04:34,222", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-13 15:04:34,223", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763514028: Success"}
{"asctime": "2025-11-13 15:04:34,224", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "ROLLBACK"}
{"asctime": "2025-11-13 15:04:35,684", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '3013435c-bb4d-416f-90bc-0f086b19b757', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763514028', 'wa_id': '27763514028'}], 'messages': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBJEOTZEMTRDNTBGQTlDMzE2OUYA'}]}}"}
{"asctime": "2025-11-13 15:04:36,913", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBJEOTZEMTRDNTBGQTlDMzE2OUYA', 'status': 'sent', 'timestamp': '1763039075', 'recipient_id': '27763514028', 'conversation': {'id': 'e2ea85059bbff0c152367bb0b3c74c24', 'expiration_timestamp': '1763039076', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 15:04:37,531", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBJEOTZEMTRDNTBGQTlDMzE2OUYA', 'status': 'delivered', 'timestamp': '1763039076', 'recipient_id': '27763514028', 'conversation': {'id': 'e2ea85059bbff0c152367bb0b3c74c24', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 15:04:37,923", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBJEOTZEMTRDNTBGQTlDMzE2OUYA', 'status': 'read', 'timestamp': '1763039076', 'recipient_id': '27763514028', 'conversation': {'id': 'e2ea85059bbff0c152367bb0b3c74c24', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-13 15:05:10,368", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-11-14 05:53:48,747", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-11-14 05:53:48,748", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-11-14 05:53:48,791", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-11-14 05:53:48,791", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 05:53:48,793", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-11-14 05:53:48,793", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 05:53:48,793", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-11-14 05:53:48,793", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 05:53:48,794", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 05:53:48,795", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 05:53:48,795", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00010s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 05:53:48,797", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 05:53:48,797", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002342s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 05:53:48,798", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 05:53:48,798", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002874s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 05:53:48,799", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 05:53:48,799", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00012s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 05:53:48,800", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 05:53:48,800", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0006909s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 05:53:48,800", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 05:53:48,800", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001137s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 05:53:48,801", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 05:53:48,801", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-11-14 05:53:48,801", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-11-14 05:53:48,801", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-11-14 05:54:05,556", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-11-14 05:54:06,103", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-11-14 05:54:06,103", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-11-14 05:54:06,123", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-11-14 05:54:06,124", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 05:54:06,124", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-11-14 05:54:06,124", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 05:54:06,124", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-11-14 05:54:06,125", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 05:54:06,125", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 05:54:06,126", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 05:54:06,126", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00009s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 05:54:06,128", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 05:54:06,128", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002176s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 05:54:06,129", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 05:54:06,129", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002741s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 05:54:06,130", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 05:54:06,130", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00008s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 05:54:06,130", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 05:54:06,130", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0006673s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 05:54:06,131", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 05:54:06,131", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001182s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 05:54:06,131", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 05:54:06,132", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-11-14 05:54:06,132", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-11-14 05:54:06,132", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-11-14 05:54:48,300", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-11-14 05:54:48,881", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-11-14 05:54:48,881", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-11-14 05:54:48,901", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-11-14 05:54:48,901", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 05:54:48,902", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-11-14 05:54:48,902", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 05:54:48,902", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-11-14 05:54:48,903", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 05:54:48,903", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 05:54:48,904", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 05:54:48,904", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00009s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 05:54:48,906", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 05:54:48,906", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002142s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 05:54:48,907", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 05:54:48,907", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002669s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 05:54:48,908", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 05:54:48,908", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00007s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 05:54:48,909", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 05:54:48,909", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001005s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 05:54:48,909", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 05:54:48,909", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001628s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 05:54:48,910", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 05:54:48,910", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-11-14 05:54:48,910", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-11-14 05:54:48,910", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-11-14 05:55:16,010", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World'}, 'wa_id': '27763024044'}], 'messages': [{'from': '27763024044', 'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQUI1MUJBOUNFNkI3MUI2NkJBMwA=', 'timestamp': '1763092512', 'text': {'body': 'Hi'}, 'type': 'text'}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 05:55:16,010", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=text, media_id=none"}
{"asctime": "2025-11-14 05:55:16,010", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763024044"}
{"asctime": "2025-11-14 05:55:16,020", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 05:55:16,024", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 05:55:16,025", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00046s] {'phone_number_1': '+27763024044', 'param_1': 1}"}
{"asctime": "2025-11-14 05:55:16,038", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-14 05:55:16,038", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00043s] {'last_active_at': datetime.datetime(2025, 11, 14, 3, 55, 16, 36238), 'users_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-14 05:55:16,053", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 05:55:16,055", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 05:55:16,055", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-14 05:55:16,055", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00014s] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-14 05:55:16,058", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-14 05:55:16,058", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00024s] {'id': UUID('82de57d6-98fd-4ba3-9ed0-fbd70fb94c03'), 'user_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'phone_number': '+27763024044', 'message_id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQUI1MUJBOUNFNkI3MUI2NkJBMwA=', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'Hi', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-14 05:55:16,063", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 05:55:16,067", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 05:55:16,067", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-14 05:55:16,068", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0125s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-14 05:55:16,073", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 05:55:16,075", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00201s] {'user_id_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'param_1': 5}"}
{"asctime": "2025-11-14 05:55:18,233", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 05:55:18,243", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-14 05:55:18,244", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00076s] {'pk_1': UUID('82de57d6-98fd-4ba3-9ed0-fbd70fb94c03')}"}
{"asctime": "2025-11-14 05:55:18,251", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-14 05:55:18,252", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00037s] {'ai_response': 'Hey there! How can I assist you today? \ud83d\ude0a', 'intent_detected': 'greeting', 'entities_extracted': '{}', 'confidence_score': 0.95, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 14, 3, 55, 18, 240495), 'conversations_id': UUID('82de57d6-98fd-4ba3-9ed0-fbd70fb94c03')}"}
{"asctime": "2025-11-14 05:55:18,256", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 05:55:18,937", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 05:55:18,939", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763024044: Success"}
{"asctime": "2025-11-14 05:55:19,630", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 05:55:19,632", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763024044: Success"}
{"asctime": "2025-11-14 05:55:21,106", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '08a5c162-2837-42c7-8dd3-63e9fe3fe478', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763024044', 'wa_id': '27763024044'}], 'messages': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI0RDA3QzJFRTNBNzQ3MjA5MjcA'}]}}"}
{"asctime": "2025-11-14 05:55:21,298", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '7c979a8a-fa34-4200-8908-38a1be65af8a', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763024044', 'wa_id': '27763024044'}], 'messages': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJGN0RBNkU3MEE5NURCNjFEQUYA'}]}}"}
{"asctime": "2025-11-14 05:55:21,885", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI0RDA3QzJFRTNBNzQ3MjA5MjcA', 'status': 'sent', 'timestamp': '1763092520', 'recipient_id': '27763024044', 'conversation': {'id': 'b39f953939e0c50ef4a6432436ae1113', 'expiration_timestamp': '1763092521', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 05:55:22,507", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJGN0RBNkU3MEE5NURCNjFEQUYA', 'status': 'sent', 'timestamp': '1763092521', 'recipient_id': '27763024044', 'conversation': {'id': '296d3fdc54a64a8497f52183de94ef7d', 'expiration_timestamp': '1763092521', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 05:55:22,764", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI0RDA3QzJFRTNBNzQ3MjA5MjcA', 'status': 'delivered', 'timestamp': '1763092521', 'recipient_id': '27763024044', 'conversation': {'id': 'b39f953939e0c50ef4a6432436ae1113', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 05:55:23,063", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJGN0RBNkU3MEE5NURCNjFEQUYA', 'status': 'delivered', 'timestamp': '1763092521', 'recipient_id': '27763024044', 'conversation': {'id': '296d3fdc54a64a8497f52183de94ef7d', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 05:55:23,504", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJGN0RBNkU3MEE5NURCNjFEQUYA', 'status': 'read', 'timestamp': '1763092522', 'recipient_id': '27763024044', 'conversation': {'id': '296d3fdc54a64a8497f52183de94ef7d', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 05:55:23,592", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI0RDA3QzJFRTNBNzQ3MjA5MjcA', 'status': 'read', 'timestamp': '1763092522', 'recipient_id': '27763024044', 'conversation': {'id': 'b39f953939e0c50ef4a6432436ae1113', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 05:55:23,760", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJGN0RBNkU3MEE5NURCNjFEQUYA', 'status': 'delivered', 'timestamp': '1763092522', 'recipient_id': '27763024044', 'conversation': {'id': '296d3fdc54a64a8497f52183de94ef7d', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 05:55:48,207", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World'}, 'wa_id': '27763024044'}], 'messages': [{'from': '27763024044', 'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQUQ3M0RGQUEzRDM3OEVEOEJBRQA=', 'timestamp': '1763092546', 'type': 'image', 'image': {'caption': 'Buy 10 rand airtime for this number', 'mime_type': 'image/jpeg', 'sha256': 'vQ2JpzifdCeEvacjS+YHnBQGsPC+9qbuHnJffYwdKx8=', 'id': '2028660147935788'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 05:55:48,209", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=image, media_id=2028660147935788"}
{"asctime": "2025-11-14 05:55:48,210", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing image message from +27763024044"}
{"asctime": "2025-11-14 05:55:48,216", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 05:55:48,217", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 05:55:48,218", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 32.19s ago] {'phone_number_1': '+27763024044', 'param_1': 1}"}
{"asctime": "2025-11-14 05:55:48,222", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-14 05:55:48,223", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 32.18s ago] {'last_active_at': datetime.datetime(2025, 11, 14, 3, 55, 48, 221759), 'users_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-14 05:55:48,225", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 05:55:48,225", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Fetching media URL for ID: 2028660147935788"}
{"asctime": "2025-11-14 05:55:48,225", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Media URL constructed: https://crm.cyraxtechnologies.com/api/meta/v19.0/2028660147935788"}
{"asctime": "2025-11-14 05:55:49,431", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: GET https://crm.cyraxtechnologies.com/api/meta/v19.0/2028660147935788 \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 05:55:49,474", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Media downloaded: media/wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQUQ3M0RGQUEzRDM3OEVEOEJBRQA=.jpg"}
{"asctime": "2025-11-14 05:55:49,493", "name": "app.services.ai_service", "levelname": "INFO", "message": "Processing image: media/wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQUQ3M0RGQUEzRDM3OEVEOEJBRQA=.jpg with caption: Buy 10 rand airtime for this number"}
{"asctime": "2025-11-14 05:55:52,251", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 05:55:52,256", "name": "app.services.ai_service", "levelname": "ERROR", "message": "Image processing error: 'NoneType' object is not subscriptable"}
{"asctime": "2025-11-14 05:55:52,906", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 05:55:52,908", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763024044: Success"}
{"asctime": "2025-11-14 05:55:54,449", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': 'b7e69aaa-9e87-43b5-ad6e-dc5fcc1c106a', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763024044', 'wa_id': '27763024044'}], 'messages': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJBN0JGNzA0MjBCRTMxMEY5QjgA'}]}}"}
{"asctime": "2025-11-14 05:55:55,424", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJBN0JGNzA0MjBCRTMxMEY5QjgA', 'status': 'sent', 'timestamp': '1763092554', 'recipient_id': '27763024044', 'conversation': {'id': '8673ce8875f828b7dcba00b63d1813fe', 'expiration_timestamp': '1763092554', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 05:55:55,701", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJBN0JGNzA0MjBCRTMxMEY5QjgA', 'status': 'delivered', 'timestamp': '1763092554', 'recipient_id': '27763024044', 'conversation': {'id': '8673ce8875f828b7dcba00b63d1813fe', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 05:55:56,496", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJBN0JGNzA0MjBCRTMxMEY5QjgA', 'status': 'read', 'timestamp': '1763092555', 'recipient_id': '27763024044', 'conversation': {'id': '8673ce8875f828b7dcba00b63d1813fe', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 05:57:14,837", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World'}, 'wa_id': '27763024044'}], 'messages': [{'from': '27763024044', 'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQUFCMkQxNzcwNkQyQjIyQTQ1MQA=', 'timestamp': '1763092632', 'type': 'image', 'image': {'caption': 'Buy 10 rand airtime for this number', 'mime_type': 'image/jpeg', 'sha256': 'vQ2JpzifdCeEvacjS+YHnBQGsPC+9qbuHnJffYwdKx8=', 'id': '1330803401694729'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 05:57:14,841", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=image, media_id=1330803401694729"}
{"asctime": "2025-11-14 05:57:14,841", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing image message from +27763024044"}
{"asctime": "2025-11-14 05:57:14,850", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 05:57:14,854", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 05:57:14,854", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 118.8s ago] {'phone_number_1': '+27763024044', 'param_1': 1}"}
{"asctime": "2025-11-14 05:57:14,867", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-14 05:57:14,867", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 118.8s ago] {'last_active_at': datetime.datetime(2025, 11, 14, 3, 57, 14, 860476), 'users_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-14 05:57:14,879", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 05:57:14,880", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Fetching media URL for ID: 1330803401694729"}
{"asctime": "2025-11-14 05:57:14,881", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Media URL constructed: https://crm.cyraxtechnologies.com/api/meta/v19.0/1330803401694729"}
{"asctime": "2025-11-14 05:57:16,076", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: GET https://crm.cyraxtechnologies.com/api/meta/v19.0/1330803401694729 \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 05:57:16,123", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Media downloaded: media/wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQUFCMkQxNzcwNkQyQjIyQTQ1MQA=.jpg"}
{"asctime": "2025-11-14 05:57:16,139", "name": "app.services.ai_service", "levelname": "INFO", "message": "Processing image: media/wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQUFCMkQxNzcwNkQyQjIyQTQ1MQA=.jpg with caption: Buy 10 rand airtime for this number"}
{"asctime": "2025-11-14 05:57:35,636", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 05:57:35,642", "name": "app.services.ai_service", "levelname": "INFO", "message": "Image processed successfully: {\"type\": \"phone_number\", \"phone_number\": \"0761905479\", \"provider\": \"Unknown\", \"amount\": \"R10\", \"inte..."}
{"asctime": "2025-11-14 05:57:36,352", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 05:57:36,353", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Buttons sent to 27763024044: Success"}
{"asctime": "2025-11-14 05:57:38,083", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '25952449-e355-43b1-8e25-2a42320d05c4', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763024044', 'wa_id': '27763024044'}], 'messages': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI4MjhGN0YwNEFEOUYxQzBDRjMA'}]}}"}
{"asctime": "2025-11-14 05:57:38,968", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI4MjhGN0YwNEFEOUYxQzBDRjMA', 'status': 'sent', 'timestamp': '1763092657', 'recipient_id': '27763024044', 'conversation': {'id': 'ec1664d5b724a7ef1fe73b1f9eee88b5', 'expiration_timestamp': '1763092657', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 05:57:39,200", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI4MjhGN0YwNEFEOUYxQzBDRjMA', 'status': 'delivered', 'timestamp': '1763092658', 'recipient_id': '27763024044', 'conversation': {'id': 'ec1664d5b724a7ef1fe73b1f9eee88b5', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 05:57:39,553", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI4MjhGN0YwNEFEOUYxQzBDRjMA', 'status': 'read', 'timestamp': '1763092658', 'recipient_id': '27763024044', 'conversation': {'id': 'ec1664d5b724a7ef1fe73b1f9eee88b5', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 05:58:04,897", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World'}, 'wa_id': '27763024044'}], 'messages': [{'context': {'from': '27769034491', 'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI4MjhGN0YwNEFEOUYxQzBDRjMA'}, 'from': '27763024044', 'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQTJGODE0Q0I5MTFCQzU1N0RDMQA=', 'timestamp': '1763092683', 'type': 'interactive', 'interactive': {'type': 'button_reply', 'button_reply': {'id': 'yes', 'title': '\u2705 Yes'}}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 05:58:04,899", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=interactive, media_id=none"}
{"asctime": "2025-11-14 05:58:04,899", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing interactive message from +27763024044"}
{"asctime": "2025-11-14 05:58:04,903", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 05:58:04,904", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 05:58:04,906", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 168.9s ago] {'phone_number_1': '+27763024044', 'param_1': 1}"}
{"asctime": "2025-11-14 05:58:04,909", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-14 05:58:04,909", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 168.9s ago] {'last_active_at': datetime.datetime(2025, 11, 14, 3, 58, 4, 908704), 'users_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-14 05:58:04,910", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 05:58:05,618", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 05:58:05,619", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763024044: Success"}
{"asctime": "2025-11-14 05:58:07,372", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '3484f6f9-65ef-4164-91df-b203b12ef629', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763024044', 'wa_id': '27763024044'}], 'messages': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI1MDI1Nzc2MEJBRkU2OENDNjMA'}]}}"}
{"asctime": "2025-11-14 05:58:08,285", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI1MDI1Nzc2MEJBRkU2OENDNjMA', 'status': 'sent', 'timestamp': '1763092687', 'recipient_id': '27763024044', 'conversation': {'id': 'ed442ccd25824a9b407736aabe1a5258', 'expiration_timestamp': '1763092687', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 05:58:08,576", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI1MDI1Nzc2MEJBRkU2OENDNjMA', 'status': 'delivered', 'timestamp': '1763092687', 'recipient_id': '27763024044', 'conversation': {'id': 'ed442ccd25824a9b407736aabe1a5258', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 05:58:08,707", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI1MDI1Nzc2MEJBRkU2OENDNjMA', 'status': 'read', 'timestamp': '1763092687', 'recipient_id': '27763024044', 'conversation': {'id': 'ed442ccd25824a9b407736aabe1a5258', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 05:58:19,835", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World'}, 'wa_id': '27763024044'}], 'messages': [{'from': '27763024044', 'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQUIxNjdENjREOUYwM0UzRjRFRQA=', 'timestamp': '1763092698', 'text': {'body': 'Yes'}, 'type': 'text'}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 05:58:19,837", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=text, media_id=none"}
{"asctime": "2025-11-14 05:58:19,837", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763024044"}
{"asctime": "2025-11-14 05:58:19,838", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 05:58:19,839", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 05:58:19,839", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 183.8s ago] {'phone_number_1': '+27763024044', 'param_1': 1}"}
{"asctime": "2025-11-14 05:58:19,840", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-14 05:58:19,841", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 183.8s ago] {'last_active_at': datetime.datetime(2025, 11, 14, 3, 58, 19, 840608), 'users_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-14 05:58:19,842", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 05:58:19,844", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 05:58:19,844", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-14 05:58:19,844", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 183.8s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-14 05:58:19,845", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-14 05:58:19,846", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 183.8s ago] {'id': UUID('8e27f0f4-e010-4b2b-a7d2-756a18498879'), 'user_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'phone_number': '+27763024044', 'message_id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQUIxNjdENjREOUYwM0UzRjRFRQA=', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'Yes', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-14 05:58:19,853", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 05:58:19,855", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 05:58:19,855", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-14 05:58:19,857", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 183.8s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-14 05:58:19,880", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 05:58:19,880", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 183.8s ago] {'user_id_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'param_1': 5}"}
{"asctime": "2025-11-14 05:58:22,723", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 05:58:22,730", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-14 05:58:22,731", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 184.5s ago] {'pk_1': UUID('8e27f0f4-e010-4b2b-a7d2-756a18498879')}"}
{"asctime": "2025-11-14 05:58:22,732", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-14 05:58:22,733", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 184.5s ago] {'ai_response': 'Great! What do you need help with? Buying airtime, data, or paying a bill? Just let me know! \ud83d\ude0a', 'intent_detected': 'conversation', 'entities_extracted': '{}', 'confidence_score': 0.7, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 14, 3, 58, 22, 728507), 'conversations_id': UUID('8e27f0f4-e010-4b2b-a7d2-756a18498879')}"}
{"asctime": "2025-11-14 05:58:22,734", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 05:58:23,541", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 05:58:23,543", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763024044: Success"}
{"asctime": "2025-11-14 05:58:25,081", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '8732592f-3a29-4e51-9b20-b9b0466c0326', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763024044', 'wa_id': '27763024044'}], 'messages': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJCOEJBNjQ4OUMxMDJEN0E1QTIA'}]}}"}
{"asctime": "2025-11-14 05:58:25,953", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJCOEJBNjQ4OUMxMDJEN0E1QTIA', 'status': 'sent', 'timestamp': '1763092704', 'recipient_id': '27763024044', 'conversation': {'id': 'e98843e51cded83c6a8b1f49f0a75205', 'expiration_timestamp': '1763092705', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 05:58:26,512", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJCOEJBNjQ4OUMxMDJEN0E1QTIA', 'status': 'delivered', 'timestamp': '1763092705', 'recipient_id': '27763024044', 'conversation': {'id': 'e98843e51cded83c6a8b1f49f0a75205', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 05:58:26,776", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJCOEJBNjQ4OUMxMDJEN0E1QTIA', 'status': 'read', 'timestamp': '1763092705', 'recipient_id': '27763024044', 'conversation': {'id': 'e98843e51cded83c6a8b1f49f0a75205', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 05:58:32,452", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World'}, 'wa_id': '27763024044'}], 'messages': [{'context': {'from': '27769034491', 'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI4MjhGN0YwNEFEOUYxQzBDRjMA'}, 'from': '27763024044', 'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQUNFMTZENENEOTFGRTAyOUVGNwA=', 'timestamp': '1763092711', 'type': 'interactive', 'interactive': {'type': 'button_reply', 'button_reply': {'id': 'no', 'title': '\u274c No'}}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 05:58:32,453", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=interactive, media_id=none"}
{"asctime": "2025-11-14 05:58:32,453", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing interactive message from +27763024044"}
{"asctime": "2025-11-14 05:58:32,454", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 05:58:32,455", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 05:58:32,455", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 196.4s ago] {'phone_number_1': '+27763024044', 'param_1': 1}"}
{"asctime": "2025-11-14 05:58:32,457", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-14 05:58:32,457", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 196.4s ago] {'last_active_at': datetime.datetime(2025, 11, 14, 3, 58, 32, 456863), 'users_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-14 05:58:32,458", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 05:58:33,163", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 05:58:33,165", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763024044: Success"}
{"asctime": "2025-11-14 05:58:34,804", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '94806e6f-3a62-43d0-af18-6a023b0c75cc', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763024044', 'wa_id': '27763024044'}], 'messages': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI2ODk1MDhBOEIyNUY2RkQ2NkEA'}]}}"}
{"asctime": "2025-11-14 05:58:36,129", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI2ODk1MDhBOEIyNUY2RkQ2NkEA', 'status': 'sent', 'timestamp': '1763092714', 'recipient_id': '27763024044', 'conversation': {'id': '6f788b8898008f92a9c5e480680b0cee', 'expiration_timestamp': '1763092714', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 05:58:36,356", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI2ODk1MDhBOEIyNUY2RkQ2NkEA', 'status': 'delivered', 'timestamp': '1763092715', 'recipient_id': '27763024044', 'conversation': {'id': '6f788b8898008f92a9c5e480680b0cee', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 05:58:37,000", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI2ODk1MDhBOEIyNUY2RkQ2NkEA', 'status': 'read', 'timestamp': '1763092715', 'recipient_id': '27763024044', 'conversation': {'id': '6f788b8898008f92a9c5e480680b0cee', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 05:59:07,130", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-11-14 05:59:07,948", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-11-14 05:59:07,948", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-11-14 05:59:07,966", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-11-14 05:59:07,967", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 05:59:07,967", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-11-14 05:59:07,967", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 05:59:07,968", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-11-14 05:59:07,968", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 05:59:07,968", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 05:59:07,969", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 05:59:07,969", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00009s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 05:59:07,971", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 05:59:07,971", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001877s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 05:59:07,971", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 05:59:07,971", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002404s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 05:59:07,972", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 05:59:07,972", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00010s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 05:59:07,973", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 05:59:07,973", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0008422s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 05:59:07,974", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 05:59:07,974", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001468s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 05:59:07,974", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 05:59:07,974", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-11-14 05:59:07,974", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-11-14 05:59:07,974", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-11-14 05:59:22,549", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World'}, 'wa_id': '27763024044'}], 'messages': [{'from': '27763024044', 'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQUFERDAxOEExNTBFNTg4REVFQQA=', 'timestamp': '1763092760', 'type': 'image', 'image': {'caption': 'Buy 10 rand airtime for this number', 'mime_type': 'image/jpeg', 'sha256': 'vQ2JpzifdCeEvacjS+YHnBQGsPC+9qbuHnJffYwdKx8=', 'id': '817094714276686'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 05:59:22,550", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=image, media_id=817094714276686"}
{"asctime": "2025-11-14 05:59:22,551", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing image message from +27763024044"}
{"asctime": "2025-11-14 05:59:22,561", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 05:59:22,565", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 05:59:22,566", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00056s] {'phone_number_1': '+27763024044', 'param_1': 1}"}
{"asctime": "2025-11-14 05:59:22,570", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-14 05:59:22,570", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00017s] {'last_active_at': datetime.datetime(2025, 11, 14, 3, 59, 22, 569364), 'users_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-14 05:59:22,571", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 05:59:22,572", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Fetching media URL for ID: 817094714276686"}
{"asctime": "2025-11-14 05:59:22,572", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Media URL constructed: https://crm.cyraxtechnologies.com/api/meta/v19.0/817094714276686"}
{"asctime": "2025-11-14 05:59:23,856", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: GET https://crm.cyraxtechnologies.com/api/meta/v19.0/817094714276686 \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 05:59:23,881", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Media downloaded: media/wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQUFERDAxOEExNTBFNTg4REVFQQA=.jpg"}
{"asctime": "2025-11-14 05:59:23,987", "name": "app.services.ai_service", "levelname": "INFO", "message": "Processing image: media/wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQUFERDAxOEExNTBFNTg4REVFQQA=.jpg with caption: Buy 10 rand airtime for this number"}
{"asctime": "2025-11-14 05:59:28,363", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 05:59:28,370", "name": "app.services.ai_service", "levelname": "INFO", "message": "Image processed successfully: {\"type\": \"phone_number\", \"phone_number\": \"+27761905479\", \"provider\": \"Unknown\", \"amount\": \"R10\", \"in..."}
{"asctime": "2025-11-14 05:59:29,040", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 05:59:29,041", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Buttons sent to 27763024044: Success"}
{"asctime": "2025-11-14 05:59:30,512", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '5421f529-ba8b-41ff-8a0b-1a8af84f0253', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763024044', 'wa_id': '27763024044'}], 'messages': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJDRTk4MjVGQTVGMDRDNjg2RDgA'}]}}"}
{"asctime": "2025-11-14 05:59:31,662", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJDRTk4MjVGQTVGMDRDNjg2RDgA', 'status': 'sent', 'timestamp': '1763092770', 'recipient_id': '27763024044', 'conversation': {'id': 'a3e23707e4d85846f5feaa7b6faedc11', 'expiration_timestamp': '1763092770', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 05:59:31,922", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJDRTk4MjVGQTVGMDRDNjg2RDgA', 'status': 'delivered', 'timestamp': '1763092770', 'recipient_id': '27763024044', 'conversation': {'id': 'a3e23707e4d85846f5feaa7b6faedc11', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 05:59:32,058", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJDRTk4MjVGQTVGMDRDNjg2RDgA', 'status': 'delivered', 'timestamp': '1763092771', 'recipient_id': '27763024044', 'conversation': {'id': 'a3e23707e4d85846f5feaa7b6faedc11', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 05:59:32,497", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJDRTk4MjVGQTVGMDRDNjg2RDgA', 'status': 'read', 'timestamp': '1763092771', 'recipient_id': '27763024044', 'conversation': {'id': 'a3e23707e4d85846f5feaa7b6faedc11', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 05:59:34,818", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World'}, 'wa_id': '27763024044'}], 'messages': [{'context': {'from': '27769034491', 'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJDRTk4MjVGQTVGMDRDNjg2RDgA'}, 'from': '27763024044', 'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQUZCRTc2MUQzMTEwQjBEQTRGNQA=', 'timestamp': '1763092773', 'type': 'interactive', 'interactive': {'type': 'button_reply', 'button_reply': {'id': 'yes', 'title': 'Yes'}}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 05:59:34,819", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=interactive, media_id=none"}
{"asctime": "2025-11-14 05:59:34,819", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing interactive message from +27763024044"}
{"asctime": "2025-11-14 05:59:34,821", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 05:59:34,822", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 05:59:34,822", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 12.26s ago] {'phone_number_1': '+27763024044', 'param_1': 1}"}
{"asctime": "2025-11-14 05:59:34,825", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-14 05:59:34,825", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 12.25s ago] {'last_active_at': datetime.datetime(2025, 11, 14, 3, 59, 34, 824394), 'users_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-14 05:59:34,826", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 05:59:35,428", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 05:59:35,430", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763024044: Success"}
{"asctime": "2025-11-14 05:59:37,112", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': 'b5069fe7-6c42-4d7b-a0bf-690a140d1ca3', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763024044', 'wa_id': '27763024044'}], 'messages': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBIzNzU3NTE0MjM1MDdEREM1NkYA'}]}}"}
{"asctime": "2025-11-14 05:59:38,193", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBIzNzU3NTE0MjM1MDdEREM1NkYA', 'status': 'sent', 'timestamp': '1763092777', 'recipient_id': '27763024044', 'conversation': {'id': '1ec15199681aa95e4e72367a2fa6b1f7', 'expiration_timestamp': '1763092777', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 05:59:38,429", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBIzNzU3NTE0MjM1MDdEREM1NkYA', 'status': 'delivered', 'timestamp': '1763092777', 'recipient_id': '27763024044', 'conversation': {'id': '1ec15199681aa95e4e72367a2fa6b1f7', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 05:59:38,739", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBIzNzU3NTE0MjM1MDdEREM1NkYA', 'status': 'read', 'timestamp': '1763092777', 'recipient_id': '27763024044', 'conversation': {'id': '1ec15199681aa95e4e72367a2fa6b1f7', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 05:59:47,435", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World'}, 'wa_id': '27763024044'}], 'messages': [{'from': '27763024044', 'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQTE0MDBBMTI4MjAzOTY1RjJBMAA=', 'timestamp': '1763092786', 'text': {'body': 'Yes'}, 'type': 'text'}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 05:59:47,436", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=text, media_id=none"}
{"asctime": "2025-11-14 05:59:47,437", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763024044"}
{"asctime": "2025-11-14 05:59:47,439", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 05:59:47,439", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 05:59:47,440", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 24.87s ago] {'phone_number_1': '+27763024044', 'param_1': 1}"}
{"asctime": "2025-11-14 05:59:47,444", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-14 05:59:47,444", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 24.87s ago] {'last_active_at': datetime.datetime(2025, 11, 14, 3, 59, 47, 443557), 'users_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-14 05:59:47,445", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 05:59:47,447", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 05:59:47,453", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-14 05:59:47,453", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00072s] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-14 05:59:47,460", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-14 05:59:47,461", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00048s] {'id': UUID('f222754a-45b0-4319-9f3d-7036ac64ac19'), 'user_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'phone_number': '+27763024044', 'message_id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQTE0MDBBMTI4MjAzOTY1RjJBMAA=', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'Yes', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-14 05:59:47,463", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 05:59:47,465", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 05:59:47,465", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-14 05:59:47,465", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.01246s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-14 05:59:47,467", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 05:59:47,468", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00021s] {'user_id_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'param_1': 5}"}
{"asctime": "2025-11-14 05:59:49,834", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 05:59:49,840", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-14 05:59:49,841", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00040s] {'pk_1': UUID('f222754a-45b0-4319-9f3d-7036ac64ac19')}"}
{"asctime": "2025-11-14 05:59:49,842", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-14 05:59:49,842", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00027s] {'ai_response': \"Could you please specify what you need help with? Just let me know if it's airtime, data, or something else! \ud83d\ude0a\", 'intent_detected': 'conversation', 'entities_extracted': '{}', 'confidence_score': 0.7, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 14, 3, 59, 49, 838779), 'conversations_id': UUID('f222754a-45b0-4319-9f3d-7036ac64ac19')}"}
{"asctime": "2025-11-14 05:59:49,843", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 05:59:50,930", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 05:59:50,932", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763024044: Success"}
{"asctime": "2025-11-14 05:59:52,482", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': 'bb057759-b8e8-47c2-a26e-fc58c70460f5', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763024044', 'wa_id': '27763024044'}], 'messages': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJFRDUxNTcyRTAzRjI5RjMzNzYA'}]}}"}
{"asctime": "2025-11-14 05:59:53,408", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJFRDUxNTcyRTAzRjI5RjMzNzYA', 'status': 'sent', 'timestamp': '1763092792', 'recipient_id': '27763024044', 'conversation': {'id': '288ce1aedcfb16d2d146f293f9c2a5c2', 'expiration_timestamp': '1763092792', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 05:59:53,807", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJFRDUxNTcyRTAzRjI5RjMzNzYA', 'status': 'delivered', 'timestamp': '1763092792', 'recipient_id': '27763024044', 'conversation': {'id': '288ce1aedcfb16d2d146f293f9c2a5c2', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 05:59:54,233", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJFRDUxNTcyRTAzRjI5RjMzNzYA', 'status': 'read', 'timestamp': '1763092793', 'recipient_id': '27763024044', 'conversation': {'id': '288ce1aedcfb16d2d146f293f9c2a5c2', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:00:09,978", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World'}, 'wa_id': '27763024044'}], 'messages': [{'from': '27763024044', 'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQUJCNzY1N0UwRTM1ODc2OEI0MwA=', 'timestamp': '1763092808', 'type': 'image', 'image': {'caption': 'Buy 10 rand airtime for this number', 'mime_type': 'image/jpeg', 'sha256': 'vQ2JpzifdCeEvacjS+YHnBQGsPC+9qbuHnJffYwdKx8=', 'id': '730265372754417'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:00:09,980", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=image, media_id=730265372754417"}
{"asctime": "2025-11-14 06:00:09,980", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing image message from +27763024044"}
{"asctime": "2025-11-14 06:00:09,984", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 06:00:09,985", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 06:00:09,985", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 47.42s ago] {'phone_number_1': '+27763024044', 'param_1': 1}"}
{"asctime": "2025-11-14 06:00:09,989", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-14 06:00:09,989", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 47.42s ago] {'last_active_at': datetime.datetime(2025, 11, 14, 4, 0, 9, 988155), 'users_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-14 06:00:09,990", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 06:00:09,997", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Fetching media URL for ID: 730265372754417"}
{"asctime": "2025-11-14 06:00:09,997", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Media URL constructed: https://crm.cyraxtechnologies.com/api/meta/v19.0/730265372754417"}
{"asctime": "2025-11-14 06:00:11,149", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: GET https://crm.cyraxtechnologies.com/api/meta/v19.0/730265372754417 \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 06:00:11,180", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Media downloaded: media/wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQUJCNzY1N0UwRTM1ODc2OEI0MwA=.jpg"}
{"asctime": "2025-11-14 06:00:11,195", "name": "app.services.ai_service", "levelname": "INFO", "message": "Processing image: media/wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQUJCNzY1N0UwRTM1ODc2OEI0MwA=.jpg with caption: Buy 10 rand airtime for this number"}
{"asctime": "2025-11-14 06:00:21,108", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 06:00:21,113", "name": "app.services.ai_service", "levelname": "INFO", "message": "Image processed successfully: {\"type\": \"phone_number\", \"phone_number\": \"0761905479\", \"provider\": \"Unknown\", \"amount\": \"R10\", \"inte..."}
{"asctime": "2025-11-14 06:00:21,766", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 06:00:21,767", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Buttons sent to 27763024044: Success"}
{"asctime": "2025-11-14 06:00:23,310", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '6852c4e2-cd76-4c5e-9010-c12187ee21cb', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763024044', 'wa_id': '27763024044'}], 'messages': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI2OEFBRDYwMjgxQUU2MjAyNzAA'}]}}"}
{"asctime": "2025-11-14 06:00:24,443", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI2OEFBRDYwMjgxQUU2MjAyNzAA', 'status': 'sent', 'timestamp': '1763092823', 'recipient_id': '27763024044', 'conversation': {'id': 'dc7c6f8f4257fb899aaf944c787f5e11', 'expiration_timestamp': '1763092823', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:00:25,589", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI2OEFBRDYwMjgxQUU2MjAyNzAA', 'status': 'delivered', 'timestamp': '1763092823', 'recipient_id': '27763024044', 'conversation': {'id': 'dc7c6f8f4257fb899aaf944c787f5e11', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:00:26,205", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI2OEFBRDYwMjgxQUU2MjAyNzAA', 'status': 'read', 'timestamp': '1763092824', 'recipient_id': '27763024044', 'conversation': {'id': 'dc7c6f8f4257fb899aaf944c787f5e11', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:00:32,156", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World'}, 'wa_id': '27763024044'}], 'messages': [{'from': '27763024044', 'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQTI4QjhCMzFFMDk5MzA4NjkxRgA=', 'timestamp': '1763092830', 'text': {'body': 'Yes'}, 'type': 'text'}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:00:32,157", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=text, media_id=none"}
{"asctime": "2025-11-14 06:00:32,157", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763024044"}
{"asctime": "2025-11-14 06:00:32,158", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 06:00:32,159", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 06:00:32,159", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 69.59s ago] {'phone_number_1': '+27763024044', 'param_1': 1}"}
{"asctime": "2025-11-14 06:00:32,160", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-14 06:00:32,160", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 69.59s ago] {'last_active_at': datetime.datetime(2025, 11, 14, 4, 0, 32, 160492), 'users_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-14 06:00:32,161", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 06:00:32,162", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 06:00:32,162", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-14 06:00:32,162", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 44.71s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-14 06:00:32,163", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-14 06:00:32,163", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 44.7s ago] {'id': UUID('da351240-3816-4829-a540-db00013b88dd'), 'user_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'phone_number': '+27763024044', 'message_id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQTI4QjhCMzFFMDk5MzA4NjkxRgA=', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'Yes', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-14 06:00:32,163", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 06:00:32,164", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 06:00:32,164", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-14 06:00:32,164", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 44.71s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-14 06:00:32,166", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 06:00:32,166", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 44.7s ago] {'user_id_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'param_1': 5}"}
{"asctime": "2025-11-14 06:00:33,818", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 06:00:33,836", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-14 06:00:33,837", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 44s ago] {'pk_1': UUID('da351240-3816-4829-a540-db00013b88dd')}"}
{"asctime": "2025-11-14 06:00:33,838", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-14 06:00:33,839", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 44s ago] {'ai_response': \"I see you're interested in something! Could you please tell me exactly what you need? Airtime, data, or paying a bill? Just let me know! \ud83d\ude0a\", 'intent_detected': 'conversation', 'entities_extracted': '{}', 'confidence_score': 0.7, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 14, 4, 0, 33, 834528), 'conversations_id': UUID('da351240-3816-4829-a540-db00013b88dd')}"}
{"asctime": "2025-11-14 06:00:33,840", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 06:00:34,614", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 06:00:34,615", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763024044: Success"}
{"asctime": "2025-11-14 06:00:35,937", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': 'ebc6dd78-7de3-4582-b6a8-958f91c05238', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763024044', 'wa_id': '27763024044'}], 'messages': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJFRjc4MkJFNDIxMDlGMjBCQkMA'}]}}"}
{"asctime": "2025-11-14 06:00:37,061", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJFRjc4MkJFNDIxMDlGMjBCQkMA', 'status': 'sent', 'timestamp': '1763092835', 'recipient_id': '27763024044', 'conversation': {'id': '692ad5b4b7a44ad09d81d0c2fee25a73', 'expiration_timestamp': '1763092836', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:00:37,345", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJFRjc4MkJFNDIxMDlGMjBCQkMA', 'status': 'delivered', 'timestamp': '1763092836', 'recipient_id': '27763024044', 'conversation': {'id': '692ad5b4b7a44ad09d81d0c2fee25a73', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:00:37,634", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJFRjc4MkJFNDIxMDlGMjBCQkMA', 'status': 'read', 'timestamp': '1763092836', 'recipient_id': '27763024044', 'conversation': {'id': '692ad5b4b7a44ad09d81d0c2fee25a73', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:00:43,191", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World'}, 'wa_id': '27763024044'}], 'messages': [{'context': {'from': '27769034491', 'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI2OEFBRDYwMjgxQUU2MjAyNzAA'}, 'from': '27763024044', 'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQTBBM0JERTNBRDNCODZGN0ZENAA=', 'timestamp': '1763092841', 'type': 'interactive', 'interactive': {'type': 'button_reply', 'button_reply': {'id': 'yes', 'title': 'Yes'}}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:00:43,192", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=interactive, media_id=none"}
{"asctime": "2025-11-14 06:00:43,192", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing interactive message from +27763024044"}
{"asctime": "2025-11-14 06:00:43,193", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 06:00:43,194", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 06:00:43,194", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 80.63s ago] {'phone_number_1': '+27763024044', 'param_1': 1}"}
{"asctime": "2025-11-14 06:00:43,196", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-14 06:00:43,196", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 80.63s ago] {'last_active_at': datetime.datetime(2025, 11, 14, 4, 0, 43, 195736), 'users_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-14 06:00:43,197", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 06:00:43,817", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 06:00:43,818", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763024044: Success"}
{"asctime": "2025-11-14 06:00:45,324", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '540898d9-ec31-4f9c-a577-e4d3ef40685a', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763024044', 'wa_id': '27763024044'}], 'messages': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI1OTM5RUNFOUREODc2MjAyNTgA'}]}}"}
{"asctime": "2025-11-14 06:00:46,424", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI1OTM5RUNFOUREODc2MjAyNTgA', 'status': 'sent', 'timestamp': '1763092845', 'recipient_id': '27763024044', 'conversation': {'id': '5e6dc2af49436eed0fcee22f2b8ac767', 'expiration_timestamp': '1763092845', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:00:46,619", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI1OTM5RUNFOUREODc2MjAyNTgA', 'status': 'delivered', 'timestamp': '1763092845', 'recipient_id': '27763024044', 'conversation': {'id': '5e6dc2af49436eed0fcee22f2b8ac767', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:00:46,881", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI1OTM5RUNFOUREODc2MjAyNTgA', 'status': 'read', 'timestamp': '1763092845', 'recipient_id': '27763024044', 'conversation': {'id': '5e6dc2af49436eed0fcee22f2b8ac767', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:05:53,005", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-11-14 06:05:53,583", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-11-14 06:05:53,583", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-11-14 06:05:53,603", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-11-14 06:05:53,603", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 06:05:53,604", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-11-14 06:05:53,604", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 06:05:53,604", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-11-14 06:05:53,604", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 06:05:53,605", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 06:05:53,606", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 06:05:53,606", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00010s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 06:05:53,608", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 06:05:53,608", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002277s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 06:05:53,608", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 06:05:53,608", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.00267s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 06:05:53,609", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 06:05:53,610", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00068s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 06:05:53,611", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 06:05:53,611", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001706s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 06:05:53,612", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 06:05:53,612", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002479s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 06:05:53,612", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 06:05:53,612", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-11-14 06:05:53,612", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-11-14 06:05:53,612", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-11-14 06:06:06,733", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-11-14 06:06:07,535", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-11-14 06:06:07,535", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-11-14 06:06:07,563", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-11-14 06:06:07,563", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 06:06:07,564", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-11-14 06:06:07,564", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 06:06:07,564", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-11-14 06:06:07,564", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 06:06:07,565", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 06:06:07,566", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 06:06:07,566", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00011s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 06:06:07,567", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 06:06:07,567", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001135s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 06:06:07,567", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 06:06:07,568", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001663s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 06:06:07,568", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 06:06:07,568", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00007s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 06:06:07,569", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 06:06:07,569", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0006377s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 06:06:07,569", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 06:06:07,570", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001222s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 06:06:07,570", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 06:06:07,570", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-11-14 06:06:07,570", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-11-14 06:06:07,570", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-11-14 06:06:21,841", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World'}, 'wa_id': '27763024044'}], 'messages': [{'from': '27763024044', 'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQTlBNTQxQkFFNTAyMzg2OUJDMwA=', 'timestamp': '1763093179', 'type': 'image', 'image': {'caption': 'Send 10 rand airtime to this number', 'mime_type': 'image/jpeg', 'sha256': 'vQ2JpzifdCeEvacjS+YHnBQGsPC+9qbuHnJffYwdKx8=', 'id': '4172545189679604'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:06:21,842", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=image, media_id=4172545189679604"}
{"asctime": "2025-11-14 06:06:21,842", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing image message from +27763024044"}
{"asctime": "2025-11-14 06:06:21,851", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 06:06:21,855", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 06:06:21,855", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00035s] {'phone_number_1': '+27763024044', 'param_1': 1}"}
{"asctime": "2025-11-14 06:06:21,860", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-14 06:06:21,860", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00018s] {'last_active_at': datetime.datetime(2025, 11, 14, 4, 6, 21, 858959), 'users_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-14 06:06:21,864", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 06:06:21,866", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Fetching media URL for ID: 4172545189679604"}
{"asctime": "2025-11-14 06:06:21,866", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Media URL constructed: https://crm.cyraxtechnologies.com/api/meta/v19.0/4172545189679604"}
{"asctime": "2025-11-14 06:06:23,292", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: GET https://crm.cyraxtechnologies.com/api/meta/v19.0/4172545189679604 \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 06:06:23,330", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Media downloaded: media/wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQTlBNTQxQkFFNTAyMzg2OUJDMwA=.jpg"}
{"asctime": "2025-11-14 06:06:23,440", "name": "app.services.ai_service", "levelname": "INFO", "message": "Processing image: media/wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQTlBNTQxQkFFNTAyMzg2OUJDMwA=.jpg with caption: Send 10 rand airtime to this number"}
{"asctime": "2025-11-14 06:06:26,792", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 06:06:26,799", "name": "app.services.ai_service", "levelname": "INFO", "message": "Image processed successfully: {\"type\": \"phone_number\", \"phone_number\": \"0761905479\", \"provider\": \"Unknown\", \"amount\": \"R10\", \"inte..."}
{"asctime": "2025-11-14 06:06:27,411", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 06:06:27,412", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Buttons sent to 27763024044: Success"}
{"asctime": "2025-11-14 06:06:29,084", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '5154872a-6b5f-4e38-a8b8-e654293d5775', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763024044', 'wa_id': '27763024044'}], 'messages': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI3OTRCRjA1REEwMDY2NDkxNTIA'}]}}"}
{"asctime": "2025-11-14 06:06:29,998", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI3OTRCRjA1REEwMDY2NDkxNTIA', 'status': 'sent', 'timestamp': '1763093189', 'recipient_id': '27763024044', 'conversation': {'id': '7ca8acbe33f1f5509de66eb08492dc8a', 'expiration_timestamp': '1763093189', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:06:30,342", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI3OTRCRjA1REEwMDY2NDkxNTIA', 'status': 'delivered', 'timestamp': '1763093189', 'recipient_id': '27763024044', 'conversation': {'id': '7ca8acbe33f1f5509de66eb08492dc8a', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:06:30,908", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI3OTRCRjA1REEwMDY2NDkxNTIA', 'status': 'read', 'timestamp': '1763093189', 'recipient_id': '27763024044', 'conversation': {'id': '7ca8acbe33f1f5509de66eb08492dc8a', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:06:38,140", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World'}, 'wa_id': '27763024044'}], 'messages': [{'context': {'from': '27769034491', 'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI3OTRCRjA1REEwMDY2NDkxNTIA'}, 'from': '27763024044', 'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQUQ3RDQ2RUI4QTAyQ0ZGQzY4QwA=', 'timestamp': '1763093196', 'type': 'interactive', 'interactive': {'type': 'button_reply', 'button_reply': {'id': 'yes', 'title': '\u2705 Yes'}}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:06:38,141", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Button clicked: yes"}
{"asctime": "2025-11-14 06:06:38,141", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=interactive, media_id=none"}
{"asctime": "2025-11-14 06:06:38,141", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763024044"}
{"asctime": "2025-11-14 06:06:38,144", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 06:06:38,144", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 06:06:38,145", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 16.29s ago] {'phone_number_1': '+27763024044', 'param_1': 1}"}
{"asctime": "2025-11-14 06:06:38,150", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-14 06:06:38,150", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 16.29s ago] {'last_active_at': datetime.datetime(2025, 11, 14, 4, 6, 38, 147205), 'users_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-14 06:06:38,151", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 06:06:38,800", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 06:06:38,801", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763024044: Success"}
{"asctime": "2025-11-14 06:06:40,261", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '2e93c660-05d1-47a3-a074-11e72a3f7bb4', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763024044', 'wa_id': '27763024044'}], 'messages': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJBRjNERDlFOTExMkJBRTQ2NkYA'}]}}"}
{"asctime": "2025-11-14 06:06:41,417", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJBRjNERDlFOTExMkJBRTQ2NkYA', 'status': 'sent', 'timestamp': '1763093200', 'recipient_id': '27763024044', 'conversation': {'id': 'b6a27a65d790f0d8e6922dee65d4ae6b', 'expiration_timestamp': '1763093200', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:06:41,642", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJBRjNERDlFOTExMkJBRTQ2NkYA', 'status': 'delivered', 'timestamp': '1763093200', 'recipient_id': '27763024044', 'conversation': {'id': 'b6a27a65d790f0d8e6922dee65d4ae6b', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:06:42,235", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJBRjNERDlFOTExMkJBRTQ2NkYA', 'status': 'read', 'timestamp': '1763093200', 'recipient_id': '27763024044', 'conversation': {'id': 'b6a27a65d790f0d8e6922dee65d4ae6b', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:06:52,555", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World'}, 'wa_id': '27763024044'}], 'messages': [{'from': '27763024044', 'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQTQxNDg0Mjg5NzVEQjgzRDBFQgA=', 'timestamp': '1763093211', 'text': {'body': 'Ok'}, 'type': 'text'}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:06:52,555", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=text, media_id=none"}
{"asctime": "2025-11-14 06:06:52,555", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763024044"}
{"asctime": "2025-11-14 06:06:52,556", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 06:06:52,556", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 06:06:52,556", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 30.7s ago] {'phone_number_1': '+27763024044', 'param_1': 1}"}
{"asctime": "2025-11-14 06:06:52,560", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-14 06:06:52,561", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 30.7s ago] {'last_active_at': datetime.datetime(2025, 11, 14, 4, 6, 52, 560573), 'users_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-14 06:06:52,562", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 06:06:52,563", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 06:06:52,564", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-14 06:06:52,565", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00025s] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-14 06:06:52,570", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-14 06:06:52,570", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00042s] {'id': UUID('f4e8956b-e294-4201-8019-91ee8c8160e0'), 'user_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'phone_number': '+27763024044', 'message_id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQTQxNDg0Mjg5NzVEQjgzRDBFQgA=', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'Ok', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-14 06:06:52,571", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 06:06:52,573", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 06:06:52,573", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-14 06:06:52,573", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.009071s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-14 06:06:52,577", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 06:06:52,577", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00039s] {'user_id_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'param_1': 5}"}
{"asctime": "2025-11-14 06:06:54,067", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 06:06:54,086", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-14 06:06:54,087", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00047s] {'pk_1': UUID('f4e8956b-e294-4201-8019-91ee8c8160e0')}"}
{"asctime": "2025-11-14 06:06:54,089", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-14 06:06:54,089", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00024s] {'ai_response': 'Awesome! What would you like to do? Buy airtime, data, or pay for electricity? Let me know! \ud83d\ude0a', 'intent_detected': 'conversation', 'entities_extracted': '{}', 'confidence_score': 0.7, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 14, 4, 6, 54, 84957), 'conversations_id': UUID('f4e8956b-e294-4201-8019-91ee8c8160e0')}"}
{"asctime": "2025-11-14 06:06:54,090", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 06:06:54,829", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 06:06:54,831", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763024044: Success"}
{"asctime": "2025-11-14 06:06:56,267", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': 'deb4399a-7e8b-4840-bc16-99ad2ca0d2ff', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763024044', 'wa_id': '27763024044'}], 'messages': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBIzMDVGNERERjU5NzMxMjhGNzUA'}]}}"}
{"asctime": "2025-11-14 06:06:57,617", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBIzMDVGNERERjU5NzMxMjhGNzUA', 'status': 'sent', 'timestamp': '1763093216', 'recipient_id': '27763024044', 'conversation': {'id': '69aac56d427b8f0394b3437a697c639b', 'expiration_timestamp': '1763093216', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:06:57,669", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBIzMDVGNERERjU5NzMxMjhGNzUA', 'status': 'delivered', 'timestamp': '1763093216', 'recipient_id': '27763024044', 'conversation': {'id': '69aac56d427b8f0394b3437a697c639b', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:06:58,154", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBIzMDVGNERERjU5NzMxMjhGNzUA', 'status': 'read', 'timestamp': '1763093217', 'recipient_id': '27763024044', 'conversation': {'id': '69aac56d427b8f0394b3437a697c639b', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:07:11,383", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World'}, 'wa_id': '27763024044'}], 'messages': [{'from': '27763024044', 'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQTA0MDVGMjRGNUZBNEMxOEE5QQA=', 'timestamp': '1763093229', 'type': 'image', 'image': {'caption': 'Buy electricity for this meter', 'mime_type': 'image/jpeg', 'sha256': 'dHdXhiG4Pw8kT3NHBKtI3JkM68+WXZmimqbK9bbQG68=', 'id': '1380838166866730'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:07:11,385", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=image, media_id=1380838166866730"}
{"asctime": "2025-11-14 06:07:11,385", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing image message from +27763024044"}
{"asctime": "2025-11-14 06:07:11,386", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 06:07:11,386", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 06:07:11,386", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 49.53s ago] {'phone_number_1': '+27763024044', 'param_1': 1}"}
{"asctime": "2025-11-14 06:07:11,387", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-14 06:07:11,388", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 49.53s ago] {'last_active_at': datetime.datetime(2025, 11, 14, 4, 7, 11, 387714), 'users_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-14 06:07:11,388", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 06:07:11,389", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Fetching media URL for ID: 1380838166866730"}
{"asctime": "2025-11-14 06:07:11,389", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Media URL constructed: https://crm.cyraxtechnologies.com/api/meta/v19.0/1380838166866730"}
{"asctime": "2025-11-14 06:07:12,715", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: GET https://crm.cyraxtechnologies.com/api/meta/v19.0/1380838166866730 \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 06:07:12,824", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Media downloaded: media/wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQTA0MDVGMjRGNUZBNEMxOEE5QQA=.jpg"}
{"asctime": "2025-11-14 06:07:12,840", "name": "app.services.ai_service", "levelname": "INFO", "message": "Processing image: media/wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQTA0MDVGMjRGNUZBNEMxOEE5QQA=.jpg with caption: Buy electricity for this meter"}
{"asctime": "2025-11-14 06:07:16,742", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 06:07:16,747", "name": "app.services.ai_service", "levelname": "INFO", "message": "Image processed successfully: ```json\n{\"type\": \"meter_number\", \"meter_number\": \"6009223606178\", \"provider\": \"Unknown\", \"amount\": \"..."}
{"asctime": "2025-11-14 06:07:17,372", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 06:07:17,374", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763024044: Success"}
{"asctime": "2025-11-14 06:07:17,375", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 06:07:17,376", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-14 06:07:17,376", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 24.81s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-14 06:07:17,377", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-14 06:07:17,377", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 24.81s ago] {'id': UUID('4f72819e-ac6e-47fa-a868-4badddea0a67'), 'user_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'phone_number': '+27763024044', 'message_id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQTA0MDVGMjRGNUZBNEMxOEE5QQA=', 'message_type': 'image', 'direction': 'inbound', 'message_text': 'buy electricity for meter 6009223606178', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-14 06:07:17,378", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 06:07:17,379", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 06:07:17,379", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-14 06:07:17,379", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 24.82s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-14 06:07:17,380", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 06:07:17,381", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 24.8s ago] {'user_id_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'param_1': 5}"}
{"asctime": "2025-11-14 06:07:18,991", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': 'f5ecc1b4-21b6-4d24-be7e-90789af9bfdc', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763024044', 'wa_id': '27763024044'}], 'messages': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBIzOUNBMEU5MDRFNDgxOTM4ODMA'}]}}"}
{"asctime": "2025-11-14 06:07:19,116", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 06:07:19,120", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-14 06:07:19,121", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 25.03s ago] {'pk_1': UUID('4f72819e-ac6e-47fa-a868-4badddea0a67')}"}
{"asctime": "2025-11-14 06:07:19,122", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-14 06:07:19,123", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 25.03s ago] {'ai_response': 'I can help you with that! However, please note that your wallet balance is currently R0.00. You\u2019ll need to top up your balance first to buy electricity.\\n\\nWould you like to buy some airtime or data to add to your wallet? Let me know! \ud83d\ude0a', 'intent_detected': 'buy_electricity', 'entities_extracted': '{\"amount\": 6009223606178.0, \"meter_number\": null}', 'confidence_score': 0.9, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 14, 4, 7, 19, 118915), 'conversations_id': UUID('4f72819e-ac6e-47fa-a868-4badddea0a67')}"}
{"asctime": "2025-11-14 06:07:19,124", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 06:07:19,767", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 06:07:19,768", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763024044: Success"}
{"asctime": "2025-11-14 06:07:20,226", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBIzOUNBMEU5MDRFNDgxOTM4ODMA', 'status': 'sent', 'timestamp': '1763093239', 'recipient_id': '27763024044', 'conversation': {'id': 'cf67b5aa6459c82838647443db9b517a', 'expiration_timestamp': '1763093239', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:07:20,448", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBIzOUNBMEU5MDRFNDgxOTM4ODMA', 'status': 'delivered', 'timestamp': '1763093239', 'recipient_id': '27763024044', 'conversation': {'id': 'cf67b5aa6459c82838647443db9b517a', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:07:20,768", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBIzOUNBMEU5MDRFNDgxOTM4ODMA', 'status': 'read', 'timestamp': '1763093239', 'recipient_id': '27763024044', 'conversation': {'id': 'cf67b5aa6459c82838647443db9b517a', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:07:21,304", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': 'a92d829a-2f10-4f0c-bd36-b2233033c651', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763024044', 'wa_id': '27763024044'}], 'messages': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI3NDRGNTVFM0RBNEE0RDBFRDcA'}]}}"}
{"asctime": "2025-11-14 06:07:22,583", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI3NDRGNTVFM0RBNEE0RDBFRDcA', 'status': 'sent', 'timestamp': '1763093241', 'recipient_id': '27763024044', 'conversation': {'id': '4ba279adcca0bb664599fb98d83009c6', 'expiration_timestamp': '1763093241', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:07:22,859", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI3NDRGNTVFM0RBNEE0RDBFRDcA', 'status': 'delivered', 'timestamp': '1763093241', 'recipient_id': '27763024044', 'conversation': {'id': '4ba279adcca0bb664599fb98d83009c6', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:07:23,258", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI3NDRGNTVFM0RBNEE0RDBFRDcA', 'status': 'read', 'timestamp': '1763093242', 'recipient_id': '27763024044', 'conversation': {'id': '4ba279adcca0bb664599fb98d83009c6', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:33:01,124", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-11-14 06:33:01,706", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-11-14 06:33:01,706", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-11-14 06:33:01,797", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-11-14 06:33:01,797", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 06:33:01,797", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-11-14 06:33:01,797", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 06:33:01,798", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-11-14 06:33:01,798", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 06:33:01,798", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 06:33:01,800", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 06:33:01,800", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00015s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 06:33:01,801", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 06:33:01,801", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.00145s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 06:33:01,801", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 06:33:01,801", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001807s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 06:33:01,803", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 06:33:01,803", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00016s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 06:33:01,803", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 06:33:01,803", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0008574s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 06:33:01,804", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 06:33:01,804", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001442s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 06:33:01,804", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 06:33:01,804", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-11-14 06:33:01,804", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-11-14 06:33:01,804", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-11-14 06:33:18,815", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-11-14 06:33:19,359", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-11-14 06:33:19,359", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-11-14 06:33:19,376", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-11-14 06:33:19,376", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 06:33:19,376", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-11-14 06:33:19,376", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 06:33:19,377", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-11-14 06:33:19,377", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 06:33:19,377", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 06:33:19,378", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 06:33:19,378", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00012s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 06:33:19,380", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 06:33:19,380", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.00183s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 06:33:19,380", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 06:33:19,380", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002364s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 06:33:19,381", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 06:33:19,381", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00009s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 06:33:19,382", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 06:33:19,382", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.00055s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 06:33:19,382", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 06:33:19,382", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0009388s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 06:33:19,383", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 06:33:19,383", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-11-14 06:33:19,383", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-11-14 06:33:19,383", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-11-14 06:33:30,053", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World'}, 'wa_id': '27763024044'}], 'messages': [{'from': '27763024044', 'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQTVBNzA3ODQzNzg1MjIxNDMxMQA=', 'timestamp': '1763094808', 'text': {'body': 'Hi'}, 'type': 'text'}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:33:30,054", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=text, media_id=none"}
{"asctime": "2025-11-14 06:33:30,054", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763024044"}
{"asctime": "2025-11-14 06:33:30,061", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 06:33:30,065", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 06:33:30,065", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00033s] {'phone_number_1': '+27763024044', 'param_1': 1}"}
{"asctime": "2025-11-14 06:33:30,070", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-14 06:33:30,070", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00023s] {'last_active_at': datetime.datetime(2025, 11, 14, 4, 33, 30, 68929), 'users_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-14 06:33:30,071", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 06:33:30,073", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 06:33:30,074", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-14 06:33:30,074", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00018s] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-14 06:33:30,077", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-14 06:33:30,077", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00023s] {'id': UUID('61cd6052-2838-4290-9a94-edeb5d8c3320'), 'user_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'phone_number': '+27763024044', 'message_id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQTVBNzA3ODQzNzg1MjIxNDMxMQA=', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'Hi', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-14 06:33:30,079", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 06:33:30,080", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 06:33:30,080", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-14 06:33:30,081", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.006412s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-14 06:33:30,083", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 06:33:30,083", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00015s] {'user_id_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'param_1': 5}"}
{"asctime": "2025-11-14 06:33:31,896", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 06:33:31,907", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-14 06:33:31,907", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00090s] {'pk_1': UUID('61cd6052-2838-4290-9a94-edeb5d8c3320')}"}
{"asctime": "2025-11-14 06:33:31,909", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-14 06:33:31,910", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00018s] {'ai_response': 'Hey there! How can I assist you today? \ud83d\ude0a', 'intent_detected': 'greeting', 'entities_extracted': '{}', 'confidence_score': 0.95, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 14, 4, 33, 31, 901437), 'conversations_id': UUID('61cd6052-2838-4290-9a94-edeb5d8c3320')}"}
{"asctime": "2025-11-14 06:33:31,911", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 06:33:32,577", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 06:33:32,579", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763024044: Success"}
{"asctime": "2025-11-14 06:33:33,219", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 06:33:34,403", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': 'b5d2c1a3-f7e8-4f70-8592-eae14fa47f33', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763024044', 'wa_id': '27763024044'}], 'messages': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI0Qzc4RThBMDM1NjdBRTYzRUQA'}]}}"}
{"asctime": "2025-11-14 06:33:34,688", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '518aafe1-9d8c-4b22-8289-a0c285361f7e', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763024044', 'wa_id': '27763024044'}], 'messages': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI0OUM4MzU0MDkzMzZENENDQjAA'}]}}"}
{"asctime": "2025-11-14 06:33:35,592", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI0Qzc4RThBMDM1NjdBRTYzRUQA', 'status': 'sent', 'timestamp': '1763094814', 'recipient_id': '27763024044', 'conversation': {'id': 'd23bf61c513159505b8ad318e653fc5e', 'expiration_timestamp': '1763094814', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:33:35,929", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 06:33:35,935", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Buttons sent to 27763024044: Success"}
{"asctime": "2025-11-14 06:33:36,015", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI0Qzc4RThBMDM1NjdBRTYzRUQA', 'status': 'delivered', 'timestamp': '1763094814', 'recipient_id': '27763024044', 'conversation': {'id': 'd23bf61c513159505b8ad318e653fc5e', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:33:36,203", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI0OUM4MzU0MDkzMzZENENDQjAA', 'status': 'sent', 'timestamp': '1763094815', 'recipient_id': '27763024044', 'conversation': {'id': 'ff24c2b166b9e6c44e46c76b2e5a19ef', 'expiration_timestamp': '1763094815', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:33:36,513", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI0OUM4MzU0MDkzMzZENENDQjAA', 'status': 'delivered', 'timestamp': '1763094815', 'recipient_id': '27763024044', 'conversation': {'id': 'ff24c2b166b9e6c44e46c76b2e5a19ef', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:33:36,747", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI0OUM4MzU0MDkzMzZENENDQjAA', 'status': 'read', 'timestamp': '1763094815', 'recipient_id': '27763024044', 'conversation': {'id': 'ff24c2b166b9e6c44e46c76b2e5a19ef', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:33:36,837", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI0Qzc4RThBMDM1NjdBRTYzRUQA', 'status': 'read', 'timestamp': '1763094815', 'recipient_id': '27763024044', 'conversation': {'id': 'd23bf61c513159505b8ad318e653fc5e', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:33:37,812", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '83d7305a-bb8c-4209-8c97-021e59202efd', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763024044', 'wa_id': '27763024044'}], 'messages': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI5QkFDRkE0MUNDN0Y1MzZGRDQA'}]}}"}
{"asctime": "2025-11-14 06:33:38,826", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI5QkFDRkE0MUNDN0Y1MzZGRDQA', 'status': 'sent', 'timestamp': '1763094817', 'recipient_id': '27763024044', 'conversation': {'id': '9ad35e509524149848a4b4ebeb8207fa', 'expiration_timestamp': '1763094818', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:33:39,099", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI5QkFDRkE0MUNDN0Y1MzZGRDQA', 'status': 'delivered', 'timestamp': '1763094818', 'recipient_id': '27763024044', 'conversation': {'id': '9ad35e509524149848a4b4ebeb8207fa', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:33:41,427", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI5QkFDRkE0MUNDN0Y1MzZGRDQA', 'status': 'read', 'timestamp': '1763094820', 'recipient_id': '27763024044', 'conversation': {'id': '9ad35e509524149848a4b4ebeb8207fa', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:33:59,082", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World'}, 'wa_id': '27763024044'}], 'messages': [{'context': {'from': '27769034491', 'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI5QkFDRkE0MUNDN0Y1MzZGRDQA'}, 'from': '27763024044', 'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQUI3MDFBOEQ2RkNFN0ZCQjYxRgA=', 'timestamp': '1763094837', 'type': 'interactive', 'interactive': {'type': 'button_reply', 'button_reply': {'id': 'airtime', 'title': '\ud83d\udcf1 Buy Airtime'}}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:33:59,083", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Button clicked: airtime"}
{"asctime": "2025-11-14 06:33:59,083", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=interactive, media_id=none"}
{"asctime": "2025-11-14 06:33:59,083", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763024044"}
{"asctime": "2025-11-14 06:33:59,085", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 06:33:59,085", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 06:33:59,085", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 28.96s ago] {'phone_number_1': '+27763024044', 'param_1': 1}"}
{"asctime": "2025-11-14 06:33:59,087", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-14 06:33:59,087", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 28.95s ago] {'last_active_at': datetime.datetime(2025, 11, 14, 4, 33, 59, 87156), 'users_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-14 06:33:59,089", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 06:33:59,784", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 06:34:01,245", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '2173d05c-6087-4008-847b-fb334a5fecbe', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763024044', 'wa_id': '27763024044'}], 'messages': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBIyRDM2NUFBNjdDNjVCREMwOUUA'}]}}"}
{"asctime": "2025-11-14 06:34:01,664", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 06:34:01,665", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763024044: Success"}
{"asctime": "2025-11-14 06:34:02,286", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBIyRDM2NUFBNjdDNjVCREMwOUUA', 'status': 'sent', 'timestamp': '1763094841', 'recipient_id': '27763024044', 'conversation': {'id': '496ea518935da24520f0dfbade61468f', 'expiration_timestamp': '1763094841', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:34:02,598", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBIyRDM2NUFBNjdDNjVCREMwOUUA', 'status': 'delivered', 'timestamp': '1763094841', 'recipient_id': '27763024044', 'conversation': {'id': '496ea518935da24520f0dfbade61468f', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:34:02,761", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBIyRDM2NUFBNjdDNjVCREMwOUUA', 'status': 'delivered', 'timestamp': '1763094841', 'recipient_id': '27763024044', 'conversation': {'id': '496ea518935da24520f0dfbade61468f', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:34:02,981", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBIyRDM2NUFBNjdDNjVCREMwOUUA', 'status': 'read', 'timestamp': '1763094841', 'recipient_id': '27763024044', 'conversation': {'id': '496ea518935da24520f0dfbade61468f', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:34:03,073", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '81d4fc0f-1e7d-4438-afa8-1b18ec667570', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763024044', 'wa_id': '27763024044'}], 'messages': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBIyRTY4M0M1RTU1QzE1Nzc4MTYA'}]}}"}
{"asctime": "2025-11-14 06:34:04,148", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBIyRTY4M0M1RTU1QzE1Nzc4MTYA', 'status': 'sent', 'timestamp': '1763094843', 'recipient_id': '27763024044', 'conversation': {'id': '525aac0bc4a3c57822419dd363bbe3ba', 'expiration_timestamp': '1763094843', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:34:04,308", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBIyRTY4M0M1RTU1QzE1Nzc4MTYA', 'status': 'delivered', 'timestamp': '1763094843', 'recipient_id': '27763024044', 'conversation': {'id': '525aac0bc4a3c57822419dd363bbe3ba', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:34:04,775", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBIyRTY4M0M1RTU1QzE1Nzc4MTYA', 'status': 'read', 'timestamp': '1763094843', 'recipient_id': '27763024044', 'conversation': {'id': '525aac0bc4a3c57822419dd363bbe3ba', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:34:15,005", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World'}, 'wa_id': '27763024044'}], 'messages': [{'context': {'from': '27769034491', 'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI5QkFDRkE0MUNDN0Y1MzZGRDQA'}, 'from': '27763024044', 'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQUMxQ0ExRDhDNDAyQ0JCMkZFMAA=', 'timestamp': '1763094853', 'type': 'interactive', 'interactive': {'type': 'button_reply', 'button_reply': {'id': 'data', 'title': '\ud83d\udcca Buy Data'}}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:34:15,006", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Button clicked: data"}
{"asctime": "2025-11-14 06:34:15,006", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=interactive, media_id=none"}
{"asctime": "2025-11-14 06:34:15,007", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763024044"}
{"asctime": "2025-11-14 06:34:15,009", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 06:34:15,010", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 06:34:15,010", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 44.88s ago] {'phone_number_1': '+27763024044', 'param_1': 1}"}
{"asctime": "2025-11-14 06:34:15,012", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-14 06:34:15,013", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 44.88s ago] {'last_active_at': datetime.datetime(2025, 11, 14, 4, 34, 15, 12184), 'users_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-14 06:34:15,014", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 06:34:15,654", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 06:34:17,078", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': 'd563e11e-0f75-4f90-90ac-d14af9ee3951', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763024044', 'wa_id': '27763024044'}], 'messages': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBIyMjVEN0MxMTEzQUE1NzQwRDIA'}]}}"}
{"asctime": "2025-11-14 06:34:17,277", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 06:34:17,279", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763024044: Success"}
{"asctime": "2025-11-14 06:34:18,220", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBIyMjVEN0MxMTEzQUE1NzQwRDIA', 'status': 'sent', 'timestamp': '1763094857', 'recipient_id': '27763024044', 'conversation': {'id': '30969739593658ba45f1b5834666f357', 'expiration_timestamp': '1763094857', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:34:18,540", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBIyMjVEN0MxMTEzQUE1NzQwRDIA', 'status': 'delivered', 'timestamp': '1763094857', 'recipient_id': '27763024044', 'conversation': {'id': '30969739593658ba45f1b5834666f357', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:34:18,852", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '6fc11502-006e-4b57-94d0-f8c434fc92e0', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763024044', 'wa_id': '27763024044'}], 'messages': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI0NkM3RTEyQjgzODU1RkVCODcA'}]}}"}
{"asctime": "2025-11-14 06:34:19,002", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBIyMjVEN0MxMTEzQUE1NzQwRDIA', 'status': 'read', 'timestamp': '1763094857', 'recipient_id': '27763024044', 'conversation': {'id': '30969739593658ba45f1b5834666f357', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:34:19,981", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI0NkM3RTEyQjgzODU1RkVCODcA', 'status': 'sent', 'timestamp': '1763094859', 'recipient_id': '27763024044', 'conversation': {'id': '6be87dd8912cd5b94d3d9d045f6bc8ed', 'expiration_timestamp': '1763094859', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:34:20,270", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI0NkM3RTEyQjgzODU1RkVCODcA', 'status': 'delivered', 'timestamp': '1763094859', 'recipient_id': '27763024044', 'conversation': {'id': '6be87dd8912cd5b94d3d9d045f6bc8ed', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:34:20,451", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI0NkM3RTEyQjgzODU1RkVCODcA', 'status': 'read', 'timestamp': '1763094859', 'recipient_id': '27763024044', 'conversation': {'id': '6be87dd8912cd5b94d3d9d045f6bc8ed', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:34:20,583", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI0NkM3RTEyQjgzODU1RkVCODcA', 'status': 'delivered', 'timestamp': '1763094859', 'recipient_id': '27763024044', 'conversation': {'id': '6be87dd8912cd5b94d3d9d045f6bc8ed', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:34:29,822", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World'}, 'wa_id': '27763024044'}], 'messages': [{'context': {'from': '27769034491', 'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI5QkFDRkE0MUNDN0Y1MzZGRDQA'}, 'from': '27763024044', 'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQTVFRDg2NTc2MzI2NTZDNTQ5NwA=', 'timestamp': '1763094868', 'type': 'interactive', 'interactive': {'type': 'button_reply', 'button_reply': {'id': 'electricity', 'title': '\u26a1 Recharge Meter'}}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:34:29,823", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Button clicked: electricity"}
{"asctime": "2025-11-14 06:34:29,824", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=interactive, media_id=none"}
{"asctime": "2025-11-14 06:34:29,824", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763024044"}
{"asctime": "2025-11-14 06:34:29,825", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 06:34:29,826", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 06:34:29,826", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 59.7s ago] {'phone_number_1': '+27763024044', 'param_1': 1}"}
{"asctime": "2025-11-14 06:34:29,828", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-14 06:34:29,828", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 59.7s ago] {'last_active_at': datetime.datetime(2025, 11, 14, 4, 34, 29, 828120), 'users_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-14 06:34:29,829", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 06:34:30,455", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 06:34:32,107", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 06:34:32,108", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763024044: Success"}
{"asctime": "2025-11-14 06:34:32,123", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': 'de8f9c2b-c051-4402-8b66-049c45b39ac1', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763024044', 'wa_id': '27763024044'}], 'messages': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI1RDNBNDM3OUQxMkMyMEU0RTEA'}]}}"}
{"asctime": "2025-11-14 06:34:32,886", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI1RDNBNDM3OUQxMkMyMEU0RTEA', 'status': 'sent', 'timestamp': '1763094871', 'recipient_id': '27763024044', 'conversation': {'id': 'ac03101f3c1f64e2c6cf35c5e2194553', 'expiration_timestamp': '1763094871', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:34:33,249", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI1RDNBNDM3OUQxMkMyMEU0RTEA', 'status': 'delivered', 'timestamp': '1763094872', 'recipient_id': '27763024044', 'conversation': {'id': 'ac03101f3c1f64e2c6cf35c5e2194553', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:34:33,467", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI1RDNBNDM3OUQxMkMyMEU0RTEA', 'status': 'read', 'timestamp': '1763094872', 'recipient_id': '27763024044', 'conversation': {'id': 'ac03101f3c1f64e2c6cf35c5e2194553', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:34:33,659", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': 'c8c6c537-82f7-4aa5-9ceb-f95a1ac91613', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763024044', 'wa_id': '27763024044'}], 'messages': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJCRkVEMzcwNjEwQzczNTZBM0MA'}]}}"}
{"asctime": "2025-11-14 06:34:34,790", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJCRkVEMzcwNjEwQzczNTZBM0MA', 'status': 'sent', 'timestamp': '1763094873', 'recipient_id': '27763024044', 'conversation': {'id': 'cdd8c28f60290ff78523854680d27fa7', 'expiration_timestamp': '1763094873', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:34:35,009", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJCRkVEMzcwNjEwQzczNTZBM0MA', 'status': 'delivered', 'timestamp': '1763094874', 'recipient_id': '27763024044', 'conversation': {'id': 'cdd8c28f60290ff78523854680d27fa7', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:34:35,445", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJCRkVEMzcwNjEwQzczNTZBM0MA', 'status': 'read', 'timestamp': '1763094874', 'recipient_id': '27763024044', 'conversation': {'id': 'cdd8c28f60290ff78523854680d27fa7', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:34:42,873", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World'}, 'wa_id': '27763024044'}], 'messages': [{'from': '27763024044', 'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQTE2NDdDRTI2QjQ2MEFFODMzQQA=', 'timestamp': '1763094881', 'text': {'body': 'Okay'}, 'type': 'text'}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:34:42,874", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=text, media_id=none"}
{"asctime": "2025-11-14 06:34:42,874", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763024044"}
{"asctime": "2025-11-14 06:34:42,876", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 06:34:42,876", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 06:34:42,877", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 72.75s ago] {'phone_number_1': '+27763024044', 'param_1': 1}"}
{"asctime": "2025-11-14 06:34:42,878", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-14 06:34:42,878", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 72.75s ago] {'last_active_at': datetime.datetime(2025, 11, 14, 4, 34, 42, 878266), 'users_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-14 06:34:42,880", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 06:34:42,881", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 06:34:42,882", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-14 06:34:42,882", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 72.74s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-14 06:34:42,884", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-14 06:34:42,884", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 72.74s ago] {'id': UUID('214dafe9-092b-4835-9e24-b1000f19a1cc'), 'user_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'phone_number': '+27763024044', 'message_id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQTE2NDdDRTI2QjQ2MEFFODMzQQA=', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'Okay', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-14 06:34:42,885", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 06:34:42,888", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 06:34:42,889", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-14 06:34:42,890", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 72.75s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-14 06:34:42,893", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 06:34:42,893", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 72.75s ago] {'user_id_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'param_1': 5}"}
{"asctime": "2025-11-14 06:34:45,534", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 06:34:45,541", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-14 06:34:45,541", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 73.57s ago] {'pk_1': UUID('214dafe9-092b-4835-9e24-b1000f19a1cc')}"}
{"asctime": "2025-11-14 06:34:45,543", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-14 06:34:45,544", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 73.57s ago] {'ai_response': \"Great! Just let me know what you need help with\u2014buying airtime, data, or paying for electricity. I'm here for you!\", 'intent_detected': 'conversation', 'entities_extracted': '{}', 'confidence_score': 0.7, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 14, 4, 34, 45, 539511), 'conversations_id': UUID('214dafe9-092b-4835-9e24-b1000f19a1cc')}"}
{"asctime": "2025-11-14 06:34:45,547", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 06:34:46,207", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 06:34:46,207", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763024044: Success"}
{"asctime": "2025-11-14 06:34:47,688", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '04c28483-aefe-424d-9b08-62ad7df0012c', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763024044', 'wa_id': '27763024044'}], 'messages': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJFQzA2NEVCNjFCRDczNUUzOUUA'}]}}"}
{"asctime": "2025-11-14 06:34:48,705", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJFQzA2NEVCNjFCRDczNUUzOUUA', 'status': 'sent', 'timestamp': '1763094887', 'recipient_id': '27763024044', 'conversation': {'id': 'e7a697ed6b1bd4dc5eddf8625d9a6a40', 'expiration_timestamp': '1763094887', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:34:49,086", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJFQzA2NEVCNjFCRDczNUUzOUUA', 'status': 'delivered', 'timestamp': '1763094888', 'recipient_id': '27763024044', 'conversation': {'id': 'e7a697ed6b1bd4dc5eddf8625d9a6a40', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:34:50,357", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJFQzA2NEVCNjFCRDczNUUzOUUA', 'status': 'read', 'timestamp': '1763094888', 'recipient_id': '27763024044', 'conversation': {'id': 'e7a697ed6b1bd4dc5eddf8625d9a6a40', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:34:54,583", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World'}, 'wa_id': '27763024044'}], 'messages': [{'from': '27763024044', 'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQTMzMkU3OERBRDUzRDVDQkM2RgA=', 'timestamp': '1763094893', 'text': {'body': 'Understand Zulu and africaans?'}, 'type': 'text'}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:34:54,583", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=text, media_id=none"}
{"asctime": "2025-11-14 06:34:54,584", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763024044"}
{"asctime": "2025-11-14 06:34:54,585", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 06:34:54,586", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 06:34:54,586", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 84.46s ago] {'phone_number_1': '+27763024044', 'param_1': 1}"}
{"asctime": "2025-11-14 06:34:54,588", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-14 06:34:54,588", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 84.46s ago] {'last_active_at': datetime.datetime(2025, 11, 14, 4, 34, 54, 587634), 'users_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-14 06:34:54,589", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 06:34:54,591", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 06:34:54,591", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-14 06:34:54,591", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 84.45s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-14 06:34:54,593", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-14 06:34:54,593", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 84.45s ago] {'id': UUID('b257e7bb-5957-44a2-8a1f-657a5340387d'), 'user_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'phone_number': '+27763024044', 'message_id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQTMzMkU3OERBRDUzRDVDQkM2RgA=', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'Understand Zulu and africaans?', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-14 06:34:54,595", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 06:34:54,600", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 06:34:54,600", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-14 06:34:54,601", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 84.46s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-14 06:34:54,602", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 06:34:54,603", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 84.46s ago] {'user_id_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'param_1': 5}"}
{"asctime": "2025-11-14 06:34:56,215", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 06:34:56,221", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-14 06:34:56,221", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 84.25s ago] {'pk_1': UUID('b257e7bb-5957-44a2-8a1f-657a5340387d')}"}
{"asctime": "2025-11-14 06:34:56,223", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-14 06:34:56,223", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 84.25s ago] {'ai_response': 'Yes, I understand Zulu and Afrikaans! Feel free to chat with me in either language. How can I help you today? \ud83d\ude0a', 'intent_detected': 'conversation', 'entities_extracted': '{}', 'confidence_score': 0.7, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 14, 4, 34, 56, 219450), 'conversations_id': UUID('b257e7bb-5957-44a2-8a1f-657a5340387d')}"}
{"asctime": "2025-11-14 06:34:56,224", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 06:34:56,899", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 06:34:56,901", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763024044: Success"}
{"asctime": "2025-11-14 06:34:58,341", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '364f90de-7849-4c69-9397-fa886396bb81', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763024044', 'wa_id': '27763024044'}], 'messages': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJENDUxQzk5OTZGNzNEMjg0QTkA'}]}}"}
{"asctime": "2025-11-14 06:34:59,595", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJENDUxQzk5OTZGNzNEMjg0QTkA', 'status': 'delivered', 'timestamp': '1763094898', 'recipient_id': '27763024044', 'conversation': {'id': '0a306a5acf34500a35ed38036126deaf', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:34:59,645", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJENDUxQzk5OTZGNzNEMjg0QTkA', 'status': 'sent', 'timestamp': '1763094898', 'recipient_id': '27763024044', 'conversation': {'id': '0a306a5acf34500a35ed38036126deaf', 'expiration_timestamp': '1763094898', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:35:00,052", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJENDUxQzk5OTZGNzNEMjg0QTkA', 'status': 'read', 'timestamp': '1763094899', 'recipient_id': '27763024044', 'conversation': {'id': '0a306a5acf34500a35ed38036126deaf', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:35:07,961", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World'}, 'wa_id': '27763024044'}], 'messages': [{'from': '27763024044', 'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQUFENDc1NkFEODQ2RDcyMkRDNwA=', 'timestamp': '1763094906', 'text': {'body': 'Haibo'}, 'type': 'text'}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:35:07,962", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=text, media_id=none"}
{"asctime": "2025-11-14 06:35:07,962", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763024044"}
{"asctime": "2025-11-14 06:35:07,964", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 06:35:07,965", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 06:35:07,966", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 97.84s ago] {'phone_number_1': '+27763024044', 'param_1': 1}"}
{"asctime": "2025-11-14 06:35:07,968", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-14 06:35:07,968", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 97.84s ago] {'last_active_at': datetime.datetime(2025, 11, 14, 4, 35, 7, 967689), 'users_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-14 06:35:07,969", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 06:35:07,971", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 06:35:07,971", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-14 06:35:07,972", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 97.83s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-14 06:35:07,975", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-14 06:35:07,976", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 97.84s ago] {'id': UUID('a71992ff-180d-4b72-ab33-8b47ea6e945a'), 'user_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'phone_number': '+27763024044', 'message_id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQUFENDc1NkFEODQ2RDcyMkRDNwA=', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'Haibo', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-14 06:35:07,977", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 06:35:07,979", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 06:35:07,980", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-14 06:35:07,984", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 97.85s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-14 06:35:07,985", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 06:35:07,985", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 97.84s ago] {'user_id_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'param_1': 5}"}
{"asctime": "2025-11-14 06:35:09,779", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 06:35:09,786", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-14 06:35:09,786", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 97.82s ago] {'pk_1': UUID('a71992ff-180d-4b72-ab33-8b47ea6e945a')}"}
{"asctime": "2025-11-14 06:35:09,788", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-14 06:35:09,788", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 97.82s ago] {'ai_response': \"Haibo! What's on your mind? \ud83d\ude0a\", 'intent_detected': 'conversation', 'entities_extracted': '{}', 'confidence_score': 0.7, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 14, 4, 35, 9, 784369), 'conversations_id': UUID('a71992ff-180d-4b72-ab33-8b47ea6e945a')}"}
{"asctime": "2025-11-14 06:35:09,789", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 06:35:10,518", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 06:35:10,520", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763024044: Success"}
{"asctime": "2025-11-14 06:35:12,623", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '64d77088-c5e8-4e8a-b730-f27a6333f5b9', 'message_status': 'failed'}, 'response': {'error': {'message': '(#131000) Something went wrong', 'type': 'OAuthException', 'code': 131000, 'error_data': {'messaging_product': 'whatsapp', 'details': 'Something went wrong'}, 'fbtrace_id': 'A49PPGt-dmOch-AxlWqDDo7'}}}"}
{"asctime": "2025-11-14 06:36:08,995", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World'}, 'wa_id': '27763024044'}], 'messages': [{'from': '27763024044', 'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQURFRkZBNDMxMzI1NkEyMDlDMgA=', 'timestamp': '1763094966', 'text': {'body': '??'}, 'type': 'text'}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:36:08,996", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=text, media_id=none"}
{"asctime": "2025-11-14 06:36:08,997", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763024044"}
{"asctime": "2025-11-14 06:36:09,004", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 06:36:09,006", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 06:36:09,007", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 158.9s ago] {'phone_number_1': '+27763024044', 'param_1': 1}"}
{"asctime": "2025-11-14 06:36:09,011", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-14 06:36:09,011", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 158.9s ago] {'last_active_at': datetime.datetime(2025, 11, 14, 4, 36, 9, 10045), 'users_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-14 06:36:09,012", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 06:36:09,016", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 06:36:09,016", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-14 06:36:09,016", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 158.9s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-14 06:36:09,018", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-14 06:36:09,018", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 158.9s ago] {'id': UUID('db42d828-c153-42b7-876c-e15486fa577b'), 'user_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'phone_number': '+27763024044', 'message_id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQURFRkZBNDMxMzI1NkEyMDlDMgA=', 'message_type': 'text', 'direction': 'inbound', 'message_text': '??', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-14 06:36:09,020", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 06:36:09,021", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 06:36:09,021", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-14 06:36:09,021", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 158.9s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-14 06:36:09,023", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 06:36:09,023", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 158.9s ago] {'user_id_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'param_1': 5}"}
{"asctime": "2025-11-14 06:36:10,732", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 06:36:10,739", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-14 06:36:10,740", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 158.8s ago] {'pk_1': UUID('db42d828-c153-42b7-876c-e15486fa577b')}"}
{"asctime": "2025-11-14 06:36:10,742", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-14 06:36:10,742", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 158.8s ago] {'ai_response': 'Just checking in! If you need help with airtime, data, or anything else, let me know! \ud83d\ude0a', 'intent_detected': 'conversation', 'entities_extracted': '{}', 'confidence_score': 0.7, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 14, 4, 36, 10, 737597), 'conversations_id': UUID('db42d828-c153-42b7-876c-e15486fa577b')}"}
{"asctime": "2025-11-14 06:36:10,745", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 06:36:11,453", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 06:36:11,455", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763024044: Success"}
{"asctime": "2025-11-14 06:36:13,188", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '7dcaae24-7241-4733-a40f-c4e9d89f6f10', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763024044', 'wa_id': '27763024044'}], 'messages': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJCQjIyOTgzNjZBNTZBNEREQzAA'}]}}"}
{"asctime": "2025-11-14 06:36:14,169", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJCQjIyOTgzNjZBNTZBNEREQzAA', 'status': 'sent', 'timestamp': '1763094972', 'recipient_id': '27763024044', 'conversation': {'id': 'bacac482447a45dbe9d191eb52ff71bc', 'expiration_timestamp': '1763094973', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:36:14,413", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJCQjIyOTgzNjZBNTZBNEREQzAA', 'status': 'delivered', 'timestamp': '1763094973', 'recipient_id': '27763024044', 'conversation': {'id': 'bacac482447a45dbe9d191eb52ff71bc', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:36:14,748", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJCQjIyOTgzNjZBNTZBNEREQzAA', 'status': 'read', 'timestamp': '1763094973', 'recipient_id': '27763024044', 'conversation': {'id': 'bacac482447a45dbe9d191eb52ff71bc', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:36:14,872", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJCQjIyOTgzNjZBNTZBNEREQzAA', 'status': 'delivered', 'timestamp': '1763094973', 'recipient_id': '27763024044', 'conversation': {'id': 'bacac482447a45dbe9d191eb52ff71bc', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:36:20,562", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World'}, 'wa_id': '27763024044'}], 'messages': [{'context': {'from': '27763024044', 'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQTMzMkU3OERBRDUzRDVDQkM2RgA='}, 'from': '27763024044', 'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQUQ0QjY1RDg4NDg4MTEyNTAzOQA=', 'timestamp': '1763094979', 'text': {'body': '?'}, 'type': 'text'}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:36:20,563", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=text, media_id=none"}
{"asctime": "2025-11-14 06:36:20,563", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763024044"}
{"asctime": "2025-11-14 06:36:20,565", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 06:36:20,565", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 06:36:20,565", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 170.4s ago] {'phone_number_1': '+27763024044', 'param_1': 1}"}
{"asctime": "2025-11-14 06:36:20,567", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-14 06:36:20,567", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 170.4s ago] {'last_active_at': datetime.datetime(2025, 11, 14, 4, 36, 20, 566875), 'users_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-14 06:36:20,568", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 06:36:20,570", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 06:36:20,571", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-14 06:36:20,571", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 170.4s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-14 06:36:20,573", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-14 06:36:20,574", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 170.4s ago] {'id': UUID('82254c19-6fd3-48b1-acaf-fcf99becbb47'), 'user_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'phone_number': '+27763024044', 'message_id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQUQ0QjY1RDg4NDg4MTEyNTAzOQA=', 'message_type': 'text', 'direction': 'inbound', 'message_text': '?', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-14 06:36:20,582", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 06:36:20,584", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 06:36:20,584", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-14 06:36:20,585", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 170.4s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-14 06:36:20,586", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 06:36:20,586", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 170.4s ago] {'user_id_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'param_1': 5}"}
{"asctime": "2025-11-14 06:36:21,913", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 06:36:21,931", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-14 06:36:21,931", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 170s ago] {'pk_1': UUID('82254c19-6fd3-48b1-acaf-fcf99becbb47')}"}
{"asctime": "2025-11-14 06:36:21,933", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-14 06:36:21,933", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 170s ago] {'ai_response': 'Looks like I might have missed the mark there! How can I assist you today? \ud83e\uddd0', 'intent_detected': 'conversation', 'entities_extracted': '{}', 'confidence_score': 0.7, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 14, 4, 36, 21, 929375), 'conversations_id': UUID('82254c19-6fd3-48b1-acaf-fcf99becbb47')}"}
{"asctime": "2025-11-14 06:36:21,934", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 06:36:22,607", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 06:36:22,609", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763024044: Success"}
{"asctime": "2025-11-14 06:36:24,013", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '4cc620f3-70b1-43c5-a921-69fcdb3b3cfd', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763024044', 'wa_id': '27763024044'}], 'messages': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJEM0NCNzRCNjk4QTE3RERGQzEA'}]}}"}
{"asctime": "2025-11-14 06:36:25,108", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJEM0NCNzRCNjk4QTE3RERGQzEA', 'status': 'sent', 'timestamp': '1763094984', 'recipient_id': '27763024044', 'conversation': {'id': '044363f35ec685b5a03e05daa66390fa', 'expiration_timestamp': '1763094984', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:36:25,386", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJEM0NCNzRCNjk4QTE3RERGQzEA', 'status': 'delivered', 'timestamp': '1763094984', 'recipient_id': '27763024044', 'conversation': {'id': '044363f35ec685b5a03e05daa66390fa', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:36:25,772", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJEM0NCNzRCNjk4QTE3RERGQzEA', 'status': 'read', 'timestamp': '1763094984', 'recipient_id': '27763024044', 'conversation': {'id': '044363f35ec685b5a03e05daa66390fa', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:36:38,515", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World'}, 'wa_id': '27763024044'}], 'messages': [{'from': '27763024044', 'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQUQyNDQ1MTg3NjREQTBBNTdCMgA=', 'timestamp': '1763094997', 'text': {'body': 'Understand Zulu and africaans?'}, 'type': 'text'}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:36:38,517", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=text, media_id=none"}
{"asctime": "2025-11-14 06:36:38,517", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763024044"}
{"asctime": "2025-11-14 06:36:38,518", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 06:36:38,518", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 06:36:38,518", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 188.4s ago] {'phone_number_1': '+27763024044', 'param_1': 1}"}
{"asctime": "2025-11-14 06:36:38,520", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-14 06:36:38,520", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 188.4s ago] {'last_active_at': datetime.datetime(2025, 11, 14, 4, 36, 38, 519786), 'users_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-14 06:36:38,520", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 06:36:38,521", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 06:36:38,522", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-14 06:36:38,522", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 188.4s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-14 06:36:38,523", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-14 06:36:38,523", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 188.4s ago] {'id': UUID('fd5a58db-b1cd-4922-8e6e-9a976d4815fe'), 'user_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'phone_number': '+27763024044', 'message_id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQUQyNDQ1MTg3NjREQTBBNTdCMgA=', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'Understand Zulu and africaans?', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-14 06:36:38,524", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 06:36:38,525", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 06:36:38,525", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-14 06:36:38,525", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 188.4s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-14 06:36:38,526", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 06:36:38,526", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 188.4s ago] {'user_id_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'param_1': 5}"}
{"asctime": "2025-11-14 06:36:40,648", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 06:36:40,653", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-14 06:36:40,654", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 188.7s ago] {'pk_1': UUID('fd5a58db-b1cd-4922-8e6e-9a976d4815fe')}"}
{"asctime": "2025-11-14 06:36:40,657", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-14 06:36:40,658", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 188.7s ago] {'ai_response': 'Yes, I understand Zulu and Afrikaans! You can chat with me in either language. How can I help you today? \ud83d\ude0a', 'intent_detected': 'conversation', 'entities_extracted': '{}', 'confidence_score': 0.7, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 14, 4, 36, 40, 651982), 'conversations_id': UUID('fd5a58db-b1cd-4922-8e6e-9a976d4815fe')}"}
{"asctime": "2025-11-14 06:36:40,659", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 06:36:41,404", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 06:36:41,405", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763024044: Success"}
{"asctime": "2025-11-14 06:36:42,785", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '8f9b5d73-b7b9-4113-b88e-9508bf6bc29c', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763024044', 'wa_id': '27763024044'}], 'messages': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI5NjkxMEQ0QTA3MzIwM0E1MzQA'}]}}"}
{"asctime": "2025-11-14 06:36:44,324", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI5NjkxMEQ0QTA3MzIwM0E1MzQA', 'status': 'sent', 'timestamp': '1763095002', 'recipient_id': '27763024044', 'conversation': {'id': 'c3cbde57adb4ae3e02c2d93815e21cda', 'expiration_timestamp': '1763095002', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:36:44,368", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI5NjkxMEQ0QTA3MzIwM0E1MzQA', 'status': 'delivered', 'timestamp': '1763095003', 'recipient_id': '27763024044', 'conversation': {'id': 'c3cbde57adb4ae3e02c2d93815e21cda', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:36:44,572", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI5NjkxMEQ0QTA3MzIwM0E1MzQA', 'status': 'read', 'timestamp': '1763095003', 'recipient_id': '27763024044', 'conversation': {'id': 'c3cbde57adb4ae3e02c2d93815e21cda', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:36:44,725", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI5NjkxMEQ0QTA3MzIwM0E1MzQA', 'status': 'delivered', 'timestamp': '1763095003', 'recipient_id': '27763024044', 'conversation': {'id': 'c3cbde57adb4ae3e02c2d93815e21cda', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:36:46,029", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World'}, 'wa_id': '27763024044'}], 'messages': [{'from': '27763024044', 'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQTA4NDE3QzQ2MDU2OTA1RjAwNQA=', 'timestamp': '1763095004', 'text': {'body': 'Haibo!'}, 'type': 'text'}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:36:46,030", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=text, media_id=none"}
{"asctime": "2025-11-14 06:36:46,030", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763024044"}
{"asctime": "2025-11-14 06:36:46,031", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 06:36:46,031", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 06:36:46,031", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 195.9s ago] {'phone_number_1': '+27763024044', 'param_1': 1}"}
{"asctime": "2025-11-14 06:36:46,034", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-14 06:36:46,034", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 195.9s ago] {'last_active_at': datetime.datetime(2025, 11, 14, 4, 36, 46, 34105), 'users_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-14 06:36:46,035", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 06:36:46,037", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 06:36:46,037", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-14 06:36:46,037", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 195.9s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-14 06:36:46,039", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-14 06:36:46,039", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 195.9s ago] {'id': UUID('0ab59d7e-251b-4c9e-b757-9704f522c194'), 'user_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'phone_number': '+27763024044', 'message_id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQTA4NDE3QzQ2MDU2OTA1RjAwNQA=', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'Haibo!', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-14 06:36:46,044", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 06:36:46,045", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 06:36:46,045", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-14 06:36:46,045", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 195.9s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-14 06:36:46,046", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 06:36:46,047", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 195.9s ago] {'user_id_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'param_1': 5}"}
{"asctime": "2025-11-14 06:36:47,051", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 06:36:47,056", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-14 06:36:47,056", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 195.1s ago] {'pk_1': UUID('0ab59d7e-251b-4c9e-b757-9704f522c194')}"}
{"asctime": "2025-11-14 06:36:47,057", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-14 06:36:47,057", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 195.1s ago] {'ai_response': \"Haibo! What's up? How can I assist you today? \ud83d\ude0a\", 'intent_detected': 'conversation', 'entities_extracted': '{}', 'confidence_score': 0.7, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 14, 4, 36, 47, 54986), 'conversations_id': UUID('0ab59d7e-251b-4c9e-b757-9704f522c194')}"}
{"asctime": "2025-11-14 06:36:47,058", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 06:36:47,693", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 06:36:47,694", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763024044: Success"}
{"asctime": "2025-11-14 06:36:49,019", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': 'f6507cf9-86cf-4677-b5f9-8d47a109223d', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763024044', 'wa_id': '27763024044'}], 'messages': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBIxOUJDQzVGMkE0NzMxMEQ1QkYA'}]}}"}
{"asctime": "2025-11-14 06:36:50,341", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBIxOUJDQzVGMkE0NzMxMEQ1QkYA', 'status': 'sent', 'timestamp': '1763095009', 'recipient_id': '27763024044', 'conversation': {'id': '439797cd169ceb85564b7102c7328808', 'expiration_timestamp': '1763095009', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:36:50,453", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBIxOUJDQzVGMkE0NzMxMEQ1QkYA', 'status': 'delivered', 'timestamp': '1763095009', 'recipient_id': '27763024044', 'conversation': {'id': '439797cd169ceb85564b7102c7328808', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:36:50,854", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBIxOUJDQzVGMkE0NzMxMEQ1QkYA', 'status': 'read', 'timestamp': '1763095009', 'recipient_id': '27763024044', 'conversation': {'id': '439797cd169ceb85564b7102c7328808', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:36:58,653", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World'}, 'wa_id': '27763024044'}], 'messages': [{'from': '27763024044', 'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQTk3REZCOUM1QTJERDcwOTQxQQA=', 'timestamp': '1763095017', 'text': {'body': 'Wena'}, 'type': 'text'}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:36:58,653", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=text, media_id=none"}
{"asctime": "2025-11-14 06:36:58,654", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763024044"}
{"asctime": "2025-11-14 06:36:58,654", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 06:36:58,655", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 06:36:58,655", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 208.5s ago] {'phone_number_1': '+27763024044', 'param_1': 1}"}
{"asctime": "2025-11-14 06:36:58,656", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-14 06:36:58,657", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 208.5s ago] {'last_active_at': datetime.datetime(2025, 11, 14, 4, 36, 58, 656736), 'users_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-14 06:36:58,657", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 06:36:58,659", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 06:36:58,659", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-14 06:36:58,659", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 208.5s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-14 06:36:58,660", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-14 06:36:58,660", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 208.5s ago] {'id': UUID('2484df78-c572-4e43-a845-00cf9ff1b20e'), 'user_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'phone_number': '+27763024044', 'message_id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQTk3REZCOUM1QTJERDcwOTQxQQA=', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'Wena', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-14 06:36:58,661", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 06:36:58,662", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 06:36:58,662", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-14 06:36:58,662", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 208.5s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-14 06:36:58,663", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 06:36:58,663", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 208.5s ago] {'user_id_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'param_1': 5}"}
{"asctime": "2025-11-14 06:37:00,394", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 06:37:00,401", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-14 06:37:00,401", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 208.4s ago] {'pk_1': UUID('2484df78-c572-4e43-a845-00cf9ff1b20e')}"}
{"asctime": "2025-11-14 06:37:00,403", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-14 06:37:00,403", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 208.4s ago] {'ai_response': 'Ngiyaphila! Wena unjani? How can I help you today? \ud83d\ude0a', 'intent_detected': 'conversation', 'entities_extracted': '{}', 'confidence_score': 0.7, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 14, 4, 37, 0, 399136), 'conversations_id': UUID('2484df78-c572-4e43-a845-00cf9ff1b20e')}"}
{"asctime": "2025-11-14 06:37:00,404", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 06:37:01,212", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 06:37:01,214", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763024044: Success"}
{"asctime": "2025-11-14 06:37:02,751", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '0d6279f4-6000-4381-b7b1-c2fd5aaa19d9', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763024044', 'wa_id': '27763024044'}], 'messages': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI2OEQ5QTc2NkQ0RkMyRUJEOTIA'}]}}"}
{"asctime": "2025-11-14 06:37:03,579", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI2OEQ5QTc2NkQ0RkMyRUJEOTIA', 'status': 'sent', 'timestamp': '1763095022', 'recipient_id': '27763024044', 'conversation': {'id': '11ca347aeb7152dd22cf1ef054e537ff', 'expiration_timestamp': '1763095022', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:37:04,286", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI2OEQ5QTc2NkQ0RkMyRUJEOTIA', 'status': 'delivered', 'timestamp': '1763095023', 'recipient_id': '27763024044', 'conversation': {'id': '11ca347aeb7152dd22cf1ef054e537ff', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:37:04,863", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI2OEQ5QTc2NkQ0RkMyRUJEOTIA', 'status': 'read', 'timestamp': '1763095023', 'recipient_id': '27763024044', 'conversation': {'id': '11ca347aeb7152dd22cf1ef054e537ff', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:37:37,563", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World'}, 'wa_id': '27763024044'}], 'messages': [{'from': '27763024044', 'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQUI5ODk0MDFBRjc4NDcxRkRFOAA=', 'timestamp': '1763095056', 'text': {'body': 'Hi'}, 'type': 'text'}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:37:37,564", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=text, media_id=none"}
{"asctime": "2025-11-14 06:37:37,564", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763024044"}
{"asctime": "2025-11-14 06:37:37,569", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 06:37:37,572", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 06:37:37,575", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 247.4s ago] {'phone_number_1': '+27763024044', 'param_1': 1}"}
{"asctime": "2025-11-14 06:37:37,581", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-14 06:37:37,581", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 247.4s ago] {'last_active_at': datetime.datetime(2025, 11, 14, 4, 37, 37, 579986), 'users_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-14 06:37:37,583", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 06:37:37,584", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 06:37:37,584", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-14 06:37:37,585", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 247.4s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-14 06:37:37,586", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-14 06:37:37,587", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 247.4s ago] {'id': UUID('0a9b0735-075f-4b28-9692-f1fc25f1caa7'), 'user_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'phone_number': '+27763024044', 'message_id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQUI5ODk0MDFBRjc4NDcxRkRFOAA=', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'Hi', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-14 06:37:37,588", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 06:37:37,590", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 06:37:37,590", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-14 06:37:37,590", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 247.5s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-14 06:37:37,591", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 06:37:37,592", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 247.4s ago] {'user_id_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'param_1': 5}"}
{"asctime": "2025-11-14 06:37:41,291", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 06:37:41,307", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-14 06:37:41,308", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 249.3s ago] {'pk_1': UUID('0a9b0735-075f-4b28-9692-f1fc25f1caa7')}"}
{"asctime": "2025-11-14 06:37:41,310", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-14 06:37:41,310", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 249.3s ago] {'ai_response': 'Hi there! How can I assist you today? \ud83d\ude0a', 'intent_detected': 'greeting', 'entities_extracted': '{}', 'confidence_score': 0.95, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 14, 4, 37, 41, 305325), 'conversations_id': UUID('0a9b0735-075f-4b28-9692-f1fc25f1caa7')}"}
{"asctime": "2025-11-14 06:37:41,311", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 06:37:41,968", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 06:37:41,970", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763024044: Success"}
{"asctime": "2025-11-14 06:37:42,601", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 06:37:43,403", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': 'de8eaae9-8c42-4f19-9152-deb895ecdd39', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763024044', 'wa_id': '27763024044'}], 'messages': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJCRTQ1MjQwNzhGQzMyMEJFMDYA'}]}}"}
{"asctime": "2025-11-14 06:37:44,105", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '4ed9fc55-c06a-43b7-87a5-01d913ea4bcc', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763024044', 'wa_id': '27763024044'}], 'messages': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJEMDZBMzc5RTQ0NEU3RkU3QTUA'}]}}"}
{"asctime": "2025-11-14 06:37:44,448", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJCRTQ1MjQwNzhGQzMyMEJFMDYA', 'status': 'sent', 'timestamp': '1763095063', 'recipient_id': '27763024044', 'conversation': {'id': '3e743da94143ce421f2d14a8c8b04d95', 'expiration_timestamp': '1763095063', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:37:45,096", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJEMDZBMzc5RTQ0NEU3RkU3QTUA', 'status': 'sent', 'timestamp': '1763095064', 'recipient_id': '27763024044', 'conversation': {'id': '573064cf1572a8f56f0a507271eae079', 'expiration_timestamp': '1763095064', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:37:45,254", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 06:37:45,256", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Buttons sent to 27763024044: Success"}
{"asctime": "2025-11-14 06:37:45,258", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJCRTQ1MjQwNzhGQzMyMEJFMDYA', 'status': 'delivered', 'timestamp': '1763095063', 'recipient_id': '27763024044', 'conversation': {'id': '3e743da94143ce421f2d14a8c8b04d95', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:37:45,285", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJCRTQ1MjQwNzhGQzMyMEJFMDYA', 'status': 'delivered', 'timestamp': '1763095064', 'recipient_id': '27763024044', 'conversation': {'id': '3e743da94143ce421f2d14a8c8b04d95', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:37:45,679", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJCRTQ1MjQwNzhGQzMyMEJFMDYA', 'status': 'read', 'timestamp': '1763095064', 'recipient_id': '27763024044', 'conversation': {'id': '3e743da94143ce421f2d14a8c8b04d95', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:37:45,689", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJEMDZBMzc5RTQ0NEU3RkU3QTUA', 'status': 'delivered', 'timestamp': '1763095064', 'recipient_id': '27763024044', 'conversation': {'id': '573064cf1572a8f56f0a507271eae079', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:37:45,884", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJEMDZBMzc5RTQ0NEU3RkU3QTUA', 'status': 'read', 'timestamp': '1763095064', 'recipient_id': '27763024044', 'conversation': {'id': '573064cf1572a8f56f0a507271eae079', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:37:46,493", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': 'bbb3bdad-d420-4a22-9a11-c5176a4653a3', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763024044', 'wa_id': '27763024044'}], 'messages': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI3ODREMUI0MEUzM0RBMDlEQUMA'}]}}"}
{"asctime": "2025-11-14 06:37:47,757", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI3ODREMUI0MEUzM0RBMDlEQUMA', 'status': 'sent', 'timestamp': '1763095066', 'recipient_id': '27763024044', 'conversation': {'id': '29d57e64111312fdd9719dce8c3a320e', 'expiration_timestamp': '1763095066', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:37:48,026", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI3ODREMUI0MEUzM0RBMDlEQUMA', 'status': 'delivered', 'timestamp': '1763095066', 'recipient_id': '27763024044', 'conversation': {'id': '29d57e64111312fdd9719dce8c3a320e', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:37:48,430", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI3ODREMUI0MEUzM0RBMDlEQUMA', 'status': 'read', 'timestamp': '1763095067', 'recipient_id': '27763024044', 'conversation': {'id': '29d57e64111312fdd9719dce8c3a320e', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:42:54,607", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-11-14 06:42:55,477", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-11-14 06:42:55,478", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-11-14 06:42:55,501", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-11-14 06:42:55,501", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 06:42:55,501", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-11-14 06:42:55,502", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 06:42:55,502", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-11-14 06:42:55,502", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 06:42:55,502", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 06:42:55,504", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 06:42:55,505", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00039s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 06:42:55,506", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 06:42:55,506", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001901s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 06:42:55,507", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 06:42:55,507", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002658s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 06:42:55,509", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 06:42:55,509", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00032s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 06:42:55,510", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 06:42:55,510", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001523s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 06:42:55,511", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 06:42:55,511", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002393s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 06:42:55,512", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 06:42:55,512", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-11-14 06:42:55,512", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-11-14 06:42:55,512", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-11-14 06:43:10,092", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-11-14 06:43:10,642", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-11-14 06:43:10,642", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-11-14 06:43:10,665", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-11-14 06:43:10,665", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 06:43:10,666", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-11-14 06:43:10,666", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 06:43:10,666", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-11-14 06:43:10,666", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 06:43:10,666", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 06:43:10,668", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 06:43:10,668", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00010s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 06:43:10,670", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 06:43:10,670", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002786s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 06:43:10,671", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 06:43:10,671", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.003221s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 06:43:10,671", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 06:43:10,672", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00008s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 06:43:10,672", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 06:43:10,672", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0007116s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 06:43:10,673", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 06:43:10,673", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001266s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 06:43:10,673", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 06:43:10,673", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-11-14 06:43:10,673", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-11-14 06:43:10,673", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-11-14 06:43:17,251", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World'}, 'wa_id': '27763024044'}], 'messages': [{'from': '27763024044', 'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQUZCNDIyRkI4OUY1MzY4QUY1NgA=', 'timestamp': '1763095395', 'text': {'body': 'Hi'}, 'type': 'text'}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:43:17,253", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=text, media_id=none"}
{"asctime": "2025-11-14 06:43:17,254", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763024044"}
{"asctime": "2025-11-14 06:43:17,262", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 06:43:17,265", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 06:43:17,265", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00022s] {'phone_number_1': '+27763024044', 'param_1': 1}"}
{"asctime": "2025-11-14 06:43:17,268", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-14 06:43:17,268", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00011s] {'last_active_at': datetime.datetime(2025, 11, 14, 4, 43, 17, 267270), 'users_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-14 06:43:17,269", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 06:43:17,270", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 06:43:17,271", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-14 06:43:17,271", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00014s] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-14 06:43:17,273", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-14 06:43:17,273", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00021s] {'id': UUID('20c53218-a6c9-4054-9087-d891c7bb1f08'), 'user_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'phone_number': '+27763024044', 'message_id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQUZCNDIyRkI4OUY1MzY4QUY1NgA=', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'Hi', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-14 06:43:17,275", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 06:43:17,275", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 06:43:17,276", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-14 06:43:17,276", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.004966s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-14 06:43:17,278", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 06:43:17,279", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00040s] {'user_id_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'param_1': 5}"}
{"asctime": "2025-11-14 06:43:18,419", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 06:43:18,430", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-14 06:43:18,430", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00050s] {'pk_1': UUID('20c53218-a6c9-4054-9087-d891c7bb1f08')}"}
{"asctime": "2025-11-14 06:43:18,432", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-14 06:43:18,432", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00021s] {'ai_response': \"Hey! How's it going? What can I help you with today? \ud83d\ude0a\", 'intent_detected': 'greeting', 'entities_extracted': '{}', 'confidence_score': 0.95, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 14, 4, 43, 18, 426356), 'conversations_id': UUID('20c53218-a6c9-4054-9087-d891c7bb1f08')}"}
{"asctime": "2025-11-14 06:43:18,433", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 06:43:19,170", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 06:43:19,172", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763024044: Success"}
{"asctime": "2025-11-14 06:43:21,288", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': 'cbe60b82-2c54-4128-9575-a8f6e1bbbfb4', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763024044', 'wa_id': '27763024044'}], 'messages': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJGNEM2ODUxODc5Q0RCNzNGRDYA'}]}}"}
{"asctime": "2025-11-14 06:43:21,320", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 06:43:21,321", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Buttons sent to 27763024044: Success"}
{"asctime": "2025-11-14 06:43:22,007", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJGNEM2ODUxODc5Q0RCNzNGRDYA', 'status': 'sent', 'timestamp': '1763095400', 'recipient_id': '27763024044', 'conversation': {'id': 'f65b3bdd5c61e4242671419f13c8fe27', 'expiration_timestamp': '1763095401', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:43:22,713", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJGNEM2ODUxODc5Q0RCNzNGRDYA', 'status': 'delivered', 'timestamp': '1763095401', 'recipient_id': '27763024044', 'conversation': {'id': 'f65b3bdd5c61e4242671419f13c8fe27', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:43:23,057", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '7ee8ab05-797c-48d6-9f9d-59c322c121d8', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763024044', 'wa_id': '27763024044'}], 'messages': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI1MkYzMDdBQjU4Mjg3Mzk2QzAA'}]}}"}
{"asctime": "2025-11-14 06:43:23,664", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJGNEM2ODUxODc5Q0RCNzNGRDYA', 'status': 'read', 'timestamp': '1763095402', 'recipient_id': '27763024044', 'conversation': {'id': 'f65b3bdd5c61e4242671419f13c8fe27', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:43:24,121", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI1MkYzMDdBQjU4Mjg3Mzk2QzAA', 'status': 'sent', 'timestamp': '1763095403', 'recipient_id': '27763024044', 'conversation': {'id': '91b7f43ee0d041afb0b8f78bc0145fce', 'expiration_timestamp': '1763095403', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:43:24,704", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI1MkYzMDdBQjU4Mjg3Mzk2QzAA', 'status': 'delivered', 'timestamp': '1763095403', 'recipient_id': '27763024044', 'conversation': {'id': '91b7f43ee0d041afb0b8f78bc0145fce', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:43:24,709", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI1MkYzMDdBQjU4Mjg3Mzk2QzAA', 'status': 'read', 'timestamp': '1763095403', 'recipient_id': '27763024044', 'conversation': {'id': '91b7f43ee0d041afb0b8f78bc0145fce', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:43:39,054", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World'}, 'wa_id': '27763024044'}], 'messages': [{'from': '27763024044', 'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQTc2RUUwRTgyOTEyMjgyQzhERAA=', 'timestamp': '1763095417', 'text': {'body': 'Nothing'}, 'type': 'text'}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:43:39,055", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=text, media_id=none"}
{"asctime": "2025-11-14 06:43:39,055", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763024044"}
{"asctime": "2025-11-14 06:43:39,057", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 06:43:39,057", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 06:43:39,058", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 21.79s ago] {'phone_number_1': '+27763024044', 'param_1': 1}"}
{"asctime": "2025-11-14 06:43:39,059", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-14 06:43:39,059", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 21.79s ago] {'last_active_at': datetime.datetime(2025, 11, 14, 4, 43, 39, 59197), 'users_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-14 06:43:39,061", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 06:43:39,063", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 06:43:39,063", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-14 06:43:39,063", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 21.79s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-14 06:43:39,065", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-14 06:43:39,066", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 21.79s ago] {'id': UUID('291d2ae6-1256-4091-8489-73cb8576ff6e'), 'user_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'phone_number': '+27763024044', 'message_id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQTc2RUUwRTgyOTEyMjgyQzhERAA=', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'Nothing', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-14 06:43:39,069", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 06:43:39,072", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 06:43:39,073", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-14 06:43:39,073", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 21.8s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-14 06:43:39,075", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 06:43:39,075", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 21.8s ago] {'user_id_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'param_1': 5}"}
{"asctime": "2025-11-14 06:43:40,594", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 06:43:40,607", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-14 06:43:40,608", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 22.18s ago] {'pk_1': UUID('291d2ae6-1256-4091-8489-73cb8576ff6e')}"}
{"asctime": "2025-11-14 06:43:40,610", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-14 06:43:40,610", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 22.18s ago] {'ai_response': \"Alright, no problem! If you need anything later, just let me know. I'm here to help! \ud83d\ude0a\", 'intent_detected': 'greeting', 'entities_extracted': '{}', 'confidence_score': 0.95, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 14, 4, 43, 40, 605300), 'conversations_id': UUID('291d2ae6-1256-4091-8489-73cb8576ff6e')}"}
{"asctime": "2025-11-14 06:43:40,611", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 06:43:41,391", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 06:43:41,393", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763024044: Success"}
{"asctime": "2025-11-14 06:43:42,830", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '544ab7d7-d7ed-43a1-9d16-e8c8a54bbeb4', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763024044', 'wa_id': '27763024044'}], 'messages': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJDRkRFNzg0MDBBNkREN0ZDRTAA'}]}}"}
{"asctime": "2025-11-14 06:43:43,539", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 06:43:43,540", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Buttons sent to 27763024044: Success"}
{"asctime": "2025-11-14 06:43:43,778", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJDRkRFNzg0MDBBNkREN0ZDRTAA', 'status': 'sent', 'timestamp': '1763095422', 'recipient_id': '27763024044', 'conversation': {'id': 'decd4070c16f853bb2c42144068bf80e', 'expiration_timestamp': '1763095422', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:43:44,381", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJDRkRFNzg0MDBBNkREN0ZDRTAA', 'status': 'delivered', 'timestamp': '1763095423', 'recipient_id': '27763024044', 'conversation': {'id': 'decd4070c16f853bb2c42144068bf80e', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:43:44,464", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJDRkRFNzg0MDBBNkREN0ZDRTAA', 'status': 'read', 'timestamp': '1763095423', 'recipient_id': '27763024044', 'conversation': {'id': 'decd4070c16f853bb2c42144068bf80e', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:43:44,947", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': 'fe6cd1b6-1157-42bb-bd10-379397e14cac', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763024044', 'wa_id': '27763024044'}], 'messages': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI4QzE2RDM0NEQ4RDFGNEI2MEYA'}]}}"}
{"asctime": "2025-11-14 06:43:45,998", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI4QzE2RDM0NEQ4RDFGNEI2MEYA', 'status': 'sent', 'timestamp': '1763095425', 'recipient_id': '27763024044', 'conversation': {'id': '0367e8fc9809e7800f646aecaeed1b32', 'expiration_timestamp': '1763095425', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:43:46,336", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI4QzE2RDM0NEQ4RDFGNEI2MEYA', 'status': 'delivered', 'timestamp': '1763095425', 'recipient_id': '27763024044', 'conversation': {'id': '0367e8fc9809e7800f646aecaeed1b32', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:43:49,205", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI4QzE2RDM0NEQ4RDFGNEI2MEYA', 'status': 'read', 'timestamp': '1763095428', 'recipient_id': '27763024044', 'conversation': {'id': '0367e8fc9809e7800f646aecaeed1b32', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:44:06,042", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World'}, 'wa_id': '27763024044'}], 'messages': [{'from': '27763024044', 'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQUNBNDQ2QzI2RkZFNzUxQjY2QwA=', 'timestamp': '1763095444', 'text': {'body': 'Nothing'}, 'type': 'text'}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:44:06,044", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=text, media_id=none"}
{"asctime": "2025-11-14 06:44:06,044", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763024044"}
{"asctime": "2025-11-14 06:44:06,051", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 06:44:06,053", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 06:44:06,054", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 48.79s ago] {'phone_number_1': '+27763024044', 'param_1': 1}"}
{"asctime": "2025-11-14 06:44:06,061", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-14 06:44:06,061", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 48.79s ago] {'last_active_at': datetime.datetime(2025, 11, 14, 4, 44, 6, 57212), 'users_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-14 06:44:06,063", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 06:44:06,065", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 06:44:06,065", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-14 06:44:06,066", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 48.8s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-14 06:44:06,068", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-14 06:44:06,068", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 48.8s ago] {'id': UUID('4e8f7e56-1ed6-4394-9f9f-217e0bb27157'), 'user_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'phone_number': '+27763024044', 'message_id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQUNBNDQ2QzI2RkZFNzUxQjY2QwA=', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'Nothing', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-14 06:44:06,070", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 06:44:06,071", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 06:44:06,071", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-14 06:44:06,071", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 48.8s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-14 06:44:06,072", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 06:44:06,072", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 48.79s ago] {'user_id_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'param_1': 5}"}
{"asctime": "2025-11-14 06:44:07,663", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 06:44:07,675", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-14 06:44:07,676", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 49.25s ago] {'pk_1': UUID('4e8f7e56-1ed6-4394-9f9f-217e0bb27157')}"}
{"asctime": "2025-11-14 06:44:07,677", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-14 06:44:07,678", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 49.25s ago] {'ai_response': 'Got it! If you change your mind or need assistance later, just give me a shout. Enjoy your day! \ud83c\udf1f', 'intent_detected': 'greeting', 'entities_extracted': '{}', 'confidence_score': 0.95, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 14, 4, 44, 7, 671982), 'conversations_id': UUID('4e8f7e56-1ed6-4394-9f9f-217e0bb27157')}"}
{"asctime": "2025-11-14 06:44:07,679", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 06:44:08,352", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 06:44:08,352", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763024044: Success"}
{"asctime": "2025-11-14 06:44:10,069", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '4c0039a3-f50f-4096-ba9c-0cafd61f0152', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763024044', 'wa_id': '27763024044'}], 'messages': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJBMkZEMTMzRkM0OTBENTZDMkUA'}]}}"}
{"asctime": "2025-11-14 06:44:10,462", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 06:44:10,463", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Buttons sent to 27763024044: Success"}
{"asctime": "2025-11-14 06:44:11,155", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJBMkZEMTMzRkM0OTBENTZDMkUA', 'status': 'sent', 'timestamp': '1763095450', 'recipient_id': '27763024044', 'conversation': {'id': 'b44f6c1fefcca163f324276db0165105', 'expiration_timestamp': '1763095450', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:44:11,325", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJBMkZEMTMzRkM0OTBENTZDMkUA', 'status': 'delivered', 'timestamp': '1763095450', 'recipient_id': '27763024044', 'conversation': {'id': 'b44f6c1fefcca163f324276db0165105', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:44:11,570", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJBMkZEMTMzRkM0OTBENTZDMkUA', 'status': 'read', 'timestamp': '1763095450', 'recipient_id': '27763024044', 'conversation': {'id': 'b44f6c1fefcca163f324276db0165105', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:44:11,727", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJBMkZEMTMzRkM0OTBENTZDMkUA', 'status': 'read', 'timestamp': '1763095450', 'recipient_id': '27763024044', 'conversation': {'id': 'b44f6c1fefcca163f324276db0165105', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:44:11,872", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '2b5df510-08f3-4ae7-b3e2-8fa9dc5327ee', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763024044', 'wa_id': '27763024044'}], 'messages': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI4QTE5MUM5MEU5MTk5REY0M0QA'}]}}"}
{"asctime": "2025-11-14 06:44:13,085", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI4QTE5MUM5MEU5MTk5REY0M0QA', 'status': 'sent', 'timestamp': '1763095451', 'recipient_id': '27763024044', 'conversation': {'id': 'ab8b90b9ad6c4db03d0de559dc367cc0', 'expiration_timestamp': '1763095452', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:44:13,238", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI4QTE5MUM5MEU5MTk5REY0M0QA', 'status': 'delivered', 'timestamp': '1763095452', 'recipient_id': '27763024044', 'conversation': {'id': 'ab8b90b9ad6c4db03d0de559dc367cc0', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:44:13,483", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI4QTE5MUM5MEU5MTk5REY0M0QA', 'status': 'read', 'timestamp': '1763095452', 'recipient_id': '27763024044', 'conversation': {'id': 'ab8b90b9ad6c4db03d0de559dc367cc0', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:44:13,801", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI4QTE5MUM5MEU5MTk5REY0M0QA', 'status': 'read', 'timestamp': '1763095452', 'recipient_id': '27763024044', 'conversation': {'id': 'ab8b90b9ad6c4db03d0de559dc367cc0', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:46:25,713", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-11-14 06:46:26,544", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-11-14 06:46:26,544", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-11-14 06:46:26,563", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-11-14 06:46:26,563", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 06:46:26,564", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-11-14 06:46:26,564", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 06:46:26,564", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-11-14 06:46:26,564", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 06:46:26,565", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 06:46:26,566", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 06:46:26,566", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00010s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 06:46:26,569", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 06:46:26,569", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002837s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 06:46:26,569", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 06:46:26,569", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.003211s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 06:46:26,570", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 06:46:26,570", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00008s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 06:46:26,570", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 06:46:26,570", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0006614s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 06:46:26,571", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 06:46:26,571", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001233s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 06:46:26,571", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 06:46:26,571", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-11-14 06:46:26,571", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-11-14 06:46:26,572", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-11-14 06:46:33,374", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World'}, 'wa_id': '27763024044'}], 'messages': [{'from': '27763024044', 'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQTc1NEM5Mjk4RDk3Q0I3MTg2OAA=', 'timestamp': '1763095591', 'text': {'body': 'Hi'}, 'type': 'text'}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:46:33,375", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=text, media_id=none"}
{"asctime": "2025-11-14 06:46:33,375", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763024044"}
{"asctime": "2025-11-14 06:46:33,383", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 06:46:33,387", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 06:46:33,387", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00035s] {'phone_number_1': '+27763024044', 'param_1': 1}"}
{"asctime": "2025-11-14 06:46:33,393", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-14 06:46:33,393", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00021s] {'last_active_at': datetime.datetime(2025, 11, 14, 4, 46, 33, 391828), 'users_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-14 06:46:33,394", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 06:46:33,396", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 06:46:33,397", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-14 06:46:33,397", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00017s] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-14 06:46:33,400", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-14 06:46:33,400", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00025s] {'id': UUID('eff7f7a9-691f-4780-aefb-1e9a6f348e70'), 'user_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'phone_number': '+27763024044', 'message_id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQTc1NEM5Mjk4RDk3Q0I3MTg2OAA=', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'Hi', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-14 06:46:33,402", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 06:46:33,403", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 06:46:33,403", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-14 06:46:33,403", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.006181s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-14 06:46:33,406", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 06:46:33,406", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00022s] {'user_id_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'param_1': 5}"}
{"asctime": "2025-11-14 06:46:34,651", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 06:46:34,661", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-14 06:46:34,661", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00058s] {'pk_1': UUID('eff7f7a9-691f-4780-aefb-1e9a6f348e70')}"}
{"asctime": "2025-11-14 06:46:34,663", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-14 06:46:34,663", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00030s] {'ai_response': 'Hi there! How can I assist you today? \ud83d\ude0a', 'intent_detected': 'greeting', 'entities_extracted': '{}', 'confidence_score': 0.95, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 14, 4, 46, 34, 657607), 'conversations_id': UUID('eff7f7a9-691f-4780-aefb-1e9a6f348e70')}"}
{"asctime": "2025-11-14 06:46:34,664", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 06:46:35,323", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 06:46:35,325", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763024044: Success"}
{"asctime": "2025-11-14 06:46:37,007", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': 'ef5f4b84-e402-40bf-a5f1-2c61a646bb42', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763024044', 'wa_id': '27763024044'}], 'messages': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI3MjhBMDBBRERDMUVBRjM3NUUA'}]}}"}
{"asctime": "2025-11-14 06:46:37,783", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI3MjhBMDBBRERDMUVBRjM3NUUA', 'status': 'sent', 'timestamp': '1763095596', 'recipient_id': '27763024044', 'conversation': {'id': '793380bc203d182503692363ed78c45a', 'expiration_timestamp': '1763095596', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:46:38,181", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI3MjhBMDBBRERDMUVBRjM3NUUA', 'status': 'delivered', 'timestamp': '1763095597', 'recipient_id': '27763024044', 'conversation': {'id': '793380bc203d182503692363ed78c45a', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:46:38,773", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI3MjhBMDBBRERDMUVBRjM3NUUA', 'status': 'read', 'timestamp': '1763095597', 'recipient_id': '27763024044', 'conversation': {'id': '793380bc203d182503692363ed78c45a', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:46:51,977", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World'}, 'wa_id': '27763024044'}], 'messages': [{'from': '27763024044', 'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQUQwQjQ5MDlERERFMUVFMDUwNAA=', 'timestamp': '1763095610', 'text': {'body': 'Need airtime'}, 'type': 'text'}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:46:51,978", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=text, media_id=none"}
{"asctime": "2025-11-14 06:46:51,978", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763024044"}
{"asctime": "2025-11-14 06:46:51,980", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 06:46:51,980", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 06:46:51,980", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 18.59s ago] {'phone_number_1': '+27763024044', 'param_1': 1}"}
{"asctime": "2025-11-14 06:46:51,982", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-14 06:46:51,983", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 18.59s ago] {'last_active_at': datetime.datetime(2025, 11, 14, 4, 46, 51, 982128), 'users_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-14 06:46:51,984", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 06:46:51,986", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 06:46:51,987", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-14 06:46:51,987", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 18.59s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-14 06:46:51,989", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-14 06:46:51,989", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 18.59s ago] {'id': UUID('d9528bf6-929a-45e1-af6a-5b55ba5f9a56'), 'user_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'phone_number': '+27763024044', 'message_id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQUQwQjQ5MDlERERFMUVFMDUwNAA=', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'Need airtime', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-14 06:46:51,990", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 06:46:51,992", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 06:46:51,993", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-14 06:46:51,993", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 18.6s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-14 06:46:51,995", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 06:46:51,995", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 18.59s ago] {'user_id_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'param_1': 5}"}
{"asctime": "2025-11-14 06:46:54,468", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 06:46:54,478", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-14 06:46:54,478", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 19.82s ago] {'pk_1': UUID('d9528bf6-929a-45e1-af6a-5b55ba5f9a56')}"}
{"asctime": "2025-11-14 06:46:54,480", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-14 06:46:54,481", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 19.82s ago] {'ai_response': 'Sure! How much airtime do you want to buy? You can choose from R5, R10, R20, R50, R100, R500, or any amount up to R1000. Let me know!', 'intent_detected': 'buy_airtime', 'entities_extracted': '{\"amount\": null, \"phone\": null, \"network\": null}', 'confidence_score': 0.9, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 14, 4, 46, 54, 476552), 'conversations_id': UUID('d9528bf6-929a-45e1-af6a-5b55ba5f9a56')}"}
{"asctime": "2025-11-14 06:46:54,482", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 06:46:55,109", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 06:46:55,110", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763024044: Success"}
{"asctime": "2025-11-14 06:46:56,754", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '2e89a4ae-65dd-45ec-8c7b-add3cb1040a0', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763024044', 'wa_id': '27763024044'}], 'messages': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBIxRTg4RDA2ODk1MDA3MTMwRjkA'}]}}"}
{"asctime": "2025-11-14 06:46:57,999", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBIxRTg4RDA2ODk1MDA3MTMwRjkA', 'status': 'sent', 'timestamp': '1763095616', 'recipient_id': '27763024044', 'conversation': {'id': 'e23856f264d9ec535c19613ab157826f', 'expiration_timestamp': '1763095617', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:46:58,465", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBIxRTg4RDA2ODk1MDA3MTMwRjkA', 'status': 'delivered', 'timestamp': '1763095617', 'recipient_id': '27763024044', 'conversation': {'id': 'e23856f264d9ec535c19613ab157826f', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:46:58,648", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBIxRTg4RDA2ODk1MDA3MTMwRjkA', 'status': 'read', 'timestamp': '1763095617', 'recipient_id': '27763024044', 'conversation': {'id': 'e23856f264d9ec535c19613ab157826f', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:50:04,601", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World!'}, 'wa_id': '27763514028'}], 'messages': [{'from': '27763514028', 'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgASGBQzQUFFQ0Q3REUyNjUxMzA2ODNBQwA=', 'timestamp': '1763095801', 'text': {'body': 'Hello'}, 'type': 'text'}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:50:04,604", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=text, media_id=none"}
{"asctime": "2025-11-14 06:50:04,604", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763514028"}
{"asctime": "2025-11-14 06:50:04,612", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 06:50:04,614", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 06:50:04,614", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 211.2s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-14 06:50:05,328", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 06:50:05,328", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763514028: Success"}
{"asctime": "2025-11-14 06:50:05,329", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "ROLLBACK"}
{"asctime": "2025-11-14 06:50:07,235", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '994d8730-4271-4f08-ad60-e3e45aabee18', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763514028', 'wa_id': '27763514028'}], 'messages': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI0RkI5OUZGMkM3RTQzNDRBNkMA'}]}}"}
{"asctime": "2025-11-14 06:50:08,308", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI0RkI5OUZGMkM3RTQzNDRBNkMA', 'status': 'sent', 'timestamp': '1763095807', 'recipient_id': '27763514028', 'conversation': {'id': '1bdfd37f530fd441dea01f87e22f11ef', 'expiration_timestamp': '1763095807', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:50:09,020", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI0RkI5OUZGMkM3RTQzNDRBNkMA', 'status': 'delivered', 'timestamp': '1763095807', 'recipient_id': '27763514028', 'conversation': {'id': '1bdfd37f530fd441dea01f87e22f11ef', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:50:09,086", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI0RkI5OUZGMkM3RTQzNDRBNkMA', 'status': 'read', 'timestamp': '1763095807', 'recipient_id': '27763514028', 'conversation': {'id': '1bdfd37f530fd441dea01f87e22f11ef', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:50:23,045", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World!'}, 'wa_id': '27763514028'}], 'messages': [{'from': '27763514028', 'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgASGBQzQTkwRTM1OEIyMzcwNEI5MkQ5MQA=', 'timestamp': '1763095821', 'text': {'body': 'Register'}, 'type': 'text'}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:50:23,047", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=text, media_id=none"}
{"asctime": "2025-11-14 06:50:23,047", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763514028"}
{"asctime": "2025-11-14 06:50:23,048", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 06:50:23,049", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 06:50:23,049", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 229.6s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-14 06:50:23,703", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 06:50:23,704", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763514028: Success"}
{"asctime": "2025-11-14 06:50:23,705", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "ROLLBACK"}
{"asctime": "2025-11-14 06:50:25,150", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '41d7ace4-6cb0-4835-bae0-fc4b63ca6589', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763514028', 'wa_id': '27763514028'}], 'messages': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBJEQjY1RDREMkIyQ0MyRDZDQkQA'}]}}"}
{"asctime": "2025-11-14 06:50:26,538", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBJEQjY1RDREMkIyQ0MyRDZDQkQA', 'status': 'sent', 'timestamp': '1763095825', 'recipient_id': '27763514028', 'conversation': {'id': '56caf343a6848f5be84892839b47ec10', 'expiration_timestamp': '1763095825', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:50:26,992", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBJEQjY1RDREMkIyQ0MyRDZDQkQA', 'status': 'read', 'timestamp': '1763095825', 'recipient_id': '27763514028', 'conversation': {'id': '56caf343a6848f5be84892839b47ec10', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:50:27,298", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBJEQjY1RDREMkIyQ0MyRDZDQkQA', 'status': 'delivered', 'timestamp': '1763095825', 'recipient_id': '27763514028', 'conversation': {'id': '56caf343a6848f5be84892839b47ec10', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:50:45,967", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World!'}, 'wa_id': '27763514028'}], 'messages': [{'from': '27763514028', 'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgASGBQzQUExNTA1MTM0ODUzMURDOERGQwA=', 'timestamp': '1763095844', 'text': {'body': 'Register Kelvin Cole 9001011234567'}, 'type': 'text'}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:50:45,968", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=text, media_id=none"}
{"asctime": "2025-11-14 06:50:45,968", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763514028"}
{"asctime": "2025-11-14 06:50:45,970", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 06:50:45,970", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 06:50:45,970", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 252.5s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-14 06:50:45,972", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 06:50:45,973", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 252.5s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-14 06:50:46,597", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 06:50:46,598", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763514028: Success"}
{"asctime": "2025-11-14 06:50:46,599", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "ROLLBACK"}
{"asctime": "2025-11-14 06:50:47,977", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '391f38a6-7355-433e-b743-176cca8777c7', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763514028', 'wa_id': '27763514028'}], 'messages': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBJENjEyODEzOTk3QTk5NTA2ODIA'}]}}"}
{"asctime": "2025-11-14 06:50:49,365", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBJENjEyODEzOTk3QTk5NTA2ODIA', 'status': 'sent', 'timestamp': '1763095848', 'recipient_id': '27763514028', 'conversation': {'id': 'cbd65452164a128fb500ba3bc7784eaf', 'expiration_timestamp': '1763095848', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:50:49,766", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBJENjEyODEzOTk3QTk5NTA2ODIA', 'status': 'delivered', 'timestamp': '1763095848', 'recipient_id': '27763514028', 'conversation': {'id': 'cbd65452164a128fb500ba3bc7784eaf', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:50:52,708", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBJENjEyODEzOTk3QTk5NTA2ODIA', 'status': 'read', 'timestamp': '1763095851', 'recipient_id': '27763514028', 'conversation': {'id': 'cbd65452164a128fb500ba3bc7784eaf', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:50:56,737", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World!'}, 'wa_id': '27763514028'}], 'messages': [{'from': '27763514028', 'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgASGBQzQTA4RkU3QTI1QkFFNjU4MTI4NAA=', 'timestamp': '1763095855', 'text': {'body': 'Hi'}, 'type': 'text'}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:50:56,738", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=text, media_id=none"}
{"asctime": "2025-11-14 06:50:56,738", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763514028"}
{"asctime": "2025-11-14 06:50:56,740", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 06:50:56,740", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 06:50:56,740", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 263.3s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-14 06:50:57,872", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 06:50:57,873", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763514028: Success"}
{"asctime": "2025-11-14 06:50:57,874", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "ROLLBACK"}
{"asctime": "2025-11-14 06:50:59,294", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': 'e40a8bc8-576a-48d0-b193-153ba47c1630', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763514028', 'wa_id': '27763514028'}], 'messages': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBJDQjY1MTRCMjMxQTcwNkFBMzgA'}]}}"}
{"asctime": "2025-11-14 06:51:00,482", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBJDQjY1MTRCMjMxQTcwNkFBMzgA', 'status': 'sent', 'timestamp': '1763095859', 'recipient_id': '27763514028', 'conversation': {'id': 'e0827c2e90fc7cc2a09270dad678746b', 'expiration_timestamp': '1763095859', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:51:00,990", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBJDQjY1MTRCMjMxQTcwNkFBMzgA', 'status': 'delivered', 'timestamp': '1763095859', 'recipient_id': '27763514028', 'conversation': {'id': 'e0827c2e90fc7cc2a09270dad678746b', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:51:01,169", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBJDQjY1MTRCMjMxQTcwNkFBMzgA', 'status': 'read', 'timestamp': '1763095859', 'recipient_id': '27763514028', 'conversation': {'id': 'e0827c2e90fc7cc2a09270dad678746b', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:56:10,634", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-11-14 06:56:11,291", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-11-14 06:56:11,292", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-11-14 06:56:11,312", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-11-14 06:56:11,312", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 06:56:11,313", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-11-14 06:56:11,313", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 06:56:11,313", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-11-14 06:56:11,313", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 06:56:11,314", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 06:56:11,315", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 06:56:11,315", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00010s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 06:56:11,317", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 06:56:11,317", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.00196s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 06:56:11,317", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 06:56:11,317", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002222s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 06:56:11,318", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 06:56:11,318", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00006s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 06:56:11,318", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 06:56:11,318", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0005905s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 06:56:11,319", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 06:56:11,319", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001014s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 06:56:11,319", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 06:56:11,319", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-11-14 06:56:11,319", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-11-14 06:56:11,319", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-11-14 06:56:26,359", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World!'}, 'wa_id': '27763514028'}], 'messages': [{'from': '27763514028', 'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgASGBQzQTlFQjMyOUQ4QkM1RDUzOTQxOAA=', 'timestamp': '1763096184', 'text': {'body': '/complete'}, 'type': 'text'}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:56:26,360", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=text, media_id=none"}
{"asctime": "2025-11-14 06:56:26,360", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763514028"}
{"asctime": "2025-11-14 06:56:26,370", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 06:56:26,373", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 06:56:26,374", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00033s] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-14 06:56:27,117", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 06:56:27,118", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763514028: Success"}
{"asctime": "2025-11-14 06:56:27,119", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "ROLLBACK"}
{"asctime": "2025-11-14 06:56:28,573", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '35bf8f55-2198-40d9-8931-1a4d2b4e3c74', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763514028', 'wa_id': '27763514028'}], 'messages': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI0MUYyNDZDMEMzMUMxREU1QjAA'}]}}"}
{"asctime": "2025-11-14 06:56:29,616", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI0MUYyNDZDMEMzMUMxREU1QjAA', 'status': 'sent', 'timestamp': '1763096188', 'recipient_id': '27763514028', 'conversation': {'id': 'fc8593d2bd2a758ec6bbeefdabd8c048', 'expiration_timestamp': '1763096188', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:56:30,420", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI0MUYyNDZDMEMzMUMxREU1QjAA', 'status': 'delivered', 'timestamp': '1763096189', 'recipient_id': '27763514028', 'conversation': {'id': 'fc8593d2bd2a758ec6bbeefdabd8c048', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:56:30,588", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI0MUYyNDZDMEMzMUMxREU1QjAA', 'status': 'read', 'timestamp': '1763096189', 'recipient_id': '27763514028', 'conversation': {'id': 'fc8593d2bd2a758ec6bbeefdabd8c048', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:56:34,043", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World!'}, 'wa_id': '27763514028'}], 'messages': [{'from': '27763514028', 'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgASGBQzQTlFNzI5REM5RDhCMUUxMTdBNAA=', 'timestamp': '1763096192', 'text': {'body': 'Hi'}, 'type': 'text'}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:56:34,043", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=text, media_id=none"}
{"asctime": "2025-11-14 06:56:34,043", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763514028"}
{"asctime": "2025-11-14 06:56:34,044", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 06:56:34,045", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 06:56:34,045", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 7.672s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-14 06:56:34,838", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 06:56:34,840", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763514028: Success"}
{"asctime": "2025-11-14 06:56:34,840", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "ROLLBACK"}
{"asctime": "2025-11-14 06:56:36,229", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '6fdc0860-9b0a-4f22-8562-95efdc6674d2', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763514028', 'wa_id': '27763514028'}], 'messages': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBJDNUQ3MjhEODk0OTRGQjVENjAA'}]}}"}
{"asctime": "2025-11-14 06:56:37,320", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBJDNUQ3MjhEODk0OTRGQjVENjAA', 'status': 'sent', 'timestamp': '1763096196', 'recipient_id': '27763514028', 'conversation': {'id': 'b4a81ea048ee49cfb41146a385a83bb5', 'expiration_timestamp': '1763096196', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:56:37,934", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBJDNUQ3MjhEODk0OTRGQjVENjAA', 'status': 'delivered', 'timestamp': '1763096196', 'recipient_id': '27763514028', 'conversation': {'id': 'b4a81ea048ee49cfb41146a385a83bb5', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:56:37,979", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBJDNUQ3MjhEODk0OTRGQjVENjAA', 'status': 'read', 'timestamp': '1763096196', 'recipient_id': '27763514028', 'conversation': {'id': 'b4a81ea048ee49cfb41146a385a83bb5', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:57:08,049", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World!'}, 'wa_id': '27763514028'}], 'messages': [{'from': '27763514028', 'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgASGBQzQTAzOTk1M0UyQjY1NTM5RTRCQgA=', 'timestamp': '1763096226', 'text': {'body': '/reset'}, 'type': 'text'}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:57:08,050", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=text, media_id=none"}
{"asctime": "2025-11-14 06:57:08,051", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763514028"}
{"asctime": "2025-11-14 06:57:08,052", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 06:57:08,053", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 06:57:08,053", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 41.68s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-14 06:57:08,839", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 06:57:08,841", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763514028: Success"}
{"asctime": "2025-11-14 06:57:08,842", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "ROLLBACK"}
{"asctime": "2025-11-14 06:57:10,310", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': 'dca4c70d-655c-46de-823f-be6b8b471555', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763514028', 'wa_id': '27763514028'}], 'messages': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBJEOTE0MTU0QTQ4MEEwMzMwQ0IA'}]}}"}
{"asctime": "2025-11-14 06:57:11,432", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBJEOTE0MTU0QTQ4MEEwMzMwQ0IA', 'status': 'sent', 'timestamp': '1763096230', 'recipient_id': '27763514028', 'conversation': {'id': 'ca625d5af45af0943126285ada83cbf7', 'expiration_timestamp': '1763096230', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:57:11,917", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBJEOTE0MTU0QTQ4MEEwMzMwQ0IA', 'status': 'delivered', 'timestamp': '1763096230', 'recipient_id': '27763514028', 'conversation': {'id': 'ca625d5af45af0943126285ada83cbf7', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 06:57:12,026", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBJEOTE0MTU0QTQ4MEEwMzMwQ0IA', 'status': 'read', 'timestamp': '1763096230', 'recipient_id': '27763514028', 'conversation': {'id': 'ca625d5af45af0943126285ada83cbf7', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 07:01:17,633", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World!'}, 'wa_id': '27763514028'}], 'messages': [{'from': '27763514028', 'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgASGBQzQUFGNkREMzFEN0Q1M0ExMzM5OAA=', 'timestamp': '1763096475', 'text': {'body': 'Hi'}, 'type': 'text'}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 07:01:17,635", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=text, media_id=none"}
{"asctime": "2025-11-14 07:01:17,636", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763514028"}
{"asctime": "2025-11-14 07:01:17,641", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 07:01:17,642", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 07:01:17,643", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 291.3s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-14 07:01:18,302", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 07:01:18,304", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763514028: Success"}
{"asctime": "2025-11-14 07:01:18,305", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "ROLLBACK"}
{"asctime": "2025-11-14 07:01:19,726", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '6ccd05a7-7132-484a-9d9f-69ac0eb3daf8', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763514028', 'wa_id': '27763514028'}], 'messages': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBJDN0QzNDBFRjk1NEYxODEyREEA'}]}}"}
{"asctime": "2025-11-14 07:01:20,867", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBJDN0QzNDBFRjk1NEYxODEyREEA', 'status': 'sent', 'timestamp': '1763096479', 'recipient_id': '27763514028', 'conversation': {'id': 'b18228a958487678b702efd1d56da1ce', 'expiration_timestamp': '1763096479', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 07:01:21,327", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBJDN0QzNDBFRjk1NEYxODEyREEA', 'status': 'read', 'timestamp': '1763096480', 'recipient_id': '27763514028', 'conversation': {'id': 'b18228a958487678b702efd1d56da1ce', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 07:01:21,384", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBJDN0QzNDBFRjk1NEYxODEyREEA', 'status': 'delivered', 'timestamp': '1763096480', 'recipient_id': '27763514028', 'conversation': {'id': 'b18228a958487678b702efd1d56da1ce', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 07:01:26,716", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World!'}, 'wa_id': '27763514028'}], 'messages': [{'from': '27763514028', 'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgASGBQzQTEzM0IyRjczQjg5MTA1QzI0QgA=', 'timestamp': '1763096485', 'text': {'body': 'Hello'}, 'type': 'text'}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 07:01:26,716", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=text, media_id=none"}
{"asctime": "2025-11-14 07:01:26,716", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763514028"}
{"asctime": "2025-11-14 07:01:26,718", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 07:01:26,718", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 07:01:26,719", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 300.3s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-14 07:01:27,389", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 07:01:27,390", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763514028: Success"}
{"asctime": "2025-11-14 07:01:27,391", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "ROLLBACK"}
{"asctime": "2025-11-14 07:01:28,816", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '4d46b7a7-36ef-43f4-ac53-735590775230', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763514028', 'wa_id': '27763514028'}], 'messages': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI4RjczMUJEOENENkIzQUUxQzMA'}]}}"}
{"asctime": "2025-11-14 07:01:29,727", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI4RjczMUJEOENENkIzQUUxQzMA', 'status': 'sent', 'timestamp': '1763096488', 'recipient_id': '27763514028', 'conversation': {'id': 'ff52e998ae4980cf7eb62d971edc8e29', 'expiration_timestamp': '1763096488', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 07:01:30,594", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI4RjczMUJEOENENkIzQUUxQzMA', 'status': 'read', 'timestamp': '1763096489', 'recipient_id': '27763514028', 'conversation': {'id': 'ff52e998ae4980cf7eb62d971edc8e29', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 07:01:30,594", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI4RjczMUJEOENENkIzQUUxQzMA', 'status': 'delivered', 'timestamp': '1763096489', 'recipient_id': '27763514028', 'conversation': {'id': 'ff52e998ae4980cf7eb62d971edc8e29', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 07:01:51,207", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World!'}, 'wa_id': '27763514028'}], 'messages': [{'from': '27763514028', 'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgASGBQzQUQwMDUwODE2MjU5RDBGNzBBMwA=', 'timestamp': '1763096509', 'text': {'body': 'Hello'}, 'type': 'text'}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 07:01:51,208", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=text, media_id=none"}
{"asctime": "2025-11-14 07:01:51,208", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763514028"}
{"asctime": "2025-11-14 07:01:51,212", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 07:01:51,212", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 07:01:51,213", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 324.8s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-14 07:01:51,895", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 07:01:51,897", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763514028: Success"}
{"asctime": "2025-11-14 07:01:51,898", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "ROLLBACK"}
{"asctime": "2025-11-14 07:01:53,621", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '4397a82b-f416-4258-9539-a99a5b7b40b6', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763514028', 'wa_id': '27763514028'}], 'messages': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI3NUJFQzMzNDQ5NzVCRUFFQzAA'}]}}"}
{"asctime": "2025-11-14 07:01:54,873", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI3NUJFQzMzNDQ5NzVCRUFFQzAA', 'status': 'sent', 'timestamp': '1763096513', 'recipient_id': '27763514028', 'conversation': {'id': '0c953645cc25eaf27c7e3c17ddba5caf', 'expiration_timestamp': '1763096513', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 07:01:55,273", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI3NUJFQzMzNDQ5NzVCRUFFQzAA', 'status': 'read', 'timestamp': '1763096514', 'recipient_id': '27763514028', 'conversation': {'id': '0c953645cc25eaf27c7e3c17ddba5caf', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 07:01:55,306", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI3NUJFQzMzNDQ5NzVCRUFFQzAA', 'status': 'delivered', 'timestamp': '1763096514', 'recipient_id': '27763514028', 'conversation': {'id': '0c953645cc25eaf27c7e3c17ddba5caf', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 07:01:59,379", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World!'}, 'wa_id': '27763514028'}], 'messages': [{'from': '27763514028', 'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgASGBQzQURERTkzQzczOUI0QzdBOERBMAA=', 'timestamp': '1763096518', 'text': {'body': 'Hi'}, 'type': 'text'}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 07:01:59,379", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=text, media_id=none"}
{"asctime": "2025-11-14 07:01:59,379", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763514028"}
{"asctime": "2025-11-14 07:01:59,380", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 07:01:59,380", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 07:01:59,380", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 333s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-14 07:02:00,025", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 07:02:00,026", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763514028: Success"}
{"asctime": "2025-11-14 07:02:00,027", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "ROLLBACK"}
{"asctime": "2025-11-14 07:02:01,530", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '8ab7ed2e-5e64-4d7d-90d8-b2364a79a2e7', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763514028', 'wa_id': '27763514028'}], 'messages': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBIwOUEyMDJDRTBDRUFGMjNFQkEA'}]}}"}
{"asctime": "2025-11-14 07:02:02,675", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBIwOUEyMDJDRTBDRUFGMjNFQkEA', 'status': 'sent', 'timestamp': '1763096521', 'recipient_id': '27763514028', 'conversation': {'id': '3e5efb4a283be5a0b96e29bda16e1793', 'expiration_timestamp': '1763096521', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 07:02:03,310", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBIwOUEyMDJDRTBDRUFGMjNFQkEA', 'status': 'delivered', 'timestamp': '1763096522', 'recipient_id': '27763514028', 'conversation': {'id': '3e5efb4a283be5a0b96e29bda16e1793', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 07:02:03,494", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBIwOUEyMDJDRTBDRUFGMjNFQkEA', 'status': 'read', 'timestamp': '1763096522', 'recipient_id': '27763514028', 'conversation': {'id': '3e5efb4a283be5a0b96e29bda16e1793', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 07:02:49,770", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-11-14 07:02:58,120", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-11-14 07:02:58,120", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-11-14 07:02:58,140", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-11-14 07:02:58,140", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 07:02:58,140", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-11-14 07:02:58,140", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 07:02:58,141", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-11-14 07:02:58,141", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 07:02:58,141", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 07:02:58,142", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 07:02:58,142", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00011s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 07:02:58,144", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 07:02:58,144", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.00132s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 07:02:58,144", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 07:02:58,144", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001866s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 07:02:58,145", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 07:02:58,145", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00007s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 07:02:58,146", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 07:02:58,146", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0007175s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 07:02:58,146", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 07:02:58,146", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001261s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 07:02:58,147", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 07:02:58,147", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-11-14 07:02:58,147", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-11-14 07:02:58,147", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-11-14 07:03:17,112", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World!'}, 'wa_id': '27763514028'}], 'messages': [{'from': '27763514028', 'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgASGBQzQUNBNTYzQkM5NzcxNTQzOUM4RQA=', 'timestamp': '1763096595', 'text': {'body': 'Hi'}, 'type': 'text'}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 07:03:17,112", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=text, media_id=none"}
{"asctime": "2025-11-14 07:03:17,112", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763514028"}
{"asctime": "2025-11-14 07:03:17,121", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 07:03:17,125", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 07:03:17,125", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00035s] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-14 07:03:17,807", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 07:03:17,808", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763514028: Success"}
{"asctime": "2025-11-14 07:03:17,809", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "ROLLBACK"}
{"asctime": "2025-11-14 07:03:19,519", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': 'abd287b3-cb92-4066-993c-fe2991bd59f2', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763514028', 'wa_id': '27763514028'}], 'messages': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI0RDMwODZDRDA0MDhCMzNFQzIA'}]}}"}
{"asctime": "2025-11-14 07:03:20,635", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI0RDMwODZDRDA0MDhCMzNFQzIA', 'status': 'sent', 'timestamp': '1763096599', 'recipient_id': '27763514028', 'conversation': {'id': '491c217288834fa080f31f281161cffd', 'expiration_timestamp': '1763096599', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 07:03:21,113", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI0RDMwODZDRDA0MDhCMzNFQzIA', 'status': 'delivered', 'timestamp': '1763096600', 'recipient_id': '27763514028', 'conversation': {'id': '491c217288834fa080f31f281161cffd', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 07:03:21,627", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI0RDMwODZDRDA0MDhCMzNFQzIA', 'status': 'read', 'timestamp': '1763096600', 'recipient_id': '27763514028', 'conversation': {'id': '491c217288834fa080f31f281161cffd', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 07:03:30,710", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World!'}, 'wa_id': '27763514028'}], 'messages': [{'from': '27763514028', 'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgASGBQzQTk0RkY4OTUxMTdBQzU4NzI4MgA=', 'timestamp': '1763096609', 'text': {'body': '/complete'}, 'type': 'text'}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 07:03:30,710", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=text, media_id=none"}
{"asctime": "2025-11-14 07:03:30,710", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763514028"}
{"asctime": "2025-11-14 07:03:30,713", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 07:03:30,714", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 07:03:30,714", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 13.59s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-14 07:03:31,842", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 07:03:31,842", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763514028: Success"}
{"asctime": "2025-11-14 07:03:31,843", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "ROLLBACK"}
{"asctime": "2025-11-14 07:03:33,165", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': 'd70a0e36-a96e-4b21-ae2d-cca0017cfda1', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763514028', 'wa_id': '27763514028'}], 'messages': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBJGMkUxNzE5NzdENTMxQ0YyQzQA'}]}}"}
{"asctime": "2025-11-14 07:03:34,260", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBJGMkUxNzE5NzdENTMxQ0YyQzQA', 'status': 'sent', 'timestamp': '1763096613', 'recipient_id': '27763514028', 'conversation': {'id': '5cf02c0b40dc113db1089f58f8baffb5', 'expiration_timestamp': '1763096613', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 07:03:34,910", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBJGMkUxNzE5NzdENTMxQ0YyQzQA', 'status': 'delivered', 'timestamp': '1763096613', 'recipient_id': '27763514028', 'conversation': {'id': '5cf02c0b40dc113db1089f58f8baffb5', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 07:03:34,934", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBJGMkUxNzE5NzdENTMxQ0YyQzQA', 'status': 'read', 'timestamp': '1763096613', 'recipient_id': '27763514028', 'conversation': {'id': '5cf02c0b40dc113db1089f58f8baffb5', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 07:03:38,458", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World!'}, 'wa_id': '27763514028'}], 'messages': [{'from': '27763514028', 'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgASGBQzQTdCM0RFMzcwQTBCOEZGOUYwNQA=', 'timestamp': '1763096617', 'text': {'body': '\\\\complete'}, 'type': 'text'}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 07:03:38,459", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=text, media_id=none"}
{"asctime": "2025-11-14 07:03:38,459", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763514028"}
{"asctime": "2025-11-14 07:03:38,461", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 07:03:38,461", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 07:03:38,461", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 21.34s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-14 07:03:39,123", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 07:03:39,125", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763514028: Success"}
{"asctime": "2025-11-14 07:03:39,125", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "ROLLBACK"}
{"asctime": "2025-11-14 07:03:41,026", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': 'aa95351f-e8b1-4779-9995-2cf63b664129', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763514028', 'wa_id': '27763514028'}], 'messages': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBJERUJFNjZBOUY3NDVCNkQwREIA'}]}}"}
{"asctime": "2025-11-14 07:03:42,023", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBJERUJFNjZBOUY3NDVCNkQwREIA', 'status': 'sent', 'timestamp': '1763096621', 'recipient_id': '27763514028', 'conversation': {'id': 'fe70ff1cb426f76bb1035001934c63af', 'expiration_timestamp': '1763096621', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 07:03:42,618", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBJERUJFNjZBOUY3NDVCNkQwREIA', 'status': 'delivered', 'timestamp': '1763096621', 'recipient_id': '27763514028', 'conversation': {'id': 'fe70ff1cb426f76bb1035001934c63af', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 07:03:42,963", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBJERUJFNjZBOUY3NDVCNkQwREIA', 'status': 'read', 'timestamp': '1763096621', 'recipient_id': '27763514028', 'conversation': {'id': 'fe70ff1cb426f76bb1035001934c63af', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 07:05:11,599", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-11-14 07:05:12,439", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-11-14 07:05:12,440", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-11-14 07:05:12,458", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-11-14 07:05:12,458", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 07:05:12,459", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-11-14 07:05:12,459", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 07:05:12,459", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-11-14 07:05:12,459", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 07:05:12,459", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 07:05:12,460", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 07:05:12,461", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00011s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 07:05:12,462", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 07:05:12,462", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001774s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 07:05:12,463", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 07:05:12,463", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002215s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 07:05:12,463", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 07:05:12,463", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00007s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 07:05:12,464", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 07:05:12,464", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0005952s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 07:05:12,464", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 07:05:12,464", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.00106s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 07:05:12,465", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 07:05:12,465", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-11-14 07:05:12,465", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-11-14 07:05:12,465", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-11-14 07:05:20,243", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-11-14 07:05:23,073", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-11-14 07:05:23,073", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-11-14 07:05:23,086", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-11-14 07:05:23,086", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 07:05:23,086", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-11-14 07:05:23,086", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 07:05:23,087", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-11-14 07:05:23,087", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 07:05:23,087", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 07:05:23,088", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 07:05:23,088", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00009s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 07:05:23,090", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 07:05:23,090", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001965s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 07:05:23,090", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 07:05:23,090", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002376s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 07:05:23,091", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 07:05:23,091", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00007s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 07:05:23,092", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 07:05:23,092", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0004394s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 07:05:23,092", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 07:05:23,092", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001056s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 07:05:23,093", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 07:05:23,093", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-11-14 07:05:23,093", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-11-14 07:05:23,093", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-11-14 07:05:39,517", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World!'}, 'wa_id': '27763514028'}], 'messages': [{'from': '27763514028', 'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgASGBQzQTgzQUNEQUFCODU4N0I1NjRCMAA=', 'timestamp': '1763096738', 'text': {'body': '/complete'}, 'type': 'text'}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 07:05:39,517", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=text, media_id=none"}
{"asctime": "2025-11-14 07:05:39,518", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763514028"}
{"asctime": "2025-11-14 07:05:39,525", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 07:05:39,528", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 07:05:39,529", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00038s] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-14 07:05:40,266", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 07:05:40,268", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763514028: Success"}
{"asctime": "2025-11-14 07:05:40,268", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "ROLLBACK"}
{"asctime": "2025-11-14 07:05:41,939", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': 'ddc84fc2-90d5-4ddb-99c9-9261ec9a422a', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763514028', 'wa_id': '27763514028'}], 'messages': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBJFRUE1QjY3QjE3Q0IzODQ2RDAA'}]}}"}
{"asctime": "2025-11-14 07:05:43,156", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBJFRUE1QjY3QjE3Q0IzODQ2RDAA', 'status': 'sent', 'timestamp': '1763096741', 'recipient_id': '27763514028', 'conversation': {'id': 'eb8fce16648d165d62521ac753dc8c44', 'expiration_timestamp': '1763096741', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 07:05:43,468", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBJFRUE1QjY3QjE3Q0IzODQ2RDAA', 'status': 'delivered', 'timestamp': '1763096742', 'recipient_id': '27763514028', 'conversation': {'id': 'eb8fce16648d165d62521ac753dc8c44', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 07:05:43,780", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBJFRUE1QjY3QjE3Q0IzODQ2RDAA', 'status': 'read', 'timestamp': '1763096742', 'recipient_id': '27763514028', 'conversation': {'id': 'eb8fce16648d165d62521ac753dc8c44', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 07:05:47,806", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World!'}, 'wa_id': '27763514028'}], 'messages': [{'from': '27763514028', 'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgASGBQzQTE3NENERTcyNzIzRTI5REE2NQA=', 'timestamp': '1763096746', 'text': {'body': '/complete'}, 'type': 'text'}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 07:05:47,806", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=text, media_id=none"}
{"asctime": "2025-11-14 07:05:47,806", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763514028"}
{"asctime": "2025-11-14 07:05:47,808", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 07:05:47,808", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 07:05:47,808", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 8.28s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-14 07:05:48,471", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 07:05:48,473", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763514028: Success"}
{"asctime": "2025-11-14 07:05:48,473", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "ROLLBACK"}
{"asctime": "2025-11-14 07:05:50,315", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': 'dee8a0cf-fdd9-4be4-a0c6-bc208cb3277b', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763514028', 'wa_id': '27763514028'}], 'messages': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI4MEQwNTExRkYwMjhENDFDRjgA'}]}}"}
{"asctime": "2025-11-14 07:05:51,160", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI4MEQwNTExRkYwMjhENDFDRjgA', 'status': 'sent', 'timestamp': '1763096750', 'recipient_id': '27763514028', 'conversation': {'id': '7bda9c0e37574e6fcb9e80297518e573', 'expiration_timestamp': '1763096750', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 07:05:51,880", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI4MEQwNTExRkYwMjhENDFDRjgA', 'status': 'read', 'timestamp': '1763096750', 'recipient_id': '27763514028', 'conversation': {'id': '7bda9c0e37574e6fcb9e80297518e573', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 07:05:51,895", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI4MEQwNTExRkYwMjhENDFDRjgA', 'status': 'delivered', 'timestamp': '1763096750', 'recipient_id': '27763514028', 'conversation': {'id': '7bda9c0e37574e6fcb9e80297518e573', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 07:09:12,947", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-11-14 07:09:18,559", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-11-14 07:09:18,559", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-11-14 07:09:18,576", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-11-14 07:09:18,576", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 07:09:18,577", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-11-14 07:09:18,577", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 07:09:18,577", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-11-14 07:09:18,577", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 07:09:18,577", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 07:09:18,579", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 07:09:18,579", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00009s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 07:09:18,580", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 07:09:18,581", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.00203s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 07:09:18,581", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 07:09:18,581", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002442s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 07:09:18,582", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 07:09:18,582", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00007s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 07:09:18,582", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 07:09:18,582", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0006903s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 07:09:18,583", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 07:09:18,583", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001173s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 07:09:18,583", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 07:09:18,583", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-11-14 07:09:18,584", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-11-14 07:09:18,584", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-11-14 07:09:31,569", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World!'}, 'wa_id': '27763514028'}], 'messages': [{'from': '27763514028', 'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgASGBQzQUEwQzFEQUU5RjgxRDcwNEYwMwA=', 'timestamp': '1763096969', 'text': {'body': 'Hi'}, 'type': 'text'}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 07:09:31,569", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=text, media_id=none"}
{"asctime": "2025-11-14 07:09:31,570", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763514028"}
{"asctime": "2025-11-14 07:09:31,580", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 07:09:31,583", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 07:09:31,583", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00035s] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-14 07:09:31,603", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO users (id, phone_number, email, whatsapp_name, first_name, last_name, id_number, date_of_birth, nationality, address_line1, address_line2, city, province, postal_code, country, account_number, balance, status, pin_hash, pin_attempts, pin_locked_until, is_phone_verified, is_email_verified, is_id_verified, is_address_verified, is_fica_compliant, id_document_url, proof_of_residence_url, selfie_url, daily_limit, monthly_limit, daily_spent, monthly_spent, last_daily_reset, last_monthly_reset, preferred_language, notification_enabled, marketing_consent, user_metadata, referral_code, referred_by, created_at, updated_at, last_active_at, verified_at) VALUES (%(id)s::UUID, %(phone_number)s, %(email)s, %(whatsapp_name)s, %(first_name)s, %(last_name)s, %(id_number)s, %(date_of_birth)s, %(nationality)s, %(address_line1)s, %(address_line2)s, %(city)s, %(province)s, %(postal_code)s, %(country)s, %(account_number)s, %(balance)s, %(status)s, %(pin_hash)s, %(pin_attempts)s, %(pin_locked_until)s, %(is_phone_verified)s, %(is_email_verified)s, %(is_id_verified)s, %(is_address_verified)s, %(is_fica_compliant)s, %(id_document_url)s, %(proof_of_residence_url)s, %(selfie_url)s, %(daily_limit)s, %(monthly_limit)s, %(daily_spent)s, %(monthly_spent)s, now(), now(), %(preferred_language)s, %(notification_enabled)s, %(marketing_consent)s, %(user_metadata)s, %(referral_code)s, %(referred_by)s::UUID, now(), now(), now(), %(verified_at)s) RETURNING users.last_daily_reset, users.last_monthly_reset, users.created_at, users.updated_at, users.last_active_at"}
{"asctime": "2025-11-14 07:09:31,603", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00058s] {'id': UUID('a2a6c247-f016-40ad-bc67-b8cc3f4dbaf1'), 'phone_number': '+27763514028', 'email': None, 'whatsapp_name': 'Hello World!', 'first_name': None, 'last_name': None, 'id_number': None, 'date_of_birth': None, 'nationality': None, 'address_line1': None, 'address_line2': None, 'city': None, 'province': None, 'postal_code': None, 'country': 'South Africa', 'account_number': None, 'balance': 0.0, 'status': 'PENDING_VERIFICATION', 'pin_hash': None, 'pin_attempts': 0, 'pin_locked_until': None, 'is_phone_verified': False, 'is_email_verified': False, 'is_id_verified': False, 'is_address_verified': False, 'is_fica_compliant': False, 'id_document_url': None, 'proof_of_residence_url': None, 'selfie_url': None, 'daily_limit': 25000.0, 'monthly_limit': 100000.0, 'daily_spent': 0.0, 'monthly_spent': 0.0, 'preferred_language': 'en', 'notification_enabled': True, 'marketing_consent': False, 'user_metadata': '{}', 'referral_code': None, 'referred_by': None, 'verified_at': None}"}
{"asctime": "2025-11-14 07:09:31,605", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 07:09:31,606", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 07:09:31,607", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id, users.phone_number, users.email, users.whatsapp_name, users.first_name, users.last_name, users.id_number, users.date_of_birth, users.nationality, users.address_line1, users.address_line2, users.city, users.province, users.postal_code, users.country, users.account_number, users.balance, users.status, users.pin_hash, users.pin_attempts, users.pin_locked_until, users.is_phone_verified, users.is_email_verified, users.is_id_verified, users.is_address_verified, users.is_fica_compliant, users.id_document_url, users.proof_of_residence_url, users.selfie_url, users.daily_limit, users.monthly_limit, users.daily_spent, users.monthly_spent, users.last_daily_reset, users.last_monthly_reset, users.preferred_language, users.notification_enabled, users.marketing_consent, users.user_metadata, users.referral_code, users.referred_by, users.created_at, users.updated_at, users.last_active_at, users.verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-14 07:09:31,607", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00012s] {'pk_1': UUID('a2a6c247-f016-40ad-bc67-b8cc3f4dbaf1')}"}
{"asctime": "2025-11-14 07:09:33,800", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 07:09:33,802", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Buttons sent to 27763514028: Success"}
{"asctime": "2025-11-14 07:09:33,803", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "ROLLBACK"}
{"asctime": "2025-11-14 07:09:35,856", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '097669ba-4eba-4249-9b1f-b420f2999b74', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763514028', 'wa_id': '27763514028'}], 'messages': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI2QTBEREM3OTlEQjVFQkM0NDEA'}]}}"}
{"asctime": "2025-11-14 07:09:36,584", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI2QTBEREM3OTlEQjVFQkM0NDEA', 'status': 'sent', 'timestamp': '1763096975', 'recipient_id': '27763514028', 'conversation': {'id': '203a9e8ccfbad2b0e4fe3c22d204f053', 'expiration_timestamp': '1763096975', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 07:09:37,314", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI2QTBEREM3OTlEQjVFQkM0NDEA', 'status': 'delivered', 'timestamp': '1763096976', 'recipient_id': '27763514028', 'conversation': {'id': '203a9e8ccfbad2b0e4fe3c22d204f053', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 07:09:37,445", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI2QTBEREM3OTlEQjVFQkM0NDEA', 'status': 'read', 'timestamp': '1763096976', 'recipient_id': '27763514028', 'conversation': {'id': '203a9e8ccfbad2b0e4fe3c22d204f053', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 07:40:27,254", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI4MjJCN0IyNjRBNTYwQzZFMkUA', 'status': 'sent', 'timestamp': '1763098825', 'recipient_id': '27763514028', 'biz_opaque_callback_data': 'Mjc3NjkwMzQ0OTEuMjc3NjM1MTQwMjg=', 'conversation': {'id': '1c28d4490d1b601aaedbc1a3c925be68', 'expiration_timestamp': '1763098825', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 07:40:28,429", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI4MjJCN0IyNjRBNTYwQzZFMkUA', 'status': 'delivered', 'timestamp': '1763098827', 'recipient_id': '27763514028', 'biz_opaque_callback_data': 'Mjc3NjkwMzQ0OTEuMjc3NjM1MTQwMjg=', 'conversation': {'id': '1c28d4490d1b601aaedbc1a3c925be68', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 07:40:44,201", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI4MjJCN0IyNjRBNTYwQzZFMkUA', 'status': 'read', 'timestamp': '1763098842', 'recipient_id': '27763514028', 'biz_opaque_callback_data': 'Mjc3NjkwMzQ0OTEuMjc3NjM1MTQwMjg=', 'conversation': {'id': '1c28d4490d1b601aaedbc1a3c925be68', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 07:42:03,403", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World!'}, 'wa_id': '27763514028'}], 'messages': [{'context': {'from': '27769034491', 'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI4MjJCN0IyNjRBNTYwQzZFMkUA'}, 'from': '27763514028', 'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgASGBQzQUFDNzA3QTYwRjdBMDVCODQyMwA=', 'timestamp': '1763098921', 'type': 'interactive', 'interactive': {'type': 'nfm_reply', 'nfm_reply': {'response_json': '{\"screen_bhgdafhhfaffg__date_of_birth_2\":\"1993-12-17\",\"screen_bhgdafhhfaffg__referral_code_5\":\"Ok\",\"screen_bhgdafeeddghg__secure_pin_0\":\"1205\",\"screen_bhgdafhhfaffg__last_name_1\":\"Cole\",\"screen_bhgdafhhfaffg__select_id_type_3\":\"SA ID\",\"screen_bhgdafhhfaffg__first_name_0\":\"Kelvin\",\"flow_token\":\"9246a31f-0477-4150-8ed0-5b107e3f4971\",\"screen_bhgdafhhfaffg__id_number_4\":\"875784848797\",\"flow_uid\":\"6916b0d4438bb928d88ac3a2\"}', 'body': 'Sent', 'name': 'flow'}}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 07:42:03,406", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Button clicked: "}
{"asctime": "2025-11-14 07:42:03,406", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=interactive, media_id=none"}
{"asctime": "2025-11-14 07:42:03,406", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763514028"}
{"asctime": "2025-11-14 07:42:03,420", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 07:42:03,424", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 07:42:03,424", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 1952s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-14 07:42:04,342", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 07:42:04,344", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763514028: Success"}
{"asctime": "2025-11-14 07:42:04,345", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "ROLLBACK"}
{"asctime": "2025-11-14 07:42:05,902", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '753687cb-4f1b-49a7-8861-24ecf8e6f4a8', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763514028', 'wa_id': '27763514028'}], 'messages': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBIzRUYxMzYyRjgwRDZFQjhENkUA'}]}}"}
{"asctime": "2025-11-14 07:42:07,542", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBIzRUYxMzYyRjgwRDZFQjhENkUA', 'status': 'sent', 'timestamp': '1763098925', 'recipient_id': '27763514028', 'conversation': {'id': 'a8575c22ea24d59b7d65b3b168d3b275', 'expiration_timestamp': '1763098925', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 07:42:07,604", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBIzRUYxMzYyRjgwRDZFQjhENkUA', 'status': 'delivered', 'timestamp': '1763098926', 'recipient_id': '27763514028', 'conversation': {'id': 'a8575c22ea24d59b7d65b3b168d3b275', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 07:42:11,548", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBIzRUYxMzYyRjgwRDZFQjhENkUA', 'status': 'read', 'timestamp': '1763098930', 'recipient_id': '27763514028', 'conversation': {'id': 'a8575c22ea24d59b7d65b3b168d3b275', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 07:49:11,896", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World'}, 'wa_id': '27763024044'}], 'messages': [{'from': '27763024044', 'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQUE4NTEwNzM4OTExQkYyNTI0MwA=', 'timestamp': '1763099350', 'text': {'body': 'Hi'}, 'type': 'text'}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 07:49:11,898", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=text, media_id=none"}
{"asctime": "2025-11-14 07:49:11,898", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763024044"}
{"asctime": "2025-11-14 07:49:11,910", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 07:49:11,912", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 07:49:11,913", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 2380s ago] {'phone_number_1': '+27763024044', 'param_1': 1}"}
{"asctime": "2025-11-14 07:49:11,933", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-14 07:49:11,933", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00024s] {'last_active_at': datetime.datetime(2025, 11, 14, 5, 49, 11, 919182), 'users_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-14 07:49:11,936", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 07:49:11,938", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 07:49:11,939", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-14 07:49:11,939", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00016s] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-14 07:49:11,942", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-14 07:49:11,942", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00027s] {'id': UUID('f9df6b16-1e93-4000-a33e-e7d3b69ba15d'), 'user_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'phone_number': '+27763024044', 'message_id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQUE4NTEwNzM4OTExQkYyNTI0MwA=', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'Hi', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-14 07:49:11,945", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 07:49:11,946", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 07:49:11,946", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-14 07:49:11,946", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.007328s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-14 07:49:11,948", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 07:49:11,948", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00014s] {'user_id_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'param_1': 5}"}
{"asctime": "2025-11-14 07:49:14,031", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 07:49:14,041", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-14 07:49:14,042", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00070s] {'pk_1': UUID('f9df6b16-1e93-4000-a33e-e7d3b69ba15d')}"}
{"asctime": "2025-11-14 07:49:14,044", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-14 07:49:14,044", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00032s] {'ai_response': 'Hello again! How can I help you today? \ud83d\ude0a', 'intent_detected': 'greeting', 'entities_extracted': '{}', 'confidence_score': 0.95, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 14, 5, 49, 14, 38095), 'conversations_id': UUID('f9df6b16-1e93-4000-a33e-e7d3b69ba15d')}"}
{"asctime": "2025-11-14 07:49:14,045", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 07:49:14,799", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 07:49:14,800", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763024044: Success"}
{"asctime": "2025-11-14 07:49:16,183", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '1a287fa1-7396-48b6-83cb-df85c1a29efc', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763024044', 'wa_id': '27763024044'}], 'messages': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI2MEUzMERGNjY4NkREMzBFRTMA'}]}}"}
{"asctime": "2025-11-14 07:49:17,592", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI2MEUzMERGNjY4NkREMzBFRTMA', 'status': 'delivered', 'timestamp': '1763099356', 'recipient_id': '27763024044', 'conversation': {'id': 'd0d42b8f80aa69b82ba9c8ab849609af', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 07:49:17,848", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI2MEUzMERGNjY4NkREMzBFRTMA', 'status': 'sent', 'timestamp': '1763099356', 'recipient_id': '27763024044', 'conversation': {'id': 'd0d42b8f80aa69b82ba9c8ab849609af', 'expiration_timestamp': '1763099356', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 07:49:20,091", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBI2MEUzMERGNjY4NkREMzBFRTMA', 'status': 'read', 'timestamp': '1763099359', 'recipient_id': '27763024044', 'conversation': {'id': 'd0d42b8f80aa69b82ba9c8ab849609af', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 07:49:32,068", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World'}, 'wa_id': '27763024044'}], 'messages': [{'from': '27763024044', 'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQUYxNzlDRDhFMUU1MjQxRjE2QwA=', 'timestamp': '1763099370', 'text': {'body': 'Do I have a transaction history ?'}, 'type': 'text'}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 07:49:32,069", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=text, media_id=none"}
{"asctime": "2025-11-14 07:49:32,069", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763024044"}
{"asctime": "2025-11-14 07:49:32,070", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 07:49:32,071", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 07:49:32,071", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 2400s ago] {'phone_number_1': '+27763024044', 'param_1': 1}"}
{"asctime": "2025-11-14 07:49:32,073", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-14 07:49:32,073", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 20.14s ago] {'last_active_at': datetime.datetime(2025, 11, 14, 5, 49, 32, 72799), 'users_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-14 07:49:32,074", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 07:49:32,075", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 07:49:32,076", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-14 07:49:32,076", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 20.14s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-14 07:49:32,077", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-14 07:49:32,078", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 20.14s ago] {'id': UUID('ed601612-3bb7-40ad-bfc4-39fc7713bbcf'), 'user_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'phone_number': '+27763024044', 'message_id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQUYxNzlDRDhFMUU1MjQxRjE2QwA=', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'Do I have a transaction history ?', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-14 07:49:32,079", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 07:49:32,080", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 07:49:32,080", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-14 07:49:32,081", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 20.14s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-14 07:49:32,082", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 07:49:32,082", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 20.13s ago] {'user_id_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'param_1': 5}"}
{"asctime": "2025-11-14 07:49:34,826", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 07:49:34,833", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-14 07:49:34,833", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 20.79s ago] {'pk_1': UUID('ed601612-3bb7-40ad-bfc4-39fc7713bbcf')}"}
{"asctime": "2025-11-14 07:49:34,835", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-14 07:49:34,835", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 20.79s ago] {'ai_response': \"You currently have a wallet balance of R0.00, so it seems there are no transactions in your history. If there's anything else you need, just let me know!\", 'intent_detected': 'transaction_history', 'entities_extracted': '{}', 'confidence_score': 0.9, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 14, 5, 49, 34, 831515), 'conversations_id': UUID('ed601612-3bb7-40ad-bfc4-39fc7713bbcf')}"}
{"asctime": "2025-11-14 07:49:34,836", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 07:49:35,627", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 07:49:35,628", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763024044: Success"}
{"asctime": "2025-11-14 07:49:37,120", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '70139c13-3b67-4bb1-9980-aa1912723b24', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763024044', 'wa_id': '27763024044'}], 'messages': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBIzODhCRUY1ODY1RkRBRTY0QUUA'}]}}"}
{"asctime": "2025-11-14 07:49:38,142", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBIzODhCRUY1ODY1RkRBRTY0QUUA', 'status': 'sent', 'timestamp': '1763099377', 'recipient_id': '27763024044', 'conversation': {'id': '711556dffd5b2bd10d147e42c5e9a826', 'expiration_timestamp': '1763099377', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 07:49:38,663", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBIzODhCRUY1ODY1RkRBRTY0QUUA', 'status': 'delivered', 'timestamp': '1763099377', 'recipient_id': '27763024044', 'conversation': {'id': '711556dffd5b2bd10d147e42c5e9a826', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 07:49:39,104", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBIzODhCRUY1ODY1RkRBRTY0QUUA', 'status': 'read', 'timestamp': '1763099377', 'recipient_id': '27763024044', 'conversation': {'id': '711556dffd5b2bd10d147e42c5e9a826', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 07:49:53,315", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World'}, 'wa_id': '27763024044'}], 'messages': [{'from': '27763024044', 'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQTJFMjYyRkYwMzRGRUEyMTlBOAA=', 'timestamp': '1763099392', 'text': {'body': 'Do I have beneficiaries?'}, 'type': 'text'}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 07:49:53,317", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=text, media_id=none"}
{"asctime": "2025-11-14 07:49:53,317", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763024044"}
{"asctime": "2025-11-14 07:49:53,320", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 07:49:53,321", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 07:49:53,321", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 2422s ago] {'phone_number_1': '+27763024044', 'param_1': 1}"}
{"asctime": "2025-11-14 07:49:53,324", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-14 07:49:53,325", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 41.39s ago] {'last_active_at': datetime.datetime(2025, 11, 14, 5, 49, 53, 324194), 'users_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-14 07:49:53,325", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 07:49:53,327", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 07:49:53,327", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-14 07:49:53,327", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 41.39s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-14 07:49:53,329", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-14 07:49:53,329", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 41.39s ago] {'id': UUID('a42f8435-0dc9-4e60-91b8-876cedd3e6a7'), 'user_id': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'phone_number': '+27763024044', 'message_id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgASGBQzQTJFMjYyRkYwMzRGRUEyMTlBOAA=', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'Do I have beneficiaries?', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-14 07:49:53,331", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 07:49:53,332", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 07:49:53,332", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-14 07:49:53,332", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 41.39s ago] {'pk_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51')}"}
{"asctime": "2025-11-14 07:49:53,334", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 07:49:53,335", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 41.39s ago] {'user_id_1': UUID('b1fc0bb7-5230-4b23-949d-44d2d5f7bb51'), 'param_1': 5}"}
{"asctime": "2025-11-14 07:49:55,404", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 07:49:55,411", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-14 07:49:55,412", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 41.37s ago] {'pk_1': UUID('a42f8435-0dc9-4e60-91b8-876cedd3e6a7')}"}
{"asctime": "2025-11-14 07:49:55,413", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-14 07:49:55,414", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 41.37s ago] {'ai_response': \"I can't check for beneficiaries right now, but I can help you with buying airtime, data bundles, or paying electricity bills. Let me know what you need!\", 'intent_detected': 'conversation', 'entities_extracted': '{}', 'confidence_score': 0.7, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 14, 5, 49, 55, 409668), 'conversations_id': UUID('a42f8435-0dc9-4e60-91b8-876cedd3e6a7')}"}
{"asctime": "2025-11-14 07:49:55,414", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 07:49:56,092", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 07:49:56,093", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763024044: Success"}
{"asctime": "2025-11-14 07:49:57,387", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': 'f3cfd7df-a9c8-464a-bee5-85cf735b1f81', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763024044', 'wa_id': '27763024044'}], 'messages': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJCMjRDRDgzODg5ODlFNzIwQ0QA'}]}}"}
{"asctime": "2025-11-14 07:49:58,605", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJCMjRDRDgzODg5ODlFNzIwQ0QA', 'status': 'sent', 'timestamp': '1763099397', 'recipient_id': '27763024044', 'conversation': {'id': 'f0244ff4289b56e031622a2d984762c6', 'expiration_timestamp': '1763099397', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 07:49:58,785", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJCMjRDRDgzODg5ODlFNzIwQ0QA', 'status': 'delivered', 'timestamp': '1763099397', 'recipient_id': '27763024044', 'conversation': {'id': 'f0244ff4289b56e031622a2d984762c6', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 07:49:59,065", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjMwMjQwNDQVAgARGBJCMjRDRDgzODg5ODlFNzIwQ0QA', 'status': 'read', 'timestamp': '1763099398', 'recipient_id': '27763024044', 'conversation': {'id': 'f0244ff4289b56e031622a2d984762c6', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 07:50:47,460", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World!'}, 'wa_id': '27763514028'}], 'messages': [{'context': {'from': '27769034491', 'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI2QTBEREM3OTlEQjVFQkM0NDEA'}, 'from': '27763514028', 'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgASGBQzQTE0MkJEOEVENjM1QzJERTk2MQA=', 'timestamp': '1763099446', 'type': 'interactive', 'interactive': {'type': 'button_reply', 'button_reply': {'id': 'yes', 'title': '\u2705 Yes, Register'}}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 07:50:47,462", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Button clicked: yes"}
{"asctime": "2025-11-14 07:50:47,462", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=interactive, media_id=none"}
{"asctime": "2025-11-14 07:50:47,463", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763514028"}
{"asctime": "2025-11-14 07:50:47,466", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 07:50:47,466", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 07:50:47,467", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 2476s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-14 07:50:48,150", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 07:50:48,152", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763514028: Success"}
{"asctime": "2025-11-14 07:50:48,153", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "ROLLBACK"}
{"asctime": "2025-11-14 07:50:49,493", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '334816b6-a517-4725-b700-af282cea9040', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763514028', 'wa_id': '27763514028'}], 'messages': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBIwMDg3RUNGRTFFODM2Njg1REEA'}]}}"}
{"asctime": "2025-11-14 07:50:50,634", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBIwMDg3RUNGRTFFODM2Njg1REEA', 'status': 'sent', 'timestamp': '1763099449', 'recipient_id': '27763514028', 'conversation': {'id': '42b61cc6fd6dc092373cf539a473d7de', 'expiration_timestamp': '1763099449', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 07:50:51,195", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBIwMDg3RUNGRTFFODM2Njg1REEA', 'status': 'delivered', 'timestamp': '1763099450', 'recipient_id': '27763514028', 'conversation': {'id': '42b61cc6fd6dc092373cf539a473d7de', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 07:50:51,226", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBIwMDg3RUNGRTFFODM2Njg1REEA', 'status': 'read', 'timestamp': '1763099450', 'recipient_id': '27763514028', 'conversation': {'id': '42b61cc6fd6dc092373cf539a473d7de', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 13:29:35,838", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-11-14 13:29:36,528", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-11-14 13:29:36,528", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-11-14 13:29:36,555", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-11-14 13:29:36,555", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 13:29:36,556", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-11-14 13:29:36,556", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 13:29:36,556", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-11-14 13:29:36,556", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 13:29:36,556", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 13:29:36,557", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 13:29:36,557", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00009s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 13:29:36,559", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 13:29:36,559", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002073s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 13:29:36,560", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 13:29:36,560", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002476s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 13:29:36,560", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 13:29:36,560", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00007s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 13:29:36,561", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 13:29:36,561", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0009152s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 13:29:36,562", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 13:29:36,562", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0013s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 13:29:36,562", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 13:29:36,562", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-11-14 13:29:36,562", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-11-14 13:29:36,562", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-11-14 13:29:58,413", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-11-14 13:29:58,959", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-11-14 13:29:58,959", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-11-14 13:29:58,980", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-11-14 13:29:58,980", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 13:29:58,981", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-11-14 13:29:58,981", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 13:29:58,981", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-11-14 13:29:58,981", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 13:29:58,982", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 13:29:58,983", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 13:29:58,983", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00012s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 13:29:58,984", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 13:29:58,984", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001412s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 13:29:58,985", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 13:29:58,985", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001869s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 13:29:58,985", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 13:29:58,986", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00007s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 13:29:58,986", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 13:29:58,986", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0007716s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 13:29:58,987", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 13:29:58,987", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001352s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 13:29:58,987", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 13:29:58,987", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-11-14 13:29:58,987", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-11-14 13:29:58,987", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-11-14 13:30:18,972", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World!'}, 'wa_id': '27763514028'}], 'messages': [{'from': '27763514028', 'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgASGBQzQTdBREM5MTIzMjQwQzc0NzYxMwA=', 'timestamp': '1763119816', 'text': {'body': 'Hi'}, 'type': 'text'}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 13:30:18,973", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=text, media_id=none"}
{"asctime": "2025-11-14 13:30:18,973", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763514028"}
{"asctime": "2025-11-14 13:30:18,981", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 13:30:18,984", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 13:30:18,985", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00034s] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-14 13:30:19,776", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 13:30:19,777", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763514028: Success"}
{"asctime": "2025-11-14 13:30:19,777", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "ROLLBACK"}
{"asctime": "2025-11-14 13:30:21,743", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '395bbdbe-61f8-4fdd-9f79-a2f6b51171e8', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763514028', 'wa_id': '27763514028'}], 'messages': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBJCODREQTM1NzY5MUVBRTZBQkMA'}]}}"}
{"asctime": "2025-11-14 13:30:22,893", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBJCODREQTM1NzY5MUVBRTZBQkMA', 'status': 'sent', 'timestamp': '1763119821', 'recipient_id': '27763514028', 'conversation': {'id': 'f5a83cd0e92a6db2991bc3cc07cfefb9', 'expiration_timestamp': '1763119821', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 13:30:23,612", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBJCODREQTM1NzY5MUVBRTZBQkMA', 'status': 'delivered', 'timestamp': '1763119822', 'recipient_id': '27763514028', 'conversation': {'id': 'f5a83cd0e92a6db2991bc3cc07cfefb9', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 13:30:23,702", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBJCODREQTM1NzY5MUVBRTZBQkMA', 'status': 'read', 'timestamp': '1763119822', 'recipient_id': '27763514028', 'conversation': {'id': 'f5a83cd0e92a6db2991bc3cc07cfefb9', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 13:30:29,991", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World!'}, 'wa_id': '27763514028'}], 'messages': [{'from': '27763514028', 'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgASGBQzQTQxMjUxOEU0QThGRTlBNDUzNQA=', 'timestamp': '1763119828', 'text': {'body': 'I wanna Register'}, 'type': 'text'}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 13:30:29,992", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=text, media_id=none"}
{"asctime": "2025-11-14 13:30:29,992", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763514028"}
{"asctime": "2025-11-14 13:30:29,993", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 13:30:29,994", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 13:30:29,994", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 11.01s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-14 13:30:30,808", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 13:30:30,810", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763514028: Success"}
{"asctime": "2025-11-14 13:30:30,811", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "ROLLBACK"}
{"asctime": "2025-11-14 13:30:32,372", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '2f608ea3-c0b8-48f8-a31f-e39f5726f6f8', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763514028', 'wa_id': '27763514028'}], 'messages': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBIzQUQ0MTY4RTlFRkJCMkIwNjkA'}]}}"}
{"asctime": "2025-11-14 13:30:33,499", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBIzQUQ0MTY4RTlFRkJCMkIwNjkA', 'status': 'sent', 'timestamp': '1763119832', 'recipient_id': '27763514028', 'conversation': {'id': '18f59431f3e12c8dbca5ab1160541798', 'expiration_timestamp': '1763119832', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 13:30:34,262", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBIzQUQ0MTY4RTlFRkJCMkIwNjkA', 'status': 'read', 'timestamp': '1763119832', 'recipient_id': '27763514028', 'conversation': {'id': '18f59431f3e12c8dbca5ab1160541798', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 13:30:34,275", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBIzQUQ0MTY4RTlFRkJCMkIwNjkA', 'status': 'delivered', 'timestamp': '1763119832', 'recipient_id': '27763514028', 'conversation': {'id': '18f59431f3e12c8dbca5ab1160541798', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 13:30:39,298", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World!'}, 'wa_id': '27763514028'}], 'messages': [{'from': '27763514028', 'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgASGBQzQTFGNjU2OTZDMjUyREU5MkJEMQA=', 'timestamp': '1763119837', 'text': {'body': 'Register'}, 'type': 'text'}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 13:30:39,299", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=text, media_id=none"}
{"asctime": "2025-11-14 13:30:39,299", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763514028"}
{"asctime": "2025-11-14 13:30:39,301", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 13:30:39,301", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 13:30:39,302", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 20.33s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-14 13:30:40,279", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 13:30:40,280", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763514028: Success"}
{"asctime": "2025-11-14 13:30:40,281", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "ROLLBACK"}
{"asctime": "2025-11-14 13:30:41,728", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': 'df6168db-48c3-43c3-9bb8-68c3e3b535de', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763514028', 'wa_id': '27763514028'}], 'messages': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBJGRjczNDk4NzIzQzU5NDQ0MTgA'}]}}"}
{"asctime": "2025-11-14 13:30:42,791", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBJGRjczNDk4NzIzQzU5NDQ0MTgA', 'status': 'sent', 'timestamp': '1763119841', 'recipient_id': '27763514028', 'conversation': {'id': 'ae100f3380a3b50051e8adc878daf1f1', 'expiration_timestamp': '1763119841', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 13:30:43,405", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBJGRjczNDk4NzIzQzU5NDQ0MTgA', 'status': 'delivered', 'timestamp': '1763119842', 'recipient_id': '27763514028', 'conversation': {'id': 'ae100f3380a3b50051e8adc878daf1f1', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 13:30:43,566", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBJGRjczNDk4NzIzQzU5NDQ0MTgA', 'status': 'read', 'timestamp': '1763119842', 'recipient_id': '27763514028', 'conversation': {'id': 'ae100f3380a3b50051e8adc878daf1f1', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 13:31:17,204", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World!'}, 'wa_id': '27763514028'}], 'messages': [{'from': '27763514028', 'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgASGBQzQTAzRDJGMEI4QkMwNjNBOTU0RgA=', 'timestamp': '1763119875', 'text': {'body': 'Register Kevin Cole  9001011234567'}, 'type': 'text'}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 13:31:17,205", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=text, media_id=none"}
{"asctime": "2025-11-14 13:31:17,205", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763514028"}
{"asctime": "2025-11-14 13:31:17,207", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 13:31:17,207", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 13:31:17,207", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 58.24s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-14 13:31:17,209", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 13:31:17,209", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 58.25s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-14 13:31:17,212", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id_number = %(id_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 13:31:17,213", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00044s] {'id_number_1': '9001011234567', 'param_1': 1}"}
{"asctime": "2025-11-14 13:31:18,240", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 13:31:18,241", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763514028: Success"}
{"asctime": "2025-11-14 13:31:18,241", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "ROLLBACK"}
{"asctime": "2025-11-14 13:31:20,165", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '5220cf7e-5dd9-4cd3-9159-fc90c8ca4c1d', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763514028', 'wa_id': '27763514028'}], 'messages': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI2ODEwMTQ1MDcwRjEwN0FBREYA'}]}}"}
{"asctime": "2025-11-14 13:31:20,866", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI2ODEwMTQ1MDcwRjEwN0FBREYA', 'status': 'sent', 'timestamp': '1763119879', 'recipient_id': '27763514028', 'conversation': {'id': '9d186f9b6d8e9b4e320cab451af395ac', 'expiration_timestamp': '1763119879', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 13:31:21,504", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI2ODEwMTQ1MDcwRjEwN0FBREYA', 'status': 'delivered', 'timestamp': '1763119880', 'recipient_id': '27763514028', 'conversation': {'id': '9d186f9b6d8e9b4e320cab451af395ac', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 13:31:21,555", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI2ODEwMTQ1MDcwRjEwN0FBREYA', 'status': 'read', 'timestamp': '1763119880', 'recipient_id': '27763514028', 'conversation': {'id': '9d186f9b6d8e9b4e320cab451af395ac', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 13:31:28,589", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World!'}, 'wa_id': '27763514028'}], 'messages': [{'from': '27763514028', 'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgASGBQzQUY0NEUxN0JEM0ZDMEJFNTk2RQA=', 'timestamp': '1763119887', 'text': {'body': 'Hello'}, 'type': 'text'}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 13:31:28,590", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=text, media_id=none"}
{"asctime": "2025-11-14 13:31:28,590", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763514028"}
{"asctime": "2025-11-14 13:31:28,592", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 13:31:28,592", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 13:31:28,592", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 69.63s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-14 13:31:29,675", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 13:31:29,676", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763514028: Success"}
{"asctime": "2025-11-14 13:31:29,676", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "ROLLBACK"}
{"asctime": "2025-11-14 13:31:31,555", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': 'a51116bd-3c10-497b-8a31-b80cca9e22cd', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763514028', 'wa_id': '27763514028'}], 'messages': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI1OUUxQjUxQzQ2QUE1RDkwMTgA'}]}}"}
{"asctime": "2025-11-14 13:31:32,500", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI1OUUxQjUxQzQ2QUE1RDkwMTgA', 'status': 'sent', 'timestamp': '1763119891', 'recipient_id': '27763514028', 'conversation': {'id': '4657da54b0bc354ba692dff4d269666b', 'expiration_timestamp': '1763119891', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 13:31:33,027", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI1OUUxQjUxQzQ2QUE1RDkwMTgA', 'status': 'delivered', 'timestamp': '1763119891', 'recipient_id': '27763514028', 'conversation': {'id': '4657da54b0bc354ba692dff4d269666b', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 13:31:33,178", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI1OUUxQjUxQzQ2QUE1RDkwMTgA', 'status': 'read', 'timestamp': '1763119891', 'recipient_id': '27763514028', 'conversation': {'id': '4657da54b0bc354ba692dff4d269666b', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 13:31:40,923", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World!'}, 'wa_id': '27763514028'}], 'messages': [{'from': '27763514028', 'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgASGBQzQTFENDNGRDE0MTE3NDFEQ0VGNAA=', 'timestamp': '1763119899', 'text': {'body': 'Register'}, 'type': 'text'}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 13:31:40,924", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=text, media_id=none"}
{"asctime": "2025-11-14 13:31:40,924", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763514028"}
{"asctime": "2025-11-14 13:31:40,926", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 13:31:40,926", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 13:31:40,926", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 81.96s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-14 13:31:42,160", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 13:31:42,161", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763514028: Success"}
{"asctime": "2025-11-14 13:31:42,162", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "ROLLBACK"}
{"asctime": "2025-11-14 13:31:45,147", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': 'b6a88f81-95b1-4855-a975-39d65684f08c', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763514028', 'wa_id': '27763514028'}], 'messages': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI0NDgyRDExNzBEQzJERTNGQTcA'}]}}"}
{"asctime": "2025-11-14 13:31:46,085", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI0NDgyRDExNzBEQzJERTNGQTcA', 'status': 'sent', 'timestamp': '1763119905', 'recipient_id': '27763514028', 'conversation': {'id': '9db82aa50bc525a1a826a7eb6a629f7a', 'expiration_timestamp': '1763119905', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 13:31:46,672", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI0NDgyRDExNzBEQzJERTNGQTcA', 'status': 'read', 'timestamp': '1763119905', 'recipient_id': '27763514028', 'conversation': {'id': '9db82aa50bc525a1a826a7eb6a629f7a', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 13:31:46,712", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI0NDgyRDExNzBEQzJERTNGQTcA', 'status': 'delivered', 'timestamp': '1763119905', 'recipient_id': '27763514028', 'conversation': {'id': '9db82aa50bc525a1a826a7eb6a629f7a', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 13:31:47,997", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World!'}, 'wa_id': '27763514028'}], 'messages': [{'from': '27763514028', 'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgASGBQzQUI5MEM4MzlENTMxMkQwRTNENgA=', 'timestamp': '1763119906', 'text': {'body': 'Register Kevin Cole  9001011234568'}, 'type': 'text'}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 13:31:47,998", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=text, media_id=none"}
{"asctime": "2025-11-14 13:31:47,999", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763514028"}
{"asctime": "2025-11-14 13:31:48,001", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 13:31:48,002", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 13:31:48,002", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 89.04s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-14 13:31:48,005", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 13:31:48,005", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 89.04s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-14 13:31:48,006", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id_number = %(id_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 13:31:48,007", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 30.79s ago] {'id_number_1': '9001011234568', 'param_1': 1}"}
{"asctime": "2025-11-14 13:31:48,017", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET first_name=%(first_name)s, last_name=%(last_name)s, id_number=%(id_number)s, date_of_birth=%(date_of_birth)s, status=%(status)s, is_phone_verified=%(is_phone_verified)s, is_id_verified=%(is_id_verified)s, is_fica_compliant=%(is_fica_compliant)s, updated_at=now(), verified_at=%(verified_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-14 13:31:48,017", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00063s] {'first_name': 'KEVIN', 'last_name': 'COLE', 'id_number': '9001011234568', 'date_of_birth': datetime.date(1990, 1, 1), 'status': 'ACTIVE', 'is_phone_verified': True, 'is_id_verified': True, 'is_fica_compliant': True, 'verified_at': datetime.datetime(2025, 11, 14, 13, 31, 48, 7738), 'users_id': UUID('a2a6c247-f016-40ad-bc67-b8cc3f4dbaf1')}"}
{"asctime": "2025-11-14 13:31:48,021", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 13:31:48,024", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 13:31:48,025", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id, users.phone_number, users.email, users.whatsapp_name, users.first_name, users.last_name, users.id_number, users.date_of_birth, users.nationality, users.address_line1, users.address_line2, users.city, users.province, users.postal_code, users.country, users.account_number, users.balance, users.status, users.pin_hash, users.pin_attempts, users.pin_locked_until, users.is_phone_verified, users.is_email_verified, users.is_id_verified, users.is_address_verified, users.is_fica_compliant, users.id_document_url, users.proof_of_residence_url, users.selfie_url, users.daily_limit, users.monthly_limit, users.daily_spent, users.monthly_spent, users.last_daily_reset, users.last_monthly_reset, users.preferred_language, users.notification_enabled, users.marketing_consent, users.user_metadata, users.referral_code, users.referred_by, users.created_at, users.updated_at, users.last_active_at, users.verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-14 13:31:48,025", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00017s] {'pk_1': UUID('a2a6c247-f016-40ad-bc67-b8cc3f4dbaf1')}"}
{"asctime": "2025-11-14 13:31:48,026", "name": "app.services.onboarding_service", "levelname": "INFO", "message": "User onboarded successfully: +27763514028"}
{"asctime": "2025-11-14 13:31:49,043", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 13:31:49,045", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763514028: Success"}
{"asctime": "2025-11-14 13:31:50,498", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': 'bdd5551d-d743-468f-9ed6-7d3c70c14e99', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763514028', 'wa_id': '27763514028'}], 'messages': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI0QjdBNzdDODA3QzhCMEZDQUUA'}]}}"}
{"asctime": "2025-11-14 13:31:51,589", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI0QjdBNzdDODA3QzhCMEZDQUUA', 'status': 'sent', 'timestamp': '1763119910', 'recipient_id': '27763514028', 'conversation': {'id': '796678ea6d3b6619943351a59ffcff07', 'expiration_timestamp': '1763119910', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 13:31:51,597", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 13:31:51,598", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Buttons sent to 27763514028: Success"}
{"asctime": "2025-11-14 13:31:51,599", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "ROLLBACK"}
{"asctime": "2025-11-14 13:31:52,106", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI0QjdBNzdDODA3QzhCMEZDQUUA', 'status': 'delivered', 'timestamp': '1763119910', 'recipient_id': '27763514028', 'conversation': {'id': '796678ea6d3b6619943351a59ffcff07', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 13:31:52,217", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI0QjdBNzdDODA3QzhCMEZDQUUA', 'status': 'read', 'timestamp': '1763119910', 'recipient_id': '27763514028', 'conversation': {'id': '796678ea6d3b6619943351a59ffcff07', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 13:31:53,178", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': 'ea43709e-0e41-462a-b8e3-1df9a0dafb08', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763514028', 'wa_id': '27763514028'}], 'messages': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBIyQ0I3QjhCREY5OTM3MDAyQUMA'}]}}"}
{"asctime": "2025-11-14 13:31:54,275", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBIyQ0I3QjhCREY5OTM3MDAyQUMA', 'status': 'sent', 'timestamp': '1763119913', 'recipient_id': '27763514028', 'conversation': {'id': '2b4c5b3af7565eda4df62f787bf0c133', 'expiration_timestamp': '1763119913', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 13:31:54,755", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBIyQ0I3QjhCREY5OTM3MDAyQUMA', 'status': 'delivered', 'timestamp': '1763119913', 'recipient_id': '27763514028', 'conversation': {'id': '2b4c5b3af7565eda4df62f787bf0c133', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 13:31:54,773", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBIyQ0I3QjhCREY5OTM3MDAyQUMA', 'status': 'read', 'timestamp': '1763119913', 'recipient_id': '27763514028', 'conversation': {'id': '2b4c5b3af7565eda4df62f787bf0c133', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 13:32:27,204", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World!'}, 'wa_id': '27763514028'}], 'messages': [{'context': {'from': '27769034491', 'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBIyQ0I3QjhCREY5OTM3MDAyQUMA'}, 'from': '27763514028', 'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgASGBQzQTNCQ0VFNDU3RjZFNDZGNUYxRQA=', 'timestamp': '1763119945', 'type': 'interactive', 'interactive': {'type': 'button_reply', 'button_reply': {'id': 'airtime', 'title': '\ud83d\udcf1 Buy Airtime'}}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 13:32:27,205", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Button clicked: airtime"}
{"asctime": "2025-11-14 13:32:27,205", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=interactive, media_id=none"}
{"asctime": "2025-11-14 13:32:27,205", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763514028"}
{"asctime": "2025-11-14 13:32:27,206", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 13:32:27,207", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 13:32:27,207", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 128.2s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-14 13:32:27,209", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-14 13:32:27,210", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00032s] {'last_active_at': datetime.datetime(2025, 11, 14, 11, 32, 27, 208797), 'users_id': UUID('a2a6c247-f016-40ad-bc67-b8cc3f4dbaf1')}"}
{"asctime": "2025-11-14 13:32:27,211", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 13:32:30,340", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 13:32:30,341", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763514028: Success"}
{"asctime": "2025-11-14 13:32:31,826", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '30b6d62a-ce0c-43db-8242-03623a396d07', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763514028', 'wa_id': '27763514028'}], 'messages': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI0RTc2NDY4MDcxODM4RTlBQjkA'}]}}"}
{"asctime": "2025-11-14 13:32:33,245", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI0RTc2NDY4MDcxODM4RTlBQjkA', 'status': 'sent', 'timestamp': '1763119951', 'recipient_id': '27763514028', 'conversation': {'id': '8879dfb29af69a2f5338c47e2a7c654a', 'expiration_timestamp': '1763119951', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 13:32:33,664", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI0RTc2NDY4MDcxODM4RTlBQjkA', 'status': 'read', 'timestamp': '1763119952', 'recipient_id': '27763514028', 'conversation': {'id': '8879dfb29af69a2f5338c47e2a7c654a', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 13:32:33,820", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI0RTc2NDY4MDcxODM4RTlBQjkA', 'status': 'delivered', 'timestamp': '1763119952', 'recipient_id': '27763514028', 'conversation': {'id': '8879dfb29af69a2f5338c47e2a7c654a', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 13:33:09,987", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World!'}, 'wa_id': '27763514028'}], 'messages': [{'from': '27763514028', 'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgASGBQzQUNGMzhDNEUyNzBEODFBOEExQgA=', 'timestamp': '1763119987', 'type': 'image', 'image': {'caption': 'Buy airtime for this number', 'mime_type': 'image/jpeg', 'sha256': 'izcIkzD1VEXfrg234VhfBUgQGAys1czDuxst3h1NcWM=', 'id': '1329411255601494'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 13:33:09,989", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=image, media_id=1329411255601494"}
{"asctime": "2025-11-14 13:33:09,989", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing image message from +27763514028"}
{"asctime": "2025-11-14 13:33:09,992", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 13:33:09,992", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 13:33:09,993", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 171s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-14 13:33:09,995", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-14 13:33:09,995", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 42.78s ago] {'last_active_at': datetime.datetime(2025, 11, 14, 11, 33, 9, 994953), 'users_id': UUID('a2a6c247-f016-40ad-bc67-b8cc3f4dbaf1')}"}
{"asctime": "2025-11-14 13:33:09,996", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 13:33:09,997", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Fetching media URL for ID: 1329411255601494"}
{"asctime": "2025-11-14 13:33:09,997", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Media URL constructed: https://crm.cyraxtechnologies.com/api/meta/v19.0/1329411255601494"}
{"asctime": "2025-11-14 13:33:11,708", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: GET https://crm.cyraxtechnologies.com/api/meta/v19.0/1329411255601494 \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 13:33:11,774", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Media downloaded: media/wamid.HBgLMjc3NjM1MTQwMjgVAgASGBQzQUNGMzhDNEUyNzBEODFBOEExQgA=.jpg"}
{"asctime": "2025-11-14 13:33:11,887", "name": "app.services.ai_service", "levelname": "INFO", "message": "Processing image: media/wamid.HBgLMjc3NjM1MTQwMjgVAgASGBQzQUNGMzhDNEUyNzBEODFBOEExQgA=.jpg with caption: Buy airtime for this number"}
{"asctime": "2025-11-14 13:33:35,356", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 13:33:35,359", "name": "app.services.ai_service", "levelname": "INFO", "message": "Image processed successfully: {\"type\": \"phone_number\", \"phone_number\": \"0769034491\", \"provider\": \"Unknown\", \"amount\": \"Unknown\", \"..."}
{"asctime": "2025-11-14 13:33:36,443", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 13:33:36,443", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Buttons sent to 27763514028: Success"}
{"asctime": "2025-11-14 13:33:37,876", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '57e51239-62a6-4a19-bda5-c150a66a5c1d', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763514028', 'wa_id': '27763514028'}], 'messages': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI4M0FGNzAzMkMxRTlDQjlFQUEA'}]}}"}
{"asctime": "2025-11-14 13:33:38,850", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI4M0FGNzAzMkMxRTlDQjlFQUEA', 'status': 'sent', 'timestamp': '1763120017', 'recipient_id': '27763514028', 'conversation': {'id': '503f5b2dcc7a51c8d380e438d4461fc5', 'expiration_timestamp': '1763120017', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 13:33:39,432", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI4M0FGNzAzMkMxRTlDQjlFQUEA', 'status': 'read', 'timestamp': '1763120018', 'recipient_id': '27763514028', 'conversation': {'id': '503f5b2dcc7a51c8d380e438d4461fc5', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 13:33:39,501", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI4M0FGNzAzMkMxRTlDQjlFQUEA', 'status': 'delivered', 'timestamp': '1763120018', 'recipient_id': '27763514028', 'conversation': {'id': '503f5b2dcc7a51c8d380e438d4461fc5', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 13:33:49,417", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World!'}, 'wa_id': '27763514028'}], 'messages': [{'context': {'from': '27769034491', 'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI4M0FGNzAzMkMxRTlDQjlFQUEA'}, 'from': '27763514028', 'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgASGBQzQTFCMEFDOUE0N0Y4N0VCNzEzQwA=', 'timestamp': '1763120027', 'type': 'interactive', 'interactive': {'type': 'button_reply', 'button_reply': {'id': 'yes', 'title': '\u2705 Yes'}}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 13:33:49,419", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Button clicked: yes"}
{"asctime": "2025-11-14 13:33:49,419", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=interactive, media_id=none"}
{"asctime": "2025-11-14 13:33:49,419", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763514028"}
{"asctime": "2025-11-14 13:33:49,421", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 13:33:49,422", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 13:33:49,422", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 210.5s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-14 13:33:49,428", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-14 13:33:49,428", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 82.22s ago] {'last_active_at': datetime.datetime(2025, 11, 14, 11, 33, 49, 427498), 'users_id': UUID('a2a6c247-f016-40ad-bc67-b8cc3f4dbaf1')}"}
{"asctime": "2025-11-14 13:33:49,429", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 13:33:52,007", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 13:33:52,008", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763514028: Success"}
{"asctime": "2025-11-14 13:33:53,601", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': 'bfbecaee-4aea-4fc8-b408-20903a760fea', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763514028', 'wa_id': '27763514028'}], 'messages': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI3MTlBNjJGQzk4MDA5MTk4MkMA'}]}}"}
{"asctime": "2025-11-14 13:33:54,581", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI3MTlBNjJGQzk4MDA5MTk4MkMA', 'status': 'sent', 'timestamp': '1763120033', 'recipient_id': '27763514028', 'conversation': {'id': '9d4b8e61ff73154013110a9e134b432e', 'expiration_timestamp': '1763120033', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 13:33:55,149", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI3MTlBNjJGQzk4MDA5MTk4MkMA', 'status': 'delivered', 'timestamp': '1763120034', 'recipient_id': '27763514028', 'conversation': {'id': '9d4b8e61ff73154013110a9e134b432e', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 13:33:55,437", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI3MTlBNjJGQzk4MDA5MTk4MkMA', 'status': 'read', 'timestamp': '1763120034', 'recipient_id': '27763514028', 'conversation': {'id': '9d4b8e61ff73154013110a9e134b432e', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 13:34:47,499", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World!'}, 'wa_id': '27763514028'}], 'messages': [{'from': '27763514028', 'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgASGBQzQTRGRUQyNTczRkY1MzM0OEZGNAA=', 'timestamp': '1763120085', 'text': {'body': 'Why didn\u2019t you ask me the amount for the airtime to send ?'}, 'type': 'text'}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 13:34:47,501", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=text, media_id=none"}
{"asctime": "2025-11-14 13:34:47,502", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763514028"}
{"asctime": "2025-11-14 13:34:47,507", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 13:34:47,508", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 13:34:47,508", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 268.5s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-14 13:34:47,511", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE users SET updated_at=now(), last_active_at=%(last_active_at)s WHERE users.id = %(users_id)s::UUID"}
{"asctime": "2025-11-14 13:34:47,512", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 140.3s ago] {'last_active_at': datetime.datetime(2025, 11, 14, 11, 34, 47, 510919), 'users_id': UUID('a2a6c247-f016-40ad-bc67-b8cc3f4dbaf1')}"}
{"asctime": "2025-11-14 13:34:47,514", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 13:34:47,517", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 13:34:47,520", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-14 13:34:47,521", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00069s] {'pk_1': UUID('a2a6c247-f016-40ad-bc67-b8cc3f4dbaf1')}"}
{"asctime": "2025-11-14 13:34:47,528", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO conversations (id, user_id, phone_number, message_id, message_type, direction, message_text, media_url, media_mime_type, ai_response, intent_detected, entities_extracted, confidence_score, processing_time_ms, conversation_context, session_id, is_processed, is_error, error_message, conversation_metadata, created_at, processed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(phone_number)s, %(message_id)s, %(message_type)s, %(direction)s, %(message_text)s, %(media_url)s, %(media_mime_type)s, %(ai_response)s, %(intent_detected)s, %(entities_extracted)s, %(confidence_score)s, %(processing_time_ms)s, %(conversation_context)s, %(session_id)s, %(is_processed)s, %(is_error)s, %(error_message)s, %(conversation_metadata)s, now(), %(processed_at)s) RETURNING conversations.created_at"}
{"asctime": "2025-11-14 13:34:47,529", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00053s] {'id': UUID('f866c6f2-4428-4012-856e-750d2f5b9403'), 'user_id': UUID('a2a6c247-f016-40ad-bc67-b8cc3f4dbaf1'), 'phone_number': '+27763514028', 'message_id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgASGBQzQTRGRUQyNTczRkY1MzM0OEZGNAA=', 'message_type': 'text', 'direction': 'inbound', 'message_text': 'Why didn\u2019t you ask me the amount for the airtime to send ?', 'media_url': None, 'media_mime_type': None, 'ai_response': None, 'intent_detected': None, 'entities_extracted': '{}', 'confidence_score': None, 'processing_time_ms': None, 'conversation_context': '{}', 'session_id': None, 'is_processed': False, 'is_error': False, 'error_message': None, 'conversation_metadata': '{}', 'processed_at': None}"}
{"asctime": "2025-11-14 13:34:47,532", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 13:34:47,540", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 13:34:47,540", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-14 13:34:47,540", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.02014s ago] {'pk_1': UUID('a2a6c247-f016-40ad-bc67-b8cc3f4dbaf1')}"}
{"asctime": "2025-11-14 13:34:47,544", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.ai_response AS conversations_ai_response, conversations.intent_detected AS conversations_intent_detected, conversations.entities_extracted AS conversations_entities_extracted, conversations.confidence_score AS conversations_confidence_score, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_processed AS conversations_is_processed, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at, conversations.processed_at AS conversations_processed_at \nFROM conversations \nWHERE conversations.user_id = %(user_id_1)s::UUID AND conversations.is_processed = true ORDER BY conversations.created_at DESC \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 13:34:47,545", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00016s] {'user_id_1': UUID('a2a6c247-f016-40ad-bc67-b8cc3f4dbaf1'), 'param_1': 5}"}
{"asctime": "2025-11-14 13:34:51,229", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://api.openai.com/v1/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 13:34:51,235", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT conversations.id AS conversations_id, conversations.user_id AS conversations_user_id, conversations.phone_number AS conversations_phone_number, conversations.message_id AS conversations_message_id, conversations.message_type AS conversations_message_type, conversations.direction AS conversations_direction, conversations.message_text AS conversations_message_text, conversations.media_url AS conversations_media_url, conversations.media_mime_type AS conversations_media_mime_type, conversations.processing_time_ms AS conversations_processing_time_ms, conversations.conversation_context AS conversations_conversation_context, conversations.session_id AS conversations_session_id, conversations.is_error AS conversations_is_error, conversations.error_message AS conversations_error_message, conversations.conversation_metadata AS conversations_conversation_metadata, conversations.created_at AS conversations_created_at \nFROM conversations \nWHERE conversations.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-14 13:34:51,235", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00044s] {'pk_1': UUID('f866c6f2-4428-4012-856e-750d2f5b9403')}"}
{"asctime": "2025-11-14 13:34:51,237", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "UPDATE conversations SET ai_response=%(ai_response)s, intent_detected=%(intent_detected)s, entities_extracted=%(entities_extracted)s, confidence_score=%(confidence_score)s, is_processed=%(is_processed)s, processed_at=%(processed_at)s WHERE conversations.id = %(conversations_id)s::UUID"}
{"asctime": "2025-11-14 13:34:51,237", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00028s] {'ai_response': 'Sorry about that, Kevin! How much airtime would you like to buy? You can choose between R5 and R1000.', 'intent_detected': 'buy_airtime', 'entities_extracted': '{\"amount\": null, \"phone\": null, \"network\": null}', 'confidence_score': 0.9, 'is_processed': True, 'processed_at': datetime.datetime(2025, 11, 14, 11, 34, 51, 233242), 'conversations_id': UUID('f866c6f2-4428-4012-856e-750d2f5b9403')}"}
{"asctime": "2025-11-14 13:34:51,238", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 13:34:52,103", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 13:34:52,104", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763514028: Success"}
{"asctime": "2025-11-14 13:34:53,502", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '9c83340e-d80b-40cc-809b-72a8c913af10', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763514028', 'wa_id': '27763514028'}], 'messages': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBJERTA2MDNDRTA5RDlDQkY1MEMA'}]}}"}
{"asctime": "2025-11-14 13:34:54,663", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBJERTA2MDNDRTA5RDlDQkY1MEMA', 'status': 'sent', 'timestamp': '1763120093', 'recipient_id': '27763514028', 'conversation': {'id': '2ab78c906b3677b7d970d4a78b37eac0', 'expiration_timestamp': '1763120093', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 13:34:55,489", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBJERTA2MDNDRTA5RDlDQkY1MEMA', 'status': 'delivered', 'timestamp': '1763120093', 'recipient_id': '27763514028', 'conversation': {'id': '2ab78c906b3677b7d970d4a78b37eac0', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 13:34:55,506", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBJERTA2MDNDRTA5RDlDQkY1MEMA', 'status': 'read', 'timestamp': '1763120093', 'recipient_id': '27763514028', 'conversation': {'id': '2ab78c906b3677b7d970d4a78b37eac0', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 13:44:48,258", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-11-14 13:44:48,809", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-11-14 13:44:48,809", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-11-14 13:44:48,831", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-11-14 13:44:48,831", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 13:44:48,831", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-11-14 13:44:48,831", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 13:44:48,832", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-11-14 13:44:48,832", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 13:44:48,832", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 13:44:48,833", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 13:44:48,833", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00010s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 13:44:48,836", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 13:44:48,836", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002943s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 13:44:48,837", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 13:44:48,837", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.00336s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 13:44:48,837", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 13:44:48,837", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00008s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 13:44:48,838", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 13:44:48,838", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0006984s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 13:44:48,839", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 13:44:48,839", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001248s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 13:44:48,839", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 13:44:48,839", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-11-14 13:44:48,839", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-11-14 13:44:48,839", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-11-14 13:47:10,175", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World!'}, 'wa_id': '27763514028'}], 'messages': [{'from': '27763514028', 'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgASGBQzQTM1QkU2MEZCRTEzOTU4MjQyQwA=', 'timestamp': '1763120828', 'text': {'body': 'Hi'}, 'type': 'text'}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 13:47:10,177", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=text, media_id=none"}
{"asctime": "2025-11-14 13:47:10,177", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763514028"}
{"asctime": "2025-11-14 13:47:10,187", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 13:47:10,192", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 13:47:10,192", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00038s] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-14 13:47:10,200", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO users (id, phone_number, email, whatsapp_name, first_name, last_name, id_number, date_of_birth, nationality, address_line1, address_line2, city, province, postal_code, country, account_number, balance, status, pin_hash, pin_attempts, pin_locked_until, is_phone_verified, is_email_verified, is_id_verified, is_address_verified, is_fica_compliant, id_document_url, proof_of_residence_url, selfie_url, daily_limit, monthly_limit, daily_spent, monthly_spent, last_daily_reset, last_monthly_reset, preferred_language, notification_enabled, marketing_consent, user_metadata, referral_code, referred_by, created_at, updated_at, last_active_at, verified_at) VALUES (%(id)s::UUID, %(phone_number)s, %(email)s, %(whatsapp_name)s, %(first_name)s, %(last_name)s, %(id_number)s, %(date_of_birth)s, %(nationality)s, %(address_line1)s, %(address_line2)s, %(city)s, %(province)s, %(postal_code)s, %(country)s, %(account_number)s, %(balance)s, %(status)s, %(pin_hash)s, %(pin_attempts)s, %(pin_locked_until)s, %(is_phone_verified)s, %(is_email_verified)s, %(is_id_verified)s, %(is_address_verified)s, %(is_fica_compliant)s, %(id_document_url)s, %(proof_of_residence_url)s, %(selfie_url)s, %(daily_limit)s, %(monthly_limit)s, %(daily_spent)s, %(monthly_spent)s, now(), now(), %(preferred_language)s, %(notification_enabled)s, %(marketing_consent)s, %(user_metadata)s, %(referral_code)s, %(referred_by)s::UUID, now(), now(), now(), %(verified_at)s) RETURNING users.last_daily_reset, users.last_monthly_reset, users.created_at, users.updated_at, users.last_active_at"}
{"asctime": "2025-11-14 13:47:10,201", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00051s] {'id': UUID('34c6fe1c-e002-4f14-a3d9-b2efde99a27b'), 'phone_number': '+27763514028', 'email': None, 'whatsapp_name': 'Hello World!', 'first_name': None, 'last_name': None, 'id_number': None, 'date_of_birth': None, 'nationality': None, 'address_line1': None, 'address_line2': None, 'city': None, 'province': None, 'postal_code': None, 'country': 'South Africa', 'account_number': None, 'balance': 0.0, 'status': 'PENDING_VERIFICATION', 'pin_hash': None, 'pin_attempts': 0, 'pin_locked_until': None, 'is_phone_verified': False, 'is_email_verified': False, 'is_id_verified': False, 'is_address_verified': False, 'is_fica_compliant': False, 'id_document_url': None, 'proof_of_residence_url': None, 'selfie_url': None, 'daily_limit': 25000.0, 'monthly_limit': 100000.0, 'daily_spent': 0.0, 'monthly_spent': 0.0, 'preferred_language': 'en', 'notification_enabled': True, 'marketing_consent': False, 'user_metadata': '{}', 'referral_code': None, 'referred_by': None, 'verified_at': None}"}
{"asctime": "2025-11-14 13:47:10,205", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 13:47:10,207", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 13:47:10,208", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id, users.phone_number, users.email, users.whatsapp_name, users.first_name, users.last_name, users.id_number, users.date_of_birth, users.nationality, users.address_line1, users.address_line2, users.city, users.province, users.postal_code, users.country, users.account_number, users.balance, users.status, users.pin_hash, users.pin_attempts, users.pin_locked_until, users.is_phone_verified, users.is_email_verified, users.is_id_verified, users.is_address_verified, users.is_fica_compliant, users.id_document_url, users.proof_of_residence_url, users.selfie_url, users.daily_limit, users.monthly_limit, users.daily_spent, users.monthly_spent, users.last_daily_reset, users.last_monthly_reset, users.preferred_language, users.notification_enabled, users.marketing_consent, users.user_metadata, users.referral_code, users.referred_by, users.created_at, users.updated_at, users.last_active_at, users.verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-14 13:47:10,208", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00016s] {'pk_1': UUID('34c6fe1c-e002-4f14-a3d9-b2efde99a27b')}"}
{"asctime": "2025-11-14 13:47:12,845", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 13:47:12,847", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Flow sent to 27763514028: Success"}
{"asctime": "2025-11-14 13:47:12,848", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "ROLLBACK"}
{"asctime": "2025-11-14 13:47:14,139", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': 'f24b3d79-4e1a-428a-a3e0-27bfb318dd71', 'message_status': 'failed'}, 'response': {'error': {'message': '(#131009) Parameter value is not valid', 'type': 'OAuthException', 'code': 131009, 'error_data': {'messaging_product': 'whatsapp', 'details': 'Parameter \"flow_id\" or parameter \"flow_name\" must be specified.'}, 'fbtrace_id': 'AOFyCQ5N4MB4hSr1Msu6T4Z'}}}"}
{"asctime": "2025-11-14 13:51:46,886", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-11-14 13:51:47,453", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-11-14 13:51:47,453", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-11-14 13:51:47,469", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-11-14 13:51:47,469", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 13:51:47,470", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-11-14 13:51:47,470", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 13:51:47,470", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-11-14 13:51:47,470", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 13:51:47,470", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 13:51:47,472", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 13:51:47,472", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00009s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 13:51:47,473", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 13:51:47,473", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001607s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 13:51:47,473", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 13:51:47,473", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001926s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 13:51:47,474", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 13:51:47,474", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00006s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 13:51:47,475", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 13:51:47,475", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0005125s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 13:51:47,475", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 13:51:47,475", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0009415s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 13:51:47,475", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 13:51:47,475", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-11-14 13:51:47,475", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-11-14 13:51:47,476", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-11-14 13:51:57,390", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World!'}, 'wa_id': '27763514028'}], 'messages': [{'from': '27763514028', 'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgASGBQzQTE5MjUzMDUyQTI2RTg3Njk3OAA=', 'timestamp': '1763121115', 'text': {'body': 'Hello'}, 'type': 'text'}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 13:51:57,391", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=text, media_id=none"}
{"asctime": "2025-11-14 13:51:57,392", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763514028"}
{"asctime": "2025-11-14 13:51:57,404", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 13:51:57,408", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 13:51:57,408", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00035s] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-14 13:51:58,422", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 13:51:58,423", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763514028: Success"}
{"asctime": "2025-11-14 13:51:58,424", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "ROLLBACK"}
{"asctime": "2025-11-14 13:52:00,706", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '7f4f0ccd-5438-4a02-8153-d0cb089e0c8f', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763514028', 'wa_id': '27763514028'}], 'messages': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBIxQThGRDI4RjlDRDc0RjlGNzYA'}]}}"}
{"asctime": "2025-11-14 13:52:01,356", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBIxQThGRDI4RjlDRDc0RjlGNzYA', 'status': 'sent', 'timestamp': '1763121120', 'recipient_id': '27763514028', 'conversation': {'id': 'aa90bf0fc2b5fa3e3d0e7e40dac8e7cf', 'expiration_timestamp': '1763121120', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 13:52:04,135", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBIxQThGRDI4RjlDRDc0RjlGNzYA', 'status': 'delivered', 'timestamp': '1763121120', 'recipient_id': '27763514028', 'conversation': {'id': 'aa90bf0fc2b5fa3e3d0e7e40dac8e7cf', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 13:52:04,136", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBIxQThGRDI4RjlDRDc0RjlGNzYA', 'status': 'read', 'timestamp': '1763121120', 'recipient_id': '27763514028', 'conversation': {'id': 'aa90bf0fc2b5fa3e3d0e7e40dac8e7cf', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 13:52:13,095", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World!'}, 'wa_id': '27763514028'}], 'messages': [{'from': '27763514028', 'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgASGBQzQTRCM0RDOThDQzczREYwQTI1QgA=', 'timestamp': '1763121131', 'text': {'body': 'Hi'}, 'type': 'text'}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 13:52:13,095", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=text, media_id=none"}
{"asctime": "2025-11-14 13:52:13,096", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763514028"}
{"asctime": "2025-11-14 13:52:13,097", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 13:52:13,098", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 13:52:13,098", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 15.69s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-14 13:52:14,255", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 13:52:14,256", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763514028: Success"}
{"asctime": "2025-11-14 13:52:14,256", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "ROLLBACK"}
{"asctime": "2025-11-14 13:52:17,133", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '370c24aa-ebd0-434f-bb10-4a367495129e', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763514028', 'wa_id': '27763514028'}], 'messages': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBJFMzYyMUI5QjU2OUYwNkExQUYA'}]}}"}
{"asctime": "2025-11-14 13:52:17,757", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBJFMzYyMUI5QjU2OUYwNkExQUYA', 'status': 'sent', 'timestamp': '1763121135', 'recipient_id': '27763514028', 'conversation': {'id': '9ea246deab484105803b22ecec885e2b', 'expiration_timestamp': '1763121135', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 13:52:17,923", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBJFMzYyMUI5QjU2OUYwNkExQUYA', 'status': 'delivered', 'timestamp': '1763121136', 'recipient_id': '27763514028', 'conversation': {'id': '9ea246deab484105803b22ecec885e2b', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 13:52:17,934", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBJFMzYyMUI5QjU2OUYwNkExQUYA', 'status': 'delivered', 'timestamp': '1763121136', 'recipient_id': '27763514028', 'conversation': {'id': '9ea246deab484105803b22ecec885e2b', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 13:52:17,951", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBJFMzYyMUI5QjU2OUYwNkExQUYA', 'status': 'read', 'timestamp': '1763121136', 'recipient_id': '27763514028', 'conversation': {'id': '9ea246deab484105803b22ecec885e2b', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 13:52:22,016", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World!'}, 'wa_id': '27763514028'}], 'messages': [{'from': '27763514028', 'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgASGBQzQTNDREU1OTU1QUNCQjIyOTkxQQA=', 'timestamp': '1763121140', 'text': {'body': 'Register'}, 'type': 'text'}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 13:52:22,017", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=text, media_id=none"}
{"asctime": "2025-11-14 13:52:22,017", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763514028"}
{"asctime": "2025-11-14 13:52:22,019", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 13:52:22,019", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 13:52:22,019", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 24.61s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-14 13:52:23,497", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 13:52:23,498", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763514028: Success"}
{"asctime": "2025-11-14 13:52:23,499", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "ROLLBACK"}
{"asctime": "2025-11-14 13:52:24,834", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '92e0550d-4459-4861-8244-1d449a1fa917', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763514028', 'wa_id': '27763514028'}], 'messages': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBJDRTA3OUFDNTcxMENGQzU2QkIA'}]}}"}
{"asctime": "2025-11-14 13:52:26,080", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBJDRTA3OUFDNTcxMENGQzU2QkIA', 'status': 'sent', 'timestamp': '1763121144', 'recipient_id': '27763514028', 'conversation': {'id': '96127e45c29ba9acb2655a95c41e00f4', 'expiration_timestamp': '1763121144', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 13:52:26,655", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBJDRTA3OUFDNTcxMENGQzU2QkIA', 'status': 'delivered', 'timestamp': '1763121145', 'recipient_id': '27763514028', 'conversation': {'id': '96127e45c29ba9acb2655a95c41e00f4', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 13:52:26,772", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBJDRTA3OUFDNTcxMENGQzU2QkIA', 'status': 'read', 'timestamp': '1763121145', 'recipient_id': '27763514028', 'conversation': {'id': '96127e45c29ba9acb2655a95c41e00f4', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 13:52:26,890", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBJDRTA3OUFDNTcxMENGQzU2QkIA', 'status': 'delivered', 'timestamp': '1763121145', 'recipient_id': '27763514028', 'conversation': {'id': '96127e45c29ba9acb2655a95c41e00f4', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 13:53:20,322", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World!'}, 'wa_id': '27763514028'}], 'messages': [{'from': '27763514028', 'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgASGBQzQTU3OEVBMDJGQzkzMjA0MjcyMgA=', 'timestamp': '1763121198', 'text': {'body': 'Hi'}, 'type': 'text'}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 13:53:20,324", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=text, media_id=none"}
{"asctime": "2025-11-14 13:53:20,325", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763514028"}
{"asctime": "2025-11-14 13:53:20,333", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 13:53:20,334", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 13:53:20,335", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 82.93s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-14 13:53:20,343", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO users (id, phone_number, email, whatsapp_name, first_name, last_name, id_number, date_of_birth, nationality, address_line1, address_line2, city, province, postal_code, country, account_number, balance, status, pin_hash, pin_attempts, pin_locked_until, is_phone_verified, is_email_verified, is_id_verified, is_address_verified, is_fica_compliant, id_document_url, proof_of_residence_url, selfie_url, daily_limit, monthly_limit, daily_spent, monthly_spent, last_daily_reset, last_monthly_reset, preferred_language, notification_enabled, marketing_consent, user_metadata, referral_code, referred_by, created_at, updated_at, last_active_at, verified_at) VALUES (%(id)s::UUID, %(phone_number)s, %(email)s, %(whatsapp_name)s, %(first_name)s, %(last_name)s, %(id_number)s, %(date_of_birth)s, %(nationality)s, %(address_line1)s, %(address_line2)s, %(city)s, %(province)s, %(postal_code)s, %(country)s, %(account_number)s, %(balance)s, %(status)s, %(pin_hash)s, %(pin_attempts)s, %(pin_locked_until)s, %(is_phone_verified)s, %(is_email_verified)s, %(is_id_verified)s, %(is_address_verified)s, %(is_fica_compliant)s, %(id_document_url)s, %(proof_of_residence_url)s, %(selfie_url)s, %(daily_limit)s, %(monthly_limit)s, %(daily_spent)s, %(monthly_spent)s, now(), now(), %(preferred_language)s, %(notification_enabled)s, %(marketing_consent)s, %(user_metadata)s, %(referral_code)s, %(referred_by)s::UUID, now(), now(), now(), %(verified_at)s) RETURNING users.last_daily_reset, users.last_monthly_reset, users.created_at, users.updated_at, users.last_active_at"}
{"asctime": "2025-11-14 13:53:20,343", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00084s] {'id': UUID('f2067ef9-9688-4f0d-8cb2-c142033c3e48'), 'phone_number': '+27763514028', 'email': None, 'whatsapp_name': 'Hello World!', 'first_name': None, 'last_name': None, 'id_number': None, 'date_of_birth': None, 'nationality': None, 'address_line1': None, 'address_line2': None, 'city': None, 'province': None, 'postal_code': None, 'country': 'South Africa', 'account_number': None, 'balance': 0.0, 'status': 'PENDING_VERIFICATION', 'pin_hash': None, 'pin_attempts': 0, 'pin_locked_until': None, 'is_phone_verified': False, 'is_email_verified': False, 'is_id_verified': False, 'is_address_verified': False, 'is_fica_compliant': False, 'id_document_url': None, 'proof_of_residence_url': None, 'selfie_url': None, 'daily_limit': 25000.0, 'monthly_limit': 100000.0, 'daily_spent': 0.0, 'monthly_spent': 0.0, 'preferred_language': 'en', 'notification_enabled': True, 'marketing_consent': False, 'user_metadata': '{}', 'referral_code': None, 'referred_by': None, 'verified_at': None}"}
{"asctime": "2025-11-14 13:53:20,346", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 13:53:20,348", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 13:53:20,352", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id, users.phone_number, users.email, users.whatsapp_name, users.first_name, users.last_name, users.id_number, users.date_of_birth, users.nationality, users.address_line1, users.address_line2, users.city, users.province, users.postal_code, users.country, users.account_number, users.balance, users.status, users.pin_hash, users.pin_attempts, users.pin_locked_until, users.is_phone_verified, users.is_email_verified, users.is_id_verified, users.is_address_verified, users.is_fica_compliant, users.id_document_url, users.proof_of_residence_url, users.selfie_url, users.daily_limit, users.monthly_limit, users.daily_spent, users.monthly_spent, users.last_daily_reset, users.last_monthly_reset, users.preferred_language, users.notification_enabled, users.marketing_consent, users.user_metadata, users.referral_code, users.referred_by, users.created_at, users.updated_at, users.last_active_at, users.verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-14 13:53:20,352", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00024s] {'pk_1': UUID('f2067ef9-9688-4f0d-8cb2-c142033c3e48')}"}
{"asctime": "2025-11-14 13:53:22,881", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 13:53:22,883", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Flow sent to 27763514028: Success"}
{"asctime": "2025-11-14 13:53:22,884", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "ROLLBACK"}
{"asctime": "2025-11-14 13:53:24,717", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': 'f243be7e-9c83-4db5-a780-7f6e82a13f61', 'message_status': 'failed'}, 'response': {'error': {'message': '(#131009) Parameter value is not valid', 'type': 'OAuthException', 'code': 131009, 'error_data': {'messaging_product': 'whatsapp', 'details': 'Parameter \"flow_id\" or parameter \"flow_name\" must be specified.'}, 'fbtrace_id': 'AjZUa6Fj_3ctn4ytKmupJ7z'}}}"}
{"asctime": "2025-11-14 13:56:22,448", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-11-14 13:56:23,041", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-11-14 13:56:23,041", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-11-14 13:56:23,057", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-11-14 13:56:23,058", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 13:56:23,058", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-11-14 13:56:23,058", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 13:56:23,059", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-11-14 13:56:23,059", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 13:56:23,059", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 13:56:23,060", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 13:56:23,060", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00010s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 13:56:23,062", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 13:56:23,062", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001931s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 13:56:23,063", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 13:56:23,063", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.00243s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 13:56:23,064", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 13:56:23,064", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00011s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 13:56:23,064", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 13:56:23,064", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0005852s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 13:56:23,065", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 13:56:23,065", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001155s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 13:56:23,065", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 13:56:23,065", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-11-14 13:56:23,065", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-11-14 13:56:23,065", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-11-14 13:56:25,997", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-11-14 13:56:26,417", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-11-14 13:56:26,418", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-11-14 13:56:26,432", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-11-14 13:56:26,432", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 13:56:26,433", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-11-14 13:56:26,433", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 13:56:26,433", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-11-14 13:56:26,433", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 13:56:26,434", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 13:56:26,435", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 13:56:26,435", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00009s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 13:56:26,436", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 13:56:26,436", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001927s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 13:56:26,437", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 13:56:26,437", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.00244s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 13:56:26,438", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 13:56:26,438", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00008s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 13:56:26,439", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 13:56:26,439", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0008771s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 13:56:26,440", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 13:56:26,440", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001563s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 13:56:26,440", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 13:56:26,440", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-11-14 13:56:26,440", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-11-14 13:56:26,440", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-11-14 13:57:37,081", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World!'}, 'wa_id': '27763514028'}], 'messages': [{'from': '27763514028', 'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgASGBQzQTBERTM5NDhBRTg1OUFFOUFCQQA=', 'timestamp': '1763121454', 'text': {'body': 'Hi'}, 'type': 'text'}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 13:57:37,082", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=text, media_id=none"}
{"asctime": "2025-11-14 13:57:37,082", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763514028"}
{"asctime": "2025-11-14 13:57:37,094", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 13:57:37,098", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 13:57:37,098", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00036s] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-14 13:57:37,104", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO users (id, phone_number, email, whatsapp_name, first_name, last_name, id_number, date_of_birth, nationality, address_line1, address_line2, city, province, postal_code, country, account_number, balance, status, pin_hash, pin_attempts, pin_locked_until, is_phone_verified, is_email_verified, is_id_verified, is_address_verified, is_fica_compliant, id_document_url, proof_of_residence_url, selfie_url, daily_limit, monthly_limit, daily_spent, monthly_spent, last_daily_reset, last_monthly_reset, preferred_language, notification_enabled, marketing_consent, user_metadata, referral_code, referred_by, created_at, updated_at, last_active_at, verified_at) VALUES (%(id)s::UUID, %(phone_number)s, %(email)s, %(whatsapp_name)s, %(first_name)s, %(last_name)s, %(id_number)s, %(date_of_birth)s, %(nationality)s, %(address_line1)s, %(address_line2)s, %(city)s, %(province)s, %(postal_code)s, %(country)s, %(account_number)s, %(balance)s, %(status)s, %(pin_hash)s, %(pin_attempts)s, %(pin_locked_until)s, %(is_phone_verified)s, %(is_email_verified)s, %(is_id_verified)s, %(is_address_verified)s, %(is_fica_compliant)s, %(id_document_url)s, %(proof_of_residence_url)s, %(selfie_url)s, %(daily_limit)s, %(monthly_limit)s, %(daily_spent)s, %(monthly_spent)s, now(), now(), %(preferred_language)s, %(notification_enabled)s, %(marketing_consent)s, %(user_metadata)s, %(referral_code)s, %(referred_by)s::UUID, now(), now(), now(), %(verified_at)s) RETURNING users.last_daily_reset, users.last_monthly_reset, users.created_at, users.updated_at, users.last_active_at"}
{"asctime": "2025-11-14 13:57:37,104", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00044s] {'id': UUID('de2b3212-d26a-4c12-931c-92784669e609'), 'phone_number': '+27763514028', 'email': None, 'whatsapp_name': 'Hello World!', 'first_name': None, 'last_name': None, 'id_number': None, 'date_of_birth': None, 'nationality': None, 'address_line1': None, 'address_line2': None, 'city': None, 'province': None, 'postal_code': None, 'country': 'South Africa', 'account_number': None, 'balance': 0.0, 'status': 'PENDING_VERIFICATION', 'pin_hash': None, 'pin_attempts': 0, 'pin_locked_until': None, 'is_phone_verified': False, 'is_email_verified': False, 'is_id_verified': False, 'is_address_verified': False, 'is_fica_compliant': False, 'id_document_url': None, 'proof_of_residence_url': None, 'selfie_url': None, 'daily_limit': 25000.0, 'monthly_limit': 100000.0, 'daily_spent': 0.0, 'monthly_spent': 0.0, 'preferred_language': 'en', 'notification_enabled': True, 'marketing_consent': False, 'user_metadata': '{}', 'referral_code': None, 'referred_by': None, 'verified_at': None}"}
{"asctime": "2025-11-14 13:57:37,106", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 13:57:37,108", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 13:57:37,109", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id, users.phone_number, users.email, users.whatsapp_name, users.first_name, users.last_name, users.id_number, users.date_of_birth, users.nationality, users.address_line1, users.address_line2, users.city, users.province, users.postal_code, users.country, users.account_number, users.balance, users.status, users.pin_hash, users.pin_attempts, users.pin_locked_until, users.is_phone_verified, users.is_email_verified, users.is_id_verified, users.is_address_verified, users.is_fica_compliant, users.id_document_url, users.proof_of_residence_url, users.selfie_url, users.daily_limit, users.monthly_limit, users.daily_spent, users.monthly_spent, users.last_daily_reset, users.last_monthly_reset, users.preferred_language, users.notification_enabled, users.marketing_consent, users.user_metadata, users.referral_code, users.referred_by, users.created_at, users.updated_at, users.last_active_at, users.verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-14 13:57:37,109", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00011s] {'pk_1': UUID('de2b3212-d26a-4c12-931c-92784669e609')}"}
{"asctime": "2025-11-14 13:57:40,223", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 13:57:40,224", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Flow sent to 27763514028: Success"}
{"asctime": "2025-11-14 13:57:40,225", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "ROLLBACK"}
{"asctime": "2025-11-14 13:57:41,612", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': 'b09fa32b-c26e-4d7e-a2e6-0d3f9e9714bc', 'message_status': 'failed'}, 'response': {'error': {'message': '(#131009) Parameter value is not valid', 'type': 'OAuthException', 'code': 131009, 'error_data': {'messaging_product': 'whatsapp', 'details': \"Sending a flow in a draft state requires setting the mode to 'draft'.\"}, 'fbtrace_id': 'ApJ4jmPpvutnfp5wLLn7FPU'}}}"}
{"asctime": "2025-11-14 13:59:22,114", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-11-14 13:59:22,700", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-11-14 13:59:22,700", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-11-14 13:59:22,719", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-11-14 13:59:22,719", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 13:59:22,719", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-11-14 13:59:22,719", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 13:59:22,720", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-11-14 13:59:22,720", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 13:59:22,720", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 13:59:22,721", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 13:59:22,721", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00009s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 13:59:22,723", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 13:59:22,724", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002311s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 13:59:22,724", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 13:59:22,724", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002936s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 13:59:22,725", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 13:59:22,725", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00007s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 13:59:22,726", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 13:59:22,726", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0005713s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 13:59:22,726", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 13:59:22,726", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001125s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 13:59:22,726", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 13:59:22,726", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-11-14 13:59:22,727", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-11-14 13:59:22,727", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-11-14 14:00:04,203", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World!'}, 'wa_id': '27763514028'}], 'messages': [{'from': '27763514028', 'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgASGBQzQTA1OUQyMDAxQTkzNUYzODE2MwA=', 'timestamp': '1763121602', 'text': {'body': 'Hi'}, 'type': 'text'}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 14:00:04,204", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=text, media_id=none"}
{"asctime": "2025-11-14 14:00:04,204", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763514028"}
{"asctime": "2025-11-14 14:00:04,216", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 14:00:04,220", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 14:00:04,220", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00030s] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-14 14:00:04,226", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO users (id, phone_number, email, whatsapp_name, first_name, last_name, id_number, date_of_birth, nationality, address_line1, address_line2, city, province, postal_code, country, account_number, balance, status, pin_hash, pin_attempts, pin_locked_until, is_phone_verified, is_email_verified, is_id_verified, is_address_verified, is_fica_compliant, id_document_url, proof_of_residence_url, selfie_url, daily_limit, monthly_limit, daily_spent, monthly_spent, last_daily_reset, last_monthly_reset, preferred_language, notification_enabled, marketing_consent, user_metadata, referral_code, referred_by, created_at, updated_at, last_active_at, verified_at) VALUES (%(id)s::UUID, %(phone_number)s, %(email)s, %(whatsapp_name)s, %(first_name)s, %(last_name)s, %(id_number)s, %(date_of_birth)s, %(nationality)s, %(address_line1)s, %(address_line2)s, %(city)s, %(province)s, %(postal_code)s, %(country)s, %(account_number)s, %(balance)s, %(status)s, %(pin_hash)s, %(pin_attempts)s, %(pin_locked_until)s, %(is_phone_verified)s, %(is_email_verified)s, %(is_id_verified)s, %(is_address_verified)s, %(is_fica_compliant)s, %(id_document_url)s, %(proof_of_residence_url)s, %(selfie_url)s, %(daily_limit)s, %(monthly_limit)s, %(daily_spent)s, %(monthly_spent)s, now(), now(), %(preferred_language)s, %(notification_enabled)s, %(marketing_consent)s, %(user_metadata)s, %(referral_code)s, %(referred_by)s::UUID, now(), now(), now(), %(verified_at)s) RETURNING users.last_daily_reset, users.last_monthly_reset, users.created_at, users.updated_at, users.last_active_at"}
{"asctime": "2025-11-14 14:00:04,227", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00046s] {'id': UUID('be33d46d-8483-44ee-a948-72a8e0500852'), 'phone_number': '+27763514028', 'email': None, 'whatsapp_name': 'Hello World!', 'first_name': None, 'last_name': None, 'id_number': None, 'date_of_birth': None, 'nationality': None, 'address_line1': None, 'address_line2': None, 'city': None, 'province': None, 'postal_code': None, 'country': 'South Africa', 'account_number': None, 'balance': 0.0, 'status': 'PENDING_VERIFICATION', 'pin_hash': None, 'pin_attempts': 0, 'pin_locked_until': None, 'is_phone_verified': False, 'is_email_verified': False, 'is_id_verified': False, 'is_address_verified': False, 'is_fica_compliant': False, 'id_document_url': None, 'proof_of_residence_url': None, 'selfie_url': None, 'daily_limit': 25000.0, 'monthly_limit': 100000.0, 'daily_spent': 0.0, 'monthly_spent': 0.0, 'preferred_language': 'en', 'notification_enabled': True, 'marketing_consent': False, 'user_metadata': '{}', 'referral_code': None, 'referred_by': None, 'verified_at': None}"}
{"asctime": "2025-11-14 14:00:04,229", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 14:00:04,231", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 14:00:04,231", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id, users.phone_number, users.email, users.whatsapp_name, users.first_name, users.last_name, users.id_number, users.date_of_birth, users.nationality, users.address_line1, users.address_line2, users.city, users.province, users.postal_code, users.country, users.account_number, users.balance, users.status, users.pin_hash, users.pin_attempts, users.pin_locked_until, users.is_phone_verified, users.is_email_verified, users.is_id_verified, users.is_address_verified, users.is_fica_compliant, users.id_document_url, users.proof_of_residence_url, users.selfie_url, users.daily_limit, users.monthly_limit, users.daily_spent, users.monthly_spent, users.last_daily_reset, users.last_monthly_reset, users.preferred_language, users.notification_enabled, users.marketing_consent, users.user_metadata, users.referral_code, users.referred_by, users.created_at, users.updated_at, users.last_active_at, users.verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-14 14:00:04,231", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00013s] {'pk_1': UUID('be33d46d-8483-44ee-a948-72a8e0500852')}"}
{"asctime": "2025-11-14 14:00:06,586", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 14:00:06,588", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Flow sent to 27763514028: Success"}
{"asctime": "2025-11-14 14:00:06,589", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "ROLLBACK"}
{"asctime": "2025-11-14 14:00:08,485", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '619393ff-867d-43c3-8112-9b128f080899', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763514028', 'wa_id': '27763514028'}], 'messages': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI4N0QwMUFEMTQwQjJBRDVBQjkA'}]}}"}
{"asctime": "2025-11-14 14:00:09,819", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI4N0QwMUFEMTQwQjJBRDVBQjkA', 'status': 'sent', 'timestamp': '1763121608', 'recipient_id': '27763514028', 'conversation': {'id': '409339d1e7558a118e271b6c74503f8b', 'expiration_timestamp': '1763121608', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 14:00:10,669", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI4N0QwMUFEMTQwQjJBRDVBQjkA', 'status': 'delivered', 'timestamp': '1763121609', 'recipient_id': '27763514028', 'conversation': {'id': '409339d1e7558a118e271b6c74503f8b', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 14:00:10,670", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI4N0QwMUFEMTQwQjJBRDVBQjkA', 'status': 'read', 'timestamp': '1763121609', 'recipient_id': '27763514028', 'conversation': {'id': '409339d1e7558a118e271b6c74503f8b', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 14:00:10,876", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI4N0QwMUFEMTQwQjJBRDVBQjkA', 'status': 'delivered', 'timestamp': '1763121608', 'recipient_id': '27763514028', 'conversation': {'id': '409339d1e7558a118e271b6c74503f8b', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 14:01:28,878", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World!'}, 'wa_id': '27763514028'}], 'messages': [{'context': {'from': '27769034491', 'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI4N0QwMUFEMTQwQjJBRDVBQjkA'}, 'from': '27763514028', 'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgASGBQzQUJFRkNEMjYyQkM4NkNEQTE4MQA=', 'timestamp': '1763121687', 'type': 'interactive', 'interactive': {'type': 'nfm_reply', 'nfm_reply': {'response_json': '{\"flow_uid\":\"6916b0d4438bb928d88ac3a2\",\"screen_bhgdafhhfaffg__date_of_birth_2\":\"1997-07-12\",\"screen_bhgdafhhfaffg__referral_code_5\":\"--NA--\",\"screen_bhgdafhhfaffg__select_id_type_3\":\"SA ID\",\"screen_bhgdafhhfaffg__last_name_1\":\"David\",\"flow_token\":\"reg_27763514028\",\"screen_bhgdafhhfaffg__first_name_0\":\"Dave\",\"screen_bhgdafhhfaffg__id_number_4\":\"084513794249\",\"screen_bhgdafeeddghg__secure_pin_0\":\"1234\"}', 'body': 'Sent', 'name': 'flow'}}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 14:01:28,880", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Flow response received: {\"flow_uid\":\"6916b0d4438bb928d88ac3a2\",\"screen_bhgdafhhfaffg__date_of_birth_2\":\"1997-07-12\",\"screen_"}
{"asctime": "2025-11-14 14:01:28,880", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=interactive, media_id=none"}
{"asctime": "2025-11-14 14:01:28,880", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763514028"}
{"asctime": "2025-11-14 14:01:28,882", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 14:01:28,882", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 14:01:28,882", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 84.66s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-14 14:01:29,621", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 14:01:29,623", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763514028: Success"}
{"asctime": "2025-11-14 14:01:29,624", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "ROLLBACK"}
{"asctime": "2025-11-14 14:01:31,446", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '3b61910b-2a44-4728-aca5-5329c94593ee', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763514028', 'wa_id': '27763514028'}], 'messages': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBJGRUEyNDM2MDkwMjg5MzVFQjkA'}]}}"}
{"asctime": "2025-11-14 14:01:32,254", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBJGRUEyNDM2MDkwMjg5MzVFQjkA', 'status': 'sent', 'timestamp': '1763121691', 'recipient_id': '27763514028', 'conversation': {'id': '0ff4ee5e3b5bfe4d8108c90efa28c0f0', 'expiration_timestamp': '1763121691', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 14:01:32,940", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBJGRUEyNDM2MDkwMjg5MzVFQjkA', 'status': 'read', 'timestamp': '1763121691', 'recipient_id': '27763514028', 'conversation': {'id': '0ff4ee5e3b5bfe4d8108c90efa28c0f0', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 14:01:33,042", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBJGRUEyNDM2MDkwMjg5MzVFQjkA', 'status': 'delivered', 'timestamp': '1763121691', 'recipient_id': '27763514028', 'conversation': {'id': '0ff4ee5e3b5bfe4d8108c90efa28c0f0', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 14:01:33,101", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBJGRUEyNDM2MDkwMjg5MzVFQjkA', 'status': 'delivered', 'timestamp': '1763121691', 'recipient_id': '27763514028', 'conversation': {'id': '0ff4ee5e3b5bfe4d8108c90efa28c0f0', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 14:01:38,114", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World!'}, 'wa_id': '27763514028'}], 'messages': [{'from': '27763514028', 'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgASGBQzQTk1MzMwMDIyMUYxMTk0MkZDRAA=', 'timestamp': '1763121696', 'text': {'body': 'Register'}, 'type': 'text'}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 14:01:38,115", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=text, media_id=none"}
{"asctime": "2025-11-14 14:01:38,116", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763514028"}
{"asctime": "2025-11-14 14:01:38,118", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 14:01:38,119", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 14:01:38,119", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 94.01s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-14 14:01:39,286", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 14:01:39,287", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763514028: Success"}
{"asctime": "2025-11-14 14:01:39,288", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "ROLLBACK"}
{"asctime": "2025-11-14 14:01:40,558", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '96573d9f-af3a-4cdd-a9a7-c71ed239eb12', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763514028', 'wa_id': '27763514028'}], 'messages': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI0OUE4NzE5RDhDQTRBNDFFNDMA'}]}}"}
{"asctime": "2025-11-14 14:01:41,870", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI0OUE4NzE5RDhDQTRBNDFFNDMA', 'status': 'sent', 'timestamp': '1763121700', 'recipient_id': '27763514028', 'conversation': {'id': 'cf60e6fe33beb59af0383821fff0a837', 'expiration_timestamp': '1763121700', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 14:01:42,243", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI0OUE4NzE5RDhDQTRBNDFFNDMA', 'status': 'delivered', 'timestamp': '1763121701', 'recipient_id': '27763514028', 'conversation': {'id': 'cf60e6fe33beb59af0383821fff0a837', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 14:01:42,556", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI0OUE4NzE5RDhDQTRBNDFFNDMA', 'status': 'read', 'timestamp': '1763121701', 'recipient_id': '27763514028', 'conversation': {'id': 'cf60e6fe33beb59af0383821fff0a837', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 14:01:42,577", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI0OUE4NzE5RDhDQTRBNDFFNDMA', 'status': 'delivered', 'timestamp': '1763121701', 'recipient_id': '27763514028', 'conversation': {'id': 'cf60e6fe33beb59af0383821fff0a837', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 19:08:59,995", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-11-14 19:09:00,578", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-11-14 19:09:00,579", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-11-14 19:09:00,599", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-11-14 19:09:00,599", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 19:09:00,599", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-11-14 19:09:00,599", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 19:09:00,600", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-11-14 19:09:00,600", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 19:09:00,600", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 19:09:00,601", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 19:09:00,601", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00009s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 19:09:00,603", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 19:09:00,603", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001863s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 19:09:00,604", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 19:09:00,604", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002818s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 19:09:00,605", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 19:09:00,605", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00016s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 19:09:00,605", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 19:09:00,605", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0007872s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 19:09:00,606", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 19:09:00,606", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001208s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 19:09:00,606", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 19:09:00,606", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-11-14 19:09:00,606", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-11-14 19:09:00,606", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-11-14 19:09:12,551", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World!'}, 'wa_id': '27763514028'}], 'messages': [{'from': '27763514028', 'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgASGBQzQTAxRDQzOUJGQTMzQTIxRjg2RAA=', 'timestamp': '1763140151', 'text': {'body': 'Hi'}, 'type': 'text'}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 19:09:12,552", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=text, media_id=none"}
{"asctime": "2025-11-14 19:09:12,552", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763514028"}
{"asctime": "2025-11-14 19:09:12,561", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 19:09:12,565", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 19:09:12,565", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00041s] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-14 19:09:12,624", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "INSERT INTO users (id, phone_number, email, whatsapp_name, first_name, last_name, id_number, date_of_birth, nationality, address_line1, address_line2, city, province, postal_code, country, account_number, balance, status, pin_hash, pin_attempts, pin_locked_until, is_phone_verified, is_email_verified, is_id_verified, is_address_verified, is_fica_compliant, id_document_url, proof_of_residence_url, selfie_url, daily_limit, monthly_limit, daily_spent, monthly_spent, last_daily_reset, last_monthly_reset, preferred_language, notification_enabled, marketing_consent, user_metadata, referral_code, referred_by, created_at, updated_at, last_active_at, verified_at) VALUES (%(id)s::UUID, %(phone_number)s, %(email)s, %(whatsapp_name)s, %(first_name)s, %(last_name)s, %(id_number)s, %(date_of_birth)s, %(nationality)s, %(address_line1)s, %(address_line2)s, %(city)s, %(province)s, %(postal_code)s, %(country)s, %(account_number)s, %(balance)s, %(status)s, %(pin_hash)s, %(pin_attempts)s, %(pin_locked_until)s, %(is_phone_verified)s, %(is_email_verified)s, %(is_id_verified)s, %(is_address_verified)s, %(is_fica_compliant)s, %(id_document_url)s, %(proof_of_residence_url)s, %(selfie_url)s, %(daily_limit)s, %(monthly_limit)s, %(daily_spent)s, %(monthly_spent)s, now(), now(), %(preferred_language)s, %(notification_enabled)s, %(marketing_consent)s, %(user_metadata)s, %(referral_code)s, %(referred_by)s::UUID, now(), now(), now(), %(verified_at)s) RETURNING users.last_daily_reset, users.last_monthly_reset, users.created_at, users.updated_at, users.last_active_at"}
{"asctime": "2025-11-14 19:09:12,624", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00084s] {'id': UUID('d8dd8650-b87b-49da-94e9-f15d9cc10c40'), 'phone_number': '+27763514028', 'email': None, 'whatsapp_name': 'Hello World!', 'first_name': None, 'last_name': None, 'id_number': None, 'date_of_birth': None, 'nationality': None, 'address_line1': None, 'address_line2': None, 'city': None, 'province': None, 'postal_code': None, 'country': 'South Africa', 'account_number': None, 'balance': 0.0, 'status': 'PENDING_VERIFICATION', 'pin_hash': None, 'pin_attempts': 0, 'pin_locked_until': None, 'is_phone_verified': False, 'is_email_verified': False, 'is_id_verified': False, 'is_address_verified': False, 'is_fica_compliant': False, 'id_document_url': None, 'proof_of_residence_url': None, 'selfie_url': None, 'daily_limit': 25000.0, 'monthly_limit': 100000.0, 'daily_spent': 0.0, 'monthly_spent': 0.0, 'preferred_language': 'en', 'notification_enabled': True, 'marketing_consent': False, 'user_metadata': '{}', 'referral_code': None, 'referred_by': None, 'verified_at': None}"}
{"asctime": "2025-11-14 19:09:12,628", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 19:09:12,629", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 19:09:12,629", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id, users.phone_number, users.email, users.whatsapp_name, users.first_name, users.last_name, users.id_number, users.date_of_birth, users.nationality, users.address_line1, users.address_line2, users.city, users.province, users.postal_code, users.country, users.account_number, users.balance, users.status, users.pin_hash, users.pin_attempts, users.pin_locked_until, users.is_phone_verified, users.is_email_verified, users.is_id_verified, users.is_address_verified, users.is_fica_compliant, users.id_document_url, users.proof_of_residence_url, users.selfie_url, users.daily_limit, users.monthly_limit, users.daily_spent, users.monthly_spent, users.last_daily_reset, users.last_monthly_reset, users.preferred_language, users.notification_enabled, users.marketing_consent, users.user_metadata, users.referral_code, users.referred_by, users.created_at, users.updated_at, users.last_active_at, users.verified_at \nFROM users \nWHERE users.id = %(pk_1)s::UUID"}
{"asctime": "2025-11-14 19:09:12,629", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00007s] {'pk_1': UUID('d8dd8650-b87b-49da-94e9-f15d9cc10c40')}"}
{"asctime": "2025-11-14 19:09:15,227", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 19:09:15,229", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Flow sent to 27763514028: Success"}
{"asctime": "2025-11-14 19:09:15,230", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "ROLLBACK"}
{"asctime": "2025-11-14 19:09:17,036", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '7d037ee1-bc9a-4eaa-a5a9-0e3420ab35fa', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763514028', 'wa_id': '27763514028'}], 'messages': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI3MDNCNUMzMzQ3N0M3MUM0QzUA'}]}}"}
{"asctime": "2025-11-14 19:09:18,299", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI3MDNCNUMzMzQ3N0M3MUM0QzUA', 'status': 'sent', 'timestamp': '1763140157', 'recipient_id': '27763514028', 'conversation': {'id': '43cf72512e777795211b96006550d4af', 'expiration_timestamp': '1763140157', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 19:09:19,056", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI3MDNCNUMzMzQ3N0M3MUM0QzUA', 'status': 'delivered', 'timestamp': '1763140158', 'recipient_id': '27763514028', 'conversation': {'id': '43cf72512e777795211b96006550d4af', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 19:09:19,209", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI3MDNCNUMzMzQ3N0M3MUM0QzUA', 'status': 'read', 'timestamp': '1763140158', 'recipient_id': '27763514028', 'conversation': {'id': '43cf72512e777795211b96006550d4af', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 19:13:16,281", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World!'}, 'wa_id': '27763514028'}], 'messages': [{'from': '27763514028', 'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgASGBQzQTYxRjIwMUY5NkNDREEwOThCOQA=', 'timestamp': '1763140395', 'text': {'body': 'Hello'}, 'type': 'text'}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 19:13:16,283", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=text, media_id=none"}
{"asctime": "2025-11-14 19:13:16,284", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763514028"}
{"asctime": "2025-11-14 19:13:16,310", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 19:13:16,311", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 19:13:16,312", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 243.8s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-14 19:13:17,292", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 19:13:17,293", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763514028: Success"}
{"asctime": "2025-11-14 19:13:17,294", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "ROLLBACK"}
{"asctime": "2025-11-14 19:13:18,780", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': 'b729edb6-c594-4bb3-a6d5-33cc849c1a92', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763514028', 'wa_id': '27763514028'}], 'messages': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI0NTNBN0RDQ0I4NjEzMjgzQkQA'}]}}"}
{"asctime": "2025-11-14 19:13:20,276", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI0NTNBN0RDQ0I4NjEzMjgzQkQA', 'status': 'sent', 'timestamp': '1763140399', 'recipient_id': '27763514028', 'conversation': {'id': 'f9894d1a98e323179fc42a1ee7a15683', 'expiration_timestamp': '1763140399', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 19:13:20,469", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI0NTNBN0RDQ0I4NjEzMjgzQkQA', 'status': 'read', 'timestamp': '1763140399', 'recipient_id': '27763514028', 'conversation': {'id': 'f9894d1a98e323179fc42a1ee7a15683', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 19:13:20,575", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBI0NTNBN0RDQ0I4NjEzMjgzQkQA', 'status': 'delivered', 'timestamp': '1763140399', 'recipient_id': '27763514028', 'conversation': {'id': 'f9894d1a98e323179fc42a1ee7a15683', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 19:13:24,876", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'contacts': [{'profile': {'name': 'Hello World!'}, 'wa_id': '27763514028'}], 'messages': [{'from': '27763514028', 'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgASGBQzQUVERTMyMENEQ0Q3MjlENzAwRQA=', 'timestamp': '1763140403', 'text': {'body': 'Register'}, 'type': 'text'}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 19:13:24,877", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Parsed webhook: type=text, media_id=none"}
{"asctime": "2025-11-14 19:13:24,878", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Processing text message from +27763514028"}
{"asctime": "2025-11-14 19:13:24,879", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 19:13:24,880", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT users.id AS users_id, users.phone_number AS users_phone_number, users.email AS users_email, users.whatsapp_name AS users_whatsapp_name, users.first_name AS users_first_name, users.last_name AS users_last_name, users.id_number AS users_id_number, users.date_of_birth AS users_date_of_birth, users.nationality AS users_nationality, users.address_line1 AS users_address_line1, users.address_line2 AS users_address_line2, users.city AS users_city, users.province AS users_province, users.postal_code AS users_postal_code, users.country AS users_country, users.account_number AS users_account_number, users.balance AS users_balance, users.status AS users_status, users.pin_hash AS users_pin_hash, users.pin_attempts AS users_pin_attempts, users.pin_locked_until AS users_pin_locked_until, users.is_phone_verified AS users_is_phone_verified, users.is_email_verified AS users_is_email_verified, users.is_id_verified AS users_is_id_verified, users.is_address_verified AS users_is_address_verified, users.is_fica_compliant AS users_is_fica_compliant, users.id_document_url AS users_id_document_url, users.proof_of_residence_url AS users_proof_of_residence_url, users.selfie_url AS users_selfie_url, users.daily_limit AS users_daily_limit, users.monthly_limit AS users_monthly_limit, users.daily_spent AS users_daily_spent, users.monthly_spent AS users_monthly_spent, users.last_daily_reset AS users_last_daily_reset, users.last_monthly_reset AS users_last_monthly_reset, users.preferred_language AS users_preferred_language, users.notification_enabled AS users_notification_enabled, users.marketing_consent AS users_marketing_consent, users.user_metadata AS users_user_metadata, users.referral_code AS users_referral_code, users.referred_by AS users_referred_by, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.last_active_at AS users_last_active_at, users.verified_at AS users_verified_at \nFROM users \nWHERE users.phone_number = %(phone_number_1)s \n LIMIT %(param_1)s"}
{"asctime": "2025-11-14 19:13:24,880", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 252.3s ago] {'phone_number_1': '+27763514028', 'param_1': 1}"}
{"asctime": "2025-11-14 19:13:25,905", "name": "httpx", "levelname": "INFO", "message": "HTTP Request: POST https://crm.cyraxtechnologies.com/api/meta/v19.0/797327890140094/messages \"HTTP/1.1 200 OK\""}
{"asctime": "2025-11-14 19:13:25,906", "name": "app.services.whatsapp_api_service", "levelname": "INFO", "message": "Message sent to 27763514028: Success"}
{"asctime": "2025-11-14 19:13:25,907", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "ROLLBACK"}
{"asctime": "2025-11-14 19:13:27,439", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'messaging_channel': 'whatsapp', 'message': {'queue_id': '96faa1bb-fb49-4cfd-84dd-06ecd8b02080', 'message_status': 'sent'}, 'response': {'messaging_product': 'whatsapp', 'contacts': [{'input': '27763514028', 'wa_id': '27763514028'}], 'messages': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBIwRjk2REI0OTEwQjAxQzQxRUIA'}]}}"}
{"asctime": "2025-11-14 19:13:28,294", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBIwRjk2REI0OTEwQjAxQzQxRUIA', 'status': 'sent', 'timestamp': '1763140407', 'recipient_id': '27763514028', 'conversation': {'id': 'b3e572876083145943e13e7b21e41554', 'expiration_timestamp': '1763140407', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 19:13:29,039", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBIwRjk2REI0OTEwQjAxQzQxRUIA', 'status': 'read', 'timestamp': '1763140408', 'recipient_id': '27763514028', 'conversation': {'id': 'b3e572876083145943e13e7b21e41554', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 19:13:29,195", "name": "app.routers.whatsapp", "levelname": "INFO", "message": "Webhook received (JSON): {'object': 'whatsapp_business_account', 'entry': [{'id': '1595026871665632', 'changes': [{'value': {'messaging_product': 'whatsapp', 'metadata': {'display_phone_number': '27769034491', 'phone_number_id': '797327890140094'}, 'statuses': [{'id': 'wamid.HBgLMjc3NjM1MTQwMjgVAgARGBIwRjk2REI0OTEwQjAxQzQxRUIA', 'status': 'delivered', 'timestamp': '1763140408', 'recipient_id': '27763514028', 'conversation': {'id': 'b3e572876083145943e13e7b21e41554', 'origin': {'type': 'service'}}, 'pricing': {'billable': False, 'pricing_model': 'PMP', 'category': 'service', 'type': 'free_customer_service'}}]}, 'field': 'messages'}]}]}"}
{"asctime": "2025-11-14 19:27:16,995", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-11-14 19:27:17,586", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-11-14 19:27:17,586", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-11-14 19:27:17,604", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-11-14 19:27:17,604", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 19:27:17,605", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-11-14 19:27:17,605", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 19:27:17,605", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-11-14 19:27:17,605", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 19:27:17,606", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 19:27:17,607", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 19:27:17,607", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00010s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 19:27:17,609", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 19:27:17,609", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002399s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 19:27:17,610", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 19:27:17,610", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.003056s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 19:27:17,611", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 19:27:17,611", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00008s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 19:27:17,611", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 19:27:17,611", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0007214s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 19:27:17,612", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 19:27:17,612", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001306s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 19:27:17,612", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 19:27:17,612", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-11-14 19:27:17,613", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-11-14 19:27:17,613", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-11-14 19:28:10,470", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-11-14 19:28:11,010", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-11-14 19:28:11,010", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-11-14 19:28:11,027", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-11-14 19:28:11,027", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 19:28:11,028", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-11-14 19:28:11,028", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 19:28:11,028", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-11-14 19:28:11,028", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 19:28:11,028", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 19:28:11,029", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 19:28:11,030", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00010s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 19:28:11,031", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 19:28:11,031", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001121s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 19:28:11,031", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 19:28:11,031", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001365s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 19:28:11,031", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 19:28:11,032", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00007s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 19:28:11,032", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 19:28:11,032", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0005106s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 19:28:11,033", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 19:28:11,033", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001189s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 19:28:11,033", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 19:28:11,033", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-11-14 19:28:11,033", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-11-14 19:28:11,033", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-11-14 19:28:17,106", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-11-14 19:28:17,643", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-11-14 19:28:17,643", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-11-14 19:28:17,660", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-11-14 19:28:17,660", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 19:28:17,661", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-11-14 19:28:17,661", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 19:28:17,661", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-11-14 19:28:17,661", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 19:28:17,662", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 19:28:17,663", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 19:28:17,663", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00010s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 19:28:17,665", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 19:28:17,665", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002389s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 19:28:17,666", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 19:28:17,666", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002916s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 19:28:17,667", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 19:28:17,667", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00007s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 19:28:17,667", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 19:28:17,667", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0007101s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 19:28:17,668", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 19:28:17,668", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.00128s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 19:28:17,669", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 19:28:17,669", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-11-14 19:28:17,669", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-11-14 19:28:17,669", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-11-14 19:28:43,635", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-11-14 19:28:44,187", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-11-14 19:28:44,187", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-11-14 19:28:44,206", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-11-14 19:28:44,206", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 19:28:44,207", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-11-14 19:28:44,207", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 19:28:44,207", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-11-14 19:28:44,207", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 19:28:44,207", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 19:28:44,208", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 19:28:44,209", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00016s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 19:28:44,210", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 19:28:44,210", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001867s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 19:28:44,211", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 19:28:44,211", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002239s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 19:28:44,212", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 19:28:44,212", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00008s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 19:28:44,212", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 19:28:44,212", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0005895s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 19:28:44,212", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 19:28:44,213", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001052s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 19:28:44,213", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 19:28:44,213", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-11-14 19:28:44,213", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-11-14 19:28:44,213", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-11-14 19:28:52,805", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-11-14 19:28:53,329", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-11-14 19:28:53,329", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-11-14 19:28:53,347", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-11-14 19:28:53,347", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 19:28:53,347", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-11-14 19:28:53,347", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 19:28:53,348", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-11-14 19:28:53,348", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 19:28:53,348", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 19:28:53,349", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 19:28:53,349", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00009s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 19:28:53,351", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 19:28:53,351", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001986s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 19:28:53,351", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 19:28:53,351", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002439s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 19:28:53,352", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 19:28:53,352", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00010s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 19:28:53,353", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 19:28:53,353", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0009073s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 19:28:53,354", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 19:28:53,354", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001465s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 19:28:53,354", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 19:28:53,354", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-11-14 19:28:53,354", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-11-14 19:28:53,354", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-11-14 19:30:24,889", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-11-14 19:30:25,499", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-11-14 19:30:25,499", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-11-14 19:30:25,517", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-11-14 19:30:25,517", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 19:30:25,517", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-11-14 19:30:25,517", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 19:30:25,518", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-11-14 19:30:25,518", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 19:30:25,518", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 19:30:25,519", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 19:30:25,519", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00010s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 19:30:25,522", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 19:30:25,522", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002666s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 19:30:25,522", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 19:30:25,522", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.003043s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 19:30:25,523", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 19:30:25,523", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00008s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 19:30:25,524", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 19:30:25,524", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0006747s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 19:30:25,524", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 19:30:25,524", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001213s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 19:30:25,525", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 19:30:25,525", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-11-14 19:30:25,525", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-11-14 19:30:25,525", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-11-14 19:36:34,927", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-11-14 19:36:35,532", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-11-14 19:36:35,532", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-11-14 19:36:35,552", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-11-14 19:36:35,552", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 19:36:35,553", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-11-14 19:36:35,553", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 19:36:35,554", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-11-14 19:36:35,554", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 19:36:35,554", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 19:36:35,555", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 19:36:35,555", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00009s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 19:36:35,557", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 19:36:35,557", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002304s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 19:36:35,558", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 19:36:35,558", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.00271s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 19:36:35,558", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 19:36:35,558", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00008s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 19:36:35,559", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 19:36:35,559", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0006608s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 19:36:35,560", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 19:36:35,560", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001208s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 19:36:35,560", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 19:36:35,560", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-11-14 19:36:35,560", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-11-14 19:36:35,560", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-11-14 19:36:41,620", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-11-14 19:36:42,125", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-11-14 19:36:42,125", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-11-14 19:36:42,144", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-11-14 19:36:42,144", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 19:36:42,144", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-11-14 19:36:42,144", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 19:36:42,145", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-11-14 19:36:42,145", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 19:36:42,145", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 19:36:42,147", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 19:36:42,147", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00016s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 19:36:42,148", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 19:36:42,148", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001271s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 19:36:42,148", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 19:36:42,148", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001595s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 19:36:42,149", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 19:36:42,149", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00011s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 19:36:42,150", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 19:36:42,150", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0007951s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 19:36:42,150", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 19:36:42,150", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001326s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 19:36:42,151", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 19:36:42,151", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-11-14 19:36:42,151", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-11-14 19:36:42,151", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
{"asctime": "2025-11-14 19:39:04,507", "name": "app.main", "levelname": "INFO", "message": "Shutting down Cyrax..."}
{"asctime": "2025-11-14 19:39:05,028", "name": "app.main", "levelname": "INFO", "message": "Starting Cyrax v1.0.0"}
{"asctime": "2025-11-14 19:39:05,028", "name": "app.main", "levelname": "INFO", "message": "Environment: development"}
{"asctime": "2025-11-14 19:39:05,047", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select pg_catalog.version()"}
{"asctime": "2025-11-14 19:39:05,047", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 19:39:05,048", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "select current_schema()"}
{"asctime": "2025-11-14 19:39:05,048", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 19:39:05,049", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "show standard_conforming_strings"}
{"asctime": "2025-11-14 19:39:05,049", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[raw sql] {}"}
{"asctime": "2025-11-14 19:39:05,049", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "BEGIN (implicit)"}
{"asctime": "2025-11-14 19:39:05,050", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 19:39:05,050", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00010s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 19:39:05,053", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 19:39:05,053", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002277s ago] {'table_name': 'conversations', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 19:39:05,053", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_class.relname \nFROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace \nWHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 19:39:05,053", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.002762s ago] {'table_name': 'transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 19:39:05,054", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 19:39:05,054", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[generated in 0.00007s] {'typname_1': 'userstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 19:39:05,054", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 19:39:05,055", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.0006371s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 19:39:05,055", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "SELECT pg_catalog.pg_type.typname \nFROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace \nWHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s"}
{"asctime": "2025-11-14 19:39:05,055", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "[cached since 0.001266s ago] {'typname_1': 'transactionstatus', 'nspname_1': 'pg_catalog'}"}
{"asctime": "2025-11-14 19:39:05,056", "name": "sqlalchemy.engine.Engine", "levelname": "INFO", "message": "COMMIT"}
{"asctime": "2025-11-14 19:39:05,056", "name": "app.database", "levelname": "INFO", "message": "Database tables created successfully"}
{"asctime": "2025-11-14 19:39:05,056", "name": "app.main", "levelname": "INFO", "message": "Database initialized successfully"}
{"asctime": "2025-11-14 19:39:05,056", "name": "app.main", "levelname": "INFO", "message": "Cyrax startup complete!"}
